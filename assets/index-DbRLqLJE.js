(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var JB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var XS={exports:{}},om={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mM=Symbol.for("react.transitional.element"),_M=Symbol.for("react.fragment");function JS(e,n,t){var r=null;if(t!==void 0&&(r=""+t),n.key!==void 0&&(r=""+n.key),"key"in n){t={};for(var i in n)i!=="key"&&(t[i]=n[i])}else t=n;return n=t.ref,{$$typeof:mM,type:e,key:r,ref:n!==void 0?n:null,props:t}}om.Fragment=_M;om.jsx=JS;om.jsxs=JS;XS.exports=om;var $i=XS.exports,eT={exports:{}},lm={},tT={exports:{}},nT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(Q,Z){var X=Q.length;Q.push(Z);e:for(;0<X;){var se=X-1>>>1,Ce=Q[se];if(0<i(Ce,Z))Q[se]=Z,Q[X]=Ce,X=se;else break e}}function t(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var Z=Q[0],X=Q.pop();if(X!==Z){Q[0]=X;e:for(var se=0,Ce=Q.length,Me=Ce>>>1;se<Me;){var Ue=2*(se+1)-1,Le=Q[Ue],ot=Ue+1,pe=Q[ot];if(0>i(Le,X))ot<Ce&&0>i(pe,Le)?(Q[se]=pe,Q[ot]=X,se=ot):(Q[se]=Le,Q[Ue]=X,se=Ue);else if(ot<Ce&&0>i(pe,X))Q[se]=pe,Q[ot]=X,se=ot;else break e}}return Z}function i(Q,Z){var X=Q.sortIndex-Z.sortIndex;return X!==0?X:Q.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,d=null,h=3,f=!1,m=!1,y=!1,C=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;function E(Q){for(var Z=t(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=Q)r(u),Z.sortIndex=Z.expirationTime,n(l,Z);else break;Z=t(u)}}function S(Q){if(y=!1,E(Q),!m)if(t(l)!==null)m=!0,ee();else{var Z=t(u);Z!==null&&ve(S,Z.startTime-Q)}}var w=!1,A=-1,D=5,O=-1;function M(){return!(e.unstable_now()-O<D)}function F(){if(w){var Q=e.unstable_now();O=Q;var Z=!0;try{e:{m=!1,y&&(y=!1,b(A),A=-1),f=!0;var X=h;try{t:{for(E(Q),d=t(l);d!==null&&!(d.expirationTime>Q&&M());){var se=d.callback;if(typeof se=="function"){d.callback=null,h=d.priorityLevel;var Ce=se(d.expirationTime<=Q);if(Q=e.unstable_now(),typeof Ce=="function"){d.callback=Ce,E(Q),Z=!0;break t}d===t(l)&&r(l),E(Q)}else r(l);d=t(l)}if(d!==null)Z=!0;else{var Me=t(u);Me!==null&&ve(S,Me.startTime-Q),Z=!1}}break e}finally{d=null,h=X,f=!1}Z=void 0}}finally{Z?U():w=!1}}}var U;if(typeof v=="function")U=function(){v(F)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,J=$.port2;$.port1.onmessage=F,U=function(){J.postMessage(null)}}else U=function(){C(F,0)};function ee(){w||(w=!0,U())}function ve(Q,Z){A=C(function(){Q(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,ee())},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return t(l)},e.unstable_next=function(Q){switch(h){case 1:case 2:case 3:var Z=3;break;default:Z=h}var X=h;h=Z;try{return Q()}finally{h=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,Z){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var X=h;h=Q;try{return Z()}finally{h=X}},e.unstable_scheduleCallback=function(Q,Z,X){var se=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?se+X:se):X=se,Q){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=X+Ce,Q={id:c++,callback:Z,priorityLevel:Q,startTime:X,expirationTime:Ce,sortIndex:-1},X>se?(Q.sortIndex=X,n(u,Q),t(l)===null&&Q===t(u)&&(y?(b(A),A=-1):y=!0,ve(S,X-se))):(Q.sortIndex=Ce,n(l,Q),m||f||(m=!0,ee())),Q},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(Q){var Z=h;return function(){var X=h;h=Z;try{return Q.apply(this,arguments)}finally{h=X}}}})(nT);tT.exports=nT;var gM=tT.exports,rT={exports:{}},je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T0=Symbol.for("react.transitional.element"),vM=Symbol.for("react.portal"),yM=Symbol.for("react.fragment"),bM=Symbol.for("react.strict_mode"),EM=Symbol.for("react.profiler"),CM=Symbol.for("react.consumer"),SM=Symbol.for("react.context"),TM=Symbol.for("react.forward_ref"),wM=Symbol.for("react.suspense"),AM=Symbol.for("react.memo"),iT=Symbol.for("react.lazy"),Ab=Symbol.iterator;function NM(e){return e===null||typeof e!="object"?null:(e=Ab&&e[Ab]||e["@@iterator"],typeof e=="function"?e:null)}var aT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sT=Object.assign,oT={};function Hu(e,n,t){this.props=e,this.context=n,this.refs=oT,this.updater=t||aT}Hu.prototype.isReactComponent={};Hu.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Hu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lT(){}lT.prototype=Hu.prototype;function w0(e,n,t){this.props=e,this.context=n,this.refs=oT,this.updater=t||aT}var A0=w0.prototype=new lT;A0.constructor=w0;sT(A0,Hu.prototype);A0.isPureReactComponent=!0;var Nb=Array.isArray,Qt={H:null,A:null,T:null,S:null},uT=Object.prototype.hasOwnProperty;function N0(e,n,t,r,i,a){return t=a.ref,{$$typeof:T0,type:e,key:n,ref:t!==void 0?t:null,props:a}}function IM(e,n){return N0(e.type,n,void 0,void 0,void 0,e.props)}function I0(e){return typeof e=="object"&&e!==null&&e.$$typeof===T0}function MM(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return n[t]})}var Ib=/\/+/g;function g_(e,n){return typeof e=="object"&&e!==null&&e.key!=null?MM(""+e.key):n.toString(36)}function Mb(){}function xM(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(Mb,Mb):(e.status="pending",e.then(function(n){e.status==="pending"&&(e.status="fulfilled",e.value=n)},function(n){e.status==="pending"&&(e.status="rejected",e.reason=n)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Gl(e,n,t,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"bigint":case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case T0:case vM:s=!0;break;case iT:return s=e._init,Gl(s(e._payload),n,t,r,i)}}if(s)return i=i(e),s=r===""?"."+g_(e,0):r,Nb(i)?(t="",s!=null&&(t=s.replace(Ib,"$&/")+"/"),Gl(i,n,t,"",function(u){return u})):i!=null&&(I0(i)&&(i=IM(i,t+(i.key==null||e&&e.key===i.key?"":(""+i.key).replace(Ib,"$&/")+"/")+s)),n.push(i)),1;s=0;var o=r===""?".":r+":";if(Nb(e))for(var l=0;l<e.length;l++)r=e[l],a=o+g_(r,l),s+=Gl(r,n,t,a,i);else if(l=NM(e),typeof l=="function")for(e=l.call(e),l=0;!(r=e.next()).done;)r=r.value,a=o+g_(r,l++),s+=Gl(r,n,t,a,i);else if(a==="object"){if(typeof e.then=="function")return Gl(xM(e),n,t,r,i);throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.")}return s}function Mh(e,n,t){if(e==null)return e;var r=[],i=0;return Gl(e,r,"","",function(a){return n.call(t,a,i++)}),r}function OM(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var xb=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function DM(){}je.Children={map:Mh,forEach:function(e,n,t){Mh(e,function(){n.apply(this,arguments)},t)},count:function(e){var n=0;return Mh(e,function(){n++}),n},toArray:function(e){return Mh(e,function(n){return n})||[]},only:function(e){if(!I0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};je.Component=Hu;je.Fragment=yM;je.Profiler=EM;je.PureComponent=w0;je.StrictMode=bM;je.Suspense=wM;je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Qt;je.act=function(){throw Error("act(...) is not supported in production builds of React.")};je.cache=function(e){return function(){return e.apply(null,arguments)}};je.cloneElement=function(e,n,t){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var r=sT({},e.props),i=e.key,a=void 0;if(n!=null)for(s in n.ref!==void 0&&(a=void 0),n.key!==void 0&&(i=""+n.key),n)!uT.call(n,s)||s==="key"||s==="__self"||s==="__source"||s==="ref"&&n.ref===void 0||(r[s]=n[s]);var s=arguments.length-2;if(s===1)r.children=t;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];r.children=o}return N0(e.type,i,void 0,void 0,a,r)};je.createContext=function(e){return e={$$typeof:SM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:CM,_context:e},e};je.createElement=function(e,n,t){var r,i={},a=null;if(n!=null)for(r in n.key!==void 0&&(a=""+n.key),n)uT.call(n,r)&&r!=="key"&&r!=="__self"&&r!=="__source"&&(i[r]=n[r]);var s=arguments.length-2;if(s===1)i.children=t;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];i.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return N0(e,a,void 0,void 0,null,i)};je.createRef=function(){return{current:null}};je.forwardRef=function(e){return{$$typeof:TM,render:e}};je.isValidElement=I0;je.lazy=function(e){return{$$typeof:iT,_payload:{_status:-1,_result:e},_init:OM}};je.memo=function(e,n){return{$$typeof:AM,type:e,compare:n===void 0?null:n}};je.startTransition=function(e){var n=Qt.T,t={};Qt.T=t;try{var r=e(),i=Qt.S;i!==null&&i(t,r),typeof r=="object"&&r!==null&&typeof r.then=="function"&&r.then(DM,xb)}catch(a){xb(a)}finally{Qt.T=n}};je.unstable_useCacheRefresh=function(){return Qt.H.useCacheRefresh()};je.use=function(e){return Qt.H.use(e)};je.useActionState=function(e,n,t){return Qt.H.useActionState(e,n,t)};je.useCallback=function(e,n){return Qt.H.useCallback(e,n)};je.useContext=function(e){return Qt.H.useContext(e)};je.useDebugValue=function(){};je.useDeferredValue=function(e,n){return Qt.H.useDeferredValue(e,n)};je.useEffect=function(e,n){return Qt.H.useEffect(e,n)};je.useId=function(){return Qt.H.useId()};je.useImperativeHandle=function(e,n,t){return Qt.H.useImperativeHandle(e,n,t)};je.useInsertionEffect=function(e,n){return Qt.H.useInsertionEffect(e,n)};je.useLayoutEffect=function(e,n){return Qt.H.useLayoutEffect(e,n)};je.useMemo=function(e,n){return Qt.H.useMemo(e,n)};je.useOptimistic=function(e,n){return Qt.H.useOptimistic(e,n)};je.useReducer=function(e,n,t){return Qt.H.useReducer(e,n,t)};je.useRef=function(e){return Qt.H.useRef(e)};je.useState=function(e){return Qt.H.useState(e)};je.useSyncExternalStore=function(e,n,t){return Qt.H.useSyncExternalStore(e,n,t)};je.useTransition=function(){return Qt.H.useTransition()};je.version="19.0.0";rT.exports=je;var p=rT.exports;const ye=ZS(p);var cT={exports:{}},Er={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kM=p;function dT(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function us(){}var mr={d:{f:us,r:function(){throw Error(dT(522))},D:us,C:us,L:us,m:us,X:us,S:us,M:us},p:0,findDOMNode:null},RM=Symbol.for("react.portal");function UM(e,n,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:RM,key:r==null?null:""+r,children:e,containerInfo:n,implementation:t}}var Hc=kM.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function um(e,n){if(e==="font")return"";if(typeof n=="string")return n==="use-credentials"?n:""}Er.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=mr;Er.createPortal=function(e,n){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)throw Error(dT(299));return UM(e,n,null,t)};Er.flushSync=function(e){var n=Hc.T,t=mr.p;try{if(Hc.T=null,mr.p=2,e)return e()}finally{Hc.T=n,mr.p=t,mr.d.f()}};Er.preconnect=function(e,n){typeof e=="string"&&(n?(n=n.crossOrigin,n=typeof n=="string"?n==="use-credentials"?n:"":void 0):n=null,mr.d.C(e,n))};Er.prefetchDNS=function(e){typeof e=="string"&&mr.d.D(e)};Er.preinit=function(e,n){if(typeof e=="string"&&n&&typeof n.as=="string"){var t=n.as,r=um(t,n.crossOrigin),i=typeof n.integrity=="string"?n.integrity:void 0,a=typeof n.fetchPriority=="string"?n.fetchPriority:void 0;t==="style"?mr.d.S(e,typeof n.precedence=="string"?n.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:a}):t==="script"&&mr.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:a,nonce:typeof n.nonce=="string"?n.nonce:void 0})}};Er.preinitModule=function(e,n){if(typeof e=="string")if(typeof n=="object"&&n!==null){if(n.as==null||n.as==="script"){var t=um(n.as,n.crossOrigin);mr.d.M(e,{crossOrigin:t,integrity:typeof n.integrity=="string"?n.integrity:void 0,nonce:typeof n.nonce=="string"?n.nonce:void 0})}}else n==null&&mr.d.M(e)};Er.preload=function(e,n){if(typeof e=="string"&&typeof n=="object"&&n!==null&&typeof n.as=="string"){var t=n.as,r=um(t,n.crossOrigin);mr.d.L(e,t,{crossOrigin:r,integrity:typeof n.integrity=="string"?n.integrity:void 0,nonce:typeof n.nonce=="string"?n.nonce:void 0,type:typeof n.type=="string"?n.type:void 0,fetchPriority:typeof n.fetchPriority=="string"?n.fetchPriority:void 0,referrerPolicy:typeof n.referrerPolicy=="string"?n.referrerPolicy:void 0,imageSrcSet:typeof n.imageSrcSet=="string"?n.imageSrcSet:void 0,imageSizes:typeof n.imageSizes=="string"?n.imageSizes:void 0,media:typeof n.media=="string"?n.media:void 0})}};Er.preloadModule=function(e,n){if(typeof e=="string")if(n){var t=um(n.as,n.crossOrigin);mr.d.m(e,{as:typeof n.as=="string"&&n.as!=="script"?n.as:void 0,crossOrigin:t,integrity:typeof n.integrity=="string"?n.integrity:void 0})}else mr.d.m(e)};Er.requestFormReset=function(e){mr.d.r(e)};Er.unstable_batchedUpdates=function(e,n){return e(n)};Er.useFormState=function(e,n,t){return Hc.H.useFormState(e,n,t)};Er.useFormStatus=function(){return Hc.H.useHostTransitionStatus()};Er.version="19.0.0";function hT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hT)}catch(e){console.error(e)}}hT(),cT.exports=Er;var fT=cT.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cn=gM,pT=p,LM=fT;function Y(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)n+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function mT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var PM=Symbol.for("react.element"),xh=Symbol.for("react.transitional.element"),Mc=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),_T=Symbol.for("react.strict_mode"),qg=Symbol.for("react.profiler"),FM=Symbol.for("react.provider"),gT=Symbol.for("react.consumer"),Ua=Symbol.for("react.context"),M0=Symbol.for("react.forward_ref"),Bg=Symbol.for("react.suspense"),Gg=Symbol.for("react.suspense_list"),x0=Symbol.for("react.memo"),gs=Symbol.for("react.lazy"),vT=Symbol.for("react.offscreen"),$M=Symbol.for("react.memo_cache_sentinel"),Ob=Symbol.iterator;function sc(e){return e===null||typeof e!="object"?null:(e=Ob&&e[Ob]||e["@@iterator"],typeof e=="function"?e:null)}var zM=Symbol.for("react.client.reference");function Vg(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===zM?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kl:return"Fragment";case Mc:return"Portal";case qg:return"Profiler";case _T:return"StrictMode";case Bg:return"Suspense";case Gg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ua:return(e.displayName||"Context")+".Provider";case gT:return(e._context.displayName||"Context")+".Consumer";case M0:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case x0:return n=e.displayName||null,n!==null?n:Vg(e.type)||"Memo";case gs:n=e._payload,e=e._init;try{return Vg(e(n))}catch{}}return null}var Be=pT.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$t=Object.assign,v_,Db;function xc(e){if(v_===void 0)try{throw Error()}catch(t){var n=t.stack.trim().match(/\n( *(at )?)/);v_=n&&n[1]||"",Db=-1<t.stack.indexOf(`
    at`)?" (<anonymous>)":-1<t.stack.indexOf("@")?"@unknown:0:0":""}return`
`+v_+e+Db}var y_=!1;function b_(e,n){if(!e||y_)return"";y_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(n){var d=function(){throw Error()};if(Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(f){var h=f}Reflect.construct(e,[],d)}else{try{d.call()}catch(f){h=f}e.call(d.prototype)}}else{try{throw Error()}catch(f){h=f}(d=e())&&typeof d.catch=="function"&&d.catch(function(){})}}catch(f){if(f&&h&&typeof f.stack=="string")return[f.stack,h.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=r.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var l=s.split(`
`),u=o.split(`
`);for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===u.length)for(r=l.length-1,i=u.length-1;1<=r&&0<=i&&l[r]!==u[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==u[i]){if(r!==1||i!==1)do if(r--,i--,0>i||l[r]!==u[i]){var c=`
`+l[r].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=r&&0<=i);break}}}finally{y_=!1,Error.prepareStackTrace=t}return(t=e?e.displayName||e.name:"")?xc(t):""}function HM(e){switch(e.tag){case 26:case 27:case 5:return xc(e.type);case 16:return xc("Lazy");case 13:return xc("Suspense");case 19:return xc("SuspenseList");case 0:case 15:return e=b_(e.type,!1),e;case 11:return e=b_(e.type.render,!1),e;case 1:return e=b_(e.type,!0),e;default:return""}}function kb(e){try{var n="";do n+=HM(e),e=e.return;while(e);return n}catch(t){return`
Error generating stack: `+t.message+`
`+t.stack}}function qu(e){var n=e,t=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(t=n.return),e=n.return;while(e)}return n.tag===3?t:null}function yT(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Rb(e){if(qu(e)!==e)throw Error(Y(188))}function qM(e){var n=e.alternate;if(!n){if(n=qu(e),n===null)throw Error(Y(188));return n!==e?null:e}for(var t=e,r=n;;){var i=t.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===t)return Rb(i),e;if(a===r)return Rb(i),n;a=a.sibling}throw Error(Y(188))}if(t.return!==r.return)t=i,r=a;else{for(var s=!1,o=i.child;o;){if(o===t){s=!0,t=i,r=a;break}if(o===r){s=!0,r=i,t=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===t){s=!0,t=a,r=i;break}if(o===r){s=!0,r=a,t=i;break}o=o.sibling}if(!s)throw Error(Y(189))}}if(t.alternate!==r)throw Error(Y(190))}if(t.tag!==3)throw Error(Y(188));return t.stateNode.current===t?e:n}function bT(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=bT(e),n!==null)return n;e=e.sibling}return null}var Oc=Array.isArray,Ft=LM.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bo={pending:!1,data:null,method:null,action:null},jg=[],Wl=-1;function da(e){return{current:e}}function Pn(e){0>Wl||(e.current=jg[Wl],jg[Wl]=null,Wl--)}function Bt(e,n){Wl++,jg[Wl]=e.current,e.current=n}var ia=da(null),Td=da(null),Ds=da(null),Zf=da(null);function Xf(e,n){switch(Bt(Ds,n),Bt(Td,e),Bt(ia,null),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)&&(n=n.namespaceURI)?UE(n):0;break;default:if(e=e===8?n.parentNode:n,n=e.tagName,e=e.namespaceURI)e=UE(e),n=D2(e,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}Pn(ia),Bt(ia,n)}function vu(){Pn(ia),Pn(Td),Pn(Ds)}function Qg(e){e.memoizedState!==null&&Bt(Zf,e);var n=ia.current,t=D2(n,e.type);n!==t&&(Bt(Td,e),Bt(ia,t))}function Jf(e){Td.current===e&&(Pn(ia),Pn(Td)),Zf.current===e&&(Pn(Zf),Ud._currentValue=Bo)}var Kg=Object.prototype.hasOwnProperty,O0=Cn.unstable_scheduleCallback,E_=Cn.unstable_cancelCallback,BM=Cn.unstable_shouldYield,GM=Cn.unstable_requestPaint,aa=Cn.unstable_now,VM=Cn.unstable_getCurrentPriorityLevel,ET=Cn.unstable_ImmediatePriority,CT=Cn.unstable_UserBlockingPriority,ep=Cn.unstable_NormalPriority,jM=Cn.unstable_LowPriority,ST=Cn.unstable_IdlePriority,QM=Cn.log,KM=Cn.unstable_setDisableYieldValue,Xd=null,Gr=null;function WM(e){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(Xd,e,void 0,(e.current.flags&128)===128)}catch{}}function Ns(e){if(typeof QM=="function"&&KM(e),Gr&&typeof Gr.setStrictMode=="function")try{Gr.setStrictMode(Xd,e)}catch{}}var Vr=Math.clz32?Math.clz32:XM,YM=Math.log,ZM=Math.LN2;function XM(e){return e>>>=0,e===0?32:31-(YM(e)/ZM|0)|0}var Oh=128,Dh=4194304;function Co(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function cm(e,n){var t=e.pendingLanes;if(t===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=e.warmLanes;e=e.finishedLanes!==0;var o=t&134217727;return o!==0?(t=o&~i,t!==0?r=Co(t):(a&=o,a!==0?r=Co(a):e||(s=o&~s,s!==0&&(r=Co(s))))):(o=t&~i,o!==0?r=Co(o):a!==0?r=Co(a):e||(s=t&~s,s!==0&&(r=Co(s)))),r===0?0:n!==0&&n!==r&&!(n&i)&&(i=r&-r,s=n&-n,i>=s||i===32&&(s&4194176)!==0)?n:r}function Jd(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function JM(e,n){switch(e){case 1:case 2:case 4:case 8:return n+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TT(){var e=Oh;return Oh<<=1,!(Oh&4194176)&&(Oh=128),e}function wT(){var e=Dh;return Dh<<=1,!(Dh&62914560)&&(Dh=4194304),e}function C_(e){for(var n=[],t=0;31>t;t++)n.push(e);return n}function eh(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ex(e,n,t,r,i,a){var s=e.pendingLanes;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=t,e.entangledLanes&=t,e.errorRecoveryDisabledLanes&=t,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,u=e.hiddenUpdates;for(t=s&~t;0<t;){var c=31-Vr(t),d=1<<c;o[c]=0,l[c]=-1;var h=u[c];if(h!==null)for(u[c]=null,c=0;c<h.length;c++){var f=h[c];f!==null&&(f.lane&=-536870913)}t&=~d}r!==0&&AT(e,r,0),a!==0&&i===0&&e.tag!==0&&(e.suspendedLanes|=a&~(s&~n))}function AT(e,n,t){e.pendingLanes|=n,e.suspendedLanes&=~n;var r=31-Vr(n);e.entangledLanes|=n,e.entanglements[r]=e.entanglements[r]|1073741824|t&4194218}function NT(e,n){var t=e.entangledLanes|=n;for(e=e.entanglements;t;){var r=31-Vr(t),i=1<<r;i&n|e[r]&n&&(e[r]|=n),t&=~i}}function IT(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function MT(){var e=Ft.p;return e!==0?e:(e=window.event,e===void 0?32:q2(e.type))}function tx(e,n){var t=Ft.p;try{return Ft.p=e,n()}finally{Ft.p=t}}var ro=Math.random().toString(36).slice(2),rr="__reactFiber$"+ro,Nr="__reactProps$"+ro,Bu="__reactContainer$"+ro,Wg="__reactEvents$"+ro,nx="__reactListeners$"+ro,rx="__reactHandles$"+ro,Ub="__reactResources$"+ro,wd="__reactMarker$"+ro;function D0(e){delete e[rr],delete e[Nr],delete e[Wg],delete e[nx],delete e[rx]}function Do(e){var n=e[rr];if(n)return n;for(var t=e.parentNode;t;){if(n=t[Bu]||t[rr]){if(t=n.alternate,n.child!==null||t!==null&&t.child!==null)for(e=PE(e);e!==null;){if(t=e[rr])return t;e=PE(e)}return n}e=t,t=e.parentNode}return null}function Gu(e){if(e=e[rr]||e[Bu]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function Dc(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(Y(33))}function lu(e){var n=e[Ub];return n||(n=e[Ub]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Dn(e){e[wd]=!0}var xT=new Set,OT={};function gl(e,n){yu(e,n),yu(e+"Capture",n)}function yu(e,n){for(OT[e]=n,e=0;e<n.length;e++)xT.add(n[e])}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ix=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lb={},Pb={};function ax(e){return Kg.call(Pb,e)?!0:Kg.call(Lb,e)?!1:ix.test(e)?Pb[e]=!0:(Lb[e]=!0,!1)}function Cf(e,n,t){if(ax(n))if(t===null)e.removeAttribute(n);else{switch(typeof t){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var r=n.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+t)}}function kh(e,n,t){if(t===null)e.removeAttribute(n);else{switch(typeof t){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+t)}}function ya(e,n,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttributeNS(n,t,""+r)}}function ai(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function DT(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function sx(e){var n=DT(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,a=t.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,a.call(this,s)}}),Object.defineProperty(e,n,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function tp(e){e._valueTracker||(e._valueTracker=sx(e))}function kT(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var t=n.getValue(),r="";return e&&(r=DT(e)?e.checked?"true":"false":e.value),e=r,e!==t?(n.setValue(e),!0):!1}function np(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ox=/[\n"\\]/g;function ci(e){return e.replace(ox,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Yg(e,n,t,r,i,a,s,o){e.name="",s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?e.type=s:e.removeAttribute("type"),n!=null?s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+ai(n)):e.value!==""+ai(n)&&(e.value=""+ai(n)):s!=="submit"&&s!=="reset"||e.removeAttribute("value"),n!=null?Zg(e,s,ai(n)):t!=null?Zg(e,s,ai(t)):r!=null&&e.removeAttribute("value"),i==null&&a!=null&&(e.defaultChecked=!!a),i!=null&&(e.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.name=""+ai(o):e.removeAttribute("name")}function RT(e,n,t,r,i,a,s,o){if(a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(e.type=a),n!=null||t!=null){if(!(a!=="submit"&&a!=="reset"||n!=null))return;t=t!=null?""+ai(t):"",n=n!=null?""+ai(n):t,o||n===e.value||(e.value=n),e.defaultValue=n}r=r??i,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.name=s)}function Zg(e,n,t){n==="number"&&np(e.ownerDocument)===e||e.defaultValue===""+t||(e.defaultValue=""+t)}function uu(e,n,t,r){if(e=e.options,n){n={};for(var i=0;i<t.length;i++)n["$"+t[i]]=!0;for(t=0;t<e.length;t++)i=n.hasOwnProperty("$"+e[t].value),e[t].selected!==i&&(e[t].selected=i),i&&r&&(e[t].defaultSelected=!0)}else{for(t=""+ai(t),n=null,i=0;i<e.length;i++){if(e[i].value===t){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}n!==null||e[i].disabled||(n=e[i])}n!==null&&(n.selected=!0)}}function UT(e,n,t){if(n!=null&&(n=""+ai(n),n!==e.value&&(e.value=n),t==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=t!=null?""+ai(t):""}function LT(e,n,t,r){if(n==null){if(r!=null){if(t!=null)throw Error(Y(92));if(Oc(r)){if(1<r.length)throw Error(Y(93));r=r[0]}t=r}t==null&&(t=""),n=t}t=ai(n),e.defaultValue=t,r=e.textContent,r===t&&r!==""&&r!==null&&(e.value=r)}function bu(e,n){if(n){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=n;return}}e.textContent=n}var lx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fb(e,n,t){var r=n.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?r?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":r?e.setProperty(n,t):typeof t!="number"||t===0||lx.has(n)?n==="float"?e.cssFloat=t:e[n]=(""+t).trim():e[n]=t+"px"}function PT(e,n,t){if(n!=null&&typeof n!="object")throw Error(Y(62));if(e=e.style,t!=null){for(var r in t)!t.hasOwnProperty(r)||n!=null&&n.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var i in n)r=n[i],n.hasOwnProperty(i)&&t[i]!==r&&Fb(e,i,r)}else for(var a in n)n.hasOwnProperty(a)&&Fb(e,a,n[a])}function k0(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ux=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sf(e){return cx.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Xg=null;function R0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Yl=null,cu=null;function $b(e){var n=Gu(e);if(n&&(e=n.stateNode)){var t=e[Nr]||null;e:switch(e=n.stateNode,n.type){case"input":if(Yg(e,t.value,t.defaultValue,t.defaultValue,t.checked,t.defaultChecked,t.type,t.name),n=t.name,t.type==="radio"&&n!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll('input[name="'+ci(""+n)+'"][type="radio"]'),n=0;n<t.length;n++){var r=t[n];if(r!==e&&r.form===e.form){var i=r[Nr]||null;if(!i)throw Error(Y(90));Yg(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(n=0;n<t.length;n++)r=t[n],r.form===e.form&&kT(r)}break e;case"textarea":UT(e,t.value,t.defaultValue);break e;case"select":n=t.value,n!=null&&uu(e,!!t.multiple,n,!1)}}}var S_=!1;function FT(e,n,t){if(S_)return e(n,t);S_=!0;try{var r=e(n);return r}finally{if(S_=!1,(Yl!==null||cu!==null)&&(bm(),Yl&&(n=Yl,e=cu,cu=Yl=null,$b(n),e)))for(n=0;n<e.length;n++)$b(e[n])}}function Ad(e,n){var t=e.stateNode;if(t===null)return null;var r=t[Nr]||null;if(r===null)return null;t=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(Y(231,n,typeof t));return t}var Jg=!1;if(Va)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{Jg=!1}var Is=null,U0=null,Tf=null;function $T(){if(Tf)return Tf;var e,n=U0,t=n.length,r,i="value"in Is?Is.value:Is.textContent,a=i.length;for(e=0;e<t&&n[e]===i[e];e++);var s=t-e;for(r=1;r<=s&&n[t-r]===i[a-r];r++);return Tf=i.slice(e,1<r?1-r:void 0)}function wf(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Rh(){return!0}function zb(){return!1}function Ir(e){function n(t,r,i,a,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Rh:zb,this.isPropagationStopped=zb,this}return $t(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Rh)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Rh)},persist:function(){},isPersistent:Rh}),n}var vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dm=Ir(vl),th=$t({},vl,{view:0,detail:0}),dx=Ir(th),T_,w_,lc,hm=$t({},th,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:L0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==lc&&(lc&&e.type==="mousemove"?(T_=e.screenX-lc.screenX,w_=e.screenY-lc.screenY):w_=T_=0,lc=e),T_)},movementY:function(e){return"movementY"in e?e.movementY:w_}}),Hb=Ir(hm),hx=$t({},hm,{dataTransfer:0}),fx=Ir(hx),px=$t({},th,{relatedTarget:0}),A_=Ir(px),mx=$t({},vl,{animationName:0,elapsedTime:0,pseudoElement:0}),_x=Ir(mx),gx=$t({},vl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vx=Ir(gx),yx=$t({},vl,{data:0}),qb=Ir(yx),bx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ex={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sx(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Cx[e])?!!n[e]:!1}function L0(){return Sx}var Tx=$t({},th,{key:function(e){if(e.key){var n=bx[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=wf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ex[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:L0,charCode:function(e){return e.type==="keypress"?wf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wx=Ir(Tx),Ax=$t({},hm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bb=Ir(Ax),Nx=$t({},th,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:L0}),Ix=Ir(Nx),Mx=$t({},vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),xx=Ir(Mx),Ox=$t({},hm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dx=Ir(Ox),kx=$t({},vl,{newState:0,oldState:0}),Rx=Ir(kx),Ux=[9,13,27,32],P0=Va&&"CompositionEvent"in window,qc=null;Va&&"documentMode"in document&&(qc=document.documentMode);var Lx=Va&&"TextEvent"in window&&!qc,zT=Va&&(!P0||qc&&8<qc&&11>=qc),Gb=" ",Vb=!1;function HT(e,n){switch(e){case"keyup":return Ux.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qT(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zl=!1;function Px(e,n){switch(e){case"compositionend":return qT(n);case"keypress":return n.which!==32?null:(Vb=!0,Gb);case"textInput":return e=n.data,e===Gb&&Vb?null:e;default:return null}}function Fx(e,n){if(Zl)return e==="compositionend"||!P0&&HT(e,n)?(e=$T(),Tf=U0=Is=null,Zl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return zT&&n.locale!=="ko"?null:n.data;default:return null}}var $x={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jb(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!$x[e.type]:n==="textarea"}function BT(e,n,t,r){Yl?cu?cu.push(r):cu=[r]:Yl=r,n=vp(n,"onChange"),0<n.length&&(t=new dm("onChange","change",null,t,r),e.push({event:t,listeners:n}))}var Bc=null,Nd=null;function zx(e){M2(e,0)}function fm(e){var n=Dc(e);if(kT(n))return e}function Qb(e,n){if(e==="change")return n}var GT=!1;if(Va){var N_;if(Va){var I_="oninput"in document;if(!I_){var Kb=document.createElement("div");Kb.setAttribute("oninput","return;"),I_=typeof Kb.oninput=="function"}N_=I_}else N_=!1;GT=N_&&(!document.documentMode||9<document.documentMode)}function Wb(){Bc&&(Bc.detachEvent("onpropertychange",VT),Nd=Bc=null)}function VT(e){if(e.propertyName==="value"&&fm(Nd)){var n=[];BT(n,Nd,e,R0(e)),FT(zx,n)}}function Hx(e,n,t){e==="focusin"?(Wb(),Bc=n,Nd=t,Bc.attachEvent("onpropertychange",VT)):e==="focusout"&&Wb()}function qx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fm(Nd)}function Bx(e,n){if(e==="click")return fm(n)}function Gx(e,n){if(e==="input"||e==="change")return fm(n)}function Vx(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Kr=typeof Object.is=="function"?Object.is:Vx;function Id(e,n){if(Kr(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var t=Object.keys(e),r=Object.keys(n);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Kg.call(n,i)||!Kr(e[i],n[i]))return!1}return!0}function Yb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zb(e,n){var t=Yb(e);e=0;for(var r;t;){if(t.nodeType===3){if(r=e+t.textContent.length,e<=n&&r>=n)return{node:t,offset:n-e};e=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Yb(t)}}function jT(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?jT(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function QT(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=np(e.document);n instanceof e.HTMLIFrameElement;){try{var t=typeof n.contentWindow.location.href=="string"}catch{t=!1}if(t)e=n.contentWindow;else break;n=np(e.document)}return n}function F0(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function jx(e,n){var t=QT(n);n=e.focusedElem;var r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&jT(n.ownerDocument.documentElement,n)){if(r!==null&&F0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=Zb(n,a);var s=Zb(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Qx=Va&&"documentMode"in document&&11>=document.documentMode,Xl=null,ev=null,Gc=null,tv=!1;function Xb(e,n,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;tv||Xl==null||Xl!==np(r)||(r=Xl,"selectionStart"in r&&F0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gc&&Id(Gc,r)||(Gc=r,r=vp(ev,"onSelect"),0<r.length&&(n=new dm("onSelect","select",null,n,t),e.push({event:n,listeners:r}),n.target=Xl)))}function go(e,n){var t={};return t[e.toLowerCase()]=n.toLowerCase(),t["Webkit"+e]="webkit"+n,t["Moz"+e]="moz"+n,t}var Jl={animationend:go("Animation","AnimationEnd"),animationiteration:go("Animation","AnimationIteration"),animationstart:go("Animation","AnimationStart"),transitionrun:go("Transition","TransitionRun"),transitionstart:go("Transition","TransitionStart"),transitioncancel:go("Transition","TransitionCancel"),transitionend:go("Transition","TransitionEnd")},M_={},KT={};Va&&(KT=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function yl(e){if(M_[e])return M_[e];if(!Jl[e])return e;var n=Jl[e],t;for(t in n)if(n.hasOwnProperty(t)&&t in KT)return M_[e]=n[t];return e}var WT=yl("animationend"),YT=yl("animationiteration"),ZT=yl("animationstart"),Kx=yl("transitionrun"),Wx=yl("transitionstart"),Yx=yl("transitioncancel"),XT=yl("transitionend"),JT=new Map,Jb="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Bi(e,n){JT.set(e,n),gl(n,[e])}var ri=[],eu=0,$0=0;function pm(){for(var e=eu,n=$0=eu=0;n<e;){var t=ri[n];ri[n++]=null;var r=ri[n];ri[n++]=null;var i=ri[n];ri[n++]=null;var a=ri[n];if(ri[n++]=null,r!==null&&i!==null){var s=r.pending;s===null?i.next=i:(i.next=s.next,s.next=i),r.pending=i}a!==0&&ew(t,i,a)}}function mm(e,n,t,r){ri[eu++]=e,ri[eu++]=n,ri[eu++]=t,ri[eu++]=r,$0|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function z0(e,n,t,r){return mm(e,n,t,r),rp(e)}function Ks(e,n){return mm(e,null,null,n),rp(e)}function ew(e,n,t){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t);for(var i=!1,a=e.return;a!==null;)a.childLanes|=t,r=a.alternate,r!==null&&(r.childLanes|=t),a.tag===22&&(e=a.stateNode,e===null||e._visibility&1||(i=!0)),e=a,a=a.return;i&&n!==null&&e.tag===3&&(a=e.stateNode,i=31-Vr(t),a=a.hiddenUpdates,e=a[i],e===null?a[i]=[n]:e.push(n),n.lane=t|536870912)}function rp(e){if(50<nd)throw nd=0,Sv=null,Error(Y(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var tu={},eE=new WeakMap;function di(e,n){if(typeof e=="object"&&e!==null){var t=eE.get(e);return t!==void 0?t:(n={value:e,source:n,stack:kb(n)},eE.set(e,n),n)}return{value:e,source:n,stack:kb(n)}}var nu=[],ru=0,ip=null,ap=0,si=[],oi=0,Go=null,La=1,Pa="";function So(e,n){nu[ru++]=ap,nu[ru++]=ip,ip=e,ap=n}function tw(e,n,t){si[oi++]=La,si[oi++]=Pa,si[oi++]=Go,Go=e;var r=La;e=Pa;var i=32-Vr(r)-1;r&=~(1<<i),t+=1;var a=32-Vr(n)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,La=1<<32-Vr(n)+i|t<<i|r,Pa=a+e}else La=1<<a|t<<i|r,Pa=e}function H0(e){e.return!==null&&(So(e,1),tw(e,1,0))}function q0(e){for(;e===ip;)ip=nu[--ru],nu[ru]=null,ap=nu[--ru],nu[ru]=null;for(;e===Go;)Go=si[--oi],si[oi]=null,Pa=si[--oi],si[oi]=null,La=si[--oi],si[oi]=null}var hr=null,Qn=null,ft=!1,Li=null,Ji=!1,nv=Error(Y(519));function el(e){var n=Error(Y(418,""));throw Md(di(n,e)),nv}function tE(e){var n=e.stateNode,t=e.type,r=e.memoizedProps;switch(n[rr]=e,n[Nr]=r,t){case"dialog":it("cancel",n),it("close",n);break;case"iframe":case"object":case"embed":it("load",n);break;case"video":case"audio":for(t=0;t<Dd.length;t++)it(Dd[t],n);break;case"source":it("error",n);break;case"img":case"image":case"link":it("error",n),it("load",n);break;case"details":it("toggle",n);break;case"input":it("invalid",n),RT(n,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),tp(n);break;case"select":it("invalid",n);break;case"textarea":it("invalid",n),LT(n,r.value,r.defaultValue,r.children),tp(n)}t=r.children,typeof t!="string"&&typeof t!="number"&&typeof t!="bigint"||n.textContent===""+t||r.suppressHydrationWarning===!0||O2(n.textContent,t)?(r.popover!=null&&(it("beforetoggle",n),it("toggle",n)),r.onScroll!=null&&it("scroll",n),r.onScrollEnd!=null&&it("scrollend",n),r.onClick!=null&&(n.onclick=Cm),n=!0):n=!1,n||el(e)}function nE(e){for(hr=e.return;hr;)switch(hr.tag){case 3:case 27:Ji=!0;return;case 5:case 13:Ji=!1;return;default:hr=hr.return}}function uc(e){if(e!==hr)return!1;if(!ft)return nE(e),ft=!0,!1;var n=!1,t;if((t=e.tag!==3&&e.tag!==27)&&((t=e.tag===5)&&(t=e.type,t=!(t!=="form"&&t!=="button")||xv(e.type,e.memoizedProps)),t=!t),t&&(n=!0),n&&Qn&&el(e),nE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Y(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(t=e.data,t==="/$"){if(n===0){Qn=zi(e.nextSibling);break e}n--}else t!=="$"&&t!=="$!"&&t!=="$?"||n++;e=e.nextSibling}Qn=null}}else Qn=hr?zi(e.stateNode.nextSibling):null;return!0}function nh(){Qn=hr=null,ft=!1}function Md(e){Li===null?Li=[e]:Li.push(e)}var Vc=Error(Y(460)),nw=Error(Y(474)),rv={then:function(){}};function rE(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Uh(){}function rw(e,n,t){switch(t=e[t],t===void 0?e.push(n):t!==n&&(n.then(Uh,Uh),n=t),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,e===Vc?Error(Y(483)):e;default:if(typeof n.status=="string")n.then(Uh,Uh);else{if(e=Ut,e!==null&&100<e.shellSuspendCounter)throw Error(Y(482));e=n,e.status="pending",e.then(function(r){if(n.status==="pending"){var i=n;i.status="fulfilled",i.value=r}},function(r){if(n.status==="pending"){var i=n;i.status="rejected",i.reason=r}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,e===Vc?Error(Y(483)):e}throw jc=n,Vc}}var jc=null;function iE(){if(jc===null)throw Error(Y(459));var e=jc;return jc=null,e}var du=null,xd=0;function Lh(e){var n=xd;return xd+=1,du===null&&(du=[]),rw(du,e,n)}function cc(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Ph(e,n){throw n.$$typeof===PM?Error(Y(525)):(e=Object.prototype.toString.call(n),Error(Y(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function aE(e){var n=e._init;return n(e._payload)}function iw(e){function n(b,v){if(e){var E=b.deletions;E===null?(b.deletions=[v],b.flags|=16):E.push(v)}}function t(b,v){if(!e)return null;for(;v!==null;)n(b,v),v=v.sibling;return null}function r(b){for(var v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function i(b,v){return b=Us(b,v),b.index=0,b.sibling=null,b}function a(b,v,E){return b.index=E,e?(E=b.alternate,E!==null?(E=E.index,E<v?(b.flags|=33554434,v):E):(b.flags|=33554434,v)):(b.flags|=1048576,v)}function s(b){return e&&b.alternate===null&&(b.flags|=33554434),b}function o(b,v,E,S){return v===null||v.tag!==6?(v=H_(E,b.mode,S),v.return=b,v):(v=i(v,E),v.return=b,v)}function l(b,v,E,S){var w=E.type;return w===Kl?c(b,v,E.props.children,S,E.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===gs&&aE(w)===v.type)?(v=i(v,E.props),cc(v,E),v.return=b,v):(v=xf(E.type,E.key,E.props,null,b.mode,S),cc(v,E),v.return=b,v)}function u(b,v,E,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==E.containerInfo||v.stateNode.implementation!==E.implementation?(v=q_(E,b.mode,S),v.return=b,v):(v=i(v,E.children||[]),v.return=b,v)}function c(b,v,E,S,w){return v===null||v.tag!==7?(v=jo(E,b.mode,S,w),v.return=b,v):(v=i(v,E),v.return=b,v)}function d(b,v,E){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return v=H_(""+v,b.mode,E),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case xh:return E=xf(v.type,v.key,v.props,null,b.mode,E),cc(E,v),E.return=b,E;case Mc:return v=q_(v,b.mode,E),v.return=b,v;case gs:var S=v._init;return v=S(v._payload),d(b,v,E)}if(Oc(v)||sc(v))return v=jo(v,b.mode,E,null),v.return=b,v;if(typeof v.then=="function")return d(b,Lh(v),E);if(v.$$typeof===Ua)return d(b,Fh(b,v),E);Ph(b,v)}return null}function h(b,v,E,S){var w=v!==null?v.key:null;if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return w!==null?null:o(b,v,""+E,S);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case xh:return E.key===w?l(b,v,E,S):null;case Mc:return E.key===w?u(b,v,E,S):null;case gs:return w=E._init,E=w(E._payload),h(b,v,E,S)}if(Oc(E)||sc(E))return w!==null?null:c(b,v,E,S,null);if(typeof E.then=="function")return h(b,v,Lh(E),S);if(E.$$typeof===Ua)return h(b,v,Fh(b,E),S);Ph(b,E)}return null}function f(b,v,E,S,w){if(typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint")return b=b.get(E)||null,o(v,b,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case xh:return b=b.get(S.key===null?E:S.key)||null,l(v,b,S,w);case Mc:return b=b.get(S.key===null?E:S.key)||null,u(v,b,S,w);case gs:var A=S._init;return S=A(S._payload),f(b,v,E,S,w)}if(Oc(S)||sc(S))return b=b.get(E)||null,c(v,b,S,w,null);if(typeof S.then=="function")return f(b,v,E,Lh(S),w);if(S.$$typeof===Ua)return f(b,v,E,Fh(v,S),w);Ph(v,S)}return null}function m(b,v,E,S){for(var w=null,A=null,D=v,O=v=0,M=null;D!==null&&O<E.length;O++){D.index>O?(M=D,D=null):M=D.sibling;var F=h(b,D,E[O],S);if(F===null){D===null&&(D=M);break}e&&D&&F.alternate===null&&n(b,D),v=a(F,v,O),A===null?w=F:A.sibling=F,A=F,D=M}if(O===E.length)return t(b,D),ft&&So(b,O),w;if(D===null){for(;O<E.length;O++)D=d(b,E[O],S),D!==null&&(v=a(D,v,O),A===null?w=D:A.sibling=D,A=D);return ft&&So(b,O),w}for(D=r(D);O<E.length;O++)M=f(D,b,O,E[O],S),M!==null&&(e&&M.alternate!==null&&D.delete(M.key===null?O:M.key),v=a(M,v,O),A===null?w=M:A.sibling=M,A=M);return e&&D.forEach(function(U){return n(b,U)}),ft&&So(b,O),w}function y(b,v,E,S){if(E==null)throw Error(Y(151));for(var w=null,A=null,D=v,O=v=0,M=null,F=E.next();D!==null&&!F.done;O++,F=E.next()){D.index>O?(M=D,D=null):M=D.sibling;var U=h(b,D,F.value,S);if(U===null){D===null&&(D=M);break}e&&D&&U.alternate===null&&n(b,D),v=a(U,v,O),A===null?w=U:A.sibling=U,A=U,D=M}if(F.done)return t(b,D),ft&&So(b,O),w;if(D===null){for(;!F.done;O++,F=E.next())F=d(b,F.value,S),F!==null&&(v=a(F,v,O),A===null?w=F:A.sibling=F,A=F);return ft&&So(b,O),w}for(D=r(D);!F.done;O++,F=E.next())F=f(D,b,O,F.value,S),F!==null&&(e&&F.alternate!==null&&D.delete(F.key===null?O:F.key),v=a(F,v,O),A===null?w=F:A.sibling=F,A=F);return e&&D.forEach(function($){return n(b,$)}),ft&&So(b,O),w}function C(b,v,E,S){if(typeof E=="object"&&E!==null&&E.type===Kl&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case xh:e:{for(var w=E.key;v!==null;){if(v.key===w){if(w=E.type,w===Kl){if(v.tag===7){t(b,v.sibling),S=i(v,E.props.children),S.return=b,b=S;break e}}else if(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===gs&&aE(w)===v.type){t(b,v.sibling),S=i(v,E.props),cc(S,E),S.return=b,b=S;break e}t(b,v);break}else n(b,v);v=v.sibling}E.type===Kl?(S=jo(E.props.children,b.mode,S,E.key),S.return=b,b=S):(S=xf(E.type,E.key,E.props,null,b.mode,S),cc(S,E),S.return=b,b=S)}return s(b);case Mc:e:{for(w=E.key;v!==null;){if(v.key===w)if(v.tag===4&&v.stateNode.containerInfo===E.containerInfo&&v.stateNode.implementation===E.implementation){t(b,v.sibling),S=i(v,E.children||[]),S.return=b,b=S;break e}else{t(b,v);break}else n(b,v);v=v.sibling}S=q_(E,b.mode,S),S.return=b,b=S}return s(b);case gs:return w=E._init,E=w(E._payload),C(b,v,E,S)}if(Oc(E))return m(b,v,E,S);if(sc(E)){if(w=sc(E),typeof w!="function")throw Error(Y(150));return E=w.call(E),y(b,v,E,S)}if(typeof E.then=="function")return C(b,v,Lh(E),S);if(E.$$typeof===Ua)return C(b,v,Fh(b,E),S);Ph(b,E)}return typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint"?(E=""+E,v!==null&&v.tag===6?(t(b,v.sibling),S=i(v,E),S.return=b,b=S):(t(b,v),S=H_(E,b.mode,S),S.return=b,b=S),s(b)):t(b,v)}return function(b,v,E,S){try{xd=0;var w=C(b,v,E,S);return du=null,w}catch(D){if(D===Vc)throw D;var A=mi(29,D,null,b.mode);return A.lanes=S,A.return=b,A}finally{}}}var tl=iw(!0),aw=iw(!1),Eu=da(null),sp=da(0);function sE(e,n){e=Ka,Bt(sp,e),Bt(Eu,n),Ka=e|n.baseLanes}function iv(){Bt(sp,Ka),Bt(Eu,Eu.current)}function B0(){Ka=sp.current,Pn(Eu),Pn(sp)}var vi=da(null),sa=null;function Es(e){var n=e.alternate;Bt(En,En.current&1),Bt(vi,e),sa===null&&(n===null||Eu.current!==null||n.memoizedState!==null)&&(sa=e)}function sw(e){if(e.tag===22){if(Bt(En,En.current),Bt(vi,e),sa===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(sa=e)}}else Cs()}function Cs(){Bt(En,En.current),Bt(vi,vi.current)}function Fa(e){Pn(vi),sa===e&&(sa=null),Pn(En)}var En=da(0);function op(e){for(var n=e;n!==null;){if(n.tag===13){var t=n.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Zx=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){n.aborted=!0,e.forEach(function(t){return t()})}},Xx=Cn.unstable_scheduleCallback,Jx=Cn.unstable_NormalPriority,yn={$$typeof:Ua,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function G0(){return{controller:new Zx,data:new Map,refCount:0}}function rh(e){e.refCount--,e.refCount===0&&Xx(Jx,function(){e.controller.abort()})}var Qc=null,av=0,Cu=0,hu=null;function e3(e,n){if(Qc===null){var t=Qc=[];av=0,Cu=fy(),hu={status:"pending",value:void 0,then:function(r){t.push(r)}}}return av++,n.then(oE,oE),n}function oE(){if(--av===0&&Qc!==null){hu!==null&&(hu.status="fulfilled");var e=Qc;Qc=null,Cu=0,hu=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function t3(e,n){var t=[],r={status:"pending",value:null,reason:null,then:function(i){t.push(i)}};return e.then(function(){r.status="fulfilled",r.value=n;for(var i=0;i<t.length;i++)(0,t[i])(n)},function(i){for(r.status="rejected",r.reason=i,i=0;i<t.length;i++)(0,t[i])(void 0)}),r}var lE=Be.S;Be.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&e3(e,n),lE!==null&&lE(e,n)};var Vo=da(null);function V0(){var e=Vo.current;return e!==null?e:Ut.pooledCache}function Af(e,n){n===null?Bt(Vo,Vo.current):Bt(Vo,n.pool)}function ow(){var e=V0();return e===null?null:{parent:yn._currentValue,pool:e}}var Ws=0,Ke=null,At=null,hn=null,lp=!1,fu=!1,nl=!1,up=0,Od=0,pu=null,n3=0;function on(){throw Error(Y(321))}function j0(e,n){if(n===null)return!1;for(var t=0;t<n.length&&t<e.length;t++)if(!Kr(e[t],n[t]))return!1;return!0}function Q0(e,n,t,r,i,a){return Ws=a,Ke=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Be.H=e===null||e.memoizedState===null?bl:io,nl=!1,a=t(r,i),nl=!1,fu&&(a=uw(n,t,r,i)),lw(e),a}function lw(e){Be.H=ua;var n=At!==null&&At.next!==null;if(Ws=0,hn=At=Ke=null,lp=!1,Od=0,pu=null,n)throw Error(Y(300));e===null||Rn||(e=e.dependencies,e!==null&&hp(e)&&(Rn=!0))}function uw(e,n,t,r){Ke=e;var i=0;do{if(fu&&(pu=null),Od=0,fu=!1,25<=i)throw Error(Y(301));if(i+=1,hn=At=null,e.updateQueue!=null){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,a.memoCache!=null&&(a.memoCache.index=0)}Be.H=El,a=n(t,r)}while(fu);return a}function r3(){var e=Be.H,n=e.useState()[0];return n=typeof n.then=="function"?ih(n):n,e=e.useState()[0],(At!==null?At.memoizedState:null)!==e&&(Ke.flags|=1024),n}function K0(){var e=up!==0;return up=0,e}function W0(e,n,t){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~t}function Y0(e){if(lp){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}lp=!1}Ws=0,hn=At=Ke=null,fu=!1,Od=up=0,pu=null}function Tr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Ke.memoizedState=hn=e:hn=hn.next=e,hn}function pn(){if(At===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var n=hn===null?Ke.memoizedState:hn.next;if(n!==null)hn=n,At=e;else{if(e===null)throw Ke.alternate===null?Error(Y(467)):Error(Y(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},hn===null?Ke.memoizedState=hn=e:hn=hn.next=e}return hn}var _m;_m=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function ih(e){var n=Od;return Od+=1,pu===null&&(pu=[]),e=rw(pu,e,n),n=Ke,(hn===null?n.memoizedState:hn.next)===null&&(n=n.alternate,Be.H=n===null||n.memoizedState===null?bl:io),e}function gm(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return ih(e);if(e.$$typeof===Ua)return ir(e)}throw Error(Y(438,String(e)))}function Z0(e){var n=null,t=Ke.updateQueue;if(t!==null&&(n=t.memoCache),n==null){var r=Ke.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(n={data:r.data.map(function(i){return i.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),t===null&&(t=_m(),Ke.updateQueue=t),t.memoCache=n,t=n.data[n.index],t===void 0)for(t=n.data[n.index]=Array(e),r=0;r<e;r++)t[r]=$M;return n.index++,t}function ja(e,n){return typeof n=="function"?n(e):n}function Nf(e){var n=pn();return X0(n,At,e)}function X0(e,n,t){var r=e.queue;if(r===null)throw Error(Y(311));r.lastRenderedReducer=t;var i=e.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(a=e.baseState,i===null)e.memoizedState=a;else{n=i.next;var o=s=null,l=null,u=n,c=!1;do{var d=u.lane&-536870913;if(d!==u.lane?(ct&d)===d:(Ws&d)===d){var h=u.revertLane;if(h===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Cu&&(c=!0);else if((Ws&h)===h){u=u.next,h===Cu&&(c=!0);continue}else d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=d,s=a):l=l.next=d,Ke.lanes|=h,Zs|=h;d=u.action,nl&&t(a,d),a=u.hasEagerState?u.eagerState:t(a,d)}else h={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=h,s=a):l=l.next=h,Ke.lanes|=d,Zs|=d;u=u.next}while(u!==null&&u!==n);if(l===null?s=a:l.next=o,!Kr(a,e.memoizedState)&&(Rn=!0,c&&(t=hu,t!==null)))throw t;e.memoizedState=a,e.baseState=s,e.baseQueue=l,r.lastRenderedState=a}return i===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function x_(e){var n=pn(),t=n.queue;if(t===null)throw Error(Y(311));t.lastRenderedReducer=e;var r=t.dispatch,i=t.pending,a=n.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Kr(a,n.memoizedState)||(Rn=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),t.lastRenderedState=a}return[a,r]}function cw(e,n,t){var r=Ke,i=pn(),a=ft;if(a){if(t===void 0)throw Error(Y(407));t=t()}else t=n();var s=!Kr((At||i).memoizedState,t);if(s&&(i.memoizedState=t,Rn=!0),i=i.queue,J0(fw.bind(null,r,i,e),[e]),i.getSnapshot!==n||s||hn!==null&&hn.memoizedState.tag&1){if(r.flags|=2048,Su(9,hw.bind(null,r,i,t,n),{destroy:void 0},null),Ut===null)throw Error(Y(349));a||Ws&60||dw(r,n,t)}return t}function dw(e,n,t){e.flags|=16384,e={getSnapshot:n,value:t},n=Ke.updateQueue,n===null?(n=_m(),Ke.updateQueue=n,n.stores=[e]):(t=n.stores,t===null?n.stores=[e]:t.push(e))}function hw(e,n,t,r){n.value=t,n.getSnapshot=r,pw(n)&&mw(e)}function fw(e,n,t){return t(function(){pw(n)&&mw(e)})}function pw(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!Kr(e,t)}catch{return!0}}function mw(e){var n=Ks(e,2);n!==null&&_r(n,e,2)}function sv(e){var n=Tr();if(typeof e=="function"){var t=e;if(e=t(),nl){Ns(!0);try{t()}finally{Ns(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:e},n}function _w(e,n,t,r){return e.baseState=t,X0(e,At,typeof r=="function"?r:ja)}function i3(e,n,t,r,i){if(ym(e))throw Error(Y(485));if(e=n.action,e!==null){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(s){a.listeners.push(s)}};Be.T!==null?t(!0):a.isTransition=!1,r(a),t=n.pending,t===null?(a.next=n.pending=a,gw(n,a)):(a.next=t.next,n.pending=t.next=a)}}function gw(e,n){var t=n.action,r=n.payload,i=e.state;if(n.isTransition){var a=Be.T,s={};Be.T=s;try{var o=t(i,r),l=Be.S;l!==null&&l(s,o),uE(e,n,o)}catch(u){ov(e,n,u)}finally{Be.T=a}}else try{a=t(i,r),uE(e,n,a)}catch(u){ov(e,n,u)}}function uE(e,n,t){t!==null&&typeof t=="object"&&typeof t.then=="function"?t.then(function(r){cE(e,n,r)},function(r){return ov(e,n,r)}):cE(e,n,t)}function cE(e,n,t){n.status="fulfilled",n.value=t,vw(n),e.state=t,n=e.pending,n!==null&&(t=n.next,t===n?e.pending=null:(t=t.next,n.next=t,gw(e,t)))}function ov(e,n,t){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do n.status="rejected",n.reason=t,vw(n),n=n.next;while(n!==r)}e.action=null}function vw(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function yw(e,n){return n}function bw(e,n){if(ft){var t=Ut.formState;if(t!==null){e:{var r=Ke;if(ft){if(Qn){t:{for(var i=Qn,a=Ji;i.nodeType!==8;){if(!a){i=null;break t}if(i=zi(i.nextSibling),i===null){i=null;break t}}a=i.data,i=a==="F!"||a==="F"?i:null}if(i){Qn=zi(i.nextSibling),r=i.data==="F!";break e}}el(r)}r=!1}r&&(n=t[0])}}return t=Tr(),t.memoizedState=t.baseState=n,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yw,lastRenderedState:n},t.queue=r,t=Pw.bind(null,Ke,r),r.dispatch=t,r=sv(!1),a=ry.bind(null,Ke,!1,r.queue),r=Tr(),i={state:n,dispatch:null,action:e,pending:null},r.queue=i,t=i3.bind(null,Ke,i,a,t),i.dispatch=t,r.memoizedState=e,[n,t,!1]}function Ew(e){var n=pn();return Cw(n,At,e)}function Cw(e,n,t){n=X0(e,n,yw)[0],e=Nf(ja)[0],n=typeof n=="object"&&n!==null&&typeof n.then=="function"?ih(n):n;var r=pn(),i=r.queue,a=i.dispatch;return t!==r.memoizedState&&(Ke.flags|=2048,Su(9,a3.bind(null,i,t),{destroy:void 0},null)),[n,a,e]}function a3(e,n){e.action=n}function Sw(e){var n=pn(),t=At;if(t!==null)return Cw(n,t,e);pn(),n=n.memoizedState,t=pn();var r=t.queue.dispatch;return t.memoizedState=e,[n,r,!1]}function Su(e,n,t,r){return e={tag:e,create:n,inst:t,deps:r,next:null},n=Ke.updateQueue,n===null&&(n=_m(),Ke.updateQueue=n),t=n.lastEffect,t===null?n.lastEffect=e.next=e:(r=t.next,t.next=e,e.next=r,n.lastEffect=e),e}function Tw(){return pn().memoizedState}function If(e,n,t,r){var i=Tr();Ke.flags|=e,i.memoizedState=Su(1|n,t,{destroy:void 0},r===void 0?null:r)}function vm(e,n,t,r){var i=pn();r=r===void 0?null:r;var a=i.memoizedState.inst;At!==null&&r!==null&&j0(r,At.memoizedState.deps)?i.memoizedState=Su(n,t,a,r):(Ke.flags|=e,i.memoizedState=Su(1|n,t,a,r))}function dE(e,n){If(8390656,8,e,n)}function J0(e,n){vm(2048,8,e,n)}function ww(e,n){return vm(4,2,e,n)}function Aw(e,n){return vm(4,4,e,n)}function Nw(e,n){if(typeof n=="function"){e=e();var t=n(e);return function(){typeof t=="function"?t():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Iw(e,n,t){t=t!=null?t.concat([e]):null,vm(4,4,Nw.bind(null,n,e),t)}function ey(){}function Mw(e,n){var t=pn();n=n===void 0?null:n;var r=t.memoizedState;return n!==null&&j0(n,r[1])?r[0]:(t.memoizedState=[e,n],e)}function xw(e,n){var t=pn();n=n===void 0?null:n;var r=t.memoizedState;if(n!==null&&j0(n,r[1]))return r[0];if(r=e(),nl){Ns(!0);try{e()}finally{Ns(!1)}}return t.memoizedState=[r,n],r}function ty(e,n,t){return t===void 0||Ws&1073741824?e.memoizedState=n:(e.memoizedState=t,e=v2(),Ke.lanes|=e,Zs|=e,t)}function Ow(e,n,t,r){return Kr(t,n)?t:Eu.current!==null?(e=ty(e,t,r),Kr(e,n)||(Rn=!0),e):Ws&42?(e=v2(),Ke.lanes|=e,Zs|=e,n):(Rn=!0,e.memoizedState=t)}function Dw(e,n,t,r,i){var a=Ft.p;Ft.p=a!==0&&8>a?a:8;var s=Be.T,o={};Be.T=o,ry(e,!1,n,t);try{var l=i(),u=Be.S;if(u!==null&&u(o,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=t3(l,r);Kc(e,n,c,jr(e))}else Kc(e,n,r,jr(e))}catch(d){Kc(e,n,{then:function(){},status:"rejected",reason:d},jr())}finally{Ft.p=a,Be.T=s}}function s3(){}function lv(e,n,t,r){if(e.tag!==5)throw Error(Y(476));var i=kw(e).queue;Dw(e,i,n,Bo,t===null?s3:function(){return Rw(e),t(r)})}function kw(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:Bo,baseState:Bo,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:Bo},next:null};var t={};return n.next={memoizedState:t,baseState:t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:t},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Rw(e){var n=kw(e).next.queue;Kc(e,n,{},jr())}function ny(){return ir(Ud)}function Uw(){return pn().memoizedState}function Lw(){return pn().memoizedState}function o3(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var t=jr();e=ks(t);var r=Rs(n,e,t);r!==null&&(_r(r,n,t),Yc(r,n,t)),n={cache:G0()},e.payload=n;return}n=n.return}}function l3(e,n,t){var r=jr();t={lane:r,revertLane:0,action:t,hasEagerState:!1,eagerState:null,next:null},ym(e)?Fw(n,t):(t=z0(e,n,t,r),t!==null&&(_r(t,e,r),$w(t,n,r)))}function Pw(e,n,t){var r=jr();Kc(e,n,t,r)}function Kc(e,n,t,r){var i={lane:r,revertLane:0,action:t,hasEagerState:!1,eagerState:null,next:null};if(ym(e))Fw(n,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var s=n.lastRenderedState,o=a(s,t);if(i.hasEagerState=!0,i.eagerState=o,Kr(o,s))return mm(e,n,i,0),Ut===null&&pm(),!1}catch{}finally{}if(t=z0(e,n,i,r),t!==null)return _r(t,e,r),$w(t,n,r),!0}return!1}function ry(e,n,t,r){if(r={lane:2,revertLane:fy(),action:r,hasEagerState:!1,eagerState:null,next:null},ym(e)){if(n)throw Error(Y(479))}else n=z0(e,t,r,2),n!==null&&_r(n,e,2)}function ym(e){var n=e.alternate;return e===Ke||n!==null&&n===Ke}function Fw(e,n){fu=lp=!0;var t=e.pending;t===null?n.next=n:(n.next=t.next,t.next=n),e.pending=n}function $w(e,n,t){if(t&4194176){var r=n.lanes;r&=e.pendingLanes,t|=r,n.lanes=t,NT(e,t)}}var ua={readContext:ir,use:gm,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on};ua.useCacheRefresh=on;ua.useMemoCache=on;ua.useHostTransitionStatus=on;ua.useFormState=on;ua.useActionState=on;ua.useOptimistic=on;var bl={readContext:ir,use:gm,useCallback:function(e,n){return Tr().memoizedState=[e,n===void 0?null:n],e},useContext:ir,useEffect:dE,useImperativeHandle:function(e,n,t){t=t!=null?t.concat([e]):null,If(4194308,4,Nw.bind(null,n,e),t)},useLayoutEffect:function(e,n){return If(4194308,4,e,n)},useInsertionEffect:function(e,n){If(4,2,e,n)},useMemo:function(e,n){var t=Tr();n=n===void 0?null:n;var r=e();if(nl){Ns(!0);try{e()}finally{Ns(!1)}}return t.memoizedState=[r,n],r},useReducer:function(e,n,t){var r=Tr();if(t!==void 0){var i=t(n);if(nl){Ns(!0);try{t(n)}finally{Ns(!1)}}}else i=n;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=l3.bind(null,Ke,e),[r.memoizedState,e]},useRef:function(e){var n=Tr();return e={current:e},n.memoizedState=e},useState:function(e){e=sv(e);var n=e.queue,t=Pw.bind(null,Ke,n);return n.dispatch=t,[e.memoizedState,t]},useDebugValue:ey,useDeferredValue:function(e,n){var t=Tr();return ty(t,e,n)},useTransition:function(){var e=sv(!1);return e=Dw.bind(null,Ke,e.queue,!0,!1),Tr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,t){var r=Ke,i=Tr();if(ft){if(t===void 0)throw Error(Y(407));t=t()}else{if(t=n(),Ut===null)throw Error(Y(349));ct&60||dw(r,n,t)}i.memoizedState=t;var a={value:t,getSnapshot:n};return i.queue=a,dE(fw.bind(null,r,a,e),[e]),r.flags|=2048,Su(9,hw.bind(null,r,a,t,n),{destroy:void 0},null),t},useId:function(){var e=Tr(),n=Ut.identifierPrefix;if(ft){var t=Pa,r=La;t=(r&~(1<<32-Vr(r)-1)).toString(32)+t,n=":"+n+"R"+t,t=up++,0<t&&(n+="H"+t.toString(32)),n+=":"}else t=n3++,n=":"+n+"r"+t.toString(32)+":";return e.memoizedState=n},useCacheRefresh:function(){return Tr().memoizedState=o3.bind(null,Ke)}};bl.useMemoCache=Z0;bl.useHostTransitionStatus=ny;bl.useFormState=bw;bl.useActionState=bw;bl.useOptimistic=function(e){var n=Tr();n.memoizedState=n.baseState=e;var t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=t,n=ry.bind(null,Ke,!0,t),t.dispatch=n,[e,n]};var io={readContext:ir,use:gm,useCallback:Mw,useContext:ir,useEffect:J0,useImperativeHandle:Iw,useInsertionEffect:ww,useLayoutEffect:Aw,useMemo:xw,useReducer:Nf,useRef:Tw,useState:function(){return Nf(ja)},useDebugValue:ey,useDeferredValue:function(e,n){var t=pn();return Ow(t,At.memoizedState,e,n)},useTransition:function(){var e=Nf(ja)[0],n=pn().memoizedState;return[typeof e=="boolean"?e:ih(e),n]},useSyncExternalStore:cw,useId:Uw};io.useCacheRefresh=Lw;io.useMemoCache=Z0;io.useHostTransitionStatus=ny;io.useFormState=Ew;io.useActionState=Ew;io.useOptimistic=function(e,n){var t=pn();return _w(t,At,e,n)};var El={readContext:ir,use:gm,useCallback:Mw,useContext:ir,useEffect:J0,useImperativeHandle:Iw,useInsertionEffect:ww,useLayoutEffect:Aw,useMemo:xw,useReducer:x_,useRef:Tw,useState:function(){return x_(ja)},useDebugValue:ey,useDeferredValue:function(e,n){var t=pn();return At===null?ty(t,e,n):Ow(t,At.memoizedState,e,n)},useTransition:function(){var e=x_(ja)[0],n=pn().memoizedState;return[typeof e=="boolean"?e:ih(e),n]},useSyncExternalStore:cw,useId:Uw};El.useCacheRefresh=Lw;El.useMemoCache=Z0;El.useHostTransitionStatus=ny;El.useFormState=Sw;El.useActionState=Sw;El.useOptimistic=function(e,n){var t=pn();return At!==null?_w(t,At,e,n):(t.baseState=e,[e,t.queue.dispatch])};function O_(e,n,t,r){n=e.memoizedState,t=t(r,n),t=t==null?n:$t({},n,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var uv={isMounted:function(e){return(e=e._reactInternals)?qu(e)===e:!1},enqueueSetState:function(e,n,t){e=e._reactInternals;var r=jr(),i=ks(r);i.payload=n,t!=null&&(i.callback=t),n=Rs(e,i,r),n!==null&&(_r(n,e,r),Yc(n,e,r))},enqueueReplaceState:function(e,n,t){e=e._reactInternals;var r=jr(),i=ks(r);i.tag=1,i.payload=n,t!=null&&(i.callback=t),n=Rs(e,i,r),n!==null&&(_r(n,e,r),Yc(n,e,r))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var t=jr(),r=ks(t);r.tag=2,n!=null&&(r.callback=n),n=Rs(e,r,t),n!==null&&(_r(n,e,t),Yc(n,e,t))}};function hE(e,n,t,r,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,s):n.prototype&&n.prototype.isPureReactComponent?!Id(t,r)||!Id(i,a):!0}function fE(e,n,t,r){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(t,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(t,r),n.state!==e&&uv.enqueueReplaceState(n,n.state,null)}function rl(e,n){var t=n;if("ref"in n){t={};for(var r in n)r!=="ref"&&(t[r]=n[r])}if(e=e.defaultProps){t===n&&(t=$t({},t));for(var i in e)t[i]===void 0&&(t[i]=e[i])}return t}var cp=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function zw(e){cp(e)}function Hw(e){console.error(e)}function qw(e){cp(e)}function dp(e,n){try{var t=e.onUncaughtError;t(n.value,{componentStack:n.stack})}catch(r){setTimeout(function(){throw r})}}function pE(e,n,t){try{var r=e.onCaughtError;r(t.value,{componentStack:t.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function cv(e,n,t){return t=ks(t),t.tag=3,t.payload={element:null},t.callback=function(){dp(e,n)},t}function Bw(e){return e=ks(e),e.tag=3,e}function Gw(e,n,t,r){var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){pE(n,t,r)}}var s=t.stateNode;s!==null&&typeof s.componentDidCatch=="function"&&(e.callback=function(){pE(n,t,r),typeof i!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var o=r.stack;this.componentDidCatch(r.value,{componentStack:o!==null?o:""})})}function u3(e,n,t,r,i){if(t.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(n=t.alternate,n!==null&&ah(n,t,i,!0),t=vi.current,t!==null){switch(t.tag){case 13:return sa===null?wv():t.alternate===null&&nn===0&&(nn=3),t.flags&=-257,t.flags|=65536,t.lanes=i,r===rv?t.flags|=16384:(n=t.updateQueue,n===null?t.updateQueue=new Set([r]):n.add(r),G_(e,r,i)),!1;case 22:return t.flags|=65536,r===rv?t.flags|=16384:(n=t.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([r])},t.updateQueue=n):(t=n.retryQueue,t===null?n.retryQueue=new Set([r]):t.add(r)),G_(e,r,i)),!1}throw Error(Y(435,t.tag))}return G_(e,r,i),wv(),!1}if(ft)return n=vi.current,n!==null?(!(n.flags&65536)&&(n.flags|=256),n.flags|=65536,n.lanes=i,r!==nv&&(e=Error(Y(422),{cause:r}),Md(di(e,t)))):(r!==nv&&(n=Error(Y(423),{cause:r}),Md(di(n,t))),e=e.current.alternate,e.flags|=65536,i&=-i,e.lanes|=i,r=di(r,t),i=cv(e.stateNode,r,i),P_(e,i),nn!==4&&(nn=2)),!1;var a=Error(Y(520),{cause:r});if(a=di(a,t),ed===null?ed=[a]:ed.push(a),nn!==4&&(nn=2),n===null)return!0;r=di(r,t),t=n;do{switch(t.tag){case 3:return t.flags|=65536,e=i&-i,t.lanes|=e,e=cv(t.stateNode,r,e),P_(t,e),!1;case 1:if(n=t.type,a=t.stateNode,(t.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||a!==null&&typeof a.componentDidCatch=="function"&&(Ls===null||!Ls.has(a))))return t.flags|=65536,i&=-i,t.lanes|=i,i=Bw(i),Gw(i,e,t,r),P_(t,i),!1}t=t.return}while(t!==null);return!1}var Vw=Error(Y(461)),Rn=!1;function Gn(e,n,t,r){n.child=e===null?aw(n,null,t,r):tl(n,e.child,t,r)}function mE(e,n,t,r,i){t=t.render;var a=n.ref;if("ref"in r){var s={};for(var o in r)o!=="ref"&&(s[o]=r[o])}else s=r;return il(n),r=Q0(e,n,t,s,a,i),o=K0(),e!==null&&!Rn?(W0(e,n,i),Qa(e,n,i)):(ft&&o&&H0(n),n.flags|=1,Gn(e,n,r,i),n.child)}function _E(e,n,t,r,i){if(e===null){var a=t.type;return typeof a=="function"&&!ly(a)&&a.defaultProps===void 0&&t.compare===null?(n.tag=15,n.type=a,jw(e,n,a,r,i)):(e=xf(t.type,null,r,n,n.mode,i),e.ref=n.ref,e.return=n,n.child=e)}if(a=e.child,!iy(e,i)){var s=a.memoizedProps;if(t=t.compare,t=t!==null?t:Id,t(s,r)&&e.ref===n.ref)return Qa(e,n,i)}return n.flags|=1,e=Us(a,r),e.ref=n.ref,e.return=n,n.child=e}function jw(e,n,t,r,i){if(e!==null){var a=e.memoizedProps;if(Id(a,r)&&e.ref===n.ref)if(Rn=!1,n.pendingProps=r=a,iy(e,i))e.flags&131072&&(Rn=!0);else return n.lanes=e.lanes,Qa(e,n,i)}return dv(e,n,t,r,i)}function Qw(e,n,t){var r=n.pendingProps,i=r.children,a=(n.stateNode._pendingVisibility&2)!==0,s=e!==null?e.memoizedState:null;if(Wc(e,n),r.mode==="hidden"||a){if(n.flags&128){if(r=s!==null?s.baseLanes|t:t,e!==null){for(i=n.child=e.child,a=0;i!==null;)a=a|i.lanes|i.childLanes,i=i.sibling;n.childLanes=a&~r}else n.childLanes=0,n.child=null;return gE(e,n,r,t)}if(t&536870912)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Af(n,s!==null?s.cachePool:null),s!==null?sE(n,s):iv(),sw(n);else return n.lanes=n.childLanes=536870912,gE(e,n,s!==null?s.baseLanes|t:t,t)}else s!==null?(Af(n,s.cachePool),sE(n,s),Cs(),n.memoizedState=null):(e!==null&&Af(n,null),iv(),Cs());return Gn(e,n,i,t),n.child}function gE(e,n,t,r){var i=V0();return i=i===null?null:{parent:yn._currentValue,pool:i},n.memoizedState={baseLanes:t,cachePool:i},e!==null&&Af(n,null),iv(),sw(n),e!==null&&ah(e,n,r,!0),null}function Wc(e,n){var t=n.ref;if(t===null)e!==null&&e.ref!==null&&(n.flags|=2097664);else{if(typeof t!="function"&&typeof t!="object")throw Error(Y(284));(e===null||e.ref!==t)&&(n.flags|=2097664)}}function dv(e,n,t,r,i){return il(n),t=Q0(e,n,t,r,void 0,i),r=K0(),e!==null&&!Rn?(W0(e,n,i),Qa(e,n,i)):(ft&&r&&H0(n),n.flags|=1,Gn(e,n,t,i),n.child)}function vE(e,n,t,r,i,a){return il(n),n.updateQueue=null,t=uw(n,r,t,i),lw(e),r=K0(),e!==null&&!Rn?(W0(e,n,a),Qa(e,n,a)):(ft&&r&&H0(n),n.flags|=1,Gn(e,n,t,a),n.child)}function yE(e,n,t,r,i){if(il(n),n.stateNode===null){var a=tu,s=t.contextType;typeof s=="object"&&s!==null&&(a=ir(s)),a=new t(r,a),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=uv,n.stateNode=a,a._reactInternals=n,a=n.stateNode,a.props=r,a.state=n.memoizedState,a.refs={},ay(n),s=t.contextType,a.context=typeof s=="object"&&s!==null?ir(s):tu,a.state=n.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(O_(n,t,s,r),a.state=n.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(s=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),s!==a.state&&uv.enqueueReplaceState(a,a.state,null),Xc(n,r,a,i),Zc(),a.state=n.memoizedState),typeof a.componentDidMount=="function"&&(n.flags|=4194308),r=!0}else if(e===null){a=n.stateNode;var o=n.memoizedProps,l=rl(t,o);a.props=l;var u=a.context,c=t.contextType;s=tu,typeof c=="object"&&c!==null&&(s=ir(c));var d=t.getDerivedStateFromProps;c=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function",o=n.pendingProps!==o,c||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o||u!==s)&&fE(n,a,r,s),vs=!1;var h=n.memoizedState;a.state=h,Xc(n,r,a,i),Zc(),u=n.memoizedState,o||h!==u||vs?(typeof d=="function"&&(O_(n,t,d,r),u=n.memoizedState),(l=vs||hE(n,t,l,r,h,u,s))?(c||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(n.flags|=4194308)):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=u),a.props=r,a.state=u,a.context=s,r=l):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{a=n.stateNode,gv(e,n),s=n.memoizedProps,c=rl(t,s),a.props=c,d=n.pendingProps,h=a.context,u=t.contextType,l=tu,typeof u=="object"&&u!==null&&(l=ir(u)),o=t.getDerivedStateFromProps,(u=typeof o=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||h!==l)&&fE(n,a,r,l),vs=!1,h=n.memoizedState,a.state=h,Xc(n,r,a,i),Zc();var f=n.memoizedState;s!==d||h!==f||vs||e!==null&&e.dependencies!==null&&hp(e.dependencies)?(typeof o=="function"&&(O_(n,t,o,r),f=n.memoizedState),(c=vs||hE(n,t,c,r,h,f,l)||e!==null&&e.dependencies!==null&&hp(e.dependencies))?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,f,l)),typeof a.componentDidUpdate=="function"&&(n.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&h===e.memoizedState||(n.flags|=1024),r=!1)}return a=r,Wc(e,n),r=(n.flags&128)!==0,a||r?(a=n.stateNode,t=r&&typeof t.getDerivedStateFromError!="function"?null:a.render(),n.flags|=1,e!==null&&r?(n.child=tl(n,e.child,null,i),n.child=tl(n,null,t,i)):Gn(e,n,t,i),n.memoizedState=a.state,e=n.child):e=Qa(e,n,i),e}function bE(e,n,t,r){return nh(),n.flags|=256,Gn(e,n,t,r),n.child}var D_={dehydrated:null,treeContext:null,retryLane:0};function k_(e){return{baseLanes:e,cachePool:ow()}}function R_(e,n,t){return e=e!==null?e.childLanes&~t:0,n&&(e|=_i),e}function Kw(e,n,t){var r=n.pendingProps,i=!1,a=(n.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(En.current&2)!==0),s&&(i=!0,n.flags&=-129),s=(n.flags&32)!==0,n.flags&=-33,e===null){if(ft){if(i?Es(n):Cs(),ft){var o=Qn,l;if(l=o){e:{for(l=o,o=Ji;l.nodeType!==8;){if(!o){o=null;break e}if(l=zi(l.nextSibling),l===null){o=null;break e}}o=l}o!==null?(n.memoizedState={dehydrated:o,treeContext:Go!==null?{id:La,overflow:Pa}:null,retryLane:536870912},l=mi(18,null,null,0),l.stateNode=o,l.return=n,n.child=l,hr=n,Qn=null,l=!0):l=!1}l||el(n)}if(o=n.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return o.data==="$!"?n.lanes=16:n.lanes=536870912,null;Fa(n)}return o=r.children,r=r.fallback,i?(Cs(),i=n.mode,o=fv({mode:"hidden",children:o},i),r=jo(r,i,t,null),o.return=n,r.return=n,o.sibling=r,n.child=o,i=n.child,i.memoizedState=k_(t),i.childLanes=R_(e,s,t),n.memoizedState=D_,r):(Es(n),hv(n,o))}if(l=e.memoizedState,l!==null&&(o=l.dehydrated,o!==null)){if(a)n.flags&256?(Es(n),n.flags&=-257,n=U_(e,n,t)):n.memoizedState!==null?(Cs(),n.child=e.child,n.flags|=128,n=null):(Cs(),i=r.fallback,o=n.mode,r=fv({mode:"visible",children:r.children},o),i=jo(i,o,t,null),i.flags|=2,r.return=n,i.return=n,r.sibling=i,n.child=r,tl(n,e.child,null,t),r=n.child,r.memoizedState=k_(t),r.childLanes=R_(e,s,t),n.memoizedState=D_,n=i);else if(Es(n),o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var u=s.dgst;s=u,r=Error(Y(419)),r.stack="",r.digest=s,Md({value:r,source:null,stack:null}),n=U_(e,n,t)}else if(Rn||ah(e,n,t,!1),s=(t&e.childLanes)!==0,Rn||s){if(s=Ut,s!==null){if(r=t&-t,r&42)r=1;else switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=64;break;case 268435456:r=134217728;break;default:r=0}if(r=r&(s.suspendedLanes|t)?0:r,r!==0&&r!==l.retryLane)throw l.retryLane=r,Ks(e,r),_r(s,e,r),Vw}o.data==="$?"||wv(),n=U_(e,n,t)}else o.data==="$?"?(n.flags|=128,n.child=e.child,n=T3.bind(null,e),o._reactRetry=n,n=null):(e=l.treeContext,Qn=zi(o.nextSibling),hr=n,ft=!0,Li=null,Ji=!1,e!==null&&(si[oi++]=La,si[oi++]=Pa,si[oi++]=Go,La=e.id,Pa=e.overflow,Go=n),n=hv(n,r.children),n.flags|=4096);return n}return i?(Cs(),i=r.fallback,o=n.mode,l=e.child,u=l.sibling,r=Us(l,{mode:"hidden",children:r.children}),r.subtreeFlags=l.subtreeFlags&31457280,u!==null?i=Us(u,i):(i=jo(i,o,t,null),i.flags|=2),i.return=n,r.return=n,r.sibling=i,n.child=r,r=i,i=n.child,o=e.child.memoizedState,o===null?o=k_(t):(l=o.cachePool,l!==null?(u=yn._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=ow(),o={baseLanes:o.baseLanes|t,cachePool:l}),i.memoizedState=o,i.childLanes=R_(e,s,t),n.memoizedState=D_,r):(Es(n),t=e.child,e=t.sibling,t=Us(t,{mode:"visible",children:r.children}),t.return=n,t.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=t,n.memoizedState=null,t)}function hv(e,n){return n=fv({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function fv(e,n){return _2(e,n,0,null)}function U_(e,n,t){return tl(n,e.child,null,t),e=hv(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function EE(e,n,t){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n),mv(e.return,n,t)}function L_(e,n,t,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=t,a.tailMode=i)}function Ww(e,n,t){var r=n.pendingProps,i=r.revealOrder,a=r.tail;if(Gn(e,n,r.children,t),r=En.current,r&2)r=r&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&EE(e,t,n);else if(e.tag===19)EE(e,t,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(Bt(En,r),i){case"forwards":for(t=n.child,i=null;t!==null;)e=t.alternate,e!==null&&op(e)===null&&(i=t),t=t.sibling;t=i,t===null?(i=n.child,n.child=null):(i=t.sibling,t.sibling=null),L_(n,!1,i,t,a);break;case"backwards":for(t=null,i=n.child,n.child=null;i!==null;){if(e=i.alternate,e!==null&&op(e)===null){n.child=i;break}e=i.sibling,i.sibling=t,t=i,i=e}L_(n,!0,t,null,a);break;case"together":L_(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Qa(e,n,t){if(e!==null&&(n.dependencies=e.dependencies),Zs|=n.lanes,!(t&n.childLanes))if(e!==null){if(ah(e,n,t,!1),(t&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(Y(153));if(n.child!==null){for(e=n.child,t=Us(e,e.pendingProps),n.child=t,t.return=n;e.sibling!==null;)e=e.sibling,t=t.sibling=Us(e,e.pendingProps),t.return=n;t.sibling=null}return n.child}function iy(e,n){return e.lanes&n?!0:(e=e.dependencies,!!(e!==null&&hp(e)))}function c3(e,n,t){switch(n.tag){case 3:Xf(n,n.stateNode.containerInfo),Ss(n,yn,e.memoizedState.cache),nh();break;case 27:case 5:Qg(n);break;case 4:Xf(n,n.stateNode.containerInfo);break;case 10:Ss(n,n.type,n.memoizedProps.value);break;case 13:var r=n.memoizedState;if(r!==null)return r.dehydrated!==null?(Es(n),n.flags|=128,null):t&n.child.childLanes?Kw(e,n,t):(Es(n),e=Qa(e,n,t),e!==null?e.sibling:null);Es(n);break;case 19:var i=(e.flags&128)!==0;if(r=(t&n.childLanes)!==0,r||(ah(e,n,t,!1),r=(t&n.childLanes)!==0),i){if(r)return Ww(e,n,t);n.flags|=128}if(i=n.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bt(En,En.current),r)break;return null;case 22:case 23:return n.lanes=0,Qw(e,n,t);case 24:Ss(n,yn,e.memoizedState.cache)}return Qa(e,n,t)}function Yw(e,n,t){if(e!==null)if(e.memoizedProps!==n.pendingProps)Rn=!0;else{if(!iy(e,t)&&!(n.flags&128))return Rn=!1,c3(e,n,t);Rn=!!(e.flags&131072)}else Rn=!1,ft&&n.flags&1048576&&tw(n,ap,n.index);switch(n.lanes=0,n.tag){case 16:e:{e=n.pendingProps;var r=n.elementType,i=r._init;if(r=i(r._payload),n.type=r,typeof r=="function")ly(r)?(e=rl(r,e),n.tag=1,n=yE(null,n,r,e,t)):(n.tag=0,n=dv(null,n,r,e,t));else{if(r!=null){if(i=r.$$typeof,i===M0){n.tag=11,n=mE(null,n,r,e,t);break e}else if(i===x0){n.tag=14,n=_E(null,n,r,e,t);break e}}throw n=Vg(r)||r,Error(Y(306,n,""))}}return n;case 0:return dv(e,n,n.type,n.pendingProps,t);case 1:return r=n.type,i=rl(r,n.pendingProps),yE(e,n,r,i,t);case 3:e:{if(Xf(n,n.stateNode.containerInfo),e===null)throw Error(Y(387));var a=n.pendingProps;i=n.memoizedState,r=i.element,gv(e,n),Xc(n,a,null,t);var s=n.memoizedState;if(a=s.cache,Ss(n,yn,a),a!==i.cache&&_v(n,[yn],t,!0),Zc(),a=s.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:s.cache},n.updateQueue.baseState=i,n.memoizedState=i,n.flags&256){n=bE(e,n,a,t);break e}else if(a!==r){r=di(Error(Y(424)),n),Md(r),n=bE(e,n,a,t);break e}else for(Qn=zi(n.stateNode.containerInfo.firstChild),hr=n,ft=!0,Li=null,Ji=!0,t=aw(n,null,a,t),n.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(nh(),a===r){n=Qa(e,n,t);break e}Gn(e,n,a,t)}n=n.child}return n;case 26:return Wc(e,n),e===null?(t=$E(n.type,null,n.pendingProps,null))?n.memoizedState=t:ft||(t=n.type,e=n.pendingProps,r=yp(Ds.current).createElement(t),r[rr]=n,r[Nr]=e,Wn(r,t,e),Dn(r),n.stateNode=r):n.memoizedState=$E(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Qg(n),e===null&&ft&&(r=n.stateNode=R2(n.type,n.pendingProps,Ds.current),hr=n,Ji=!0,Qn=zi(r.firstChild)),r=n.pendingProps.children,e!==null||ft?Gn(e,n,r,t):n.child=tl(n,null,r,t),Wc(e,n),n.child;case 5:return e===null&&ft&&((i=r=Qn)&&(r=z3(r,n.type,n.pendingProps,Ji),r!==null?(n.stateNode=r,hr=n,Qn=zi(r.firstChild),Ji=!1,i=!0):i=!1),i||el(n)),Qg(n),i=n.type,a=n.pendingProps,s=e!==null?e.memoizedProps:null,r=a.children,xv(i,a)?r=null:s!==null&&xv(i,s)&&(n.flags|=32),n.memoizedState!==null&&(i=Q0(e,n,r3,null,null,t),Ud._currentValue=i),Wc(e,n),Gn(e,n,r,t),n.child;case 6:return e===null&&ft&&((e=t=Qn)&&(t=H3(t,n.pendingProps,Ji),t!==null?(n.stateNode=t,hr=n,Qn=null,e=!0):e=!1),e||el(n)),null;case 13:return Kw(e,n,t);case 4:return Xf(n,n.stateNode.containerInfo),r=n.pendingProps,e===null?n.child=tl(n,null,r,t):Gn(e,n,r,t),n.child;case 11:return mE(e,n,n.type,n.pendingProps,t);case 7:return Gn(e,n,n.pendingProps,t),n.child;case 8:return Gn(e,n,n.pendingProps.children,t),n.child;case 12:return Gn(e,n,n.pendingProps.children,t),n.child;case 10:return r=n.pendingProps,Ss(n,n.type,r.value),Gn(e,n,r.children,t),n.child;case 9:return i=n.type._context,r=n.pendingProps.children,il(n),i=ir(i),r=r(i),n.flags|=1,Gn(e,n,r,t),n.child;case 14:return _E(e,n,n.type,n.pendingProps,t);case 15:return jw(e,n,n.type,n.pendingProps,t);case 19:return Ww(e,n,t);case 22:return Qw(e,n,t);case 24:return il(n),r=ir(yn),e===null?(i=V0(),i===null&&(i=Ut,a=G0(),i.pooledCache=a,a.refCount++,a!==null&&(i.pooledCacheLanes|=t),i=a),n.memoizedState={parent:r,cache:i},ay(n),Ss(n,yn,i)):(e.lanes&t&&(gv(e,n),Xc(n,null,null,t),Zc()),i=e.memoizedState,a=n.memoizedState,i.parent!==r?(i={parent:r,cache:r},n.memoizedState=i,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=i),Ss(n,yn,r)):(r=a.cache,Ss(n,yn,r),r!==i.cache&&_v(n,[yn],t,!0))),Gn(e,n,n.pendingProps.children,t),n.child;case 29:throw n.pendingProps}throw Error(Y(156,n.tag))}var pv=da(null),Cl=null,$a=null;function Ss(e,n,t){Bt(pv,n._currentValue),n._currentValue=t}function Ba(e){e._currentValue=pv.current,Pn(pv)}function mv(e,n,t){for(;e!==null;){var r=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),e===t)break;e=e.return}}function _v(e,n,t,r){var i=e.child;for(i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){var s=i.child;a=a.firstContext;e:for(;a!==null;){var o=a;a=i;for(var l=0;l<n.length;l++)if(o.context===n[l]){a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),mv(a.return,t,e),r||(s=null);break e}a=o.next}}else if(i.tag===18){if(s=i.return,s===null)throw Error(Y(341));s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),mv(s,t,e),s=null}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}}function ah(e,n,t,r){e=null;for(var i=n,a=!1;i!==null;){if(!a){if(i.flags&524288)a=!0;else if(i.flags&262144)break}if(i.tag===10){var s=i.alternate;if(s===null)throw Error(Y(387));if(s=s.memoizedProps,s!==null){var o=i.type;Kr(i.pendingProps.value,s.value)||(e!==null?e.push(o):e=[o])}}else if(i===Zf.current){if(s=i.alternate,s===null)throw Error(Y(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(e!==null?e.push(Ud):e=[Ud])}i=i.return}e!==null&&_v(n,e,t,r),n.flags|=262144}function hp(e){for(e=e.firstContext;e!==null;){if(!Kr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function il(e){Cl=e,$a=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ir(e){return Zw(Cl,e)}function Fh(e,n){return Cl===null&&il(e),Zw(e,n)}function Zw(e,n){var t=n._currentValue;if(n={context:n,memoizedValue:t,next:null},$a===null){if(e===null)throw Error(Y(308));$a=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else $a=$a.next=n;return t}var vs=!1;function ay(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gv(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ks(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Rs(e,n,t){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Kt&2){var i=r.pending;return i===null?n.next=n:(n.next=i.next,i.next=n),r.pending=n,n=rp(e),ew(e,null,t),n}return mm(e,r,n,t),rp(e)}function Yc(e,n,t){if(n=n.updateQueue,n!==null&&(n=n.shared,(t&4194176)!==0)){var r=n.lanes;r&=e.pendingLanes,t|=r,n.lanes=t,NT(e,t)}}function P_(e,n){var t=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,a=null;if(t=t.firstBaseUpdate,t!==null){do{var s={lane:t.lane,tag:t.tag,payload:t.payload,callback:null,next:null};a===null?i=a=s:a=a.next=s,t=t.next}while(t!==null);a===null?i=a=n:a=a.next=n}else i=a=n;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=n:e.next=n,t.lastBaseUpdate=n}var vv=!1;function Zc(){if(vv){var e=hu;if(e!==null)throw e}}function Xc(e,n,t,r){vv=!1;var i=e.updateQueue;vs=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,c=u=l=null,o=a;do{var h=o.lane&-536870913,f=h!==o.lane;if(f?(ct&h)===h:(r&h)===h){h!==0&&h===Cu&&(vv=!0),c!==null&&(c=c.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,y=o;h=n;var C=t;switch(y.tag){case 1:if(m=y.payload,typeof m=="function"){d=m.call(C,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,h=typeof m=="function"?m.call(C,d,h):m,h==null)break e;d=$t({},d,h);break e;case 2:vs=!0}}h=o.callback,h!==null&&(e.flags|=64,f&&(e.flags|=8192),f=i.callbacks,f===null?i.callbacks=[h]:f.push(h))}else f={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,s|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,a===null&&(i.shared.lanes=0),Zs|=s,e.lanes=s,e.memoizedState=d}}function Xw(e,n){if(typeof e!="function")throw Error(Y(191,e));e.call(n)}function Jw(e,n){var t=e.callbacks;if(t!==null)for(e.callbacks=null,e=0;e<t.length;e++)Xw(t[e],n)}function sh(e,n){try{var t=n.updateQueue,r=t!==null?t.lastEffect:null;if(r!==null){var i=r.next;t=i;do{if((t.tag&e)===e){r=void 0;var a=t.create,s=t.inst;r=a(),s.destroy=r}t=t.next}while(t!==i)}}catch(o){Ot(n,n.return,o)}}function Ys(e,n,t){try{var r=n.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(o!==void 0){s.destroy=void 0,i=n;var l=t;try{o()}catch(u){Ot(i,l,u)}}}r=r.next}while(r!==a)}}catch(u){Ot(n,n.return,u)}}function e2(e){var n=e.updateQueue;if(n!==null){var t=e.stateNode;try{Jw(n,t)}catch(r){Ot(e,e.return,r)}}}function t2(e,n,t){t.props=rl(e.type,e.memoizedProps),t.state=e.memoizedState;try{t.componentWillUnmount()}catch(r){Ot(e,n,r)}}function ko(e,n){try{var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=r;break;default:i=r}typeof t=="function"?e.refCleanup=t(i):t.current=i}}catch(a){Ot(e,n,a)}}function zr(e,n){var t=e.ref,r=e.refCleanup;if(t!==null)if(typeof r=="function")try{r()}catch(i){Ot(e,n,i)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof t=="function")try{t(null)}catch(i){Ot(e,n,i)}else t.current=null}function n2(e){var n=e.type,t=e.memoizedProps,r=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":t.autoFocus&&r.focus();break e;case"img":t.src?r.src=t.src:t.srcSet&&(r.srcset=t.srcSet)}}catch(i){Ot(e,e.return,i)}}function CE(e,n,t){try{var r=e.stateNode;U3(r,e.type,t,n),r[Nr]=n}catch(i){Ot(e,e.return,i)}}function r2(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function F_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||r2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yv(e,n,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?t.nodeType===8?t.parentNode.insertBefore(e,n):t.insertBefore(e,n):(t.nodeType===8?(n=t.parentNode,n.insertBefore(e,t)):(n=t,n.appendChild(e)),t=t._reactRootContainer,t!=null||n.onclick!==null||(n.onclick=Cm));else if(r!==4&&r!==27&&(e=e.child,e!==null))for(yv(e,n,t),e=e.sibling;e!==null;)yv(e,n,t),e=e.sibling}function fp(e,n,t){var r=e.tag;if(r===5||r===6)e=e.stateNode,n?t.insertBefore(e,n):t.appendChild(e);else if(r!==4&&r!==27&&(e=e.child,e!==null))for(fp(e,n,t),e=e.sibling;e!==null;)fp(e,n,t),e=e.sibling}var Da=!1,tn=!1,$_=!1,SE=typeof WeakSet=="function"?WeakSet:Set,xn=null,TE=!1;function d3(e,n){if(e=e.containerInfo,Iv=Sp,e=QT(e),F0(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{t.nodeType,a.nodeType}catch{t=null;break e}var s=0,o=-1,l=-1,u=0,c=0,d=e,h=null;t:for(;;){for(var f;d!==t||i!==0&&d.nodeType!==3||(o=s+i),d!==a||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break t;if(h===t&&++u===i&&(o=s),h===a&&++c===r&&(l=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Mv={focusedElem:e,selectionRange:t},Sp=!1,xn=n;xn!==null;)if(n=xn,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,xn=e;else for(;xn!==null;){switch(n=xn,a=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&a!==null){e=void 0,t=n,i=a.memoizedProps,a=a.memoizedState,r=t.stateNode;try{var m=rl(t.type,i,t.elementType===t.type);e=r.getSnapshotBeforeUpdate(m,a),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Ot(t,t.return,y)}}break;case 3:if(e&1024){if(e=n.stateNode.containerInfo,t=e.nodeType,t===9)Ov(e);else if(t===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Ov(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(Y(163))}if(e=n.sibling,e!==null){e.return=n.return,xn=e;break}xn=n.return}return m=TE,TE=!1,m}function i2(e,n,t){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Ea(e,t),r&4&&sh(5,t);break;case 1:if(Ea(e,t),r&4)if(e=t.stateNode,n===null)try{e.componentDidMount()}catch(o){Ot(t,t.return,o)}else{var i=rl(t.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(i,n,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Ot(t,t.return,o)}}r&64&&e2(t),r&512&&ko(t,t.return);break;case 3:if(Ea(e,t),r&64&&(r=t.updateQueue,r!==null)){if(e=null,t.child!==null)switch(t.child.tag){case 27:case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}try{Jw(r,e)}catch(o){Ot(t,t.return,o)}}break;case 26:Ea(e,t),r&512&&ko(t,t.return);break;case 27:case 5:Ea(e,t),n===null&&r&4&&n2(t),r&512&&ko(t,t.return);break;case 12:Ea(e,t);break;case 13:Ea(e,t),r&4&&o2(e,t);break;case 22:if(i=t.memoizedState!==null||Da,!i){n=n!==null&&n.memoizedState!==null||tn;var a=Da,s=tn;Da=i,(tn=n)&&!s?ms(e,t,(t.subtreeFlags&8772)!==0):Ea(e,t),Da=a,tn=s}r&512&&(t.memoizedProps.mode==="manual"?ko(t,t.return):zr(t,t.return));break;default:Ea(e,t)}}function a2(e){var n=e.alternate;n!==null&&(e.alternate=null,a2(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&D0(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var dn=null,Rr=!1;function ba(e,n,t){for(t=t.child;t!==null;)s2(e,n,t),t=t.sibling}function s2(e,n,t){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(Xd,t)}catch{}switch(t.tag){case 26:tn||zr(t,n),ba(e,n,t),t.memoizedState?t.memoizedState.count--:t.stateNode&&(t=t.stateNode,t.parentNode.removeChild(t));break;case 27:tn||zr(t,n);var r=dn,i=Rr;for(dn=t.stateNode,ba(e,n,t),t=t.stateNode,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);D0(t),dn=r,Rr=i;break;case 5:tn||zr(t,n);case 6:i=dn;var a=Rr;if(dn=null,ba(e,n,t),dn=i,Rr=a,dn!==null)if(Rr)try{e=dn,r=t.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)}catch(s){Ot(t,n,s)}else try{dn.removeChild(t.stateNode)}catch(s){Ot(t,n,s)}break;case 18:dn!==null&&(Rr?(n=dn,t=t.stateNode,n.nodeType===8?Z_(n.parentNode,t):n.nodeType===1&&Z_(n,t),Fd(n)):Z_(dn,t.stateNode));break;case 4:r=dn,i=Rr,dn=t.stateNode.containerInfo,Rr=!0,ba(e,n,t),dn=r,Rr=i;break;case 0:case 11:case 14:case 15:tn||Ys(2,t,n),tn||Ys(4,t,n),ba(e,n,t);break;case 1:tn||(zr(t,n),r=t.stateNode,typeof r.componentWillUnmount=="function"&&t2(t,n,r)),ba(e,n,t);break;case 21:ba(e,n,t);break;case 22:tn||zr(t,n),tn=(r=tn)||t.memoizedState!==null,ba(e,n,t),tn=r;break;default:ba(e,n,t)}}function o2(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Fd(e)}catch(t){Ot(n,n.return,t)}}function h3(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new SE),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new SE),n;default:throw Error(Y(435,e.tag))}}function z_(e,n){var t=h3(e);n.forEach(function(r){var i=w3.bind(null,e,r);t.has(r)||(t.add(r),r.then(i,i))})}function ti(e,n){var t=n.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r],a=e,s=n,o=s;e:for(;o!==null;){switch(o.tag){case 27:case 5:dn=o.stateNode,Rr=!1;break e;case 3:dn=o.stateNode.containerInfo,Rr=!0;break e;case 4:dn=o.stateNode.containerInfo,Rr=!0;break e}o=o.return}if(dn===null)throw Error(Y(160));s2(a,s,i),dn=null,Rr=!1,a=i.alternate,a!==null&&(a.return=null),i.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)l2(n,e),n=n.sibling}var Ui=null;function l2(e,n){var t=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ti(n,e),ni(e),r&4&&(Ys(3,e,e.return),sh(3,e),Ys(5,e,e.return));break;case 1:ti(n,e),ni(e),r&512&&(tn||t===null||zr(t,t.return)),r&64&&Da&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(t=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=t===null?r:t.concat(r))));break;case 26:var i=Ui;if(ti(n,e),ni(e),r&512&&(tn||t===null||zr(t,t.return)),r&4){var a=t!==null?t.memoizedState:null;if(r=e.memoizedState,t===null)if(r===null)if(e.stateNode===null){e:{r=e.type,t=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":a=i.getElementsByTagName("title")[0],(!a||a[wd]||a[rr]||a.namespaceURI==="http://www.w3.org/2000/svg"||a.hasAttribute("itemprop"))&&(a=i.createElement(r),i.head.insertBefore(a,i.querySelector("head > title"))),Wn(a,r,t),a[rr]=e,Dn(a),r=a;break e;case"link":var s=HE("link","href",i).get(r+(t.href||""));if(s){for(var o=0;o<s.length;o++)if(a=s[o],a.getAttribute("href")===(t.href==null?null:t.href)&&a.getAttribute("rel")===(t.rel==null?null:t.rel)&&a.getAttribute("title")===(t.title==null?null:t.title)&&a.getAttribute("crossorigin")===(t.crossOrigin==null?null:t.crossOrigin)){s.splice(o,1);break t}}a=i.createElement(r),Wn(a,r,t),i.head.appendChild(a);break;case"meta":if(s=HE("meta","content",i).get(r+(t.content||""))){for(o=0;o<s.length;o++)if(a=s[o],a.getAttribute("content")===(t.content==null?null:""+t.content)&&a.getAttribute("name")===(t.name==null?null:t.name)&&a.getAttribute("property")===(t.property==null?null:t.property)&&a.getAttribute("http-equiv")===(t.httpEquiv==null?null:t.httpEquiv)&&a.getAttribute("charset")===(t.charSet==null?null:t.charSet)){s.splice(o,1);break t}}a=i.createElement(r),Wn(a,r,t),i.head.appendChild(a);break;default:throw Error(Y(468,r))}a[rr]=e,Dn(a),r=a}e.stateNode=r}else qE(i,e.type,e.stateNode);else e.stateNode=zE(i,r,e.memoizedProps);else a!==r?(a===null?t.stateNode!==null&&(t=t.stateNode,t.parentNode.removeChild(t)):a.count--,r===null?qE(i,e.type,e.stateNode):zE(i,r,e.memoizedProps)):r===null&&e.stateNode!==null&&CE(e,e.memoizedProps,t.memoizedProps)}break;case 27:if(r&4&&e.alternate===null){i=e.stateNode,a=e.memoizedProps;try{for(var l=i.firstChild;l;){var u=l.nextSibling,c=l.nodeName;l[wd]||c==="HEAD"||c==="BODY"||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&l.rel.toLowerCase()==="stylesheet"||i.removeChild(l),l=u}for(var d=e.type,h=i.attributes;h.length;)i.removeAttributeNode(h[0]);Wn(i,d,a),i[rr]=e,i[Nr]=a}catch(m){Ot(e,e.return,m)}}case 5:if(ti(n,e),ni(e),r&512&&(tn||t===null||zr(t,t.return)),e.flags&32){i=e.stateNode;try{bu(i,"")}catch(m){Ot(e,e.return,m)}}r&4&&e.stateNode!=null&&(i=e.memoizedProps,CE(e,i,t!==null?t.memoizedProps:i)),r&1024&&($_=!0);break;case 6:if(ti(n,e),ni(e),r&4){if(e.stateNode===null)throw Error(Y(162));r=e.memoizedProps,t=e.stateNode;try{t.nodeValue=r}catch(m){Ot(e,e.return,m)}}break;case 3:if(Df=null,i=Ui,Ui=bp(n.containerInfo),ti(n,e),Ui=i,ni(e),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Fd(n.containerInfo)}catch(m){Ot(e,e.return,m)}$_&&($_=!1,u2(e));break;case 4:r=Ui,Ui=bp(e.stateNode.containerInfo),ti(n,e),ni(e),Ui=r;break;case 12:ti(n,e),ni(e);break;case 13:ti(n,e),ni(e),e.child.flags&8192&&e.memoizedState!==null!=(t!==null&&t.memoizedState!==null)&&(dy=aa()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,z_(e,r)));break;case 22:if(r&512&&(tn||t===null||zr(t,t.return)),l=e.memoizedState!==null,u=t!==null&&t.memoizedState!==null,c=Da,d=tn,Da=c||l,tn=d||u,ti(n,e),tn=d,Da=c,ni(e),n=e.stateNode,n._current=e,n._visibility&=-3,n._visibility|=n._pendingVisibility&2,r&8192&&(n._visibility=l?n._visibility&-2:n._visibility|1,l&&(n=Da||tn,t===null||u||n||Vl(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(t=null,n=e;;){if(n.tag===5||n.tag===26||n.tag===27){if(t===null){u=t=n;try{if(i=u.stateNode,l)a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{s=u.stateNode,o=u.memoizedProps.style;var f=o!=null&&o.hasOwnProperty("display")?o.display:null;s.style.display=f==null||typeof f=="boolean"?"":(""+f).trim()}}catch(m){Ot(u,u.return,m)}}}else if(n.tag===6){if(t===null){u=n;try{u.stateNode.nodeValue=l?"":u.memoizedProps}catch(m){Ot(u,u.return,m)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;t===n&&(t=null),n=n.return}t===n&&(t=null),n.sibling.return=n.return,n=n.sibling}r&4&&(r=e.updateQueue,r!==null&&(t=r.retryQueue,t!==null&&(r.retryQueue=null,z_(e,t))));break;case 19:ti(n,e),ni(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,z_(e,r)));break;case 21:break;default:ti(n,e),ni(e)}}function ni(e){var n=e.flags;if(n&2){try{if(e.tag!==27){e:{for(var t=e.return;t!==null;){if(r2(t)){var r=t;break e}t=t.return}throw Error(Y(160))}switch(r.tag){case 27:var i=r.stateNode,a=F_(e);fp(e,a,i);break;case 5:var s=r.stateNode;r.flags&32&&(bu(s,""),r.flags&=-33);var o=F_(e);fp(e,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,u=F_(e);yv(e,u,l);break;default:throw Error(Y(161))}}}catch(c){Ot(e,e.return,c)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function u2(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;u2(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ea(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)i2(e,n.alternate,n),n=n.sibling}function Vl(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Ys(4,n,n.return),Vl(n);break;case 1:zr(n,n.return);var t=n.stateNode;typeof t.componentWillUnmount=="function"&&t2(n,n.return,t),Vl(n);break;case 26:case 27:case 5:zr(n,n.return),Vl(n);break;case 22:zr(n,n.return),n.memoizedState===null&&Vl(n);break;default:Vl(n)}e=e.sibling}}function ms(e,n,t){for(t=t&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var r=n.alternate,i=e,a=n,s=a.flags;switch(a.tag){case 0:case 11:case 15:ms(i,a,t),sh(4,a);break;case 1:if(ms(i,a,t),r=a,i=r.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){Ot(r,r.return,u)}if(r=a,i=r.updateQueue,i!==null){var o=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(l!==null)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Xw(l[i],o)}catch(u){Ot(r,r.return,u)}}t&&s&64&&e2(a),ko(a,a.return);break;case 26:case 27:case 5:ms(i,a,t),t&&r===null&&s&4&&n2(a),ko(a,a.return);break;case 12:ms(i,a,t);break;case 13:ms(i,a,t),t&&s&4&&o2(i,a);break;case 22:a.memoizedState===null&&ms(i,a,t),ko(a,a.return);break;default:ms(i,a,t)}n=n.sibling}}function sy(e,n){var t=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==t&&(e!=null&&e.refCount++,t!=null&&rh(t))}function oy(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&rh(e))}function cs(e,n,t,r){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)c2(e,n,t,r),n=n.sibling}function c2(e,n,t,r){var i=n.flags;switch(n.tag){case 0:case 11:case 15:cs(e,n,t,r),i&2048&&sh(9,n);break;case 3:cs(e,n,t,r),i&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&rh(e)));break;case 12:if(i&2048){cs(e,n,t,r),e=n.stateNode;try{var a=n.memoizedProps,s=a.id,o=a.onPostCommit;typeof o=="function"&&o(s,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Ot(n,n.return,l)}}else cs(e,n,t,r);break;case 23:break;case 22:a=n.stateNode,n.memoizedState!==null?a._visibility&4?cs(e,n,t,r):Jc(e,n):a._visibility&4?cs(e,n,t,r):(a._visibility|=4,jl(e,n,t,r,(n.subtreeFlags&10256)!==0)),i&2048&&sy(n.alternate,n);break;case 24:cs(e,n,t,r),i&2048&&oy(n.alternate,n);break;default:cs(e,n,t,r)}}function jl(e,n,t,r,i){for(i=i&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var a=e,s=n,o=t,l=r,u=s.flags;switch(s.tag){case 0:case 11:case 15:jl(a,s,o,l,i),sh(8,s);break;case 23:break;case 22:var c=s.stateNode;s.memoizedState!==null?c._visibility&4?jl(a,s,o,l,i):Jc(a,s):(c._visibility|=4,jl(a,s,o,l,i)),i&&u&2048&&sy(s.alternate,s);break;case 24:jl(a,s,o,l,i),i&&u&2048&&oy(s.alternate,s);break;default:jl(a,s,o,l,i)}n=n.sibling}}function Jc(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var t=e,r=n,i=r.flags;switch(r.tag){case 22:Jc(t,r),i&2048&&sy(r.alternate,r);break;case 24:Jc(t,r),i&2048&&oy(r.alternate,r);break;default:Jc(t,r)}n=n.sibling}}var kc=8192;function kl(e){if(e.subtreeFlags&kc)for(e=e.child;e!==null;)d2(e),e=e.sibling}function d2(e){switch(e.tag){case 26:kl(e),e.flags&kc&&e.memoizedState!==null&&eO(Ui,e.memoizedState,e.memoizedProps);break;case 5:kl(e);break;case 3:case 4:var n=Ui;Ui=bp(e.stateNode.containerInfo),kl(e),Ui=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=kc,kc=16777216,kl(e),kc=n):kl(e));break;default:kl(e)}}function h2(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function dc(e){var n=e.deletions;if(e.flags&16){if(n!==null)for(var t=0;t<n.length;t++){var r=n[t];xn=r,p2(r,e)}h2(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)f2(e),e=e.sibling}function f2(e){switch(e.tag){case 0:case 11:case 15:dc(e),e.flags&2048&&Ys(9,e,e.return);break;case 3:dc(e);break;case 12:dc(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&4&&(e.return===null||e.return.tag!==13)?(n._visibility&=-5,Mf(e)):dc(e);break;default:dc(e)}}function Mf(e){var n=e.deletions;if(e.flags&16){if(n!==null)for(var t=0;t<n.length;t++){var r=n[t];xn=r,p2(r,e)}h2(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Ys(8,n,n.return),Mf(n);break;case 22:t=n.stateNode,t._visibility&4&&(t._visibility&=-5,Mf(n));break;default:Mf(n)}e=e.sibling}}function p2(e,n){for(;xn!==null;){var t=xn;switch(t.tag){case 0:case 11:case 15:Ys(8,t,n);break;case 23:case 22:if(t.memoizedState!==null&&t.memoizedState.cachePool!==null){var r=t.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:rh(t.memoizedState.cache)}if(r=t.child,r!==null)r.return=t,xn=r;else e:for(t=e;xn!==null;){r=xn;var i=r.sibling,a=r.return;if(a2(r),r===t){xn=null;break e}if(i!==null){i.return=a,xn=i;break e}xn=a}}}function f3(e,n,t,r){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mi(e,n,t,r){return new f3(e,n,t,r)}function ly(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Us(e,n){var t=e.alternate;return t===null?(t=mi(e.tag,n,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=n,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&31457280,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,n=e.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t.refCleanup=e.refCleanup,t}function m2(e,n){e.flags&=31457282;var t=e.alternate;return t===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=t.childLanes,e.lanes=t.lanes,e.child=t.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=t.memoizedProps,e.memoizedState=t.memoizedState,e.updateQueue=t.updateQueue,e.type=t.type,n=t.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function xf(e,n,t,r,i,a){var s=0;if(r=e,typeof e=="function")ly(e)&&(s=1);else if(typeof e=="string")s=X3(e,t,ia.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Kl:return jo(t.children,i,a,n);case _T:s=8,i|=24;break;case qg:return e=mi(12,t,n,i|2),e.elementType=qg,e.lanes=a,e;case Bg:return e=mi(13,t,n,i),e.elementType=Bg,e.lanes=a,e;case Gg:return e=mi(19,t,n,i),e.elementType=Gg,e.lanes=a,e;case vT:return _2(t,i,a,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case FM:case Ua:s=10;break e;case gT:s=9;break e;case M0:s=11;break e;case x0:s=14;break e;case gs:s=16,r=null;break e}s=29,t=Error(Y(130,e===null?"null":typeof e,"")),r=null}return n=mi(s,t,n,i),n.elementType=e,n.type=r,n.lanes=a,n}function jo(e,n,t,r){return e=mi(7,e,r,n),e.lanes=t,e}function _2(e,n,t,r){e=mi(22,e,r,n),e.elementType=vT,e.lanes=t;var i={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var a=i._current;if(a===null)throw Error(Y(456));if(!(i._pendingVisibility&2)){var s=Ks(a,2);s!==null&&(i._pendingVisibility|=2,_r(s,a,2))}},attach:function(){var a=i._current;if(a===null)throw Error(Y(456));if(i._pendingVisibility&2){var s=Ks(a,2);s!==null&&(i._pendingVisibility&=-3,_r(s,a,2))}}};return e.stateNode=i,e}function H_(e,n,t){return e=mi(6,e,null,n),e.lanes=t,e}function q_(e,n,t){return n=mi(4,e.children!==null?e.children:[],e.key,n),n.lanes=t,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Ca(e){e.flags|=4}function wE(e,n){if(n.type!=="stylesheet"||n.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!P2(n)){if(n=vi.current,n!==null&&((ct&4194176)===ct?sa!==null:(ct&62914560)!==ct&&!(ct&536870912)||n!==sa))throw jc=rv,nw;e.flags|=8192}}function $h(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?wT():536870912,e.lanes|=n,Tu|=n)}function hc(e,n){if(!ft)switch(e.tailMode){case"hidden":n=e.tail;for(var t=null;n!==null;)n.alternate!==null&&(t=n),n=n.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var n=e.alternate!==null&&e.alternate.child===e.child,t=0,r=0;if(n)for(var i=e.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&31457280,r|=i.flags&31457280,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=t,n}function p3(e,n,t){var r=n.pendingProps;switch(q0(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(n),null;case 1:return jt(n),null;case 3:return t=n.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Ba(yn),vu(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(e===null||e.child===null)&&(uc(n)?Ca(n):e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Li!==null&&(Tv(Li),Li=null))),jt(n),null;case 26:return t=n.memoizedState,e===null?(Ca(n),t!==null?(jt(n),wE(n,t)):(jt(n),n.flags&=-16777217)):t?t!==e.memoizedState?(Ca(n),jt(n),wE(n,t)):(jt(n),n.flags&=-16777217):(e.memoizedProps!==r&&Ca(n),jt(n),n.flags&=-16777217),null;case 27:Jf(n),t=Ds.current;var i=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==r&&Ca(n);else{if(!r){if(n.stateNode===null)throw Error(Y(166));return jt(n),null}e=ia.current,uc(n)?tE(n):(e=R2(i,r,t),n.stateNode=e,Ca(n))}return jt(n),null;case 5:if(Jf(n),t=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==r&&Ca(n);else{if(!r){if(n.stateNode===null)throw Error(Y(166));return jt(n),null}if(e=ia.current,uc(n))tE(n);else{switch(i=yp(Ds.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",t);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",t);break;default:switch(t){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",t);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",t);break;case"script":e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof r.is=="string"?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e=typeof r.is=="string"?i.createElement(t,{is:r.is}):i.createElement(t)}}e[rr]=n,e[Nr]=r;e:for(i=n.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.tag!==27&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n.stateNode=e;e:switch(Wn(e,t,r),t){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ca(n)}}return jt(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==r&&Ca(n);else{if(typeof r!="string"&&n.stateNode===null)throw Error(Y(166));if(e=Ds.current,uc(n)){if(e=n.stateNode,t=n.memoizedProps,r=null,i=hr,i!==null)switch(i.tag){case 27:case 5:r=i.memoizedProps}e[rr]=n,e=!!(e.nodeValue===t||r!==null&&r.suppressHydrationWarning===!0||O2(e.nodeValue,t)),e||el(n)}else e=yp(e).createTextNode(r),e[rr]=n,n.stateNode=e}return jt(n),null;case 13:if(r=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(i=uc(n),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Y(318));if(i=n.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Y(317));i[rr]=n}else nh(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;jt(n),i=!1}else Li!==null&&(Tv(Li),Li=null),i=!0;if(!i)return n.flags&256?(Fa(n),n):(Fa(n),null)}if(Fa(n),n.flags&128)return n.lanes=t,n;if(t=r!==null,e=e!==null&&e.memoizedState!==null,t){r=n.child,i=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(i=r.alternate.memoizedState.cachePool.pool);var a=null;r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),a!==i&&(r.flags|=2048)}return t!==e&&t&&(n.child.flags|=8192),$h(n,n.updateQueue),jt(n),null;case 4:return vu(),e===null&&py(n.stateNode.containerInfo),jt(n),null;case 10:return Ba(n.type),jt(n),null;case 19:if(Pn(En),i=n.memoizedState,i===null)return jt(n),null;if(r=(n.flags&128)!==0,a=i.rendering,a===null)if(r)hc(i,!1);else{if(nn!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(a=op(e),a!==null){for(n.flags|=128,hc(i,!1),e=a.updateQueue,n.updateQueue=e,$h(n,e),n.subtreeFlags=0,e=t,t=n.child;t!==null;)m2(t,e),t=t.sibling;return Bt(En,En.current&1|2),n.child}e=e.sibling}i.tail!==null&&aa()>pp&&(n.flags|=128,r=!0,hc(i,!1),n.lanes=4194304)}else{if(!r)if(e=op(a),e!==null){if(n.flags|=128,r=!0,e=e.updateQueue,n.updateQueue=e,$h(n,e),hc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!ft)return jt(n),null}else 2*aa()-i.renderingStartTime>pp&&t!==536870912&&(n.flags|=128,r=!0,hc(i,!1),n.lanes=4194304);i.isBackwards?(a.sibling=n.child,n.child=a):(e=i.last,e!==null?e.sibling=a:n.child=a,i.last=a)}return i.tail!==null?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.renderingStartTime=aa(),n.sibling=null,e=En.current,Bt(En,r?e&1|2:e&1),n):(jt(n),null);case 22:case 23:return Fa(n),B0(),r=n.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(n.flags|=8192):r&&(n.flags|=8192),r?t&536870912&&!(n.flags&128)&&(jt(n),n.subtreeFlags&6&&(n.flags|=8192)):jt(n),t=n.updateQueue,t!==null&&$h(n,t.retryQueue),t=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),r=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==t&&(n.flags|=2048),e!==null&&Pn(Vo),null;case 24:return t=null,e!==null&&(t=e.memoizedState.cache),n.memoizedState.cache!==t&&(n.flags|=2048),Ba(yn),jt(n),null;case 25:return null}throw Error(Y(156,n.tag))}function m3(e,n){switch(q0(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ba(yn),vu(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Jf(n),null;case 13:if(Fa(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(Y(340));nh()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Pn(En),null;case 4:return vu(),null;case 10:return Ba(n.type),null;case 22:case 23:return Fa(n),B0(),e!==null&&Pn(Vo),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Ba(yn),null;case 25:return null;default:return null}}function g2(e,n){switch(q0(n),n.tag){case 3:Ba(yn),vu();break;case 26:case 27:case 5:Jf(n);break;case 4:vu();break;case 13:Fa(n);break;case 19:Pn(En);break;case 10:Ba(n.type);break;case 22:case 23:Fa(n),B0(),e!==null&&Pn(Vo);break;case 24:Ba(yn)}}var _3={getCacheForType:function(e){var n=ir(yn),t=n.data.get(e);return t===void 0&&(t=e(),n.data.set(e,t)),t}},g3=typeof WeakMap=="function"?WeakMap:Map,Kt=0,Ut=null,Je=null,ct=0,Rt=0,Ur=null,ka=!1,Vu=!1,uy=!1,Ka=0,nn=0,Zs=0,Qo=0,cy=0,_i=0,Tu=0,ed=null,ea=null,bv=!1,dy=0,pp=1/0,mp=null,Ls=null,zh=!1,Ao=null,td=0,Ev=0,Cv=null,nd=0,Sv=null;function jr(){if(Kt&2&&ct!==0)return ct&-ct;if(Be.T!==null){var e=Cu;return e!==0?e:fy()}return MT()}function v2(){_i===0&&(_i=!(ct&536870912)||ft?TT():536870912);var e=vi.current;return e!==null&&(e.flags|=32),_i}function _r(e,n,t){(e===Ut&&Rt===2||e.cancelPendingCommit!==null)&&(wu(e,0),Ra(e,ct,_i,!1)),eh(e,t),(!(Kt&2)||e!==Ut)&&(e===Ut&&(!(Kt&2)&&(Qo|=t),nn===4&&Ra(e,ct,_i,!1)),ha(e))}function y2(e,n,t){if(Kt&6)throw Error(Y(327));var r=!t&&(n&60)===0&&(n&e.expiredLanes)===0||Jd(e,n),i=r?b3(e,n):B_(e,n,!0),a=r;do{if(i===0){Vu&&!r&&Ra(e,n,0,!1);break}else if(i===6)Ra(e,n,0,!ka);else{if(t=e.current.alternate,a&&!v3(t)){i=B_(e,n,!1),a=!1;continue}if(i===2){if(a=n,e.errorRecoveryDisabledLanes&a)var s=0;else s=e.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){n=s;e:{var o=e;i=ed;var l=o.current.memoizedState.isDehydrated;if(l&&(wu(o,s).flags|=256),s=B_(o,s,!1),s!==2){if(uy&&!l){o.errorRecoveryDisabledLanes|=a,Qo|=a,i=4;break e}a=ea,ea=i,a!==null&&Tv(a)}i=s}if(a=!1,i!==2)continue}}if(i===1){wu(e,0),Ra(e,n,0,!0);break}e:{switch(r=e,i){case 0:case 1:throw Error(Y(345));case 4:if((n&4194176)===n){Ra(r,n,_i,!ka);break e}break;case 2:ea=null;break;case 3:case 5:break;default:throw Error(Y(329))}if(r.finishedWork=t,r.finishedLanes=n,(n&62914560)===n&&(a=dy+300-aa(),10<a)){if(Ra(r,n,_i,!ka),cm(r,0)!==0)break e;r.timeoutHandle=k2(AE.bind(null,r,t,ea,mp,bv,n,_i,Qo,Tu,ka,2,-0,0),a);break e}AE(r,t,ea,mp,bv,n,_i,Qo,Tu,ka,0,-0,0)}}break}while(!0);ha(e)}function Tv(e){ea===null?ea=e:ea.push.apply(ea,e)}function AE(e,n,t,r,i,a,s,o,l,u,c,d,h){var f=n.subtreeFlags;if((f&8192||(f&16785408)===16785408)&&(Rd={stylesheets:null,count:0,unsuspend:J3},d2(n),n=tO(),n!==null)){e.cancelPendingCommit=n(IE.bind(null,e,t,r,i,s,o,l,1,d,h)),Ra(e,a,s,!u);return}IE(e,t,r,i,s,o,l,c,d,h)}function v3(e){for(var n=e;;){var t=n.tag;if((t===0||t===11||t===15)&&n.flags&16384&&(t=n.updateQueue,t!==null&&(t=t.stores,t!==null)))for(var r=0;r<t.length;r++){var i=t[r],a=i.getSnapshot;i=i.value;try{if(!Kr(a(),i))return!1}catch{return!1}}if(t=n.child,n.subtreeFlags&16384&&t!==null)t.return=n,n=t;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ra(e,n,t,r){n&=~cy,n&=~Qo,e.suspendedLanes|=n,e.pingedLanes&=~n,r&&(e.warmLanes|=n),r=e.expirationTimes;for(var i=n;0<i;){var a=31-Vr(i),s=1<<a;r[a]=-1,i&=~s}t!==0&&AT(e,t,n)}function bm(){return Kt&6?!0:(oh(0),!1)}function hy(){if(Je!==null){if(Rt===0)var e=Je.return;else e=Je,$a=Cl=null,Y0(e),du=null,xd=0,e=Je;for(;e!==null;)g2(e.alternate,e),e=e.return;Je=null}}function wu(e,n){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;t!==-1&&(e.timeoutHandle=-1,P3(t)),t=e.cancelPendingCommit,t!==null&&(e.cancelPendingCommit=null,t()),hy(),Ut=e,Je=t=Us(e.current,null),ct=n,Rt=0,Ur=null,ka=!1,Vu=Jd(e,n),uy=!1,Tu=_i=cy=Qo=Zs=nn=0,ea=ed=null,bv=!1,n&8&&(n|=n&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=n;0<r;){var i=31-Vr(r),a=1<<i;n|=e[i],r&=~a}return Ka=n,pm(),t}function b2(e,n){Ke=null,Be.H=ua,n===Vc?(n=iE(),Rt=3):n===nw?(n=iE(),Rt=4):Rt=n===Vw?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Ur=n,Je===null&&(nn=1,dp(e,di(n,e.current)))}function E2(){var e=Be.H;return Be.H=ua,e===null?ua:e}function C2(){var e=Be.A;return Be.A=_3,e}function wv(){nn=4,ka||(ct&4194176)!==ct&&vi.current!==null||(Vu=!0),!(Zs&134217727)&&!(Qo&134217727)||Ut===null||Ra(Ut,ct,_i,!1)}function B_(e,n,t){var r=Kt;Kt|=2;var i=E2(),a=C2();(Ut!==e||ct!==n)&&(mp=null,wu(e,n)),n=!1;var s=nn;e:do try{if(Rt!==0&&Je!==null){var o=Je,l=Ur;switch(Rt){case 8:hy(),s=6;break e;case 3:case 2:case 6:vi.current===null&&(n=!0);var u=Rt;if(Rt=0,Ur=null,iu(e,o,l,u),t&&Vu){s=0;break e}break;default:u=Rt,Rt=0,Ur=null,iu(e,o,l,u)}}y3(),s=nn;break}catch(c){b2(e,c)}while(!0);return n&&e.shellSuspendCounter++,$a=Cl=null,Kt=r,Be.H=i,Be.A=a,Je===null&&(Ut=null,ct=0,pm()),s}function y3(){for(;Je!==null;)S2(Je)}function b3(e,n){var t=Kt;Kt|=2;var r=E2(),i=C2();Ut!==e||ct!==n?(mp=null,pp=aa()+500,wu(e,n)):Vu=Jd(e,n);e:do try{if(Rt!==0&&Je!==null){n=Je;var a=Ur;t:switch(Rt){case 1:Rt=0,Ur=null,iu(e,n,a,1);break;case 2:if(rE(a)){Rt=0,Ur=null,NE(n);break}n=function(){Rt===2&&Ut===e&&(Rt=7),ha(e)},a.then(n,n);break e;case 3:Rt=7;break e;case 4:Rt=5;break e;case 7:rE(a)?(Rt=0,Ur=null,NE(n)):(Rt=0,Ur=null,iu(e,n,a,7));break;case 5:var s=null;switch(Je.tag){case 26:s=Je.memoizedState;case 5:case 27:var o=Je;if(!s||P2(s)){Rt=0,Ur=null;var l=o.sibling;if(l!==null)Je=l;else{var u=o.return;u!==null?(Je=u,Em(u)):Je=null}break t}}Rt=0,Ur=null,iu(e,n,a,5);break;case 6:Rt=0,Ur=null,iu(e,n,a,6);break;case 8:hy(),nn=6;break e;default:throw Error(Y(462))}}E3();break}catch(c){b2(e,c)}while(!0);return $a=Cl=null,Be.H=r,Be.A=i,Kt=t,Je!==null?0:(Ut=null,ct=0,pm(),nn)}function E3(){for(;Je!==null&&!BM();)S2(Je)}function S2(e){var n=Yw(e.alternate,e,Ka);e.memoizedProps=e.pendingProps,n===null?Em(e):Je=n}function NE(e){var n=e,t=n.alternate;switch(n.tag){case 15:case 0:n=vE(t,n,n.pendingProps,n.type,void 0,ct);break;case 11:n=vE(t,n,n.pendingProps,n.type.render,n.ref,ct);break;case 5:Y0(n);default:g2(t,n),n=Je=m2(n,Ka),n=Yw(t,n,Ka)}e.memoizedProps=e.pendingProps,n===null?Em(e):Je=n}function iu(e,n,t,r){$a=Cl=null,Y0(n),du=null,xd=0;var i=n.return;try{if(u3(e,i,n,t,ct)){nn=1,dp(e,di(t,e.current)),Je=null;return}}catch(a){if(i!==null)throw Je=i,a;nn=1,dp(e,di(t,e.current)),Je=null;return}n.flags&32768?(ft||r===1?e=!0:Vu||ct&536870912?e=!1:(ka=e=!0,(r===2||r===3||r===6)&&(r=vi.current,r!==null&&r.tag===13&&(r.flags|=16384))),T2(n,e)):Em(n)}function Em(e){var n=e;do{if(n.flags&32768){T2(n,ka);return}e=n.return;var t=p3(n.alternate,n,Ka);if(t!==null){Je=t;return}if(n=n.sibling,n!==null){Je=n;return}Je=n=e}while(n!==null);nn===0&&(nn=5)}function T2(e,n){do{var t=m3(e.alternate,e);if(t!==null){t.flags&=32767,Je=t;return}if(t=e.return,t!==null&&(t.flags|=32768,t.subtreeFlags=0,t.deletions=null),!n&&(e=e.sibling,e!==null)){Je=e;return}Je=e=t}while(e!==null);nn=6,Je=null}function IE(e,n,t,r,i,a,s,o,l,u){var c=Be.T,d=Ft.p;try{Ft.p=2,Be.T=null,C3(e,n,t,r,d,i,a,s,o,l,u)}finally{Be.T=c,Ft.p=d}}function C3(e,n,t,r,i,a,s,o){do mu();while(Ao!==null);if(Kt&6)throw Error(Y(327));var l=e.finishedWork;if(r=e.finishedLanes,l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(Y(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=l.lanes|l.childLanes;if(u|=$0,ex(e,r,u,a,s,o),e===Ut&&(Je=Ut=null,ct=0),!(l.subtreeFlags&10256)&&!(l.flags&10256)||zh||(zh=!0,Ev=u,Cv=t,A3(ep,function(){return mu(),null})),t=(l.flags&15990)!==0,l.subtreeFlags&15990||t?(t=Be.T,Be.T=null,a=Ft.p,Ft.p=2,s=Kt,Kt|=4,d3(e,l),l2(l,e),jx(Mv,e.containerInfo),Sp=!!Iv,Mv=Iv=null,e.current=l,i2(e,l.alternate,l),GM(),Kt=s,Ft.p=a,Be.T=t):e.current=l,zh?(zh=!1,Ao=e,td=r):w2(e,u),u=e.pendingLanes,u===0&&(Ls=null),WM(l.stateNode),ha(e),n!==null)for(i=e.onRecoverableError,l=0;l<n.length;l++)u=n[l],i(u.value,{componentStack:u.stack});return td&3&&mu(),u=e.pendingLanes,r&4194218&&u&42?e===Sv?nd++:(nd=0,Sv=e):nd=0,oh(0),null}function w2(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,rh(n)))}function mu(){if(Ao!==null){var e=Ao,n=Ev;Ev=0;var t=IT(td),r=Be.T,i=Ft.p;try{if(Ft.p=32>t?32:t,Be.T=null,Ao===null)var a=!1;else{t=Cv,Cv=null;var s=Ao,o=td;if(Ao=null,td=0,Kt&6)throw Error(Y(331));var l=Kt;if(Kt|=4,f2(s.current),c2(s,s.current,o,t),Kt=l,oh(0,!1),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(Xd,s)}catch{}a=!0}return a}finally{Ft.p=i,Be.T=r,w2(e,n)}}return!1}function ME(e,n,t){n=di(t,n),n=cv(e.stateNode,n,2),e=Rs(e,n,2),e!==null&&(eh(e,2),ha(e))}function Ot(e,n,t){if(e.tag===3)ME(e,e,t);else for(;n!==null;){if(n.tag===3){ME(n,e,t);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ls===null||!Ls.has(r))){e=di(t,e),t=Bw(2),r=Rs(n,t,2),r!==null&&(Gw(t,r,n,e),eh(r,2),ha(r));break}}n=n.return}}function G_(e,n,t){var r=e.pingCache;if(r===null){r=e.pingCache=new g3;var i=new Set;r.set(n,i)}else i=r.get(n),i===void 0&&(i=new Set,r.set(n,i));i.has(t)||(uy=!0,i.add(t),e=S3.bind(null,e,n,t),n.then(e,e))}function S3(e,n,t){var r=e.pingCache;r!==null&&r.delete(n),e.pingedLanes|=e.suspendedLanes&t,e.warmLanes&=~t,Ut===e&&(ct&t)===t&&(nn===4||nn===3&&(ct&62914560)===ct&&300>aa()-dy?!(Kt&2)&&wu(e,0):cy|=t,Tu===ct&&(Tu=0)),ha(e)}function A2(e,n){n===0&&(n=wT()),e=Ks(e,n),e!==null&&(eh(e,n),ha(e))}function T3(e){var n=e.memoizedState,t=0;n!==null&&(t=n.retryLane),A2(e,t)}function w3(e,n){var t=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(Y(314))}r!==null&&r.delete(n),A2(e,t)}function A3(e,n){return O0(e,n)}var _p=null,Ql=null,Av=!1,gp=!1,V_=!1,Ko=0;function ha(e){e!==Ql&&e.next===null&&(Ql===null?_p=Ql=e:Ql=Ql.next=e),gp=!0,Av||(Av=!0,I3(N3))}function oh(e,n){if(!V_&&gp){V_=!0;do for(var t=!1,r=_p;r!==null;){if(e!==0){var i=r.pendingLanes;if(i===0)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-Vr(42|e)+1)-1,a&=i&~(s&~o),a=a&201326677?a&201326677|1:a?a|2:0}a!==0&&(t=!0,xE(r,a))}else a=ct,a=cm(r,r===Ut?a:0),!(a&3)||Jd(r,a)||(t=!0,xE(r,a));r=r.next}while(t);V_=!1}}function N3(){gp=Av=!1;var e=0;Ko!==0&&(L3()&&(e=Ko),Ko=0);for(var n=aa(),t=null,r=_p;r!==null;){var i=r.next,a=N2(r,n);a===0?(r.next=null,t===null?_p=i:t.next=i,i===null&&(Ql=t)):(t=r,(e!==0||a&3)&&(gp=!0)),r=i}oh(e)}function N2(e,n){for(var t=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes&-62914561;0<a;){var s=31-Vr(a),o=1<<s,l=i[s];l===-1?(!(o&t)||o&r)&&(i[s]=JM(o,n)):l<=n&&(e.expiredLanes|=o),a&=~o}if(n=Ut,t=ct,t=cm(e,e===n?t:0),r=e.callbackNode,t===0||e===n&&Rt===2||e.cancelPendingCommit!==null)return r!==null&&r!==null&&E_(r),e.callbackNode=null,e.callbackPriority=0;if(!(t&3)||Jd(e,t)){if(n=t&-t,n===e.callbackPriority)return n;switch(r!==null&&E_(r),IT(t)){case 2:case 8:t=CT;break;case 32:t=ep;break;case 268435456:t=ST;break;default:t=ep}return r=I2.bind(null,e),t=O0(t,r),e.callbackPriority=n,e.callbackNode=t,n}return r!==null&&r!==null&&E_(r),e.callbackPriority=2,e.callbackNode=null,2}function I2(e,n){var t=e.callbackNode;if(mu()&&e.callbackNode!==t)return null;var r=ct;return r=cm(e,e===Ut?r:0),r===0?null:(y2(e,r,n),N2(e,aa()),e.callbackNode!=null&&e.callbackNode===t?I2.bind(null,e):null)}function xE(e,n){if(mu())return null;y2(e,n,!0)}function I3(e){F3(function(){Kt&6?O0(ET,e):e()})}function fy(){return Ko===0&&(Ko=TT()),Ko}function OE(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Sf(""+e)}function DE(e,n){var t=n.ownerDocument.createElement("input");return t.name=n.name,t.value=n.value,e.id&&t.setAttribute("form",e.id),n.parentNode.insertBefore(t,n),e=new FormData(e),t.parentNode.removeChild(t),e}function M3(e,n,t,r,i){if(n==="submit"&&t&&t.stateNode===i){var a=OE((i[Nr]||null).action),s=r.submitter;s&&(n=(n=s[Nr]||null)?OE(n.formAction):s.getAttribute("formAction"),n!==null&&(a=n,s=null));var o=new dm("action","action",null,r,i);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(Ko!==0){var l=s?DE(i,s):new FormData(i);lv(t,{pending:!0,data:l,method:i.method,action:a},null,l)}}else typeof a=="function"&&(o.preventDefault(),l=s?DE(i,s):new FormData(i),lv(t,{pending:!0,data:l,method:i.method,action:a},a,l))},currentTarget:i}]})}}for(var j_=0;j_<Jb.length;j_++){var Q_=Jb[j_],x3=Q_.toLowerCase(),O3=Q_[0].toUpperCase()+Q_.slice(1);Bi(x3,"on"+O3)}Bi(WT,"onAnimationEnd");Bi(YT,"onAnimationIteration");Bi(ZT,"onAnimationStart");Bi("dblclick","onDoubleClick");Bi("focusin","onFocus");Bi("focusout","onBlur");Bi(Kx,"onTransitionRun");Bi(Wx,"onTransitionStart");Bi(Yx,"onTransitionCancel");Bi(XT,"onTransitionEnd");yu("onMouseEnter",["mouseout","mouseover"]);yu("onMouseLeave",["mouseout","mouseover"]);yu("onPointerEnter",["pointerout","pointerover"]);yu("onPointerLeave",["pointerout","pointerover"]);gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dd));function M2(e,n){n=(n&4)!==0;for(var t=0;t<e.length;t++){var r=e[t],i=r.event;r=r.listeners;e:{var a=void 0;if(n)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(c){cp(c)}i.currentTarget=null,a=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(c){cp(c)}i.currentTarget=null,a=l}}}}function it(e,n){var t=n[Wg];t===void 0&&(t=n[Wg]=new Set);var r=e+"__bubble";t.has(r)||(x2(n,e,2,!1),t.add(r))}function K_(e,n,t){var r=0;n&&(r|=4),x2(t,e,r,n)}var Hh="_reactListening"+Math.random().toString(36).slice(2);function py(e){if(!e[Hh]){e[Hh]=!0,xT.forEach(function(t){t!=="selectionchange"&&(D3.has(t)||K_(t,!1,e),K_(t,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Hh]||(n[Hh]=!0,K_("selectionchange",!1,n))}}function x2(e,n,t,r){switch(q2(n)){case 2:var i=iO;break;case 8:i=aO;break;default:i=vy}t=i.bind(null,n,t,e),i=void 0,!Jg||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(n,t,{capture:!0,passive:i}):e.addEventListener(n,t,!0):i!==void 0?e.addEventListener(n,t,{passive:i}):e.addEventListener(n,t,!1)}function W_(e,n,t,r,i){var a=r;if(!(n&1)&&!(n&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=Do(o),s===null)return;if(l=s.tag,l===5||l===6||l===26||l===27){r=a=s;continue e}o=o.parentNode}}r=r.return}FT(function(){var u=a,c=R0(t),d=[];e:{var h=JT.get(e);if(h!==void 0){var f=dm,m=e;switch(e){case"keypress":if(wf(t)===0)break e;case"keydown":case"keyup":f=wx;break;case"focusin":m="focus",f=A_;break;case"focusout":m="blur",f=A_;break;case"beforeblur":case"afterblur":f=A_;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Hb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=fx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Ix;break;case WT:case YT:case ZT:f=_x;break;case XT:f=xx;break;case"scroll":case"scrollend":f=dx;break;case"wheel":f=Dx;break;case"copy":case"cut":case"paste":f=vx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Bb;break;case"toggle":case"beforetoggle":f=Rx}var y=(n&4)!==0,C=!y&&(e==="scroll"||e==="scrollend"),b=y?h!==null?h+"Capture":null:h;y=[];for(var v=u,E;v!==null;){var S=v;if(E=S.stateNode,S=S.tag,S!==5&&S!==26&&S!==27||E===null||b===null||(S=Ad(v,b),S!=null&&y.push(kd(v,S,E))),C)break;v=v.return}0<y.length&&(h=new f(h,m,null,t,c),d.push({event:h,listeners:y}))}}if(!(n&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&t!==Xg&&(m=t.relatedTarget||t.fromElement)&&(Do(m)||m[Bu]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=t.relatedTarget||t.toElement,f=u,m=m?Do(m):null,m!==null&&(C=qu(m),y=m.tag,m!==C||y!==5&&y!==27&&y!==6)&&(m=null)):(f=null,m=u),f!==m)){if(y=Hb,S="onMouseLeave",b="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(y=Bb,S="onPointerLeave",b="onPointerEnter",v="pointer"),C=f==null?h:Dc(f),E=m==null?h:Dc(m),h=new y(S,v+"leave",f,t,c),h.target=C,h.relatedTarget=E,S=null,Do(c)===u&&(y=new y(b,v+"enter",m,t,c),y.target=E,y.relatedTarget=C,S=y),C=S,f&&m)t:{for(y=f,b=m,v=0,E=y;E;E=Rl(E))v++;for(E=0,S=b;S;S=Rl(S))E++;for(;0<v-E;)y=Rl(y),v--;for(;0<E-v;)b=Rl(b),E--;for(;v--;){if(y===b||b!==null&&y===b.alternate)break t;y=Rl(y),b=Rl(b)}y=null}else y=null;f!==null&&kE(d,h,f,y,!1),m!==null&&C!==null&&kE(d,C,m,y,!0)}}e:{if(h=u?Dc(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=Qb;else if(jb(h))if(GT)w=Gx;else{w=qx;var A=Hx}else f=h.nodeName,!f||f.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&k0(u.elementType)&&(w=Qb):w=Bx;if(w&&(w=w(e,u))){BT(d,w,t,c);break e}A&&A(e,h,u),e==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&Zg(h,"number",h.value)}switch(A=u?Dc(u):window,e){case"focusin":(jb(A)||A.contentEditable==="true")&&(Xl=A,ev=u,Gc=null);break;case"focusout":Gc=ev=Xl=null;break;case"mousedown":tv=!0;break;case"contextmenu":case"mouseup":case"dragend":tv=!1,Xb(d,t,c);break;case"selectionchange":if(Qx)break;case"keydown":case"keyup":Xb(d,t,c)}var D;if(P0)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Zl?HT(e,t)&&(O="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(O="onCompositionStart");O&&(zT&&t.locale!=="ko"&&(Zl||O!=="onCompositionStart"?O==="onCompositionEnd"&&Zl&&(D=$T()):(Is=c,U0="value"in Is?Is.value:Is.textContent,Zl=!0)),A=vp(u,O),0<A.length&&(O=new qb(O,e,null,t,c),d.push({event:O,listeners:A}),D?O.data=D:(D=qT(t),D!==null&&(O.data=D)))),(D=Lx?Px(e,t):Fx(e,t))&&(O=vp(u,"onBeforeInput"),0<O.length&&(A=new qb("onBeforeInput","beforeinput",null,t,c),d.push({event:A,listeners:O}),A.data=D)),M3(d,e,u,t,c)}M2(d,n)})}function kd(e,n,t){return{instance:e,listener:n,currentTarget:t}}function vp(e,n){for(var t=n+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i=i.tag,i!==5&&i!==26&&i!==27||a===null||(i=Ad(e,t),i!=null&&r.unshift(kd(e,i,a)),i=Ad(e,n),i!=null&&r.push(kd(e,i,a))),e=e.return}return r}function Rl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function kE(e,n,t,r,i){for(var a=n._reactName,s=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(o=o.tag,l!==null&&l===r)break;o!==5&&o!==26&&o!==27||u===null||(l=u,i?(u=Ad(t,a),u!=null&&s.unshift(kd(t,u,l))):i||(u=Ad(t,a),u!=null&&s.push(kd(t,u,l)))),t=t.return}s.length!==0&&e.push({event:n,listeners:s})}var k3=/\r\n?/g,R3=/\u0000|\uFFFD/g;function RE(e){return(typeof e=="string"?e:""+e).replace(k3,`
`).replace(R3,"")}function O2(e,n){return n=RE(n),RE(e)===n}function Cm(){}function wt(e,n,t,r,i,a){switch(t){case"children":typeof r=="string"?n==="body"||n==="textarea"&&r===""||bu(e,r):(typeof r=="number"||typeof r=="bigint")&&n!=="body"&&bu(e,""+r);break;case"className":kh(e,"class",r);break;case"tabIndex":kh(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":kh(e,t,r);break;case"style":PT(e,r,a);break;case"data":if(n!=="object"){kh(e,"data",r);break}case"src":case"href":if(r===""&&(n!=="a"||t!=="href")){e.removeAttribute(t);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(t);break}r=Sf(""+r),e.setAttribute(t,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(t,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof a=="function"&&(t==="formAction"?(n!=="input"&&wt(e,n,"name",i.name,i,null),wt(e,n,"formEncType",i.formEncType,i,null),wt(e,n,"formMethod",i.formMethod,i,null),wt(e,n,"formTarget",i.formTarget,i,null)):(wt(e,n,"encType",i.encType,i,null),wt(e,n,"method",i.method,i,null),wt(e,n,"target",i.target,i,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(t);break}r=Sf(""+r),e.setAttribute(t,r);break;case"onClick":r!=null&&(e.onclick=Cm);break;case"onScroll":r!=null&&it("scroll",e);break;case"onScrollEnd":r!=null&&it("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(Y(61));if(t=r.__html,t!=null){if(i.children!=null)throw Error(Y(60));e.innerHTML=t}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}t=Sf(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,""+r):e.removeAttribute(t);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,""):e.removeAttribute(t);break;case"capture":case"download":r===!0?e.setAttribute(t,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(t,r):e.removeAttribute(t);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(t,r):e.removeAttribute(t);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(t):e.setAttribute(t,r);break;case"popover":it("beforetoggle",e),it("toggle",e),Cf(e,"popover",r);break;case"xlinkActuate":ya(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ya(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ya(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ya(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ya(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ya(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ya(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ya(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ya(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":Cf(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t=ux.get(t)||t,Cf(e,t,r))}}function Nv(e,n,t,r,i,a){switch(t){case"style":PT(e,r,a);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(Y(61));if(t=r.__html,t!=null){if(i.children!=null)throw Error(Y(60));e.innerHTML=t}}break;case"children":typeof r=="string"?bu(e,r):(typeof r=="number"||typeof r=="bigint")&&bu(e,""+r);break;case"onScroll":r!=null&&it("scroll",e);break;case"onScrollEnd":r!=null&&it("scrollend",e);break;case"onClick":r!=null&&(e.onclick=Cm);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!OT.hasOwnProperty(t))e:{if(t[0]==="o"&&t[1]==="n"&&(i=t.endsWith("Capture"),n=t.slice(2,i?t.length-7:void 0),a=e[Nr]||null,a=a!=null?a[t]:null,typeof a=="function"&&e.removeEventListener(n,a,i),typeof r=="function")){typeof a!="function"&&a!==null&&(t in e?e[t]=null:e.hasAttribute(t)&&e.removeAttribute(t)),e.addEventListener(n,r,i);break e}t in e?e[t]=r:r===!0?e.setAttribute(t,""):Cf(e,t,r)}}}function Wn(e,n,t){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":it("error",e),it("load",e);var r=!1,i=!1,a;for(a in t)if(t.hasOwnProperty(a)){var s=t[a];if(s!=null)switch(a){case"src":r=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Y(137,n));default:wt(e,n,a,s,t,null)}}i&&wt(e,n,"srcSet",t.srcSet,t,null),r&&wt(e,n,"src",t.src,t,null);return;case"input":it("invalid",e);var o=a=s=i=null,l=null,u=null;for(r in t)if(t.hasOwnProperty(r)){var c=t[r];if(c!=null)switch(r){case"name":i=c;break;case"type":s=c;break;case"checked":l=c;break;case"defaultChecked":u=c;break;case"value":a=c;break;case"defaultValue":o=c;break;case"children":case"dangerouslySetInnerHTML":if(c!=null)throw Error(Y(137,n));break;default:wt(e,n,r,c,t,null)}}RT(e,a,o,l,u,s,i,!1),tp(e);return;case"select":it("invalid",e),r=s=a=null;for(i in t)if(t.hasOwnProperty(i)&&(o=t[i],o!=null))switch(i){case"value":a=o;break;case"defaultValue":s=o;break;case"multiple":r=o;default:wt(e,n,i,o,t,null)}n=a,t=s,e.multiple=!!r,n!=null?uu(e,!!r,n,!1):t!=null&&uu(e,!!r,t,!0);return;case"textarea":it("invalid",e),a=i=r=null;for(s in t)if(t.hasOwnProperty(s)&&(o=t[s],o!=null))switch(s){case"value":r=o;break;case"defaultValue":i=o;break;case"children":a=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Y(91));break;default:wt(e,n,s,o,t,null)}LT(e,r,i,a),tp(e);return;case"option":for(l in t)if(t.hasOwnProperty(l)&&(r=t[l],r!=null))switch(l){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:wt(e,n,l,r,t,null)}return;case"dialog":it("cancel",e),it("close",e);break;case"iframe":case"object":it("load",e);break;case"video":case"audio":for(r=0;r<Dd.length;r++)it(Dd[r],e);break;case"image":it("error",e),it("load",e);break;case"details":it("toggle",e);break;case"embed":case"source":case"link":it("error",e),it("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in t)if(t.hasOwnProperty(u)&&(r=t[u],r!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(Y(137,n));default:wt(e,n,u,r,t,null)}return;default:if(k0(n)){for(c in t)t.hasOwnProperty(c)&&(r=t[c],r!==void 0&&Nv(e,n,c,r,t,void 0));return}}for(o in t)t.hasOwnProperty(o)&&(r=t[o],r!=null&&wt(e,n,o,r,t,null))}function U3(e,n,t,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,s=null,o=null,l=null,u=null,c=null;for(f in t){var d=t[f];if(t.hasOwnProperty(f)&&d!=null)switch(f){case"checked":break;case"value":break;case"defaultValue":l=d;default:r.hasOwnProperty(f)||wt(e,n,f,null,r,d)}}for(var h in r){var f=r[h];if(d=t[h],r.hasOwnProperty(h)&&(f!=null||d!=null))switch(h){case"type":a=f;break;case"name":i=f;break;case"checked":u=f;break;case"defaultChecked":c=f;break;case"value":s=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(Y(137,n));break;default:f!==d&&wt(e,n,h,f,r,d)}}Yg(e,s,o,l,u,c,a,i);return;case"select":f=s=o=h=null;for(a in t)if(l=t[a],t.hasOwnProperty(a)&&l!=null)switch(a){case"value":break;case"multiple":f=l;default:r.hasOwnProperty(a)||wt(e,n,a,null,r,l)}for(i in r)if(a=r[i],l=t[i],r.hasOwnProperty(i)&&(a!=null||l!=null))switch(i){case"value":h=a;break;case"defaultValue":o=a;break;case"multiple":s=a;default:a!==l&&wt(e,n,i,a,r,l)}n=o,t=s,r=f,h!=null?uu(e,!!t,h,!1):!!r!=!!t&&(n!=null?uu(e,!!t,n,!0):uu(e,!!t,t?[]:"",!1));return;case"textarea":f=h=null;for(o in t)if(i=t[o],t.hasOwnProperty(o)&&i!=null&&!r.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:wt(e,n,o,null,r,i)}for(s in r)if(i=r[s],a=t[s],r.hasOwnProperty(s)&&(i!=null||a!=null))switch(s){case"value":h=i;break;case"defaultValue":f=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(Y(91));break;default:i!==a&&wt(e,n,s,i,r,a)}UT(e,h,f);return;case"option":for(var m in t)if(h=t[m],t.hasOwnProperty(m)&&h!=null&&!r.hasOwnProperty(m))switch(m){case"selected":e.selected=!1;break;default:wt(e,n,m,null,r,h)}for(l in r)if(h=r[l],f=t[l],r.hasOwnProperty(l)&&h!==f&&(h!=null||f!=null))switch(l){case"selected":e.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:wt(e,n,l,h,r,f)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var y in t)h=t[y],t.hasOwnProperty(y)&&h!=null&&!r.hasOwnProperty(y)&&wt(e,n,y,null,r,h);for(u in r)if(h=r[u],f=t[u],r.hasOwnProperty(u)&&h!==f&&(h!=null||f!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(Y(137,n));break;default:wt(e,n,u,h,r,f)}return;default:if(k0(n)){for(var C in t)h=t[C],t.hasOwnProperty(C)&&h!==void 0&&!r.hasOwnProperty(C)&&Nv(e,n,C,void 0,r,h);for(c in r)h=r[c],f=t[c],!r.hasOwnProperty(c)||h===f||h===void 0&&f===void 0||Nv(e,n,c,h,r,f);return}}for(var b in t)h=t[b],t.hasOwnProperty(b)&&h!=null&&!r.hasOwnProperty(b)&&wt(e,n,b,null,r,h);for(d in r)h=r[d],f=t[d],!r.hasOwnProperty(d)||h===f||h==null&&f==null||wt(e,n,d,h,r,f)}var Iv=null,Mv=null;function yp(e){return e.nodeType===9?e:e.ownerDocument}function UE(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function D2(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function xv(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Y_=null;function L3(){var e=window.event;return e&&e.type==="popstate"?e===Y_?!1:(Y_=e,!0):(Y_=null,!1)}var k2=typeof setTimeout=="function"?setTimeout:void 0,P3=typeof clearTimeout=="function"?clearTimeout:void 0,LE=typeof Promise=="function"?Promise:void 0,F3=typeof queueMicrotask=="function"?queueMicrotask:typeof LE<"u"?function(e){return LE.resolve(null).then(e).catch($3)}:k2;function $3(e){setTimeout(function(){throw e})}function Z_(e,n){var t=n,r=0;do{var i=t.nextSibling;if(e.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){e.removeChild(i),Fd(n);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Fd(n)}function Ov(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var t=n;switch(n=n.nextSibling,t.nodeName){case"HTML":case"HEAD":case"BODY":Ov(t),D0(t);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(t.rel.toLowerCase()==="stylesheet")continue}e.removeChild(t)}}function z3(e,n,t,r){for(;e.nodeType===1;){var i=t;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[wd])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(a=e.getAttribute("rel"),a==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(a!==i.rel||e.getAttribute("href")!==(i.href==null?null:i.href)||e.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||e.getAttribute("title")!==(i.title==null?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(a=e.getAttribute("src"),(a!==(i.src==null?null:i.src)||e.getAttribute("type")!==(i.type==null?null:i.type)||e.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var a=i.name==null?null:""+i.name;if(i.type==="hidden"&&e.getAttribute("name")===a)return e}else return e;if(e=zi(e.nextSibling),e===null)break}return null}function H3(e,n,t){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=zi(e.nextSibling),e===null))return null;return e}function zi(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}function PE(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(n===0)return e;n--}else t==="/$"&&n++}e=e.previousSibling}return null}function R2(e,n,t){switch(n=yp(t),e){case"html":if(e=n.documentElement,!e)throw Error(Y(452));return e;case"head":if(e=n.head,!e)throw Error(Y(453));return e;case"body":if(e=n.body,!e)throw Error(Y(454));return e;default:throw Error(Y(451))}}var yi=new Map,FE=new Set;function bp(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var Za=Ft.d;Ft.d={f:q3,r:B3,D:G3,C:V3,L:j3,m:Q3,X:W3,S:K3,M:Y3};function q3(){var e=Za.f(),n=bm();return e||n}function B3(e){var n=Gu(e);n!==null&&n.tag===5&&n.type==="form"?Rw(n):Za.r(e)}var ju=typeof document>"u"?null:document;function U2(e,n,t){var r=ju;if(r&&typeof n=="string"&&n){var i=ci(n);i='link[rel="'+e+'"][href="'+i+'"]',typeof t=="string"&&(i+='[crossorigin="'+t+'"]'),FE.has(i)||(FE.add(i),e={rel:e,crossOrigin:t,href:n},r.querySelector(i)===null&&(n=r.createElement("link"),Wn(n,"link",e),Dn(n),r.head.appendChild(n)))}}function G3(e){Za.D(e),U2("dns-prefetch",e,null)}function V3(e,n){Za.C(e,n),U2("preconnect",e,n)}function j3(e,n,t){Za.L(e,n,t);var r=ju;if(r&&e&&n){var i='link[rel="preload"][as="'+ci(n)+'"]';n==="image"&&t&&t.imageSrcSet?(i+='[imagesrcset="'+ci(t.imageSrcSet)+'"]',typeof t.imageSizes=="string"&&(i+='[imagesizes="'+ci(t.imageSizes)+'"]')):i+='[href="'+ci(e)+'"]';var a=i;switch(n){case"style":a=Au(e);break;case"script":a=Qu(e)}yi.has(a)||(e=$t({rel:"preload",href:n==="image"&&t&&t.imageSrcSet?void 0:e,as:n},t),yi.set(a,e),r.querySelector(i)!==null||n==="style"&&r.querySelector(lh(a))||n==="script"&&r.querySelector(uh(a))||(n=r.createElement("link"),Wn(n,"link",e),Dn(n),r.head.appendChild(n)))}}function Q3(e,n){Za.m(e,n);var t=ju;if(t&&e){var r=n&&typeof n.as=="string"?n.as:"script",i='link[rel="modulepreload"][as="'+ci(r)+'"][href="'+ci(e)+'"]',a=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Qu(e)}if(!yi.has(a)&&(e=$t({rel:"modulepreload",href:e},n),yi.set(a,e),t.querySelector(i)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(t.querySelector(uh(a)))return}r=t.createElement("link"),Wn(r,"link",e),Dn(r),t.head.appendChild(r)}}}function K3(e,n,t){Za.S(e,n,t);var r=ju;if(r&&e){var i=lu(r).hoistableStyles,a=Au(e);n=n||"default";var s=i.get(a);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(lh(a)))o.loading=5;else{e=$t({rel:"stylesheet",href:e,"data-precedence":n},t),(t=yi.get(a))&&my(e,t);var l=s=r.createElement("link");Dn(l),Wn(l,"link",e),l._p=new Promise(function(u,c){l.onload=u,l.onerror=c}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Of(s,n,r)}s={type:"stylesheet",instance:s,count:1,state:o},i.set(a,s)}}}function W3(e,n){Za.X(e,n);var t=ju;if(t&&e){var r=lu(t).hoistableScripts,i=Qu(e),a=r.get(i);a||(a=t.querySelector(uh(i)),a||(e=$t({src:e,async:!0},n),(n=yi.get(i))&&_y(e,n),a=t.createElement("script"),Dn(a),Wn(a,"link",e),t.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}}function Y3(e,n){Za.M(e,n);var t=ju;if(t&&e){var r=lu(t).hoistableScripts,i=Qu(e),a=r.get(i);a||(a=t.querySelector(uh(i)),a||(e=$t({src:e,async:!0,type:"module"},n),(n=yi.get(i))&&_y(e,n),a=t.createElement("script"),Dn(a),Wn(a,"link",e),t.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}}function $E(e,n,t,r){var i=(i=Ds.current)?bp(i):null;if(!i)throw Error(Y(446));switch(e){case"meta":case"title":return null;case"style":return typeof t.precedence=="string"&&typeof t.href=="string"?(n=Au(t.href),t=lu(i).hoistableStyles,r=t.get(n),r||(r={type:"style",instance:null,count:0,state:null},t.set(n,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(t.rel==="stylesheet"&&typeof t.href=="string"&&typeof t.precedence=="string"){e=Au(t.href);var a=lu(i).hoistableStyles,s=a.get(e);if(s||(i=i.ownerDocument||i,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},a.set(e,s),(a=i.querySelector(lh(e)))&&!a._p&&(s.instance=a,s.state.loading=5),yi.has(e)||(t={rel:"preload",as:"style",href:t.href,crossOrigin:t.crossOrigin,integrity:t.integrity,media:t.media,hrefLang:t.hrefLang,referrerPolicy:t.referrerPolicy},yi.set(e,t),a||Z3(i,e,t,s.state))),n&&r===null)throw Error(Y(528,""));return s}if(n&&r!==null)throw Error(Y(529,""));return null;case"script":return n=t.async,t=t.src,typeof t=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Qu(t),t=lu(i).hoistableScripts,r=t.get(n),r||(r={type:"script",instance:null,count:0,state:null},t.set(n,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(Y(444,e))}}function Au(e){return'href="'+ci(e)+'"'}function lh(e){return'link[rel="stylesheet"]['+e+"]"}function L2(e){return $t({},e,{"data-precedence":e.precedence,precedence:null})}function Z3(e,n,t,r){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?r.loading=1:(n=e.createElement("link"),r.preload=n,n.addEventListener("load",function(){return r.loading|=1}),n.addEventListener("error",function(){return r.loading|=2}),Wn(n,"link",t),Dn(n),e.head.appendChild(n))}function Qu(e){return'[src="'+ci(e)+'"]'}function uh(e){return"script[async]"+e}function zE(e,n,t){if(n.count++,n.instance===null)switch(n.type){case"style":var r=e.querySelector('style[data-href~="'+ci(t.href)+'"]');if(r)return n.instance=r,Dn(r),r;var i=$t({},t,{"data-href":t.href,"data-precedence":t.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),Dn(r),Wn(r,"style",i),Of(r,t.precedence,e),n.instance=r;case"stylesheet":i=Au(t.href);var a=e.querySelector(lh(i));if(a)return n.state.loading|=4,n.instance=a,Dn(a),a;r=L2(t),(i=yi.get(i))&&my(r,i),a=(e.ownerDocument||e).createElement("link"),Dn(a);var s=a;return s._p=new Promise(function(o,l){s.onload=o,s.onerror=l}),Wn(a,"link",r),n.state.loading|=4,Of(a,t.precedence,e),n.instance=a;case"script":return a=Qu(t.src),(i=e.querySelector(uh(a)))?(n.instance=i,Dn(i),i):(r=t,(i=yi.get(a))&&(r=$t({},t),_y(r,i)),e=e.ownerDocument||e,i=e.createElement("script"),Dn(i),Wn(i,"link",r),e.head.appendChild(i),n.instance=i);case"void":return null;default:throw Error(Y(443,n.type))}else n.type==="stylesheet"&&!(n.state.loading&4)&&(r=n.instance,n.state.loading|=4,Of(r,t.precedence,e));return n.instance}function Of(e,n,t){for(var r=t.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,a=i,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===n)a=o;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(n=t.nodeType===9?t.head:t,n.insertBefore(e,n.firstChild))}function my(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function _y(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Df=null;function HE(e,n,t){if(Df===null){var r=new Map,i=Df=new Map;i.set(t,r)}else i=Df,r=i.get(t),r||(r=new Map,i.set(t,r));if(r.has(e))return r;for(r.set(e,null),t=t.getElementsByTagName(e),i=0;i<t.length;i++){var a=t[i];if(!(a[wd]||a[rr]||e==="link"&&a.getAttribute("rel")==="stylesheet")&&a.namespaceURI!=="http://www.w3.org/2000/svg"){var s=a.getAttribute(n)||"";s=e+s;var o=r.get(s);o?o.push(a):r.set(s,[a])}}return r}function qE(e,n,t){e=e.ownerDocument||e,e.head.insertBefore(t,n==="title"?e.querySelector("head > title"):null)}function X3(e,n,t){if(t===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function P2(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Rd=null;function J3(){}function eO(e,n,t){if(Rd===null)throw Error(Y(475));var r=Rd;if(n.type==="stylesheet"&&(typeof t.media!="string"||matchMedia(t.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var i=Au(t.href),a=e.querySelector(lh(i));if(a){e=a._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(r.count++,r=Ep.bind(r),e.then(r,r)),n.state.loading|=4,n.instance=a,Dn(a);return}a=e.ownerDocument||e,t=L2(t),(i=yi.get(i))&&my(t,i),a=a.createElement("link"),Dn(a);var s=a;s._p=new Promise(function(o,l){s.onload=o,s.onerror=l}),Wn(a,"link",t),n.instance=a}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(r.count++,n=Ep.bind(r),e.addEventListener("load",n),e.addEventListener("error",n))}}function tO(){if(Rd===null)throw Error(Y(475));var e=Rd;return e.stylesheets&&e.count===0&&Dv(e,e.stylesheets),0<e.count?function(n){var t=setTimeout(function(){if(e.stylesheets&&Dv(e,e.stylesheets),e.unsuspend){var r=e.unsuspend;e.unsuspend=null,r()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(t)}}:null}function Ep(){if(this.count--,this.count===0){if(this.stylesheets)Dv(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Cp=null;function Dv(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Cp=new Map,n.forEach(nO,e),Cp=null,Ep.call(e))}function nO(e,n){if(!(n.state.loading&4)){var t=Cp.get(e);if(t)var r=t.get(null);else{t=new Map,Cp.set(e,t);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var s=i[a];(s.nodeName==="LINK"||s.getAttribute("media")!=="not all")&&(t.set(s.dataset.precedence,s),r=s)}r&&t.set(null,r)}i=n.instance,s=i.getAttribute("data-precedence"),a=t.get(s)||r,a===r&&t.set(null,i),t.set(s,i),this.count++,r=Ep.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(i,e.firstChild)),n.state.loading|=4}}var Ud={$$typeof:Ua,Provider:null,Consumer:null,_currentValue:Bo,_currentValue2:Bo,_threadCount:0};function rO(e,n,t,r,i,a,s,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=C_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=C_(0),this.hiddenUpdates=C_(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function F2(e,n,t,r,i,a,s,o,l,u,c,d){return e=new rO(e,n,t,s,o,l,u,d),n=1,a===!0&&(n|=24),a=mi(3,null,null,n),e.current=a,a.stateNode=e,n=G0(),n.refCount++,e.pooledCache=n,n.refCount++,a.memoizedState={element:r,isDehydrated:t,cache:n},ay(a),e}function $2(e){return e?(e=tu,e):tu}function z2(e,n,t,r,i,a){i=$2(i),r.context===null?r.context=i:r.pendingContext=i,r=ks(n),r.payload={element:t},a=a===void 0?null:a,a!==null&&(r.callback=a),t=Rs(e,r,n),t!==null&&(_r(t,e,n),Yc(t,e,n))}function BE(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<n?t:n}}function gy(e,n){BE(e,n),(e=e.alternate)&&BE(e,n)}function H2(e){if(e.tag===13){var n=Ks(e,67108864);n!==null&&_r(n,e,67108864),gy(e,67108864)}}var Sp=!0;function iO(e,n,t,r){var i=Be.T;Be.T=null;var a=Ft.p;try{Ft.p=2,vy(e,n,t,r)}finally{Ft.p=a,Be.T=i}}function aO(e,n,t,r){var i=Be.T;Be.T=null;var a=Ft.p;try{Ft.p=8,vy(e,n,t,r)}finally{Ft.p=a,Be.T=i}}function vy(e,n,t,r){if(Sp){var i=kv(r);if(i===null)W_(e,n,r,Tp,t),GE(e,r);else if(oO(i,e,n,t,r))r.stopPropagation();else if(GE(e,r),n&4&&-1<sO.indexOf(e)){for(;i!==null;){var a=Gu(i);if(a!==null)switch(a.tag){case 3:if(a=a.stateNode,a.current.memoizedState.isDehydrated){var s=Co(a.pendingLanes);if(s!==0){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-Vr(s);o.entanglements[1]|=l,s&=~l}ha(a),!(Kt&6)&&(pp=aa()+500,oh(0))}}break;case 13:o=Ks(a,2),o!==null&&_r(o,a,2),bm(),gy(a,2)}if(a=kv(r),a===null&&W_(e,n,r,Tp,t),a===i)break;i=a}i!==null&&r.stopPropagation()}else W_(e,n,r,null,t)}}function kv(e){return e=R0(e),yy(e)}var Tp=null;function yy(e){if(Tp=null,e=Do(e),e!==null){var n=qu(e);if(n===null)e=null;else{var t=n.tag;if(t===13){if(e=yT(n),e!==null)return e;e=null}else if(t===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Tp=e,null}function q2(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(VM()){case ET:return 2;case CT:return 8;case ep:case jM:return 32;case ST:return 268435456;default:return 32}default:return 32}}var Rv=!1,Ps=null,Fs=null,$s=null,Ld=new Map,Pd=new Map,Ts=[],sO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function GE(e,n){switch(e){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":Ld.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(n.pointerId)}}function fc(e,n,t,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:n,domEventName:t,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},n!==null&&(n=Gu(n),n!==null&&H2(n)),e):(e.eventSystemFlags|=r,n=e.targetContainers,i!==null&&n.indexOf(i)===-1&&n.push(i),e)}function oO(e,n,t,r,i){switch(n){case"focusin":return Ps=fc(Ps,e,n,t,r,i),!0;case"dragenter":return Fs=fc(Fs,e,n,t,r,i),!0;case"mouseover":return $s=fc($s,e,n,t,r,i),!0;case"pointerover":var a=i.pointerId;return Ld.set(a,fc(Ld.get(a)||null,e,n,t,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pd.set(a,fc(Pd.get(a)||null,e,n,t,r,i)),!0}return!1}function B2(e){var n=Do(e.target);if(n!==null){var t=qu(n);if(t!==null){if(n=t.tag,n===13){if(n=yT(t),n!==null){e.blockedOn=n,tx(e.priority,function(){if(t.tag===13){var r=jr(),i=Ks(t,r);i!==null&&_r(i,t,r),gy(t,r)}});return}}else if(n===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kf(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var t=kv(e.nativeEvent);if(t===null){t=e.nativeEvent;var r=new t.constructor(t.type,t);Xg=r,t.target.dispatchEvent(r),Xg=null}else return n=Gu(t),n!==null&&H2(n),e.blockedOn=t,!1;n.shift()}return!0}function VE(e,n,t){kf(e)&&t.delete(n)}function lO(){Rv=!1,Ps!==null&&kf(Ps)&&(Ps=null),Fs!==null&&kf(Fs)&&(Fs=null),$s!==null&&kf($s)&&($s=null),Ld.forEach(VE),Pd.forEach(VE)}function qh(e,n){e.blockedOn===n&&(e.blockedOn=null,Rv||(Rv=!0,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,lO)))}var Bh=null;function jE(e){Bh!==e&&(Bh=e,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,function(){Bh===e&&(Bh=null);for(var n=0;n<e.length;n+=3){var t=e[n],r=e[n+1],i=e[n+2];if(typeof r!="function"){if(yy(r||t)===null)continue;break}var a=Gu(t);a!==null&&(e.splice(n,3),n-=3,lv(a,{pending:!0,data:i,method:t.method,action:r},r,i))}}))}function Fd(e){function n(l){return qh(l,e)}Ps!==null&&qh(Ps,e),Fs!==null&&qh(Fs,e),$s!==null&&qh($s,e),Ld.forEach(n),Pd.forEach(n);for(var t=0;t<Ts.length;t++){var r=Ts[t];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Ts.length&&(t=Ts[0],t.blockedOn===null);)B2(t),t.blockedOn===null&&Ts.shift();if(t=(e.ownerDocument||e).$$reactFormReplay,t!=null)for(r=0;r<t.length;r+=3){var i=t[r],a=t[r+1],s=i[Nr]||null;if(typeof a=="function")s||jE(t);else if(s){var o=null;if(a&&a.hasAttribute("formAction")){if(i=a,s=a[Nr]||null)o=s.formAction;else if(yy(i)!==null)continue}else o=s.action;typeof o=="function"?t[r+1]=o:(t.splice(r,3),r-=3),jE(t)}}}function by(e){this._internalRoot=e}Sm.prototype.render=by.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(Y(409));var t=n.current,r=jr();z2(t,r,e,n,null,null)};Sm.prototype.unmount=by.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;e.tag===0&&mu(),z2(e.current,2,null,e,null,null),bm(),n[Bu]=null}};function Sm(e){this._internalRoot=e}Sm.prototype.unstable_scheduleHydration=function(e){if(e){var n=MT();e={blockedOn:null,target:e,priority:n};for(var t=0;t<Ts.length&&n!==0&&n<Ts[t].priority;t++);Ts.splice(t,0,e),t===0&&B2(e)}};var QE=pT.version;if(QE!=="19.0.0")throw Error(Y(527,QE,"19.0.0"));Ft.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(Y(188)):(e=Object.keys(e).join(","),Error(Y(268,e)));return e=qM(n),e=e!==null?bT(e):null,e=e===null?null:e.stateNode,e};var uO={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Be,findFiberByHostInstance:Do,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gh.isDisabled&&Gh.supportsFiber)try{Xd=Gh.inject(uO),Gr=Gh}catch{}}lm.createRoot=function(e,n){if(!mT(e))throw Error(Y(299));var t=!1,r="",i=zw,a=Hw,s=qw,o=null;return n!=null&&(n.unstable_strictMode===!0&&(t=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(i=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(s=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(o=n.unstable_transitionCallbacks)),n=F2(e,1,!1,null,null,t,r,i,a,s,o,null),e[Bu]=n.current,py(e.nodeType===8?e.parentNode:e),new by(n)};lm.hydrateRoot=function(e,n,t){if(!mT(e))throw Error(Y(299));var r=!1,i="",a=zw,s=Hw,o=qw,l=null,u=null;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(a=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(l=t.unstable_transitionCallbacks),t.formState!==void 0&&(u=t.formState)),n=F2(e,1,!0,n,t??null,r,i,a,s,o,l,u),n.context=$2(null),t=n.current,r=jr(),i=ks(r),i.callback=null,Rs(t,i,r),n.current.lanes=r,eh(n,r),ha(n),e[Bu]=n.current,py(e),new Sm(n)};lm.version="19.0.0";function G2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(G2)}catch(e){console.error(e)}}G2(),eT.exports=lm;var cO=eT.exports;const dO="modulepreload",hO=function(e){return"/"+e},KE={},Ie=function(n,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=s?.nonce||s?.getAttribute("nonce");i=Promise.allSettled(t.map(l=>{if(l=hO(l),l in KE)return;KE[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":dO,u||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&a(o.reason);return n().catch(a)})},V2=p.createContext(void 0),fO=()=>{const e=p.useContext(V2);if(!e)throw new Error("useReactMessengerState must be used within a ReactMessengerProvider");return e},pO=({children:e})=>{const[n,t]=p.useState({opened:!0,currentLanguage:"en-US",hasSession:!1,hasContext:!1,messengerKey:0,appId:"6EAE4F97-4017-4A53-970B-BACF55E85A67",aiAgentId:"0cecacfa-f910-40b1-b51f-84aa28479828",customStringSet:null});p.useEffect(()=>()=>{t(l=>({...l,opened:!1}))},[]);const r=l=>{t(u=>({...u,...l}))},o={appConfig:n,setAppConfig:l=>{t(u=>({...u,...l}))},updateAppConfig:r,getStringSet:()=>n.customStringSet||void 0,loadLanguageStringSet:async l=>{try{let u=null;switch(l){case"zh-CN":u=(await Ie(()=>import("./cn-CKlsuyvo.js"),[])).stringSet;break;case"es-ES":u={MESSAGE_INPUT__PLACE_HOLDER:"Pregntame cualquier cosa!",CONVERSATION_LIST__HEADER_TITLE:"Lista de conversaciones anteriores"};break;default:u=null}r({customStringSet:u,currentLanguage:l,messengerKey:n.messengerKey+1})}catch(u){console.error("Failed to load language strings:",u)}}};return $i.jsx(V2.Provider,{value:o,children:e})};function mO(e,n){return{appId:e.appId,aiAgentId:e.aiAgentId,language:e.currentLanguage,countryCode:_O(e.currentLanguage),stringSet:n(),context:e.hasContext?{userPreference:"technical",customerTier:"premium"}:void 0,userSessionInfo:e.hasSession?{userId:"aiagent-test-user",authToken:"4a2ba29f9e3470dcd032e834fb5365160cad376c",sessionHandler:{onSessionTokenRequired:async t=>{t("4a2ba29f9e3470dcd032e834fb5365160cad376c")},onSessionClosed:()=>{console.log("Session closed")},onSessionError:t=>{console.error("Session error:",t)},onSessionRefreshed:()=>{console.log("Session refreshed")}}}:void 0}}function _O(e){switch(e){case"ko-KR":return"KR";case"zh-CN":return"CN";default:return"US"}}var Uv=function(e,n){return Uv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Uv(e,n)};function T(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}Uv(e,n),e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var N=function(){return N=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},N.apply(this,arguments)};function gO(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]])}return t}function g(e,n,t,r){return new(t||(t=Promise))(function(i,a){function s(u){try{l(r.next(u))}catch(c){a(c)}}function o(u){try{l(r.throw(u))}catch(c){a(c)}}function l(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(d){d(c)})).then(s,o)}l((r=r.apply(e,[])).next())})}function _(e,n){var t,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(a=0)),a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(e,a)}catch(d){c=[6,d],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function K(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(e,n){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r,i,a=t.call(e),s=[];try{for(;(n===void 0||n-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(o){i={error:o}}finally{try{r&&!r.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return s}function ce(e,n,t){if(arguments.length===2)for(var r,i=0,a=n.length;i<a;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var re,j2="4.19.1",zs=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return j2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();(function(e){e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",e[e.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.SESSION_REVOKED=400310]="SESSION_REVOKED",e[e.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",e[e.INVALID_AUTH_FOR_SERVICE=400313]="INVALID_AUTH_FOR_SERVICE",e[e.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",e[e.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",e[e.ERR_DUPLICATED_DATA=400202]="ERR_DUPLICATED_DATA",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_COMMAND=700700]="INVALID_COMMAND",e[e.XMLHTTPREQUEST_NOT_SUPPORTED=700800]="XMLHTTPREQUEST_NOT_SUPPORTED",e[e.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED=800270]="ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",e[e.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",e[e.DATABASE_ERROR=800700]="DATABASE_ERROR",e[e.USER_DEACTIVATED=900021]="USER_DEACTIVATED",e[e.CHANNEL_IS_FROZEN=900050]="CHANNEL_IS_FROZEN",e[e.RECEIVER_USER_DEACTIVATED=900081]="RECEIVER_USER_DEACTIVATED"})(re||(re={}));var er,Ro,ln,wp,Lv,rd,fr=function(e){return!(e instanceof k&&!e.shouldThrowOutside)},k=function(e){function n(t){var r=t.code,i=r===void 0?0:r,a=t.message,s=a===void 0?"":a,o=e.call(this,s)||this;return o.shouldThrowOutside=!1,o._detail="",o.name="SendbirdError",o.code=i,Object.setPrototypeOf(o,n.prototype),o}return T(n,e),Object.defineProperty(n.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),n.prototype.setDetail=function(t){this._detail=t},Object.defineProperty(n.prototype,"isInvalidTokenError",{get:function(){return this.code===re.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===re.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===re.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionRevokedError",{get:function(){return this.code===re.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===re.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===re.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isNetworkError",{get:function(){return this.code===re.NETWORK_ERROR||this.code===re.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(n,"debugModeRequired",{get:function(){return new n({code:re.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"lostInstance",{get:function(){return new n({code:re.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidCommand",{get:function(){return new n({code:re.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"unknown",{get:function(){return new n({code:re.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRenew",{get:function(){return new n({code:re.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidConnectionStateTransition",{get:function(){return new n({code:re.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"xmlHttpRequestNotSupported",{get:function(){return new n({code:re.XMLHTTPREQUEST_NOT_SUPPORTED,message:"Cannot upload file. XMLHttpRequest is not defined in this environment."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRequired",{get:function(){return new n({code:re.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionCanceled",{get:function(){return new n({code:re.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidParameters",{get:function(){return new n({code:re.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"notSupportedError",{get:function(){return new n({code:re.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"channelTypeNotSupportedError",{get:function(){return new n({code:re.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"networkError",{get:function(){return new n({code:re.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"markAsReadAllRateLimitExceeded",{get:function(){return new n({code:re.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"queryInProgress",{get:function(){return new n({code:re.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"noAckTimeout",{get:function(){return new n({code:re.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"loginTimeout",{get:function(){return new n({code:re.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionClosed",{get:function(){return new n({code:re.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestFailed",{get:function(){return new n({code:re.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"tooManyRequests",{get:function(){return new n({code:re.REQUEST_DUPLICATED,message:"Too many requests."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"alreadyConnectedAsAnotherUser",{get:function(){return new n({code:re.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"fileUploadCanceled",{get:function(){return new n({code:re.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestCanceled",{get:function(){return new n({code:re.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRefreshFailed",{get:function(){return new n({code:re.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRequestFailed",{get:function(){return new n({code:re.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"databaseError",{get:function(){return new n({code:re.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"fileSizeLimitExceededError",{get:function(){return new n({code:re.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"statLogUploadLimitExceededError",{get:function(){return new n({code:re.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED,message:"The upload request failed due to the retry count being exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"malformedDataError",{get:function(){return new n({code:re.MALFORMED_DATA,message:"Malformed data."})},enumerable:!1,configurable:!0}),n.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},n}(Error),vO=[re.CONNECTION_REQUIRED,re.NETWORK_ERROR,re.ACK_TIMEOUT,re.WEBSOCKET_CONNECTION_CLOSED,re.WEBSOCKET_CONNECTION_FAILED,re.FILE_UPLOAD_CANCEL_FAILED,re.REQUEST_CANCELED,re.INTERNAL_SERVER_ERROR,re.RATE_LIMIT_EXCEEDED,re.UNKNOWN_SERVER_ERROR,re.USER_DEACTIVATED,re.CHANNEL_IS_FROZEN,re.RECEIVER_USER_DEACTIVATED],yO=[re.WEBSOCKET_CONNECTION_CLOSED,re.WEBSOCKET_CONNECTION_FAILED,re.CONNECTION_REQUIRED,re.CHANNEL_IS_FROZEN],Q2=function(e,n){if(e!==n){var t=N({},e),r=N({},n);return(!t.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||t.messageId===r.messageId)&&(!t.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||t.reqId===r.reqId)&&(t.hasOwnProperty("messageId")&&delete t.messageId,t.hasOwnProperty("reqId")&&delete t.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(t)===JSON.stringify(r))}return!0},x=function(e,n,t){return t===void 0&&(t=!1),!(!t||!ch(n))||(typeof e!="string"?typeof e=="object"?be(e,n):bO(e,n):typeof n===e)},be=function(e,n,t){return t===void 0&&(t=!1),!(!t||!ch(n))||Object.values(e).includes(n)},bO=function(e,n){return n instanceof e},Te=function(e,n,t){return t===void 0&&(t=!1),!(!t||!ch(n))||Array.isArray(n)&&n.every(function(r){return x(e,r)})},WE=function(e,n){return!!ch(e)||typeof e=="number"&&e.toString().length===13},EO=function(e){return e>0&&vO.indexOf(e)>=0},Ap=function(e){return e>0&&yO.indexOf(e)>=0},Kn=function(e,n){if(n===void 0&&(n=!1),n&&ch(e))return!0;var t=typeof e=="object"&&e!==null&&e.hasOwnProperty("name")&&typeof e.name=="string"&&e.hasOwnProperty("uri")&&typeof e.uri=="string"&&e.hasOwnProperty("type")&&typeof e.type=="string";if(!t){if(typeof Blob<"u")return e instanceof Blob;if(typeof File<"u")return e instanceof File}return t},CO=function(e,n){if(e===n)return!0;if(e==null||n==null||e.length!==n.length)return!1;for(var t=ce([],ne(e),!1).sort(),r=ce([],ne(n),!1).sort(),i=0;i<t.length;++i)if(t[i]!==r[i])return!1;return!0},ch=function(e){return e==null},K2=function(){function e(n){var t=n===void 0?{}:n,r=t.useMemberInfoInMessage,i=r===void 0||r,a=t.typingIndicatorInvalidateTime,s=a===void 0?1e4:a,o=t.typingIndicatorThrottle,l=o===void 0?1e3:o,u=t.websocketResponseTimeout,c=u===void 0?1e4:u,d=t.websocketPayloadDecompression,h=d===void 0||d,f=t.sessionTokenRefreshTimeout,m=f===void 0?60:f;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=i,this._typingIndicatorInvalidateTime=s,this._typingIndicatorThrottle=l,this._websocketResponseTimeout=c,this._sessionTokenRefreshTimeout=m,this.websocketPayloadDecompression=h}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(n){x("boolean",n)&&(this._useMemberInfoInMessage=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(n){x("number",n)&&(this._typingIndicatorInvalidateTime=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(n){x("number",n)&&n>=1e3&&n<=9e3&&(this._typingIndicatorThrottle=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(n){x("number",n)&&n>=5e3&&n<=3e4&&(this._websocketResponseTimeout=n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(n){x("number",n)&&(n<60?n=60:n>1800&&(n=1800),this._sessionTokenRefreshTimeout=n)},enumerable:!1,configurable:!0}),e}(),W2={encrypt:function(e){return e},decrypt:function(e){return e}},YE=function(){function e(n){var t=n.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this._store.set({key:this._keysAddress,value:ce([],ne(this._preference.keys()),!1)})];case 1:return n.sent(),[2]}})})},e.prototype.init=function(n,t){var r;return t===void 0&&(t=1),g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h,f,m;return _(this,function(y){switch(y.label){case 0:return this._version=t,this._keysAddress=n,i="".concat(n,".metadata.version"),[4,this._store.get(i)];case 1:return a=y.sent(),[4,this._store.get(n)];case 2:return s=(r=y.sent())!==null&&r!==void 0?r:[],!a||a.version<this._version?this._version===9?[3,3]:[3,6]:[3,10];case 3:return o=s.find(function(C){return C.includes("groupchannel/sync.meta")}),o?[4,this._store.remove(o)]:[3,5];case 4:y.sent(),y.label=5;case 5:return[3,8];case 6:return[4,this._resetPreferenceData(s)];case 7:y.sent(),y.label=8;case 8:return[4,this._updatePreferenceVersionInfo(i)];case 9:return y.sent(),[3,17];case 10:y.trys.push([10,15,16,17]),l=K(s),u=l.next(),y.label=11;case 11:return u.done?[3,14]:(c=u.value,[4,this._store.get(c)]);case 12:(d=y.sent())&&this._preference.set(c,d),y.label=13;case 13:return u=l.next(),[3,11];case 14:return[3,17];case 15:return h=y.sent(),f={error:h},[3,17];case 16:try{u&&!u.done&&(m=l.return)&&m.call(l)}finally{if(f)throw f.error}return[7];case 17:return[2]}})})},e.prototype._updatePreferenceVersionInfo=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._store.set({key:n,value:{version:this._version}})];case 1:return t.sent(),[2]}})})},e.prototype._resetPreferenceData=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this._preference=new Map,[4,this._store.removeMany(n)];case 1:return t.sent(),[2]}})})},e.prototype.get=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this._preference.get(n)]})})},e.prototype.set=function(n,t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=!this._preference.has(n),[4,this._store.set({key:n,value:t})];case 1:return i.sent(),this._preference.set(n,t),r?[4,this._savePreferenceKeys()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype.remove=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._store.remove(n)];case 1:return t.sent(),this._preference.delete(n),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this._store.removeMany(ce([],ne(this._preference.keys()),!1))];case 1:return n.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return n.sent(),[2]}})})},e}(),SO=function(){function e(n){var t=n.encryption,r=n.store,i=n.localCacheEnabled,a=n.localCacheConfig;this.store=r,this.preference=new YE({store:r}),this.encryption=t??W2,this.localCacheEnabled=i,this.localCacheConfig=a}return e.prototype.replaceStore=function(n){this.store=n,this.preference=new YE({store:n})},e}();(function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error"})(er||(er={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off"}(Ro||(Ro={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown"}(ln||(ln={})),function(e){e.SESSION_TOKEN="session_token",e.ACCESS_TOKEN="access_token"}(wp||(wp={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default"}(Lv||(Lv={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(rd||(rd={}));var Np,TO=function(){function e(n){var t=n.channel,r=n.cachedMessageCount;this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=r}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),Y2=function(){function e(n){var t=n===void 0?{}:n,r=t.maxSize,i=r===void 0?256:r,a=t.clearOrder,s=a===void 0?rd.MESSAGE_COLLECTION_ACCESSED_AT:a,o=t.customClearOrderComparator,l=t.enableAutoResend,u=l===void 0||l;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(c,d){return c.channel.messageCollectionLastAccessedAt===d.channel.messageCollectionLastAccessedAt?c.channel.lastMessage&&!d.channel.lastMessage?1:!c.channel.lastMessage&&d.channel.lastMessage?-1:c.channel.lastMessage||d.channel.lastMessage?c.channel.lastMessage.createdAt-d.channel.lastMessage.createdAt:0:c.channel.messageCollectionLastAccessedAt>d.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(i,64),o?(this._clearOrder=s,this._customClearOrderComparator=o):this._clearOrder=rd.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=u}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var n;return this._clearOrder===rd.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:(n=this._customClearOrderComparator)!==null&&n!==void 0?n:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),e}();(function(e){e.FEED="feed",e.CHAT="chat",e.CHAT_API="chat_api"})(Np||(Np={}));var Pe,gi,Fi,vt,Un,Nu,$n,Fn,qi,rt,ZE,Pv,Fv,wO=function(){function e(){this.isRefreshing=!1}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasChatServicePermission",{get:function(){var n;return!!(!((n=this.services)===null||n===void 0)&&n.includes(Np.CHAT))},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},e}(),Wr=function(){var e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),(n==="x"?t:3&t|8).toString(16)})},XE=function(){function e(n){var t=n.container;this._container={},this._container=t,this.key=Wr()}return e.prototype._register=function(n,t,r){var i;return n in this._container||(this._container[n]=new Map),(i=this._container[n])===null||i===void 0||i.set(this.key,{occurence:t,handler:r}),this},e.prototype.on=function(n,t){return this._register(n,-1,t)},e.prototype.once=function(n,t){return this._register(n,1,t)},e.prototype.close=function(){var n=this;Object.keys(this._container).forEach(function(t){var r;(r=n._container[t])===null||r===void 0||r.delete(n.key)})},e}(),Sl=function(){function e(){this._container={}}return e.prototype.on=function(n,t){return new XE({container:this._container}).on(n,t)},e.prototype.once=function(n,t){return new XE({container:this._container}).once(n,t)},e.prototype.dispatch=function(n,t){var r,i,a=this._container[n];if(a){var s=[];try{for(var o=K(a.keys()),l=o.next();!l.done;l=o.next()){var u=l.value,c=a.get(u);c.handler(t),c.occurence>0&&(c.occurence--,c.occurence===0&&s.push(u))}}catch(d){r={error:d}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}s.forEach(function(d){return a.delete(d)})}},e}(),AO=function(){function e(){this._dispatcher=new Sl}return e.prototype.on=function(n){return this._dispatcher.on("event",n)},e.prototype.once=function(n){return this._dispatcher.once("event",n)},e.prototype.dispatch=function(n){this._dispatcher.dispatch("event",n)},e}(),st=function(){},W=function(e){var n={};return e&&Object.keys(e).forEach(function(t){e[t]===void 0||Number.isNaN(e[t])||e[t]===null||(n[t]=e[t])}),n},ae=function(e){if(e!=null){if(typeof e=="object"){if(Array.isArray(e)){for(var n=ce([],ne(e),!1),t=0;t<n.length;t++)n[t]=ae(n[t]);return n}return Object.keys(e).forEach(function(r){e[r]===null&&delete e[r]}),e}return e}};(function(e){e.BASE="base",e.GROUP="group",e.OPEN="open",e.FEED="feed"})(Pe||(Pe={})),function(e){e.OPERATOR="operator",e.NONE="none"}(gi||(gi={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted"}(Fi||(Fi={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(vt||(vt={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(Un||(Un={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(Nu||(Nu={})),function(e){e.USERS="users",e.CHANNEL="channel"}($n||($n={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(Fn||(Fn={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(qi||(qi={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}(rt||(rt={})),function(e){e.INREVIEW="InReview",e.APPROVED="Approved"}(ZE||(ZE={})),function(e){e.HIGH="high",e.NORMAL="normal",e.LOW="low"}(Pv||(Pv={})),function(e){e.CREATED_AT="created_at",e.UPDATED_AT="updated_at"}(Fv||(Fv={}));var z,rn="v3",Fe="/".concat(rn,"/users"),NO="/".concat(rn,"/sdk/users"),IO="/".concat(rn,"/storage/file"),Jn="/".concat(rn,"/group_channels"),MO="/".concat(rn,"/sdk/group_channels"),xO="/".concat(rn,"/open_channels"),OO="/".concat(rn,"/search"),$v="/".concat(rn,"/report"),DO="/".concat(rn,"/emojis"),Z2="/".concat(rn,"/emoji_categories"),Gi="/".concat(rn,"/polls"),X2="/".concat(rn,"/scheduled_messages"),kO="/".concat(rn,"/sdk/ui_kit/configuration"),RO="/".concat(rn,"/sdk/statistics"),UO="/".concat(rn,"/sdk/notification_statistics"),J2="/".concat(rn,"/message_templates"),LO="/".concat(rn,"/sdk/push_delivery"),PO="/".concat(rn,"/forms"),FO="/".concat(rn,"/report_category"),$O="/".concat(rn,"/sdk/applications/settings"),Tm="/".concat(rn,"/ai_agent"),Ey="/".concat(rn,"/ai_agent/group_channels"),Re=function(e){switch(e){case Pe.FEED:case Pe.GROUP:return Jn;case Pe.OPEN:return xO;default:return null}},eA=function(e){switch(e){case Pe.GROUP:return"".concat($v,"/group_channels");case Pe.OPEN:return"".concat($v,"/open_channels");default:return null}},Iu=function(e,n,t){var r,i;switch(e){case $n.CHANNEL:return!0;case $n.USERS:if(n)try{for(var a=K(n),s=a.next();!s.done;s=a.next())if(s.value===t)return!0}catch(o){r={error:o}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return!1},Cy=function(e,n,t){var r,i,a,s,o=Iu((r=e.mentionType)!==null&&r!==void 0?r:null,(i=e.mentionedUserIds)!==null&&i!==void 0?i:[],t),l=Iu((a=n.mentionType)!==null&&a!==void 0?a:null,(s=n.mentionedUserIds)!==null&&s!==void 0?s:[],t);return!o&&l?1:o&&!l?-1:0},tA=function(e,n,t){var r,i=n||new FormData;for(var a in e)if(e.hasOwnProperty(a)){var s=e[a],o=t?"".concat(t,"[").concat(a,"]"):a;Kn(s)?i.append(o,s,(r=s.name)!==null&&r!==void 0?r:"filename"):typeof s!="object"||s===null||Array.isArray(s)||s instanceof Blob?i.append(o,String(s)):i=tA(s,i,o)}return i};(function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"})(z||(z={}));var Ze,H=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=Wr(),t}return T(n,e),n.prototype.encodeParams=function(t){var r=this;return t==null||t===""?encodeURIComponent(""):Array.isArray(t)?t.map(function(i){return r.encodeParams(i)}).join(","):encodeURIComponent(typeof t=="object"?JSON.stringify(t):String(t))},Object.defineProperty(n.prototype,"query",{get:function(){var t=this,r=W(this.params);return"?".concat(Object.keys(r).map(function(i){return"".concat(encodeURIComponent(i),"=").concat(t.encodeParams(r[i]))}).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"payload",{get:function(){var t=W(this.params);return Object.keys(t).some(function(r){return Kn(t[r])})?tA(t):JSON.stringify(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasSessionKey",{get:function(){return this.headers["Session-Key"]!==void 0},enumerable:!1,configurable:!0}),n}(st),j=function(e){function n(t,r){var i=e.call(this)||this;return i._iid=t,i._payload=r,i}return T(n,e),Object.defineProperty(n.prototype,"payload",{get:function(){return N({},this._payload)},enumerable:!1,configurable:!0}),n.prototype.as=function(t){return new t(this._iid,this.payload)},n}(st),zO=function(e){function n(t){var r=e.call(this)||this;return r.requestId=t,r}return T(n,e),n}(st),Mu=function(e){function n(t){var r=t.expires_in,i=t.reason,a=i===void 0?re.SESSION_KEY_EXPIRED:i,s=t.message,o=s===void 0?"":s,l=e.call(this)||this;switch(l.expiresIn=r??0,a){case re.SESSION_KEY_EXPIRED:case re.SESSION_TOKEN_EXPIRED:case re.SESSION_REVOKED:case re.USER_AUTH_DEACTIVATED:case re.USER_AUTH_DELETED_OR_NOT_FOUND:l.error=new k({code:a,message:o})}return l}return T(n,e),Object.defineProperty(n.prototype,"invalidateSessionToken",{get:function(){var t;return!!(!((t=this.error)===null||t===void 0)&&t.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),n}(st),pt=function(e){function n(t,r,i,a){a===void 0&&(a="");var s,o=this;return(o=e.call(this)||this)._iid=t,o.code=r,o.payload=i,o.requestId=(s=i.req_id)!==null&&s!==void 0?s:a,o}return T(n,e),n.createFromRawMessage=function(t,r){var i=r.substring(0,4),a={};try{a=JSON.parse(r.substring(4))}catch{i="NOOP"}finally{return new n(t,i,a)}},n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},n.prototype.as=function(t){return new t(this._iid,this.code,this.payload)},n}(st),sr=function(e){function n(t){var r,i=t.code,a=t.ackRequired,s=t.payload,o=s===void 0?{}:s,l=this;return(l=e.call(this)||this).code=i,l.payload=o,l.requestId=(r=l.payload.req_id)!==null&&r!==void 0?r:Wr(),l.ackRequired=a,l.payload.req_id=l.requestId,l}return T(n,e),n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},n}(st),Sy=function(e){function n(t){var r=t.userId,i=t.authToken,a=t.services,s=t.expiringSession,o=s===void 0||s,l=e.call(this)||this;return l.path="".concat(Fe,"/").concat(r,"/session_key"),l.method=z.POST,l.params=W({token:i,services:a,expiring_session:!!o}),l.requireAuth=!1,l}return T(n,e),n}(H),HO=function(e){function n(t){var r=t.authToken,i=t.expiringSession,a=i===void 0||i,s=t.requestId,o=s===void 0?void 0:s;return e.call(this,{code:"LOGI",payload:W({token:r,expiring_session:a?1:0,req_id:o}),ackRequired:!0})||this}return T(n,e),n}(sr),qO=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.key,s=r.expires_at,o=r.services;return i.key=a,i.expiresAt=s,i.services=o,i}return T(n,e),n}(j),BO=function(e){function n(t,r,i){var a,s=this;return(s=e.call(this,t,"LOGI",i)||this).error=null,s.newKey=null,s.newKey=(a=i.new_key)!==null&&a!==void 0?a:null,s.error=i.error?new k(i):null,s}return T(n,e),n}(pt),za=function(e){function n(t){var r=e.call(this)||this;return r.statLog=t,r}return T(n,e),n}(st),nA=function(e){function n(t){var r=t.request,i=t.deferred,a=t.error,s=a===void 0?k.requestFailed:a,o=e.call(this)||this;return o.request=r,o.deferred=i,o.error=s,o}return T(n,e),n}(st);(function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",e.NOTIFICATION="noti:stats",e.WEBSOCKET_CONNECT="ws:connect",e.WEBSOCKET_DISCONNECT="ws:disconnect",e.API_RESULT="api:result"})(Ze||(Ze={}));var zv,$d,Ms,ut=function(){function e(n){var t=n.type,r=n.data,i=n.ts,a=i===void 0?Date.now():i;this.type=t,this.createdAt=a,this.data=r}return e.payloadify=function(n){return W({stat_type:n.type,ts:n.createdAt,data:W(n.data)})},e}(),Hv=function(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product=="ReactNative"},JE=function(){return!(typeof navigator>"u"||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};(function(e){e.CHAT="chat",e.CALLS="calls",e.DESK="desk",e.LIVE="live",e.UIKIT_CHAT="uikit-chat",e.UIKIT_LIVE="uikit-live",e.AI_AGENT="ai-agent"})(zv||(zv={})),function(e){e.ANDROID="android",e.IOS="ios",e.JS="js",e.UNREAL="unreal",e.UNITY="unity",e.REACT_NATIVE="react-native",e.FLUTTER="flutter"}($d||($d={})),function(e){e.ANDROID="android",e.IOS="ios",e.WEB="web",e.MOBILE_WEB="mobile_web",e.WINDOWS="windows"}(Ms||(Ms={}));var GO="^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",Ip=function(){function e(){}var n;return n=e,e._getFrameWork=function(){if(typeof window<"u"){if(window.__REACT__)return"react";if(window.__VUE__)return"vue";var t=window.__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t&&t.getFiberRoots&&t.getFiberRoots(1).size>0)return"react";if(window.__NUXT__)return"vue(SSR)";if(window.__NEXT_DATA__||window.__NEXT_P||window.__NEXT_F)return"nextjs"}return""},e.sendbirdSdkUserAgentWithExtension=function(t){var r=Hv()?$d.REACT_NATIVE:$d.JS,i={main_sdk_info:"chat/".concat(r,"/").concat(zs.SDK_VERSION),device_os_platform:JE()?"mobile-web":"web",os_version:zs.OS_VERSION};if(t){var a=t.sendbirdExtensions,s=t.deviceOS,o=t.customData,l=o===void 0?{}:o;s.version&&(i.os_version=s.version),s.platform&&(i.device_os_platform=s.platform),a.length>0&&(i.extension_sdk_info=a.map(function(c){var d=c.product,h=c.platform,f=c.version;return"".concat(d,"/").concat(h,"/").concat(f)}).join(",")),Object.keys(i).forEach(function(c){return delete l[c]}),Object.keys(l).length>0&&(i=N(N({},i),l))}var u=n._getFrameWork();return u&&(i.javascript_framework=u),Object.entries(i).map(function(c){var d=ne(c,2),h=d[0],f=d[1];return"".concat(h,"=").concat(f)}).join("&")},e.userAgentWithExtension=function(t){var r=Hv()?"reactnative":"JS",i=t.sb_syncmanager?"s".concat(t.sb_syncmanager):"",a=t.sb_uikit?"u".concat(t.sb_uikit):"",s=t["device-os-platform"]?"o".concat(t["device-os-platform"]):JE()?"omobile-web":"oweb";return"".concat(r,"/c").concat(zs.SDK_VERSION,"/").concat(i,"/").concat(a,"/").concat(s)},e}(),ar=function(){var e=this;this.promise=new Promise(function(n,t){e.resolve=n,e.reject=function(r){t(r)}})},Mp=function(e){function n(t){var r=e.call(this)||this;return r.requestId=t.requestId,r}return T(n,e),n}(st),rA=function(e){function n(t){var r=e.call(this)||this;return r.method=z.DELETE,r.path="".concat(Re(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),t.messageToken&&(r.params=W({mesg_token:t.messageToken})),r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var VO=function(e){function n(t,r,i){var a,s=this;return(s=e.call(this,t,"DELM",i)||this).channelUrl=i.channel_url,s.channelType=i.channel_type,s.messageId=Number(i.msg_id),s.silent=i.silent,s.messageCreatedAt=i.message_created_at?Number(i.message_created_at):-1,s.senderId=(a=i.sender_id)!==null&&a!==void 0?a:void 0,s}return T(n,e),n}(pt),jO=function(){function e(n,t){var r=t.session,i=t.sdkState,a=t.dispatcher,s=t.logger,o=t.useFetchCompat,l=o!==void 0&&o,u=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=n,this._session=r,this._sdkState=i,this._dispatcher=a,this._dispatcher.on(function(c){c instanceof zO&&u.cancel(c.requestId)}),this._logger=s,this._shouldImportFetchCompat=l}return e.prototype._createHeader=function(n,t){var r=this._sdkState,i=r.appId,a=r.appVersion,s=r.sendbirdRuntimeEnvironment,o=N(N({},n.headers),{SendBird:"JS,".concat(zs.OS_VERSION,",").concat(zs.SDK_VERSION,",").concat(i).concat(a?",".concat(a):""),"SB-User-Agent":Ip.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":Ip.sendbirdSdkUserAgentWithExtension(s)});return t||(o["Content-Type"]="application/json; charset=utf-8"),n.requireAuth&&!n.hasSessionKey&&this._session.hasSession&&(o["Session-Key"]=this._session.sessionKey),o["App-Id"]=i,this._session&&this._session.authToken&&(o["Access-Token"]=this._session.authToken),o},e.prototype._statLogApiResult=function(n,t,r){n.path.includes("/sdk/statistics")||this._dispatcher.dispatch(new za(new ut({type:Ze.API_RESULT,data:{endpoint:n.path,method:n.method,success:!r,latency:Date.now()-t,error_code:r?.code,error_description:r?.message}})))},e.prototype._isBodyRequired=function(n){var t=n.method;return t!==z.GET&&(t!==z.DELETE||n instanceof rA)},e.prototype.send=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S;return _(this,function(w){switch(w.label){case 0:t=n.path,r=n.method,i=n.uploadProgressHandler,a=this._isBodyRequired(n),s=this._sdkState.api,o="".concat(s.host).concat(t).concat(a?"":n.query),l=a?n.payload:null,u=this._createHeader(n,l instanceof FormData?l:void 0),c=new AbortController,d=c.signal,this._abortControl.set(n.requestId,c),h=Date.now(),w.label=1;case 1:return w.trys.push([1,13,,14]),i?[4,Ie(()=>import("./__bundle-dc980434-DrOPt-gZ.js"),[])]:[3,6];case 2:f=w.sent().xmlHttpRequest,w.label=3;case 3:return w.trys.push([3,5,,6]),[4,f(this._iid,{requestId:n.requestId,method:n.method,url:o,headers:u,data:l??void 0,uploadProgressHandler:i})];case 4:return m=w.sent(),this._logger.debug("receive api response",n.requestId),this._statLogApiResult(n,h),[2,m];case 5:if(!((y=w.sent())instanceof k&&y.code===re.XMLHTTPREQUEST_NOT_SUPPORTED))throw y;return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."),[3,6];case 6:return this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,(typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{fetch:null}).fetch=null),typeof AbortController<"u"?[3,8]:[4,Ie(()=>Promise.resolve().then(()=>XB),void 0)];case 7:w.sent(),w.label=8;case 8:return typeof fetch=="function"?[3,10]:[4,Ie(()=>import("./__bundle-46d64517-D6FYSspz.js").then(A=>A._),[])];case 9:w.sent(),w.label=10;case 10:return[4,fetch(o,{method:r,body:l,headers:u,signal:d})];case 11:return[4,(C=w.sent()).json()];case 12:if(b=w.sent(),C.ok||C.redirected)return this._logger.debug("receive api response",n.requestId),this._statLogApiResult(n,h),[2,new j(this._iid,b)];if(b){if((v=new k(b)).isSessionExpiredError){if(this._dispatcher.dispatch(new Mu({reason:v.code,message:v.message})),!(n instanceof Sy))return E=new ar,this._dispatcher.dispatch(new nA({request:n,deferred:E,error:v})),[2,E.promise];throw v}throw v.isSessionInvalidatedError&&this._dispatcher.dispatch(new Mu({reason:v.code,message:v.message})),v}throw k.requestFailed;case 13:throw S=w.sent(),this._statLogApiResult(n,h,S),S instanceof k?(this._logger.debug("fail api request",S),S):S?.name==="AbortError"?k.requestCanceled:(this._logger.debug("fail api request",S),k.networkError);case 14:return[2]}})})},e.prototype.cancel=function(n){this._abortControl.has(n)&&(this._abortControl.get(n).abort(),this._abortControl.delete(n)),this._dispatcher.dispatch(new Mp({requestId:n}))},e.prototype.cancelAll=function(){var n,t;try{for(var r=K(this._abortControl.values()),i=r.next();!i.done;i=r.next())i.value.abort()}catch(a){n={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}this._abortControl.clear(),this._dispatcher.dispatch(new Mp({}))},e}(),Ne=function(){};function Ku(e){let n=e.length;for(;--n>=0;)e[n]=0}const Ty=256,iA=286,id=30,ad=15,qv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Rf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),QO=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),e1=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Aa=new Array(576);Ku(Aa);const sd=new Array(60);Ku(sd);const zd=new Array(512);Ku(zd);const od=new Array(256);Ku(od);const wy=new Array(29);Ku(wy);const xp=new Array(id);function X_(e,n,t,r,i){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let t1,n1,r1;function J_(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}Ku(xp);const aA=e=>e<256?zd[e]:zd[256+(e>>>7)],Hd=(e,n)=>{e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255},wr=(e,n,t)=>{e.bi_valid>16-t?(e.bi_buf|=n<<e.bi_valid&65535,Hd(e,e.bi_buf),e.bi_buf=n>>16-e.bi_valid,e.bi_valid+=t-16):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)},ta=(e,n,t)=>{wr(e,t[2*n],t[2*n+1])},sA=(e,n)=>{let t=0;do t|=1&e,e>>>=1,t<<=1;while(--n>0);return t>>>1},oA=(e,n,t)=>{const r=new Array(16);let i,a,s=0;for(i=1;i<=ad;i++)s=s+t[i-1]<<1,r[i]=s;for(a=0;a<=n;a++){let o=e[2*a+1];o!==0&&(e[2*a]=sA(r[o]++,o))}},lA=e=>{let n;for(n=0;n<iA;n++)e.dyn_ltree[2*n]=0;for(n=0;n<id;n++)e.dyn_dtree[2*n]=0;for(n=0;n<19;n++)e.bl_tree[2*n]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},uA=e=>{e.bi_valid>8?Hd(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},i1=(e,n,t,r)=>{const i=2*n,a=2*t;return e[i]<e[a]||e[i]===e[a]&&r[n]<=r[t]},eg=(e,n,t)=>{const r=e.heap[t];let i=t<<1;for(;i<=e.heap_len&&(i<e.heap_len&&i1(n,e.heap[i+1],e.heap[i],e.depth)&&i++,!i1(n,r,e.heap[i],e.depth));)e.heap[t]=e.heap[i],t=i,i<<=1;e.heap[t]=r},a1=(e,n,t)=>{let r,i,a,s,o=0;if(e.sym_next!==0)do r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,i=e.pending_buf[e.sym_buf+o++],r===0?ta(e,i,n):(a=od[i],ta(e,a+Ty+1,n),s=qv[a],s!==0&&(i-=wy[a],wr(e,i,s)),r--,a=aA(r),ta(e,a,t),s=Rf[a],s!==0&&(r-=xp[a],wr(e,r,s)));while(o<e.sym_next);ta(e,256,n)},tg=(e,n)=>{const t=n.dyn_tree,r=n.stat_desc.static_tree,i=n.stat_desc.has_stree,a=n.stat_desc.elems;let s,o,l,u=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)t[2*s]!==0?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):t[2*s+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=u<2?++u:0,t[2*l]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=r[2*l+1]);for(n.max_code=u,s=e.heap_len>>1;s>=1;s--)eg(e,t,s);l=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],eg(e,t,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,t[2*l]=t[2*s]+t[2*o],e.depth[l]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,t[2*s+1]=t[2*o+1]=l,e.heap[1]=l++,eg(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((c,d)=>{const h=d.dyn_tree,f=d.max_code,m=d.stat_desc.static_tree,y=d.stat_desc.has_stree,C=d.stat_desc.extra_bits,b=d.stat_desc.extra_base,v=d.stat_desc.max_length;let E,S,w,A,D,O,M=0;for(A=0;A<=ad;A++)c.bl_count[A]=0;for(h[2*c.heap[c.heap_max]+1]=0,E=c.heap_max+1;E<573;E++)S=c.heap[E],A=h[2*h[2*S+1]+1]+1,A>v&&(A=v,M++),h[2*S+1]=A,S>f||(c.bl_count[A]++,D=0,S>=b&&(D=C[S-b]),O=h[2*S],c.opt_len+=O*(A+D),y&&(c.static_len+=O*(m[2*S+1]+D)));if(M!==0){do{for(A=v-1;c.bl_count[A]===0;)A--;c.bl_count[A]--,c.bl_count[A+1]+=2,c.bl_count[v]--,M-=2}while(M>0);for(A=v;A!==0;A--)for(S=c.bl_count[A];S!==0;)w=c.heap[--E],w>f||(h[2*w+1]!==A&&(c.opt_len+=(A-h[2*w+1])*h[2*w],h[2*w+1]=A),S--)}})(e,n),oA(t,u,e.bl_count)},s1=(e,n,t)=>{let r,i,a=-1,s=n[1],o=0,l=7,u=4;for(s===0&&(l=138,u=3),n[2*(t+1)+1]=65535,r=0;r<=t;r++)i=s,s=n[2*(r+1)+1],++o<l&&i===s||(o<u?e.bl_tree[2*i]+=o:i!==0?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=i,s===0?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4))},o1=(e,n,t)=>{let r,i,a=-1,s=n[1],o=0,l=7,u=4;for(s===0&&(l=138,u=3),r=0;r<=t;r++)if(i=s,s=n[2*(r+1)+1],!(++o<l&&i===s)){if(o<u)do ta(e,i,e.bl_tree);while(--o!=0);else i!==0?(i!==a&&(ta(e,i,e.bl_tree),o--),ta(e,16,e.bl_tree),wr(e,o-3,2)):o<=10?(ta(e,17,e.bl_tree),wr(e,o-3,3)):(ta(e,18,e.bl_tree),wr(e,o-11,7));o=0,a=i,s===0?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4)}};let l1=!1;const cA=(e,n,t,r)=>{wr(e,0+(r?1:0),3),uA(e),Hd(e,t),Hd(e,~t),t&&e.pending_buf.set(e.window.subarray(n,n+t),e.pending),e.pending+=t};var KO=(e,n,t,r)=>{let i,a,s=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=(o=>{let l,u=4093624447;for(l=0;l<=31;l++,u>>>=1)if(1&u&&o.dyn_ltree[2*l]!==0)return 0;if(o.dyn_ltree[18]!==0||o.dyn_ltree[20]!==0||o.dyn_ltree[26]!==0)return 1;for(l=32;l<Ty;l++)if(o.dyn_ltree[2*l]!==0)return 1;return 0})(e)),tg(e,e.l_desc),tg(e,e.d_desc),s=(o=>{let l;for(s1(o,o.dyn_ltree,o.l_desc.max_code),s1(o,o.dyn_dtree,o.d_desc.max_code),tg(o,o.bl_desc),l=18;l>=3&&o.bl_tree[2*e1[l]+1]===0;l--);return o.opt_len+=3*(l+1)+5+5+4,l})(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=t+5,t+4<=i&&n!==-1?cA(e,n,t,r):e.strategy===4||a===i?(wr(e,2+(r?1:0),3),a1(e,Aa,sd)):(wr(e,4+(r?1:0),3),((o,l,u,c)=>{let d;for(wr(o,l-257,5),wr(o,u-1,5),wr(o,c-4,4),d=0;d<c;d++)wr(o,o.bl_tree[2*e1[d]+1],3);o1(o,o.dyn_ltree,l-1),o1(o,o.dyn_dtree,u-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),a1(e,e.dyn_ltree,e.dyn_dtree)),lA(e),r&&uA(e)},WO={_tr_init:e=>{l1||((()=>{let n,t,r,i,a;const s=new Array(16);for(r=0,i=0;i<28;i++)for(wy[i]=r,n=0;n<1<<qv[i];n++)od[r++]=i;for(od[r-1]=i,a=0,i=0;i<16;i++)for(xp[i]=a,n=0;n<1<<Rf[i];n++)zd[a++]=i;for(a>>=7;i<id;i++)for(xp[i]=a<<7,n=0;n<1<<Rf[i]-7;n++)zd[256+a++]=i;for(t=0;t<=ad;t++)s[t]=0;for(n=0;n<=143;)Aa[2*n+1]=8,n++,s[8]++;for(;n<=255;)Aa[2*n+1]=9,n++,s[9]++;for(;n<=279;)Aa[2*n+1]=7,n++,s[7]++;for(;n<=287;)Aa[2*n+1]=8,n++,s[8]++;for(oA(Aa,287,s),n=0;n<id;n++)sd[2*n+1]=5,sd[2*n]=sA(n,5);t1=new X_(Aa,qv,257,iA,ad),n1=new X_(sd,Rf,0,id,ad),r1=new X_(new Array(0),QO,0,19,7)})(),l1=!0),e.l_desc=new J_(e.dyn_ltree,t1),e.d_desc=new J_(e.dyn_dtree,n1),e.bl_desc=new J_(e.bl_tree,r1),e.bi_buf=0,e.bi_valid=0,lA(e)},_tr_stored_block:cA,_tr_flush_block:KO,_tr_tally:(e,n,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=n,e.pending_buf[e.sym_buf+e.sym_next++]=n>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,n===0?e.dyn_ltree[2*t]++:(e.matches++,n--,e.dyn_ltree[2*(od[t]+Ty+1)]++,e.dyn_dtree[2*aA(n)]++),e.sym_next===e.sym_end),_tr_align:e=>{wr(e,2,3),ta(e,256,Aa),(n=>{n.bi_valid===16?(Hd(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(e)}},ld=(e,n,t,r)=>{let i=65535&e,a=e>>>16&65535,s=0;for(;t!==0;){s=t>2e3?2e3:t,t-=s;do i=i+n[r++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16};const YO=new Uint32Array((()=>{let e,n=[];for(var t=0;t<256;t++){e=t;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;n[t]=e}return n})());var Mn=(e,n,t,r)=>{const i=YO,a=r+t;e^=-1;for(let s=r;s<a;s++)e=e>>>8^i[255&(e^n[s])];return~e},al={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},dh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ZO,_tr_stored_block:Bv,_tr_flush_block:XO,_tr_tally:Hs,_tr_align:JO}=WO,{Z_NO_FLUSH:qs,Z_PARTIAL_FLUSH:eD,Z_FULL_FLUSH:tD,Z_FINISH:hi,Z_BLOCK:u1,Z_OK:qn,Z_STREAM_END:c1,Z_STREAM_ERROR:Wi,Z_DATA_ERROR:nD,Z_BUF_ERROR:ng,Z_DEFAULT_COMPRESSION:rD,Z_FILTERED:iD,Z_HUFFMAN_ONLY:Vh,Z_RLE:aD,Z_FIXED:sD,Z_DEFAULT_STRATEGY:oD,Z_UNKNOWN:lD,Z_DEFLATED:Op}=dh,Uo=258,oa=262,_u=42,No=113,Rc=666,Io=(e,n)=>(e.msg=al[n],n),d1=e=>2*e-(e>4?9:0),ws=e=>{let n=e.length;for(;--n>=0;)e[n]=0},uD=e=>{let n,t,r,i=e.w_size;n=e.hash_size,r=n;do t=e.head[--r],e.head[r]=t>=i?t-i:0;while(--n);n=i,r=n;do t=e.prev[--r],e.prev[r]=t>=i?t-i:0;while(--n)};let Bs=(e,n,t)=>(n<<e.hash_shift^t)&e.hash_mask;const Dr=e=>{const n=e.state;let t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+t),e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))},Fr=(e,n)=>{XO(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,Dr(e.strm)},mt=(e,n)=>{e.pending_buf[e.pending++]=n},pc=(e,n)=>{e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n},Gv=(e,n,t,r)=>{let i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,n.set(e.input.subarray(e.next_in,e.next_in+i),t),e.state.wrap===1?e.adler=ld(e.adler,n,i,t):e.state.wrap===2&&(e.adler=Mn(e.adler,n,i,t)),e.next_in+=i,e.total_in+=i,i)},dA=(e,n)=>{let t,r,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-oa?e.strstart-(e.w_size-oa):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+Uo;let f=u[a+s-1],m=u[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do if(t=n,u[t+s]===m&&u[t+s-1]===f&&u[t]===u[a]&&u[++t]===u[a+1]){a+=2,t++;do;while(u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&u[++a]===u[++t]&&a<h);if(r=Uo-(h-a),a=h-Uo,r>s){if(e.match_start=n,s=r,r>=o)break;f=u[a+s-1],m=u[a+s]}}while((n=d[n&c])>l&&--i!=0);return s<=e.lookahead?s:e.lookahead},au=e=>{const n=e.w_size;let t,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-oa)&&(e.window.set(e.window.subarray(n,n+n-r),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),uD(e),r+=n),e.strm.avail_in===0)break;if(t=Gv(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=t,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Bs(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Bs(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<oa&&e.strm.avail_in!==0)},hA=(e,n)=>{let t,r,i,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,o=e.strm.avail_in;do{if(t=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,r=e.strstart-e.block_start,t>r+e.strm.avail_in&&(t=r+e.strm.avail_in),t>i&&(t=i),t<a&&(t===0&&n!==hi||n===qs||t!==r+e.strm.avail_in)))break;s=n===hi&&t===r+e.strm.avail_in?1:0,Bv(e,0,0,s),e.pending_buf[e.pending-4]=t,e.pending_buf[e.pending-3]=t>>8,e.pending_buf[e.pending-2]=~t,e.pending_buf[e.pending-1]=~t>>8,Dr(e.strm),r&&(r>t&&(r=t),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,t-=r),t&&(Gv(e.strm,e.strm.output,e.strm.next_out,t),e.strm.next_out+=t,e.strm.avail_out-=t,e.strm.total_out+=t)}while(s===0);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:n!==qs&&n!==hi&&e.strm.avail_in===0&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Gv(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,a=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=a||(r||n===hi)&&n!==qs&&e.strm.avail_in===0&&r<=i)&&(t=r>i?i:r,s=n===hi&&e.strm.avail_in===0&&t===r?1:0,Bv(e,e.block_start,t,s),e.block_start+=t,Dr(e.strm)),s?3:1)},rg=(e,n)=>{let t,r;for(;;){if(e.lookahead<oa){if(au(e),e.lookahead<oa&&n===qs)return 1;if(e.lookahead===0)break}if(t=0,e.lookahead>=3&&(e.ins_h=Bs(e,e.ins_h,e.window[e.strstart+3-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-oa&&(e.match_length=dA(e,t)),e.match_length>=3)if(r=Hs(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=Bs(e,e.ins_h,e.window[e.strstart+3-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Bs(e,e.ins_h,e.window[e.strstart+1]);else r=Hs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Fr(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,n===hi?(Fr(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Fr(e,!1),e.strm.avail_out===0)?1:2},Ul=(e,n)=>{let t,r,i;for(;;){if(e.lookahead<oa){if(au(e),e.lookahead<oa&&n===qs)return 1;if(e.lookahead===0)break}if(t=0,e.lookahead>=3&&(e.ins_h=Bs(e,e.ins_h,e.window[e.strstart+3-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-oa&&(e.match_length=dA(e,t),e.match_length<=5&&(e.strategy===iD||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=Hs(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=Bs(e,e.ins_h,e.window[e.strstart+3-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Fr(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(r=Hs(e,0,e.window[e.strstart-1]),r&&Fr(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Hs(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,n===hi?(Fr(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Fr(e,!1),e.strm.avail_out===0)?1:2};function Ki(e,n,t,r,i){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=r,this.func=i}const Uc=[new Ki(0,0,0,0,hA),new Ki(4,4,8,4,rg),new Ki(4,5,16,8,rg),new Ki(4,6,32,32,rg),new Ki(4,4,16,16,Ul),new Ki(8,16,32,32,Ul),new Ki(8,16,128,128,Ul),new Ki(8,32,128,256,Ul),new Ki(32,128,258,1024,Ul),new Ki(32,258,258,4096,Ul)];function cD(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Op,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ws(this.dyn_ltree),ws(this.dyn_dtree),ws(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ws(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ws(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Lc=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.status!==_u&&n.status!==57&&n.status!==69&&n.status!==73&&n.status!==91&&n.status!==103&&n.status!==No&&n.status!==Rc?1:0},fA=e=>{if(Lc(e))return Io(e,Wi);e.total_in=e.total_out=0,e.data_type=lD;const n=e.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?57:n.wrap?_u:No,e.adler=n.wrap===2?0:1,n.last_flush=-2,ZO(n),qn},pA=e=>{const n=fA(e);var t;return n===qn&&((t=e.state).window_size=2*t.w_size,ws(t.head),t.max_lazy_match=Uc[t.level].max_lazy,t.good_match=Uc[t.level].good_length,t.nice_match=Uc[t.level].nice_length,t.max_chain_length=Uc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n},h1=(e,n,t,r,i,a)=>{if(!e)return Wi;let s=1;if(n===rD&&(n=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||t!==Op||r<8||r>15||n<0||n>9||a<0||a>sD||r===8&&s!==1)return Io(e,Wi);r===8&&(r=9);const o=new cD;return e.state=o,o.strm=e,o.status=_u,o.wrap=s,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=n,o.strategy=a,o.method=t,pA(e)};var ud={deflateInit:(e,n)=>h1(e,n,Op,15,8,oD),deflateInit2:h1,deflateReset:pA,deflateResetKeep:fA,deflateSetHeader:(e,n)=>Lc(e)||e.state.wrap!==2?Wi:(e.state.gzhead=n,qn),deflate:(e,n)=>{if(Lc(e)||n>u1||n<0)return e?Io(e,Wi):Wi;const t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===Rc&&n!==hi)return Io(e,e.avail_out===0?ng:Wi);const r=t.last_flush;if(t.last_flush=n,t.pending!==0){if(Dr(e),e.avail_out===0)return t.last_flush=-1,qn}else if(e.avail_in===0&&d1(n)<=d1(r)&&n!==hi)return Io(e,ng);if(t.status===Rc&&e.avail_in!==0)return Io(e,ng);if(t.status===_u&&t.wrap===0&&(t.status=No),t.status===_u){let i=Op+(t.w_bits-8<<4)<<8,a=-1;if(a=t.strategy>=Vh||t.level<2?0:t.level<6?1:t.level===6?2:3,i|=a<<6,t.strstart!==0&&(i|=32),i+=31-i%31,pc(t,i),t.strstart!==0&&(pc(t,e.adler>>>16),pc(t,65535&e.adler)),e.adler=1,t.status=No,Dr(e),t.pending!==0)return t.last_flush=-1,qn}if(t.status===57){if(e.adler=0,mt(t,31),mt(t,139),mt(t,8),t.gzhead)mt(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),mt(t,255&t.gzhead.time),mt(t,t.gzhead.time>>8&255),mt(t,t.gzhead.time>>16&255),mt(t,t.gzhead.time>>24&255),mt(t,t.level===9?2:t.strategy>=Vh||t.level<2?4:0),mt(t,255&t.gzhead.os),t.gzhead.extra&&t.gzhead.extra.length&&(mt(t,255&t.gzhead.extra.length),mt(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=Mn(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=69;else if(mt(t,0),mt(t,0),mt(t,0),mt(t,0),mt(t,0),mt(t,t.level===9?2:t.strategy>=Vh||t.level<2?4:0),mt(t,3),t.status=No,Dr(e),t.pending!==0)return t.last_flush=-1,qn}if(t.status===69){if(t.gzhead.extra){let i=t.pending,a=(65535&t.gzhead.extra.length)-t.gzindex;for(;t.pending+a>t.pending_buf_size;){let o=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>i&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-i,i)),t.gzindex+=o,Dr(e),t.pending!==0)return t.last_flush=-1,qn;i=0,a-=o}let s=new Uint8Array(t.gzhead.extra);t.pending_buf.set(s.subarray(t.gzindex,t.gzindex+a),t.pending),t.pending+=a,t.gzhead.hcrc&&t.pending>i&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=73}if(t.status===73){if(t.gzhead.name){let i,a=t.pending;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-a,a)),Dr(e),t.pending!==0)return t.last_flush=-1,qn;a=0}i=t.gzindex<t.gzhead.name.length?255&t.gzhead.name.charCodeAt(t.gzindex++):0,mt(t,i)}while(i!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=91}if(t.status===91){if(t.gzhead.comment){let i,a=t.pending;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-a,a)),Dr(e),t.pending!==0)return t.last_flush=-1,qn;a=0}i=t.gzindex<t.gzhead.comment.length?255&t.gzhead.comment.charCodeAt(t.gzindex++):0,mt(t,i)}while(i!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=Mn(e.adler,t.pending_buf,t.pending-a,a))}t.status=103}if(t.status===103){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Dr(e),t.pending!==0))return t.last_flush=-1,qn;mt(t,255&e.adler),mt(t,e.adler>>8&255),e.adler=0}if(t.status=No,Dr(e),t.pending!==0)return t.last_flush=-1,qn}if(e.avail_in!==0||t.lookahead!==0||n!==qs&&t.status!==Rc){let i=t.level===0?hA(t,n):t.strategy===Vh?((a,s)=>{let o;for(;;){if(a.lookahead===0&&(au(a),a.lookahead===0)){if(s===qs)return 1;break}if(a.match_length=0,o=Hs(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,o&&(Fr(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===hi?(Fr(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(Fr(a,!1),a.strm.avail_out===0)?1:2})(t,n):t.strategy===aD?((a,s)=>{let o,l,u,c;const d=a.window;for(;;){if(a.lookahead<=Uo){if(au(a),a.lookahead<=Uo&&s===qs)return 1;if(a.lookahead===0)break}if(a.match_length=0,a.lookahead>=3&&a.strstart>0&&(u=a.strstart-1,l=d[u],l===d[++u]&&l===d[++u]&&l===d[++u])){c=a.strstart+Uo;do;while(l===d[++u]&&l===d[++u]&&l===d[++u]&&l===d[++u]&&l===d[++u]&&l===d[++u]&&l===d[++u]&&l===d[++u]&&u<c);a.match_length=Uo-(c-u),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=3?(o=Hs(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(o=Hs(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),o&&(Fr(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===hi?(Fr(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(Fr(a,!1),a.strm.avail_out===0)?1:2})(t,n):Uc[t.level].func(t,n);if(i!==3&&i!==4||(t.status=Rc),i===1||i===3)return e.avail_out===0&&(t.last_flush=-1),qn;if(i===2&&(n===eD?JO(t):n!==u1&&(Bv(t,0,0,!1),n===tD&&(ws(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Dr(e),e.avail_out===0))return t.last_flush=-1,qn}return n!==hi?qn:t.wrap<=0?c1:(t.wrap===2?(mt(t,255&e.adler),mt(t,e.adler>>8&255),mt(t,e.adler>>16&255),mt(t,e.adler>>24&255),mt(t,255&e.total_in),mt(t,e.total_in>>8&255),mt(t,e.total_in>>16&255),mt(t,e.total_in>>24&255)):(pc(t,e.adler>>>16),pc(t,65535&e.adler)),Dr(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?qn:c1)},deflateEnd:e=>{if(Lc(e))return Wi;const n=e.state.status;return e.state=null,n===No?Io(e,nD):qn},deflateSetDictionary:(e,n)=>{let t=n.length;if(Lc(e))return Wi;const r=e.state,i=r.wrap;if(i===2||i===1&&r.status!==_u||r.lookahead)return Wi;if(i===1&&(e.adler=ld(e.adler,n,t,0)),r.wrap=0,t>=r.w_size){i===0&&(ws(r.head),r.strstart=0,r.block_start=0,r.insert=0);let l=new Uint8Array(r.w_size);l.set(n.subarray(t-r.w_size,t),0),n=l,t=r.w_size}const a=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=t,e.next_in=0,e.input=n,au(r);r.lookahead>=3;){let l=r.strstart,u=r.lookahead-2;do r.ins_h=Bs(r,r.ins_h,r.window[l+3-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--u);r.strstart=l,r.lookahead=2,au(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=o,e.avail_in=a,r.wrap=i,qn},deflateInfo:"pako deflate (from Nodeca project)"};const dD=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);var mA=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const t=n.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)dD(t,r)&&(e[r]=t[r])}}return e},_A=e=>{let n=0;for(let r=0,i=e.length;r<i;r++)n+=e[r].length;const t=new Uint8Array(n);for(let r=0,i=0,a=e.length;r<a;r++){let s=e[r];t.set(s,i),i+=s.length}return t};let gA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{gA=!1}const qd=new Uint8Array(256);for(let e=0;e<256;e++)qd[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;qd[254]=qd[254]=1;var Ay=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let n,t,r,i,a,s=e.length,o=0;for(i=0;i<s;i++)t=e.charCodeAt(i),(64512&t)==55296&&i+1<s&&(r=e.charCodeAt(i+1),(64512&r)==56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Uint8Array(o),a=0,i=0;a<o;i++)t=e.charCodeAt(i),(64512&t)==55296&&i+1<s&&(r=e.charCodeAt(i+1),(64512&r)==56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?n[a++]=t:t<2048?(n[a++]=192|t>>>6,n[a++]=128|63&t):t<65536?(n[a++]=224|t>>>12,n[a++]=128|t>>>6&63,n[a++]=128|63&t):(n[a++]=240|t>>>18,n[a++]=128|t>>>12&63,n[a++]=128|t>>>6&63,n[a++]=128|63&t);return n},hD=(e,n)=>{const t=n||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,n));let r,i;const a=new Array(2*t);for(i=0,r=0;r<t;){let s=e[r++];if(s<128){a[i++]=s;continue}let o=qd[s];if(o>4)a[i++]=65533,r+=o-1;else{for(s&=o===2?31:o===3?15:7;o>1&&r<t;)s=s<<6|63&e[r++],o--;o>1?a[i++]=65533:s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|1023&s)}}return((s,o)=>{if(o<65534&&s.subarray&&gA)return String.fromCharCode.apply(null,s.length===o?s:s.subarray(0,o));let l="";for(let u=0;u<o;u++)l+=String.fromCharCode(s[u]);return l})(a,i)},fD=(e,n)=>{(n=n||e.length)>e.length&&(n=e.length);let t=n-1;for(;t>=0&&(192&e[t])==128;)t--;return t<0||t===0?n:t+qd[e[t]]>n?t:n},vA=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const yA=Object.prototype.toString,{Z_NO_FLUSH:pD,Z_SYNC_FLUSH:mD,Z_FULL_FLUSH:_D,Z_FINISH:gD,Z_OK:Dp,Z_STREAM_END:vD,Z_DEFAULT_COMPRESSION:yD,Z_DEFAULT_STRATEGY:bD,Z_DEFLATED:ED}=dh;function cd(e){this.options=mA({level:yD,method:ED,chunkSize:16384,windowBits:15,memLevel:8,strategy:bD},e||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vA,this.strm.avail_out=0;let t=ud.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==Dp)throw new Error(al[t]);if(n.header&&ud.deflateSetHeader(this.strm,n.header),n.dictionary){let r;if(r=typeof n.dictionary=="string"?Ay(n.dictionary):yA.call(n.dictionary)==="[object ArrayBuffer]"?new Uint8Array(n.dictionary):n.dictionary,t=ud.deflateSetDictionary(this.strm,r),t!==Dp)throw new Error(al[t]);this._dict_set=!0}}function ig(e,n){const t=new cd(n);if(t.push(e,!0),t.err)throw t.msg||al[t.err];return t.result}cd.prototype.push=function(e,n){const t=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=n===~~n?n:n===!0?gD:pD,typeof e=="string"?t.input=Ay(e):yA.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;)if(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),(a===mD||a===_D)&&t.avail_out<=6)this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;else{if(i=ud.deflate(t,a),i===vD)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),i=ud.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Dp;if(t.avail_out!==0){if(a>0&&t.next_out>0)this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;else if(t.avail_in===0)break}else this.onData(t.output)}return!0},cd.prototype.onData=function(e){this.chunks.push(e)},cd.prototype.onEnd=function(e){e===Dp&&(this.result=_A(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var CD={Deflate:cd,deflate:ig,deflateRaw:function(e,n){return(n=n||{}).raw=!0,ig(e,n)},gzip:function(e,n){return(n=n||{}).gzip=!0,ig(e,n)}};const jh=16209;var SD=function(e,n){let t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M;const F=e.state;t=e.next_in,O=e.input,r=t+(e.avail_in-5),i=e.next_out,M=e.output,a=i-(n-e.avail_out),s=i+(e.avail_out-257),o=F.dmax,l=F.wsize,u=F.whave,c=F.wnext,d=F.window,h=F.hold,f=F.bits,m=F.lencode,y=F.distcode,C=(1<<F.lenbits)-1,b=(1<<F.distbits)-1;e:do{f<15&&(h+=O[t++]<<f,f+=8,h+=O[t++]<<f,f+=8),v=m[h&C];t:for(;;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,E===0)M[i++]=65535&v;else{if(!(16&E)){if(64&E){if(32&E){F.mode=16191;break e}e.msg="invalid literal/length code",F.mode=jh;break e}v=m[(65535&v)+(h&(1<<E)-1)];continue t}for(S=65535&v,E&=15,E&&(f<E&&(h+=O[t++]<<f,f+=8),S+=h&(1<<E)-1,h>>>=E,f-=E),f<15&&(h+=O[t++]<<f,f+=8,h+=O[t++]<<f,f+=8),v=y[h&b];;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,16&E){if(w=65535&v,E&=15,f<E&&(h+=O[t++]<<f,f+=8,f<E&&(h+=O[t++]<<f,f+=8)),w+=h&(1<<E)-1,w>o){e.msg="invalid distance too far back",F.mode=jh;break e}if(h>>>=E,f-=E,E=i-a,w>E){if(E=w-E,E>u&&F.sane){e.msg="invalid distance too far back",F.mode=jh;break e}if(A=0,D=d,c===0){if(A+=l-E,E<S){S-=E;do M[i++]=d[A++];while(--E);A=i-w,D=M}}else if(c<E){if(A+=l+c-E,E-=c,E<S){S-=E;do M[i++]=d[A++];while(--E);if(A=0,c<S){E=c,S-=E;do M[i++]=d[A++];while(--E);A=i-w,D=M}}}else if(A+=c-E,E<S){S-=E;do M[i++]=d[A++];while(--E);A=i-w,D=M}for(;S>2;)M[i++]=D[A++],M[i++]=D[A++],M[i++]=D[A++],S-=3;S&&(M[i++]=D[A++],S>1&&(M[i++]=D[A++]))}else{A=i-w;do M[i++]=M[A++],M[i++]=M[A++],M[i++]=M[A++],S-=3;while(S>2);S&&(M[i++]=M[A++],S>1&&(M[i++]=M[A++]))}break}if(64&E){e.msg="invalid distance code",F.mode=jh;break e}v=y[(65535&v)+(h&(1<<E)-1)]}}break}}while(t<r&&i<s);S=f>>3,t-=S,f-=S<<3,h&=(1<<f)-1,e.next_in=t,e.next_out=i,e.avail_in=t<r?r-t+5:5-(t-r),e.avail_out=i<s?s-i+257:257-(i-s),F.hold=h,F.bits=f};const Qh=15,TD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wD=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),AD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ND=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var dd=(e,n,t,r,i,a,s,o)=>{const l=o.bits;let u,c,d,h,f,m,y=0,C=0,b=0,v=0,E=0,S=0,w=0,A=0,D=0,O=0,M=null;const F=new Uint16Array(16),U=new Uint16Array(16);let $,J,ee,ve=null;for(y=0;y<=Qh;y++)F[y]=0;for(C=0;C<r;C++)F[n[t+C]]++;for(E=l,v=Qh;v>=1&&F[v]===0;v--);if(E>v&&(E=v),v===0)return i[a++]=20971520,i[a++]=20971520,o.bits=1,0;for(b=1;b<v&&F[b]===0;b++);for(E<b&&(E=b),A=1,y=1;y<=Qh;y++)if(A<<=1,A-=F[y],A<0)return-1;if(A>0&&(e===0||v!==1))return-1;for(U[1]=0,y=1;y<Qh;y++)U[y+1]=U[y]+F[y];for(C=0;C<r;C++)n[t+C]!==0&&(s[U[n[t+C]]++]=C);if(e===0?(M=ve=s,m=20):e===1?(M=TD,ve=wD,m=257):(M=AD,ve=ND,m=0),O=0,C=0,y=b,f=a,S=E,w=0,d=-1,D=1<<E,h=D-1,e===1&&D>852||e===2&&D>592)return 1;for(;;){$=y-w,s[C]+1<m?(J=0,ee=s[C]):s[C]>=m?(J=ve[s[C]-m],ee=M[s[C]-m]):(J=96,ee=0),u=1<<y-w,c=1<<S,b=c;do c-=u,i[f+(O>>w)+c]=$<<24|J<<16|ee;while(c!==0);for(u=1<<y-1;O&u;)u>>=1;if(u!==0?(O&=u-1,O+=u):O=0,C++,--F[y]==0){if(y===v)break;y=n[t+s[C]]}if(y>E&&(O&h)!==d){for(w===0&&(w=E),f+=b,S=y-w,A=1<<S;S+w<v&&(A-=F[S+w],!(A<=0));)S++,A<<=1;if(D+=1<<S,e===1&&D>852||e===2&&D>592)return 1;d=O&h,i[d]=E<<24|S<<16|f-a}}return O!==0&&(i[f+O]=y-w<<24|64<<16),o.bits=E,0};const{Z_FINISH:f1,Z_BLOCK:ID,Z_TREES:Kh,Z_OK:Mo,Z_STREAM_END:MD,Z_NEED_DICT:xD,Z_STREAM_ERROR:ii,Z_DATA_ERROR:p1,Z_MEM_ERROR:m1,Z_BUF_ERROR:OD,Z_DEFLATED:_1}=dh,wm=16180,Wh=16190,Sa=16191,ag=16192,sg=16194,Yh=16199,Zh=16200,og=16206,zt=16209,g1=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function DD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Lo=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.mode<wm||n.mode>16211?1:0},bA=e=>{if(Lo(e))return ii;const n=e.state;return e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=wm,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Mo},EA=e=>{if(Lo(e))return ii;const n=e.state;return n.wsize=0,n.whave=0,n.wnext=0,bA(e)},CA=(e,n)=>{let t;if(Lo(e))return ii;const r=e.state;return n<0?(t=0,n=-n):(t=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?ii:(r.window!==null&&r.wbits!==n&&(r.window=null),r.wrap=t,r.wbits=n,EA(e))},v1=(e,n)=>{if(!e)return ii;const t=new DD;e.state=t,t.strm=e,t.window=null,t.mode=wm;const r=CA(e,n);return r!==Mo&&(e.state=null),r};let lg,ug,y1=!0;const kD=e=>{if(y1){lg=new Int32Array(512),ug=new Int32Array(32);let n=0;for(;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(dd(1,e.lens,0,288,lg,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;dd(2,e.lens,0,32,ug,0,e.work,{bits:5}),y1=!1}e.lencode=lg,e.lenbits=9,e.distcode=ug,e.distbits=5},b1=(e,n,t,r)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(n.subarray(t-a.wsize,t),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(n.subarray(t-r,t-r+i),a.wnext),(r-=i)?(a.window.set(n.subarray(t-r,t),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var xa={inflateReset:EA,inflateReset2:CA,inflateResetKeep:bA,inflateInit:e=>v1(e,15),inflateInit2:v1,inflate:(e,n)=>{let t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O=0;const M=new Uint8Array(4);let F,U;const $=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Lo(e)||!e.output||!e.input&&e.avail_in!==0)return ii;t=e.state,t.mode===Sa&&(t.mode=ag),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,u=t.hold,c=t.bits,d=o,h=l,D=Mo;e:for(;;)switch(t.mode){case wm:if(t.wrap===0){t.mode=ag;break}for(;c<16;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(2&t.wrap&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,M[0]=255&u,M[1]=u>>>8&255,t.check=Mn(t.check,M,2,0),u=0,c=0,t.mode=16181;break}if(t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",t.mode=zt;break}if((15&u)!==_1){e.msg="unknown compression method",t.mode=zt;break}if(u>>>=4,c-=4,A=8+(15&u),t.wbits===0&&(t.wbits=A),A>15||A>t.wbits){e.msg="invalid window size",t.mode=zt;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=512&u?16189:Sa,u=0,c=0;break;case 16181:for(;c<16;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(t.flags=u,(255&t.flags)!==_1){e.msg="unknown compression method",t.mode=zt;break}if(57344&t.flags){e.msg="unknown header flags set",t.mode=zt;break}t.head&&(t.head.text=u>>8&1),512&t.flags&&4&t.wrap&&(M[0]=255&u,M[1]=u>>>8&255,t.check=Mn(t.check,M,2,0)),u=0,c=0,t.mode=16182;case 16182:for(;c<32;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.head&&(t.head.time=u),512&t.flags&&4&t.wrap&&(M[0]=255&u,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,t.check=Mn(t.check,M,4,0)),u=0,c=0,t.mode=16183;case 16183:for(;c<16;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.head&&(t.head.xflags=255&u,t.head.os=u>>8),512&t.flags&&4&t.wrap&&(M[0]=255&u,M[1]=u>>>8&255,t.check=Mn(t.check,M,2,0)),u=0,c=0,t.mode=16184;case 16184:if(1024&t.flags){for(;c<16;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.length=u,t.head&&(t.head.extra_len=u),512&t.flags&&4&t.wrap&&(M[0]=255&u,M[1]=u>>>8&255,t.check=Mn(t.check,M,2,0)),u=0,c=0}else t.head&&(t.head.extra=null);t.mode=16185;case 16185:if(1024&t.flags&&(f=t.length,f>o&&(f=o),f&&(t.head&&(A=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(a,a+f),A)),512&t.flags&&4&t.wrap&&(t.check=Mn(t.check,r,f,a)),o-=f,a+=f,t.length-=f),t.length))break e;t.length=0,t.mode=16186;case 16186:if(2048&t.flags){if(o===0)break e;f=0;do A=r[a+f++],t.head&&A&&t.length<65536&&(t.head.name+=String.fromCharCode(A));while(A&&f<o);if(512&t.flags&&4&t.wrap&&(t.check=Mn(t.check,r,f,a)),o-=f,a+=f,A)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=16187;case 16187:if(4096&t.flags){if(o===0)break e;f=0;do A=r[a+f++],t.head&&A&&t.length<65536&&(t.head.comment+=String.fromCharCode(A));while(A&&f<o);if(512&t.flags&&4&t.wrap&&(t.check=Mn(t.check,r,f,a)),o-=f,a+=f,A)break e}else t.head&&(t.head.comment=null);t.mode=16188;case 16188:if(512&t.flags){for(;c<16;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(4&t.wrap&&u!==(65535&t.check)){e.msg="header crc mismatch",t.mode=zt;break}u=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=Sa;break;case 16189:for(;c<32;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}e.adler=t.check=g1(u),u=0,c=0,t.mode=Wh;case Wh:if(t.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,xD;e.adler=t.check=1,t.mode=Sa;case Sa:if(n===ID||n===Kh)break e;case ag:if(t.last){u>>>=7&c,c-=7&c,t.mode=og;break}for(;c<3;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}switch(t.last=1&u,u>>>=1,c-=1,3&u){case 0:t.mode=16193;break;case 1:if(kD(t),t.mode=Yh,n===Kh){u>>>=2,c-=2;break e}break;case 2:t.mode=16196;break;case 3:e.msg="invalid block type",t.mode=zt}u>>>=2,c-=2;break;case 16193:for(u>>>=7&c,c-=7&c;c<32;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",t.mode=zt;break}if(t.length=65535&u,u=0,c=0,t.mode=sg,n===Kh)break e;case sg:t.mode=16195;case 16195:if(f=t.length,f){if(f>o&&(f=o),f>l&&(f=l),f===0)break e;i.set(r.subarray(a,a+f),s),o-=f,a+=f,l-=f,s+=f,t.length-=f;break}t.mode=Sa;break;case 16196:for(;c<14;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(t.nlen=257+(31&u),u>>>=5,c-=5,t.ndist=1+(31&u),u>>>=5,c-=5,t.ncode=4+(15&u),u>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=zt;break}t.have=0,t.mode=16197;case 16197:for(;t.have<t.ncode;){for(;c<3;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.lens[$[t.have++]]=7&u,u>>>=3,c-=3}for(;t.have<19;)t.lens[$[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,F={bits:t.lenbits},D=dd(0,t.lens,0,19,t.lencode,0,t.work,F),t.lenbits=F.bits,D){e.msg="invalid code lengths set",t.mode=zt;break}t.have=0,t.mode=16198;case 16198:for(;t.have<t.nlen+t.ndist;){for(;O=t.lencode[u&(1<<t.lenbits)-1],C=O>>>24,b=O>>>16&255,v=65535&O,!(C<=c);){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(v<16)u>>>=C,c-=C,t.lens[t.have++]=v;else{if(v===16){for(U=C+2;c<U;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(u>>>=C,c-=C,t.have===0){e.msg="invalid bit length repeat",t.mode=zt;break}A=t.lens[t.have-1],f=3+(3&u),u>>>=2,c-=2}else if(v===17){for(U=C+3;c<U;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}u>>>=C,c-=C,A=0,f=3+(7&u),u>>>=3,c-=3}else{for(U=C+7;c<U;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}u>>>=C,c-=C,A=0,f=11+(127&u),u>>>=7,c-=7}if(t.have+f>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=zt;break}for(;f--;)t.lens[t.have++]=A}}if(t.mode===zt)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=zt;break}if(t.lenbits=9,F={bits:t.lenbits},D=dd(1,t.lens,0,t.nlen,t.lencode,0,t.work,F),t.lenbits=F.bits,D){e.msg="invalid literal/lengths set",t.mode=zt;break}if(t.distbits=6,t.distcode=t.distdyn,F={bits:t.distbits},D=dd(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,F),t.distbits=F.bits,D){e.msg="invalid distances set",t.mode=zt;break}if(t.mode=Yh,n===Kh)break e;case Yh:t.mode=Zh;case Zh:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,SD(e,h),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,u=t.hold,c=t.bits,t.mode===Sa&&(t.back=-1);break}for(t.back=0;O=t.lencode[u&(1<<t.lenbits)-1],C=O>>>24,b=O>>>16&255,v=65535&O,!(C<=c);){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(b&&!(240&b)){for(E=C,S=b,w=v;O=t.lencode[w+((u&(1<<E+S)-1)>>E)],C=O>>>24,b=O>>>16&255,v=65535&O,!(E+C<=c);){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}u>>>=E,c-=E,t.back+=E}if(u>>>=C,c-=C,t.back+=C,t.length=v,b===0){t.mode=16205;break}if(32&b){t.back=-1,t.mode=Sa;break}if(64&b){e.msg="invalid literal/length code",t.mode=zt;break}t.extra=15&b,t.mode=16201;case 16201:if(t.extra){for(U=t.extra;c<U;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=16202;case 16202:for(;O=t.distcode[u&(1<<t.distbits)-1],C=O>>>24,b=O>>>16&255,v=65535&O,!(C<=c);){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(!(240&b)){for(E=C,S=b,w=v;O=t.distcode[w+((u&(1<<E+S)-1)>>E)],C=O>>>24,b=O>>>16&255,v=65535&O,!(E+C<=c);){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}u>>>=E,c-=E,t.back+=E}if(u>>>=C,c-=C,t.back+=C,64&b){e.msg="invalid distance code",t.mode=zt;break}t.offset=v,t.extra=15&b,t.mode=16203;case 16203:if(t.extra){for(U=t.extra;c<U;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=zt;break}t.mode=16204;case 16204:if(l===0)break e;if(f=h-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=zt;break}f>t.wnext?(f-=t.wnext,m=t.wsize-f):m=t.wnext-f,f>t.length&&(f=t.length),y=t.window}else y=i,m=s-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do i[s++]=y[m++];while(--f);t.length===0&&(t.mode=Zh);break;case 16205:if(l===0)break e;i[s++]=t.length,l--,t.mode=Zh;break;case og:if(t.wrap){for(;c<32;){if(o===0)break e;o--,u|=r[a++]<<c,c+=8}if(h-=l,e.total_out+=h,t.total+=h,4&t.wrap&&h&&(e.adler=t.check=t.flags?Mn(t.check,i,h,s-h):ld(t.check,i,h,s-h)),h=l,4&t.wrap&&(t.flags?u:g1(u))!==t.check){e.msg="incorrect data check",t.mode=zt;break}u=0,c=0}t.mode=16207;case 16207:if(t.wrap&&t.flags){for(;c<32;){if(o===0)break e;o--,u+=r[a++]<<c,c+=8}if(4&t.wrap&&u!==(4294967295&t.total)){e.msg="incorrect length check",t.mode=zt;break}u=0,c=0}t.mode=16208;case 16208:D=MD;break e;case zt:D=p1;break e;case 16210:return m1;default:return ii}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,t.hold=u,t.bits=c,(t.wsize||h!==e.avail_out&&t.mode<zt&&(t.mode<og||n!==f1))&&b1(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,t.total+=h,4&t.wrap&&h&&(e.adler=t.check=t.flags?Mn(t.check,i,h,e.next_out-h):ld(t.check,i,h,e.next_out-h)),e.data_type=t.bits+(t.last?64:0)+(t.mode===Sa?128:0)+(t.mode===Yh||t.mode===sg?256:0),(d===0&&h===0||n===f1)&&D===Mo&&(D=OD),D},inflateEnd:e=>{if(Lo(e))return ii;let n=e.state;return n.window&&(n.window=null),e.state=null,Mo},inflateGetHeader:(e,n)=>{if(Lo(e))return ii;const t=e.state;return 2&t.wrap?(t.head=n,n.done=!1,Mo):ii},inflateSetDictionary:(e,n)=>{const t=n.length;let r,i,a;return Lo(e)?ii:(r=e.state,r.wrap!==0&&r.mode!==Wh?ii:r.mode===Wh&&(i=1,i=ld(i,n,t,0),i!==r.check)?p1:(a=b1(e,n,t,t),a?(r.mode=16210,m1):(r.havedict=1,Mo)))},inflateInfo:"pako inflate (from Nodeca project)"},RD=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const SA=Object.prototype.toString,{Z_NO_FLUSH:UD,Z_FINISH:LD,Z_OK:hd,Z_STREAM_END:cg,Z_NEED_DICT:dg,Z_STREAM_ERROR:PD,Z_DATA_ERROR:E1,Z_MEM_ERROR:FD}=dh;function fd(e){this.options=mA({chunkSize:65536,windowBits:15,to:""},e||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),!(n.windowBits>=0&&n.windowBits<16)||e&&e.windowBits||(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(15&n.windowBits||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vA,this.strm.avail_out=0;let t=xa.inflateInit2(this.strm,n.windowBits);if(t!==hd)throw new Error(al[t]);if(this.header=new RD,xa.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Ay(n.dictionary):SA.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=xa.inflateSetDictionary(this.strm,n.dictionary),t!==hd)))throw new Error(al[t])}function hg(e,n){const t=new fd(n);if(t.push(e),t.err)throw t.msg||al[t.err];return t.result}fd.prototype.push=function(e,n){const t=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(s=n===~~n?n:n===!0?LD:UD,SA.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),a=xa.inflate(t,s),a===dg&&i&&(a=xa.inflateSetDictionary(t,i),a===hd?a=xa.inflate(t,s):a===E1&&(a=dg));t.avail_in>0&&a===cg&&t.state.wrap>0&&e[t.next_in]!==0;)xa.inflateReset(t),a=xa.inflate(t,s);switch(a){case PD:case E1:case dg:case FD:return this.onEnd(a),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||a===cg))if(this.options.to==="string"){let l=fD(t.output,t.next_out),u=t.next_out-l,c=hD(t.output,l);t.next_out=u,t.avail_out=r-u,u&&t.output.set(t.output.subarray(l,l+u),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(a!==hd||o!==0){if(a===cg)return a=xa.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},fd.prototype.onData=function(e){this.chunks.push(e)},fd.prototype.onEnd=function(e){e===hd&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_A(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var $D={Inflate:fd,inflate:hg,inflateRaw:function(e,n){return(n=n||{}).raw=!0,hg(e,n)},ungzip:hg};const{Deflate:zD,deflate:HD,deflateRaw:qD,gzip:BD}=CD,{Inflate:GD,inflate:VD,inflateRaw:jD,ungzip:QD}=$D;var li,KD={Deflate:zD,deflate:HD,deflateRaw:qD,gzip:BD,Inflate:GD,inflate:VD,inflateRaw:jD,ungzip:QD,constants:dh},fg=function(e){return g(void 0,void 0,void 0,function(){var n,t;return _(this,function(r){if(n=KD.ungzip(e),typeof TextDecoder<"u")try{return[2,new TextDecoder("utf-8").decode(new Uint8Array(n))]}catch{}return t=8192,[2,Array.from({length:Math.ceil(n.length/t)},function(i,a){var s=a*t,o=n.slice(s,s+t);return String.fromCharCode.apply(null,o)}).join("")]})})},he=function(e){return g(void 0,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:return t.sent(),[3,3];case 2:if(!((n=t.sent())instanceof k))throw n;return n.throwOutside(),[3,3];case 3:return[2]}})})},Ct=function(e){return g(void 0,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:case 2:return n.sent(),[3,3];case 3:return[2]}})})};(function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"})(li||(li={}));var He,WD=function(e){function n(t,r){var i=r.sdkState,a=r.dispatcher,s=r.logger,o=e.call(this)||this;return o.lastActive=0,o._iid=t,o._sdkState=i,o._dispatcher=a,o._logger=s,o}return T(n,e),Object.defineProperty(n.prototype,"isOpen",{get:function(){return this.connectionState===li.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return li.CONNECTING;case 1:return li.OPEN}return li.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ws",{get:function(){var t;return(t=this._ws)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),n.prototype._handleMessage=function(t){var r=this;t.split(`
`).forEach(function(i){if(i){var a=pt.createFromRawMessage(r._iid,i);if(r._logger.debug("receive websocket event",a),a.code==="LOGI")r.dispatch("message",a);else if(a.code==="PONG")r.dispatch("pong");else if(a.code==="EXPR"){if(a.payload){var s=new Mu(a.payload);s.expiresIn>=0&&r._dispatcher.dispatch(s)}}else a.code==="NOOP"||r.dispatch("message",a)}})},n.prototype.connect=function(t,r){return r===void 0&&(r=""),g(this,void 0,void 0,function(){var i=this;return _(this,function(a){switch(a.label){case 0:return typeof fetch=="function"?[3,2]:[4,Ie(()=>import("./__bundle-46d64517-D6FYSspz.js").then(s=>s._),[])];case 1:a.sent(),a.label=2;case 2:return Ct(function(){return g(i,void 0,void 0,function(){return _(this,function(s){return fetch(this._sdkState.api.host),[2]})})}),this._ws=new WebSocket(t,encodeURIComponent(r)),this._ws.onopen=function(){i._logger.debug("websocket open"),i.dispatch("open")},this._ws.onmessage=function(s){return g(i,void 0,void 0,function(){var o,l,u,c,d,h,f,m=this;return _(this,function(y){switch(y.label){case 0:return!((f=this._sdkState.websocket)===null||f===void 0)&&f.compression?s.data instanceof Blob?((o=new FileReader).readAsArrayBuffer(s.data),o.onloadend=function(){return g(m,void 0,void 0,function(){var C,b;return _(this,function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,fg(o.result)];case 1:return C=v.sent(),this._handleMessage(C),[3,3];case 2:return b=v.sent(),this.error(b),[3,3];case 3:return[2]}})})},[3,12]):[3,1]:[3,13];case 1:if(!(s.data instanceof ArrayBuffer))return[3,6];y.label=2;case 2:return y.trys.push([2,4,,5]),[4,fg(new Uint8Array(s.data))];case 3:return d=y.sent(),this._handleMessage(d),[3,5];case 4:return l=y.sent(),this.error(l),[3,5];case 5:return[3,12];case 6:if(!(typeof Buffer<"u"&&s.data instanceof Buffer))return[3,11];y.label=7;case 7:return y.trys.push([7,9,,10]),u=s.data,c=u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength),[4,fg(c)];case 8:return d=y.sent(),this._handleMessage(d),[3,10];case 9:return h=y.sent(),this.error(h),[3,10];case 10:return[3,12];case 11:typeof s.data=="string"&&this._handleMessage(s.data),y.label=12;case 12:return[3,14];case 13:this._handleMessage(s.data),y.label=14;case 14:return[2]}})})},this._ws.onerror=function(){i._logger.debug("websocket error"),i.dispatch("error",k.networkError)},this._ws.onclose=function(s){i._logger.debug("websocket close",s.code,s.reason),i.cleanUpWebSocket(),i.dispatch("close")},this.lastActive=Date.now(),[2]}})})},n.prototype.cleanUpWebSocket=function(){this._ws&&(this._ws.onopen=Ne,this._ws.onmessage=Ne,this._ws.onerror=Ne,this._ws.onclose=Ne,this.connectionState===li.OPEN&&this._ws.close(1e3,"Normal Closure"),this._ws=void 0)},n.prototype.disconnect=function(){var t=this;return new Promise(function(r){if(t._ws){if(t.connectionState===li.CLOSED)return t.cleanUpWebSocket(),void r();t._ws.onclose=function(){t.cleanUpWebSocket(),t.dispatch("close"),r()},t._ws.close()}else r()})},n.prototype.send=function(t){if(!this._ws)throw k.connectionClosed;t.code!=="PING"?this.dispatch("ping-refresh"):this._logger.debug("send ping",t),this._ws.send(t.convertToMessage())},n.prototype.error=function(t){this._logger.debug("websocket error",t),this.dispatch("error",t)},n}(Sl),Ny=function(e){function n(t){var r=t.all,i=t.feed,a=t.custom_types,s=t.ts,o=e.call(this)||this;return o.all=r,o.feed=i,o.customTypes=a,o.ts=s,o}return T(n,e),n}(st),YD=function(){function e(n,t){var r=t.session,i=t.sdkState,a=t.dispatcher,s=t.logger,o=t.useFetchCompat,l=o!==void 0&&o,u=this;this._ackStateMap=new Map,this._batchableCommandAckStateMap=new Map,this._redundantActionCommands=new Set,this._sdkState=i,this._dispatcher=a,this._logger=s,this.apiClient=new jO(n,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:l}),this.websocketClient=new WD(n,{sdkState:i,dispatcher:a,logger:s}),this.websocketClient.on("message",function(c){var d,h;if(c.payload.unread_cnt&&u._dispatcher.dispatch(new Ny(c.payload.unread_cnt)),c.requestId){if(u._ackStateMap.has(c.requestId)){var f=u._ackStateMap.get(c.requestId);c.code!=="EROR"?f.resolve(c):f.reject(new k({code:c.payload.code,message:c.payload.message}))}else if(u._batchableCommandAckStateMap.has(c.requestId)){var m=Date.now();try{for(var y=K(u._batchableCommandAckStateMap.entries()),C=y.next();!C.done;C=y.next()){var b=ne(C.value,2),v=(b[0],b[1]);v.channelUrl===c.payload.channel_url&&v.requestTime<m&&(f=v.ackState,c.code!=="EROR"?f.resolve(c):f.reject(new k({code:c.payload.code,message:c.payload.message})))}}catch(E){d={error:E}}finally{try{C&&!C.done&&(h=y.return)&&h.call(y)}finally{if(d)throw d.error}}}}else u._redundantActionCommands.has(c.payload.unique_id)?u._redundantActionCommands.delete(c.payload.unique_id):u._dispatcher.dispatch(c)}).on("close",function(){u._ackStateMap.forEach(function(c){c.reject(k.connectionClosed)}),u._ackStateMap.clear(),u._batchableCommandAckStateMap.clear()})}return e.prototype._sendApiRequest=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return n.params.unique_id&&this._redundantActionCommands.add(n.params.unique_id),[4,this.apiClient.send(n)];case 1:return[2,t.sent()]}})})},e.prototype._sendWebsocketRequest=function(n){return g(this,void 0,void 0,function(){var t,r,i,a=this;return _(this,function(s){if(!this._sdkState.websocket)throw k.connectionRequired;if(t=new ar,n.ackRequired){i=function(o,l){var u=n.code==="READ"?a._batchableCommandAckStateMap:a._ackStateMap;u.has(n.requestId)&&(u.delete(n.requestId),r&&(clearTimeout(r),r=null),o?(a._logger.debug("fail websocket request",n.requestId,o),t.reject(o)):(a._logger.debug("receive websocket ack",n.requestId,n),a._logger.debug("receive websocket ack",l),t.resolve(l)))};try{r=setTimeout(function(){return i(k.noAckTimeout)},this._sdkState.websocket.responseTimeout),n.code==="READ"?this._batchableCommandAckStateMap.set(n.requestId,{ackState:{resolve:function(o){return i(void 0,o)},reject:function(o){return i(o)}},channelUrl:n.payload.channel_url,requestTime:Date.now()}):this._ackStateMap.set(n.requestId,{resolve:function(o){return i(void 0,o)},reject:function(o){return i(o)}}),this.websocketClient.send(n)}catch(o){i(o)}}else try{this.websocketClient.send(n),t.resolve()}catch(o){t.reject(o)}return[2,t.promise]})})},e.prototype.send=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return n instanceof H?[4,this._sendApiRequest(n)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return n instanceof sr?[4,this._sendWebsocketRequest(n)]:[3,4];case 4:throw k.invalidParameters}})})},e.prototype.cancel=function(n){this.apiClient.cancel(n)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();(function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"})(He||(He={}));var Po,Fo,Zr=function(e){function n(t){var r=t.stateType,i=e.call(this)||this;return i.stateType=r,i}return T(n,e),n}(st),TA=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return T(n,e),n}(st),Vv=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return T(n,e),n}(st),wA=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return T(n,e),n}(st),C1=function(){function e(n){var t,r,i,a;this.isEnabled=(t=n.enabled)!==null&&t!==void 0&&t,this.feedChannels=(r=n.feed_channels)!==null&&r!==void 0?r:{},this.templateListToken=(i=n.template_list_token)!==null&&i!==void 0?i:null,this.settingsUpdatedAt=(a=n.settings_updated_at)!==null&&a!==void 0?a:0}return e.payloadify=function(n){return W(ae({enabled:n.isEnabled,feed_channels:n.feedChannels,template_list_token:n.templateListToken,settings_updated_at:n.settingsUpdatedAt}))},e}(),Iy=function(e){return"sendbird@".concat(e,"/changelog_include_chat_notifications")},S1=function(){function e(n){var t;this.lastUpdatedAt=(t=n.last_updated_at)!==null&&t!==void 0?t:0}return e.payloadify=function(n){return W(ae({last_updated_at:n.lastUpdatedAt}))},e}(),T1=function(){function e(n){var t;this.token=(t=n.template_list_token)!==null&&t!==void 0?t:""}return e.payloadify=function(n){return W(ae({template_list_token:n.token}))},e}(),Xh=function(){function e(n){n===void 0&&(n={min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}),this.minStatCount=n.min_stat_count,this.minInterval=1e3*n.min_interval,this.maxStatCountPerRequest=n.max_stat_count_per_request,this.lowerThreshold=n.lower_threshold,this.requestDelayRange=1e3*n.request_delay_range}return e.payloadify=function(n){return W(ae({min_stat_count:n.minStatCount,min_interval:n.minInterval/1e3,max_stat_count_per_request:n.maxStatCountPerRequest,lower_threshold:n.lowerThreshold,request_delay_range:n.requestDelayRange/1e3}))},e}(),pg=function(){function e(n){n===void 0&&(n={default:{min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}}),this.default=new Xh(n.default),this.realTime=new Xh(n.realtime)}return e.payloadify=function(n){return W(ae({default:Xh.payloadify(n.default),realtime:Xh.payloadify(n.realTime)}))},e}(),ZD=function(){function e(n){var t;this.templateListToken=(t=n.template_list_token)!==null&&t!==void 0?t:null}return e.payloadify=function(n){return W(ae({template_list_token:n.templateListToken}))},e}(),w1=1048576,XD=5;(function(e){e[e.NONE=0]="NONE",e[e.INCLUDE_REPLY=1]="INCLUDE_REPLY",e[e.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",e[e.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"})(Po||(Po={})),function(e){e[e.NONE=0]="NONE",e[e.INCLUDE_REPLY=1]="INCLUDE_REPLY",e[e.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",e[e.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"}(Fo||(Fo={}));var A1=function(){function e(n){var t,r,i,a,s,o,l,u,c,d;n===void 0&&(n={}),this.emojiHash=n.emoji_hash||"",this.uploadSizeLimit=n.file_upload_size_limit?n.file_upload_size_limit*w1:Number.MAX_SAFE_INTEGER,this.useReaction=!!n.use_reaction,this.applicationAttributes=(t=n.application_attributes)!==null&&t!==void 0?t:[],this.premiumFeatureList=(r=n.premium_feature_list)!==null&&r!==void 0?r:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=(i=n.multiple_file_send_max_size)!==null&&i!==void 0?i:5,this.allowSdkStatsUpload=(a=n.allow_sdk_log_ingestion)===null||a===void 0||a,this.unreadCountThreadingPolicy=(s=n.unread_cnt_threading_policy)!==null&&s!==void 0?s:Po.NONE,this.lastMessageThreadingPolicy=(o=n.last_msg_threading_policy)!==null&&o!==void 0?o:Fo.NONE,this.uikitConfigInfo=new S1((l=n.uikit_config)!==null&&l!==void 0?l:{}),this.notificationInfo=n.notifications?new C1(n.notifications):null,this.messageTemplateInfo=n.message_template?new T1(n.message_template):null,this.aiAgentInfo=n.ai_agent?new ZD(n.ai_agent):null,this.statConfigInfo=n.log_publish_config?new pg(n.log_publish_config):new pg,this.disableSuperGroupMack=(u=n.disable_supergroup_mack)!==null&&u!==void 0&&u,this.configSyncNeeded=(c=n.config_sync_needed)!==null&&c!==void 0&&c,this.requestDedupIntervalMs=(d=n.request_dedup_interval_ms)!==null&&d!==void 0?d:500}return e.payloadify=function(n){return W(ae({emoji_hash:n.emojiHash,file_upload_size_limit:n.uploadSizeLimit/w1,application_attributes:n.applicationAttributes,premium_feature_list:n.premiumFeatureList,use_reaction:n.useReaction,allow_sdk_log_ingestion:n.allowSdkStatsUpload,unread_cnt_threading_policy:n.unreadCountThreadingPolicy,last_msg_threading_policy:n.lastMessageThreadingPolicy,uikit_config:n.uikitConfigInfo?S1.payloadify(n.uikitConfigInfo):null,notifications:n.notificationInfo?C1.payloadify(n.notificationInfo):null,message_template:n.messageTemplateInfo?T1.payloadify(n.messageTemplateInfo):null,log_publish_config:n.statConfigInfo?pg.payloadify(n.statConfigInfo):null,disable_supergroup_mack:n.disableSuperGroupMack,config_sync_needed:n.configSyncNeeded,request_dedup_interval_ms:n.requestDedupIntervalMs}))},e}(),kp=function(e){return"sendbird@".concat(e,"/app_configs_info")},Wt=function(){function e(n){this._iid="",this._iid=n}return e.payloadify=function(n){return{}},e}(),JD=function(e){function n(t){var r=t.userId,i=t.metadata,a=e.call(this)||this;return a.method=z.POST,a.path="".concat(Fe,"/").concat(r,"/metadata"),a.params={metadata:i},a}return T(n,e),n}(H),ek=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.metaData=r,i}return T(n,e),n}(j),tk=function(e){function n(t){var r=t.userId,i=t.metadata,a=t.upsert,s=e.call(this)||this;return s.method=z.PUT,s.path="".concat(Fe,"/").concat(r,"/metadata"),s.params={metadata:i,upsert:a},s}return T(n,e),n}(H),nk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.metadata=r,i}return T(n,e),n}(j),rk=function(e){function n(t){var r=t.userId,i=t.metadataKey,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(r,"/metadata/").concat(i),a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var ik=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.DELETE,i.path="".concat(Fe,"/").concat(r,"/metadata"),i}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var su,Wu=function(e,n){var t=JSON.parse(JSON.stringify(e));return t._iid&&delete t._iid,n&&n(t),t},Gs=function(e,n){var t=JSON.parse(JSON.stringify(e));return t},B=function(e){return{do:function(n){e||n()},throw:function(n){if(!e)throw n}}};(function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"})(su||(su={}));var xu,xe=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b=this;return(b=e.call(this,t)||this).userId=(a=(i=r.guest_id)!==null&&i!==void 0?i:r.user_id)!==null&&a!==void 0?a:"",b.nickname=(o=(s=r.nickname)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:"",b.plainProfileUrl=(u=(l=r.profile_url)!==null&&l!==void 0?l:r.image)!==null&&u!==void 0?u:"",b.requireAuth=(c=r.require_auth_for_profile_image)!==null&&c!==void 0&&c,b.metaData=(d=r.metadata)!==null&&d!==void 0?d:{},b.connectionStatus=su.NON_AVAILABLE,be(su,r.is_online)?b.connectionStatus=r.is_online:x("boolean",r.is_online)&&(b.connectionStatus=r.is_online?su.ONLINE:su.OFFLINE),b.isActive=(h=r.is_active)===null||h===void 0||h,b.lastSeenAt=(f=r.last_seen_at)!==null&&f!==void 0?f:null,b.preferredLanguages=r.preferred_languages?ce([],ne(r.preferred_languages),!1):null,b.friendDiscoveryKey=(m=r.friend_discovery_key)!==null&&m!==void 0?m:null,b.friendName=(y=r.friend_name)!==null&&y!==void 0?y:null,b._hashValue=b._generateHashValue(),b._updatedAt=(C=r.updatedat)!==null&&C!==void 0?C:0,b}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})))},n._buildUserFromSerializedData=function(t){var r=Gs(t);return new n(r._iid,n.payloadify(r))},n.prototype._generateHashValue=function(){for(var t,r=JSON.stringify({userId:this.userId,nickname:this.nickname,plainProfileUrl:this.plainProfileUrl,friendDiscoveryKey:this.friendDiscoveryKey,friendName:this.friendName,metaData:JSON.stringify(this.metaData),performanceLanguages:(t=this.preferredLanguages)===null||t===void 0?void 0:t.toString(),requireAuth:this.requireAuth}),i=0,a=0;a<r.length;a++)i=(i<<5)-i+r.charCodeAt(a),i|=0;return i},Object.defineProperty(n.prototype,"profileUrl",{get:function(){var t=I.of(this._iid).sessionManager;return this.requireAuth&&t.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(t.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),n.prototype.serialize=function(){return Wu(this)},n.prototype._isValidMetaData=function(t){return!Array.isArray(t)&&Object.keys(t).length>0&&Object.keys(t).map(function(r){return t[r]}).every(function(r){return x("string",r)})},n.prototype._applyMetaData=function(t,r){var i=this;r===void 0&&(r=!1),Object.keys(t).forEach(function(a){r?delete i.metaData[a]:i.metaData[a]=t[a]})},n.prototype.createMetaData=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(this._isValidMetaData(t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new JD({userId:i.userId,metadata:t}),[4,a.send(s)];case 1:return o=u.sent(),l=o.as(ek).metaData,this._applyMetaData(l),[2,this.metaData]}})})},n.prototype.updateMetaData=function(t,r){return r===void 0&&(r=!1),g(this,void 0,void 0,function(){var i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(this._isValidMetaData(t)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.requestQueue,o=new tk({userId:a.userId,metadata:t,upsert:r}),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(nk).metadata,this._applyMetaData(u),[2,this.metaData]}})})},n.prototype.deleteMetaData=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return B(x("string",t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new rk({userId:i.userId,metadataKey:t}),[4,a.send(s)];case 1:return l.sent(),this._applyMetaData(((o={})[t]=!0,o),!0),[2,this.metaData]}})})},n.prototype.deleteAllMetaData=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new ik({userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.metaData={},[2]}})})},n}(Wt),AA=function(e){function n(t){var r=t.userProfile,i=e.call(this)||this;return i.userProfile=r,i}return T(n,e),n}(st),jv=function(){function e(n,t){var r,i,a,s,o,l,u,c,d,h,f,m,y,C;this._iid=n,this.appInfo=new A1(t),this.user=new xe(n,t),this.connectedAt=(r=t.login_ts)!==null&&r!==void 0?r:0,this.firstConnectedAt=0,this.pingInterval=(i=t.ping_interval)!==null&&i!==void 0?i:15e3,this.pongTimeout=(a=t.pong_timeout)!==null&&a!==void 0?a:5e3,this.reconnectInterval=(o=(s=t.reconnect)===null||s===void 0?void 0:s.interval)!==null&&o!==void 0?o:3e3,this.reconnectMaxInterval=(u=(l=t.reconnect)===null||l===void 0?void 0:l.max_interval)!==null&&u!==void 0?u:6e4,this.reconnectRetryCount=(d=(c=t.reconnect)===null||c===void 0?void 0:c.retry_cnt)!==null&&d!==void 0?d:5,this.reconnectIntervalMultiple=(f=(h=t.reconnect)===null||h===void 0?void 0:h.mul)!==null&&f!==void 0?f:2,this.maxUnreadCountOnSuperGroup=(m=t.max_unread_cnt_on_super_group)!==null&&m!==void 0?m:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=(y=t.concurrent_call_limit)!==null&&y!==void 0?y:5,this.backOffDelay=(C=t.back_off_delay)!==null&&C!==void 0?C:100}return e.payloadify=function(n){return W(ae(N(N(N({},xe.payloadify(n.user)),A1.payloadify(n.appInfo)),{login_ts:n.connectedAt,ping_interval:n.pingInterval,pong_timeout:n.pongTimeout,reconnect:{interval:n.reconnectInterval,max_interval:n.reconnectMaxInterval,retry_cnt:n.reconnectRetryCount,mul:n.reconnectIntervalMultiple},max_unread_cnt_on_super_group:n.maxUnreadCountOnSuperGroup,profile_image_encryption:n.profileImageEncryption,concurrent_call_limit:n.concurrentCallLimit,back_off_delay:n.backOffDelay})))},e.prototype.apply=function(){var n=this.reconnectInterval,t=this.reconnectMaxInterval,r=this.reconnectIntervalMultiple,i=I.of(this._iid);i.sdkState.websocket&&(i.sdkState.websocket.pingInterval=1e3*this.pingInterval,i.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,i.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,i.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(a){return a>0?1e3*Math.min(n*Math.pow(r,a-1),t):10}}),i.appInfo=this.appInfo,i.sessionManager.currentUser=this.user,i.connectedAt=this.connectedAt,this.firstConnectedAt||(i.firstConnectedAt=this.connectedAt),i.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,i.concurrentCallLimit=this.concurrentCallLimit,i.backOffDelay=this.backOffDelay,i.requestDeduplicator.requestDedupInterval=this.appInfo.requestDedupIntervalMs,i.dispatcher.dispatch(new AA({userProfile:this}))},e}(),NA=function(e){function n(t){var r=t.request,i=r===void 0||r,a=t.features,s=a===void 0?{}:a,o=t.options,l=o===void 0?{}:o,u=t.statConfigInfo,c=e.call(this)||this;return c.request=i,c.features=N({localCache:!0,notification:!0},s),c.options=N({ingestion:!0},l),c.statConfigInfo=u,c}return T(n,e),n}(st),IA=function(e){function n(t){var r=e.call(this)||this;return r.configSyncNeeded=!1,r.configSyncNeeded=t,r}return T(n,e),n}(st),Uf=function(e){function n(t,r,i){var a,s,o,l,u=this;return(u=e.call(this,t,r,i)||this).error=null,u.services=[],u.userProfile=new jv(t,i),u.deviceTokenLastDeletedAt=(a=i.device_token_last_deleted_at)!==null&&a!==void 0?a:0,u.key=(s=i.key)!==null&&s!==void 0?s:"",u.ekey=(o=i.ekey)!==null&&o!==void 0?o:"",u.error=i.error?new k(i):null,u.services=(l=i.services)!==null&&l!==void 0?l:[],u}return T(n,e),n.asError=function(t){return new n("","LOGI",N({user_id:"",error:!0},t))},n.prototype.applyTo=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return this.error?[3,4]:(r=I.of(t))?(i=r.sessionManager,a=r.dispatcher,[4,i.login(this)]):[3,2];case 1:return s.sent(),this.userProfile.apply(),a.dispatch(new IA(this.userProfile.appInfo.configSyncNeeded)),a.dispatch(new NA({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload},statConfigInfo:this.userProfile.appInfo.statConfigInfo})),[3,3];case 2:throw k.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}})})},n}(pt),Tl=function(){function e(){this.type=He.NONE,this.name="none"}return e.prototype.run=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2]})})},e.prototype.onConnect=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},e.prototype.onReconnect=function(n,t){return t.resetReconnectCount,g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},e.prototype.onDisconnect=function(n,t){return t.error,t.autoReconnect,t.cause,g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},e.prototype.onDisconnectWebSocket=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},e.prototype.onLogout=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},e}(),Vs=function(e){function n(t){t===void 0&&(t={});var r,i=this;return(i=e.call(this)||this).type=He.LOGOUT,i.name="logout",i._wasPreviouslyConnected=(r=t.wasPreviouslyConnected)===null||r===void 0||r,i}return T(n,e),n.prototype.run=function(t){return g(this,void 0,void 0,function(){var r,i,a=this;return _(this,function(s){switch(s.label){case 0:return r=Date.now(),i=t.sdkState.userId,[4,t.logout()];case 1:return s.sent(),[4,t.changeState(new My,r)];case 2:return s.sent(),this._wasPreviouslyConnected&&he(function(){return g(a,void 0,void 0,function(){return _(this,function(o){return t.connectionHandlers.forEach(function(l){l.onDisconnected&&l.onDisconnected(i)}),[2]})})}),[2]}})})},n}(Tl),Am=function(e){function n(){var t=e.call(this)||this;return t.type=He.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return T(n,e),n.prototype.run=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,t.disconnect()];case 1:return r.sent(),[2]}})})},n.prototype.onConnect=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,t.disconnect()];case 1:return a.sent(),[4,t.changeState(new Im({authToken:r}),i)];case 2:return a.sent(),[2]}})})},n.prototype.onReconnect=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Up,r)];case 1:return i.sent(),[2]}})})},n.prototype.onLogout=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Vs,r)];case 1:return i.sent(),[2]}})})},n}(Tl),Rp=function(e){function n(t){var r=t.autoReconnect,i=e.call(this)||this;return i.type=He.INTERNAL_DISCONNECTED,i.name="internaldisconnected",i._autoReconnect=!1,i._autoReconnect=r,i}return T(n,e),n.prototype.run=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.disconnect()];case 1:return i.sent(),this._autoReconnect?[4,t.changeState(new Up,r)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.onConnect=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,t.disconnect()];case 1:return a.sent(),[4,t.changeState(new Im({authToken:r}),i)];case 2:return a.sent(),[2]}})})},n.prototype.onReconnect=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Up,r)];case 1:return i.sent(),[2]}})})},n.prototype.onDisconnectWebSocket=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},n.prototype.onLogout=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Vs,r)];case 1:return i.sent(),[2]}})})},n}(Tl),tr=function(e){return g(void 0,void 0,void 0,function(){return _(this,function(n){return[2,new Promise(function(t){return setTimeout(t,e)})]})})},MA=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),Nm=function(e,n,t){return t===void 0&&(t=new MA),g(void 0,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:r=0,i=null,a=function(c){return i=c??new Error("Halted")},s=function(){r=0},u.label=1;case 1:if(!(n===-1||r<n))return[3,9];u.label=2;case 2:return u.trys.push([2,4,,8]),[4,e(a,s)];case 3:if(o=u.sent(),i)throw i;return[2,o];case 4:if(l=u.sent(),i)return[3,6];if(++r===n)throw l;return[4,tr(t.calcTimeout(r))];case 5:return u.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}})})},Up=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=He.RECONNECTING,t.name="reconnecting",t._callbacks=[],t}return T(n,e),n.prototype._halt=function(t){this._haltConnect&&(this._haltConnect(t),this._haltConnect=void 0)},n.prototype._flushCallbacks=function(t){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach(function(r){return r(t)})},n.prototype.run=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:r=Date.now(),i=new ar,this._callbacks.push(function(f){return f?i.reject(f):i.resolve()}),he(function(){return g(d,void 0,void 0,function(){return _(this,function(f){return t.connectionHandlers.forEach(function(m){m.onReconnectStarted&&m.onReconnectStarted()}),[2]})})}),h.label=1;case 1:return h.trys.push([1,4,,9]),a=Wr(),s=0,o=t.sdkState.websocket,l=o.reconnectMaxRetry,u=o.reconnectRetryStrategy,[4,Nm(function(f,m){return g(d,void 0,void 0,function(){var y;return _(this,function(C){switch(C.label){case 0:this._haltConnect=f,this._resetConnect=m,C.label=1;case 1:return C.trys.push([1,3,,4]),s++,[4,t.connect({connectionKey:a,connectionRetryCount:s})];case 2:return C.sent(),[3,4];case 3:if(y=C.sent(),t.clearLoginTimer(),y instanceof k){if(y.code===re.CONNECTION_CANCELED)return f(y),[2];if(y.isSessionExpiredError||y.isSessionInvalidatedError)return f(y),[2]}throw y;case 4:return[2]}})})},l,u)];case 2:return h.sent(),[4,t.changeState(new xA,r)];case 3:return h.sent(),this._flushCallbacks(),he(function(){return g(d,void 0,void 0,function(){return _(this,function(f){return t.connectionHandlers.forEach(function(m){m.onReconnectSucceeded&&m.onReconnectSucceeded()}),[2]})})}),[3,9];case 4:return c=h.sent(),fr(c)?[3,7]:c instanceof k?c.code===re.CONNECTION_CANCELED?[3,6]:[4,t.changeState(new Rp({autoReconnect:!1}),r)]:[3,6];case 5:h.sent(),h.label=6;case 6:return this._flushCallbacks(c),he(function(){return g(d,void 0,void 0,function(){return _(this,function(f){return t.connectionHandlers.forEach(function(m){m.onReconnectFailed&&m.onReconnectFailed()}),[2]})})}),[3,8];case 7:throw c;case 8:return[3,9];case 9:return[2,i.promise]}})})},n.prototype.onConnect=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){return i=new ar,this._halt(k.connectionCanceled),t.cancelConnectForRetry(),this._callbacks.push(function(){var s=Date.now();t.changeState(new Im({authToken:r}),s).then(function(){i.resolve()}).catch(function(o){i.reject(o)})}),[2,i.promise]})})},n.prototype.onReconnect=function(t,r){var i=r.resetReconnectCount,a=i!==void 0&&i;return g(this,void 0,void 0,function(){var s;return _(this,function(o){return s=new ar,this._resetConnect&&a&&this._resetConnect(),this._callbacks.push(function(l){return l?s.reject(l):s.resolve()}),[2,s.promise]})})},n.prototype.onDisconnect=function(t,r){r._error;var i=r.autoReconnect,a=i===void 0||i;return g(this,void 0,void 0,function(){var s;return _(this,function(o){switch(o.label){case 0:return s=Date.now(),this._halt(k.connectionCanceled),[4,t.changeState(new Rp({autoReconnect:a}),s)];case 1:return o.sent(),[2]}})})},n.prototype.onDisconnectWebSocket=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(k.connectionCanceled),[4,t.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},n.prototype.onLogout=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(k.connectionCanceled),[4,t.changeState(new Vs,r)];case 1:return i.sent(),[2]}})})},n}(Tl),xA=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=He.CONNECTED,t.name="connected",t}return T(n,e),n.prototype.onReconnect=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.disconnect()];case 1:return i.sent(),[4,t.changeState(new Up,r)];case 2:return i.sent(),[2]}})})},n.prototype.onDisconnect=function(t,r){var i=r.autoReconnect;return g(this,void 0,void 0,function(){var a;return _(this,function(s){switch(s.label){case 0:return a=Date.now(),[4,t.changeState(new Rp({autoReconnect:i}),a)];case 1:return s.sent(),[2]}})})},n.prototype.onDisconnectWebSocket=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},n.prototype.onLogout=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Vs,r)];case 1:return i.sent(),[2]}})})},n}(Tl);(function(e){e.ExternalSetBackground="ExternalSetBackground",e.ExternalDisconnectWebSocket="ExternalDisconnectWebSocket"})(xu||(xu={}));var ak=function(){function e(n,t){var r=t.sdkState,i=t.cacheContext,a=t.connectionHandlers,s=t.sessionManager,o=t.websocketClient,l=t.dispatcher,u=t.logger,c=t.disableWebSocketCloseEventHandling,d=c!==void 0&&c;this._disableWebSocketCloseEventHandling=!1,this._webSocketClosedCause=null,this._logger=u,this._disableWebSocketCloseEventHandling=d,this._context=new lk(n,{sdkState:r,cacheContext:i,connectionHandlers:a,sessionManager:s,websocketClient:o,dispatcher:l,logger:u}),this._sdkState=r,this._sessionManager=s,this._websocketClient=o}return e.prototype._registerEventDispatcher=function(){var n=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",function(){n.isConnecting||n.isConnected||(n._logger.debug("try reconnect by session key refresh"),Ct(function(){return g(n,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this.reconnect()];case 1:return t.sent(),[2]}})})}))}),this._websocketEventDispatcherContext=this._websocketClient.on("close",function(){n._sdkState.appState!=="foreground"||n._webSocketClosedCause||Ct(function(){return g(n,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return t.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:t.sent(),t.label=4;case 4:return[2]}})})})}))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===He.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var n=this._context.currentState;return n.type===He.CONNECTING||n.type===He.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),e.prototype.connect=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onConnect(this._context,n)];case 1:return r.sent(),this._registerEventDispatcher(),[2]}})})},e.prototype.reconnect=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=this._context.currentState,this._webSocketClosedCause=null,[4,n.onReconnect(this._context,{})];case 1:return t.sent(),[2]}})})},e.prototype.resetAndReconnect=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=this._context.currentState,this._webSocketClosedCause=null,[4,n.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}})})},e.prototype.background=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=this._context.currentState,this._webSocketClosedCause=xu.ExternalSetBackground,[4,n.onDisconnect(this._context,{autoReconnect:!1,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}})})},e.prototype.disconnect=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:n,autoReconnect:!0,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}})})},e.prototype.disconnectWebSocket=function(n){return n===void 0&&(n=!1),g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return t=this._context.currentState,n&&(this._webSocketClosedCause=xu.ExternalDisconnectWebSocket),[4,t.onDisconnectWebSocket(this._context,{cause:this._webSocketClosedCause})];case 1:return r.sent(),[2]}})})},e.prototype.logout=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return t=this._context.currentState,this._clearEventDispatcher(),[4,t.onLogout(this._context,n)];case 1:return r.sent(),[2]}})})},e}(),Im=function(e){function n(t){var r=t.authToken,i=e.call(this)||this;return i.type=He.CONNECTING,i.name="connecting",i._authToken="",i._callbacks=[],i._authToken=r,i}return T(n,e),n.prototype._halt=function(t){this._haltConnect&&(this._haltConnect(t),this._haltConnect=void 0)},n.prototype._flushCallbacks=function(t){this._haltConnect=void 0,this._callbacks.forEach(function(r){return r(t)})},n.prototype.run=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:r=Date.now(),i=new ar,this._callbacks.push(function(c){return c?i.reject(c):i.resolve()}),u.label=1;case 1:return u.trys.push([1,4,,10]),a=Wr(),s=0,[4,Nm(function(c){return g(l,void 0,void 0,function(){var d;return _(this,function(h){switch(h.label){case 0:this._haltConnect=c,h.label=1;case 1:return h.trys.push([1,3,,4]),s++,[4,t.connect({authToken:this._authToken,connectionKey:a,connectionRetryCount:s})];case 2:return h.sent(),[3,4];case 3:if(d=h.sent(),t.clearLoginTimer(),d instanceof k&&d.code===re.CONNECTION_CANCELED)return c(d),[2];throw d;case 4:return[2]}})})},t.sdkState.websocket.connectMaxRetry)];case 2:return u.sent(),[4,t.changeState(new xA,r)];case 3:return u.sent(),he(function(){return g(l,void 0,void 0,function(){return _(this,function(c){return this._flushCallbacks(),t.connectionHandlers.forEach(function(d){d.onConnected&&d.onConnected(t.sdkState.userId)}),[2]})})}),[3,10];case 4:return o=u.sent(),fr(o)?[3,8]:[4,t.disconnect()];case 5:return u.sent(),o instanceof k?o.code===re.CONNECTION_CANCELED?[3,7]:[4,t.changeState(new My,r)]:[3,7];case 6:u.sent(),u.label=7;case 7:return he(function(){return g(l,void 0,void 0,function(){return _(this,function(c){return this._flushCallbacks(o),[2]})})}),[3,9];case 8:throw o;case 9:return[3,10];case 10:return[2,i.promise]}})})},n.prototype.onConnect=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=new ar,this._callbacks.push(function(a){return a?r.reject(a):r.resolve()}),[2,r.promise]})})},n.prototype.onDisconnect=function(t,r){var i=r.error,a=i===void 0?null:i,s=r.autoReconnect,o=s!==void 0&&s,l=r.cause,u=l===void 0?null:l;return g(this,void 0,void 0,function(){var c;return _(this,function(d){switch(d.label){case 0:return c=Date.now(),this._halt(a??N1(u)),t.hasSession?[4,t.changeState(new Rp({autoReconnect:o}),c)]:[3,2];case 1:return d.sent(),[3,4];case 2:return[4,t.changeState(new Vs,c)];case 3:d.sent(),d.label=4;case 4:return[2]}})})},n.prototype.onDisconnectWebSocket=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return this._halt(N1(r?.cause||null)),i=Date.now(),t.hasSession?[4,t.changeState(new Am,i)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,t.changeState(new Vs,i)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},n.prototype.onLogout=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=Date.now(),this._halt(r??k.connectionCanceled),[4,t.changeState(new Vs,i)];case 1:return a.sent(),[2]}})})},n}(Tl);function N1(e){var n=k.connectionCanceled;if(e){var t=null;switch(e){case xu.ExternalSetBackground:t="Connection has been canceled due to the application having externally moved to background while in ConnectingState.";break;case xu.ExternalDisconnectWebSocket:t="Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState."}t&&n.setDetail(t)}return n}var ys,My=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=He.INITIALIZED,t.name="initialized",t}return T(n,e),n.prototype.onConnect=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,t.changeState(new Im({authToken:r}),i)];case 1:return a.sent(),[2]}})})},n.prototype.onLogout=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,t.changeState(new Vs({wasPreviouslyConnected:!1}),r)];case 1:return i.sent(),[2]}})})},n}(Tl),sk=function(e){function n(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return T(n,e),n}(sr),ok=function(){function e(n){var t=n.pingDelegate,r=n.sdkState,i=n.logger;this.pingDelegate=t,this.sdkState=r,this._logger=i}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var n,t=this;if(!this.sdkState.websocket)throw k.connectionRequired;var r=new sk;try{var i=(n=this.sdkState.websocket.pongTimeout)!==null&&n!==void 0?n:5e3;this._pingTimeoutTimer=setTimeout(function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error()},i),this.pingDelegate.send(r),this._logger.debug("pinger.ping()")}catch(a){this._logger.debug("pinger.ping() error",a),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return r},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e.prototype.refreshTimer=function(){var n,t=this;if(!this.sdkState.websocket)throw k.connectionRequired;this._logger.debug("pinger.refreshTimer()");var r=(n=this.sdkState.websocket.pingInterval)!==null&&n!==void 0?n:15e3;this.stop(),this._pingTimer=setInterval(function(){t.ping()},r)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e}(),OA=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications","message_template","ai_agent"],lk=function(e){function n(t,r){var i,a=r.sdkState,s=r.cacheContext,o=r.connectionHandlers,l=r.sessionManager,u=r.websocketClient,c=r.dispatcher,d=r.logger,h=r.entryState,f=h===void 0?new My:h,m=this;return(m=e.call(this)||this)._currentConnectionRetryCount=0,m._stateUpdatedAt=0,m._connectingAt=0,m._connectedAt=0,m._logiReceivedAt=0,m._connectionRequestQueue=[],m._iid=t,m.sdkState=a,m.cacheContext=s,m.connectionHandlers=o,m._sessionManager=l,m._websocketClient=u,m._dispatcher=c,m._logger=d,m._currentState=f,!((i=m.sdkState.websocket)===null||i===void 0)&&i.pingerDisabled||(m._pinger=new ok({pingDelegate:{send:function(y){return m._websocketClient.send(y)},error:function(y){c.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:re.NETWORK_ERROR,error_description:"cause=ping_pong_timedout"}}))),m._websocketClient.error(y)}},sdkState:m.sdkState,logger:d})),m._websocketClient.on("open",function(){m._connectedAt=Date.now(),m._tryResolveConnectionRequest()}).on("message",function(y){y.code==="LOGI"&&(m.clearLoginTimer(),m._dispatcher.dispatch(y.as(Uf)))}).on("ping-refresh",function(){var y;return(y=m._pinger)===null||y===void 0?void 0:y.refreshTimer()}).on("pong",function(){var y;return(y=m._pinger)===null||y===void 0?void 0:y.pong()}).on("error",function(){var y;return(y=m._pinger)===null||y===void 0?void 0:y.stop()}).on("close",function(){m._logiProcessingTimer=setTimeout(function(){m._logiProcessingTimer=void 0,m._unresolvedLogi||m._rejectConnectionRequest(k.networkError)},500)}),m._dispatcher.on(function(y){y instanceof Uf&&(m._unresolvedLogi=y,m._tryResolveConnectionRequest())}),m}return T(n,e),Object.defineProperty(n.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),n.prototype.changeState=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return r>=this._stateUpdatedAt?(this._currentState=t,this._stateUpdatedAt=r,this._dispatcher.dispatch(new Zr({stateType:t.type})),this._logger.debug("connection state changes to ".concat(t.name)),[4,this._currentState.run(this)]):[3,2];case 1:return i.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype._tryResolveConnectionRequest=function(){var t;return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=this._unresolvedLogi,this._websocketClient.isOpen&&r?(this._unresolvedLogi=void 0,this._logiReceivedAt=Date.now(),r.error?[3,2]:[4,r.applyTo(this._iid)]):[3,3];case 1:return i.sent(),this._statLogConnection(),(t=this._pinger)===null||t===void 0||t.start(),this._connectionRequestQueue.forEach(function(a){return a.resolve()}),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,r.error.isSessionExpiredError||r.error.isSessionInvalidatedError?this._dispatcher.dispatch(new Mu({reason:r.error.code,message:r.error.message})):this._logger.warn("login failed: ".concat(r.error)),this._rejectConnectionRequest(r.error),i.label=3;case 3:return[2]}})})},n.prototype._rejectConnectionRequest=function(t){var r;if((r=this._pinger)===null||r===void 0||r.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var i=this._connectionRequestQueue;this._connectionRequestQueue=[],i.forEach(function(a){return a.reject(t)}),this._statLogConnection(t)}},n.prototype._url=function(t){var r,i=t.configTs,a=this.sdkState,s=a.appId,o=a.appVersion,l=a.userId,u=a.extensions,c=a.sendbirdRuntimeEnvironment,d=this.cacheContext.localCacheEnabled,h=this._sessionManager.session,f=(r=this.sdkState.websocket)===null||r===void 0?void 0:r.compression,m=!!(u??{}).sb_uikit,y=Ip.userAgentWithExtension(u);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(zs.OS_VERSION),"&sv=").concat(encodeURIComponent(zs.SDK_VERSION),"&ai=").concat(s).concat(o?"&av=".concat(o):"").concat(h.hasSession?"":"&user_id=".concat(encodeURIComponent(l)),"&pmce=").concat(f?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(y,"&SB-SDK-User-Agent=").concat(encodeURIComponent(Ip.sendbirdSdkUserAgentWithExtension(c)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(OA))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(d?1:0,"&include_poll_details=1").concat(m?"&uikit_config=1":"","&config_ts=").concat(i)},n.prototype._statLogConnection=function(t){var r;this._dispatcher.dispatch(new za(new ut({type:Ze.WEBSOCKET_CONNECT,data:{host_url:(r=this.sdkState.websocket)===null||r===void 0?void 0:r.host,success:!t,latency:this._connectedAt>0?this._connectedAt-this._connectingAt:Date.now()-this._connectingAt,logi_latency:this._logiReceivedAt>0?this._logiReceivedAt-this._connectingAt:void 0,connection_id:this._currentConnectionKey,accum_trial:this._currentConnectionRetryCount,error_code:t?.code,error_description:t?.message}})))},n.prototype.connect=function(t){var r;return t===void 0&&(t={}),g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h,f,m,y=this;return _(this,function(C){switch(C.label){case 0:return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(k.connectionCanceled)),i=new ar,a=t.authToken,s=a===void 0?"":a,o=t.connectionKey,l=o===void 0?Wr():o,u=t.connectionRetryCount,c=u===void 0?1:u,this._connectionRequestQueue.push(i),this._connectionRequestQueue.length!==1?[3,2]:(this._currentConnectionKey=l,this._currentConnectionRetryCount=c,this._connectingAt=Date.now(),this._connectedAt=0,this._logiReceivedAt=0,this._loginTimer=setTimeout(function(){y._loginTimer=void 0,y._rejectConnectionRequest(k.loginTimeout)},(r=this.sdkState.websocket)===null||r===void 0?void 0:r.responseTimeout),d=this._sessionManager.session,s&&(d.authToken=s,d.sessionKey=void 0),h=0,[4,this.cacheContext.preference.get(kp(this.sdkState.appId))]);case 1:(f=C.sent())&&(h=f.configTs),m=this._url({configTs:h}),d.sessionKey||d.authToken?this._websocketClient.connect(m,JSON.stringify(d.hasSession?{auth:d.sessionKey}:{token:d.authToken})):this._websocketClient.connect(m,JSON.stringify({})),C.label=2;case 2:return[2,i.promise]}})})},n.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Uf.asError(k.connectionRenew))},n.prototype.disconnect=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return t.sent(),[2]}})})},n.prototype.logout=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this.disconnect()];case 1:return t.sent(),[4,this._sessionManager.clear()];case 2:return t.sent(),[2]}})})},n.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},n}(Sl),DA=function(e){function n(t){var r=t.appId,i=t.userId,a=t.includeUIKitConfig,s=a!==void 0&&a,o=t.localCacheEnabled,l=o===void 0||o,u=t.expiringSession,c=u===void 0||u,d=t.configTs,h=d===void 0?0:d,f=e.call(this)||this;return f.path="".concat(NO,"/").concat(i,"/authentication"),f.method=z.POST,f.params=W({expiring_session:!!c,include_logi:!0,include_extra_data:String(OA),uikit_config:s,use_local_cache:l,app_id:r,config_ts:h}),f.requireAuth=!1,f}return T(n,e),n}(H),uk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.logi=new Uf(t,"LOGI",r),i}return T(n,e),n}(j);(function(e){e[e.ALL=0]="ALL",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.API=2]="API"})(ys||(ys={}));var gt,I1,ck=[Sy,DA],dk=function(){function e(n,t){var r=t.session,i=t.sdkState,a=t.dispatcher,s=t.logger,o=t.useFetchCompat,l=o!==void 0&&o,u=this;this._currentConnectionStateType=He.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new YD(n,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:l}),this._session=r,this._logger=s,this._dispatcher=a,this._dispatcher.on(function(c){var d,h,f;if(c instanceof Zr){var m=c.stateType;switch(u._currentConnectionStateType=m,m){case He.CONNECTED:u._resolveLazyCallQueue();break;case He.INITIALIZED:case He.INTERNAL_DISCONNECTED:case He.EXTERNAL_DISCONNECTED:case He.LOGOUT:u._session.isRefreshing||u._rejectLazyCallQueue(!((f=u._session)===null||f===void 0)&&f.hasSession?k.connectionClosed:k.connectionRequired)}}else if(c instanceof TA)u._session.hasChatServicePermission||u._resolveLazyCallQueue(ys.API);else if(c instanceof Vv||c instanceof wA)u._rejectLazyCallQueue(k.connectionClosed);else if(c instanceof nA){var y=c.request,C=c.deferred,b=c.error;try{for(var v=K(ck),E=v.next();!E.done;E=v.next())if(y instanceof E.value)return void C.reject(b)}catch(S){d={error:S}}finally{try{E&&!E.done&&(h=v.return)&&h.call(v)}finally{if(d)throw d.error}}u._lazyCallQueue.push({command:y,deferred:C})}})}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===He.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===He.CONNECTING||this._currentConnectionStateType===He.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),e.prototype._classifyLazyCallQueueByScope=function(n){var t,r=[],i=[];switch(n){case ys.ALL:t=null;break;case ys.WEBSOCKET:t=sr;break;case ys.API:t=H}var a=!1;return this._lazyCallQueue.forEach(function(s){!t||s.command instanceof t||(a=!0),a?i.push(s):r.push(s)}),[r,i]},e.prototype._resolveLazyCallQueue=function(n){var t=this;n===void 0&&(n=ys.ALL);var r=ne(this._classifyLazyCallQueueByScope(n),2),i=r[0],a=r[1];this._lazyCallQueue=a,i.forEach(function(s){return g(t,void 0,void 0,function(){var o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:o=s.command,l=s.deferred,(u=s.timeout)&&clearTimeout(u),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this.send(o)];case 2:return c=h.sent(),l.resolve(c),[3,4];case 3:return d=h.sent(),l.reject(d),[3,4];case 4:return[2]}})})})},e.prototype._rejectLazyCallQueue=function(n,t){var r=this;t===void 0&&(t=ys.ALL);var i=ne(this._classifyLazyCallQueueByScope(t),2),a=i[0],s=i[1];this._lazyCallQueue=s,a.forEach(function(o){return g(r,void 0,void 0,function(){var l,u;return _(this,function(c){return l=o.deferred,u=o.timeout,clearTimeout(u),l.reject(n),[2]})})})},e.prototype.send=function(n){return g(this,void 0,void 0,function(){var t,r,i=this;return _(this,function(a){switch(a.label){case 0:return n instanceof sr?this.isReady?(this._logger.debug("send websocket request",n),[4,this.commandRouter.send(n)]):[3,2]:[3,4];case 1:case 5:case 7:return[2,a.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",n),t=new ar,this._lazyCallQueue.push({command:n,deferred:t,timeout:setTimeout(function(){return i.timeout(n.requestId)},1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),k.connectionRequired;case 3:case 9:return[3,11];case 4:return n instanceof H?this._session.hasSession?(this._logger.debug("send api request",n),[4,this.commandRouter.send(n)]):[3,6]:[3,10];case 6:return n.hasSessionKey?(this._logger.debug("send api request with tmp session key",n),[4,this.commandRouter.send(n)]):[3,8];case 8:if(this.isLazyCallActivated)return this._logger.debug("wait api request",n),t=new ar,this._lazyCallQueue.push({command:n,deferred:t,timeout:setTimeout(function(){return i.timeout(n.requestId)},1e4)}),[2,t.promise];throw r=k.connectionRequired,this._logger.debug("fail api request",r),r;case 10:throw k.invalidCommand;case 11:return[2]}})})},e.prototype.forceSend=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this._logger.debug("send forced request",n),n instanceof sr||n instanceof H?[4,this.commandRouter.send(n)]:[3,2];case 1:return[2,t.sent()];case 2:throw k.invalidCommand}})})},e.prototype.timeout=function(n){this._logger.debug("timeout request",n);var t=this._lazyCallQueue.findIndex(function(r){return r.command.requestId===n});t>-1&&(this._lazyCallQueue[t].deferred.reject(k.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(n){this._logger.debug("cancel api request",n),this.commandRouter.cancel(n)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),mg="sendbird@devicetokens",_g=function(){function e(n){var t=n.type,r=n.token,i=n.device_os,a=n.device_manufacturer,s=n.system_push_enabled;this.type=t,this.token=r,this.deviceOS=i,this.deviceManufacturer=a,this.systemPushEnabled=s}return e.payloadify=function(n){return W(ae({type:n.type,token:n.token,device_os:n.deviceOS,device_manufacturer:n.deviceManufacturer,system_push_enabled:n.systemPushEnabled}))},e}(),gg=new WeakMap,hk=function(e){function n(t){var r=t._iid,i=t.session,a=t.cacheContext,s=t.sdkState,o=t.dispatcher,l=t.requestQueue,u=t.logger,c=t.pushNotificationAckManager,d=e.call(this)||this;return d._currentConnectionStateType=He.INITIALIZED,d._isRefreshingAuthToken=!1,d.currentUser=null,d.session=i,d._iid=r,d._cacheContext=a,d._sdkState=s,d._dispatcher=o,d._requestQueue=l,d._logger=u,d._pushNotificationAckManager=c,d._deviceTokens=[],d._dispatcher.on(function(h){var f,m,y;if(h instanceof Zr){var C=h.stateType;d._currentConnectionStateType=C}else if(h instanceof Mu&&d.handler&&!d.isSessionKeyRefreshing){if(d._currentConnectionStateType===He.CONNECTING)return;!((f=h.error)===null||f===void 0)&&f.isSessionInvalidatedError?d.clear():(!((m=h.error)===null||m===void 0)&&m.isSessionTokenExpiredError&&d.refreshAuthToken().catch(function(b){if(fr(b)&&d._sdkState.appState==="foreground")throw b}),!((y=h.error)===null||y===void 0)&&y.isSessionKeyExpiredError&&(d._logger.debug("session expired"),d.handler.onSessionExpired&&d.handler.onSessionExpired(),d._currentConnectionStateType===He.CONNECTED&&d._dispatcher.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:re.SESSION_KEY_EXPIRED,error_description:"cause=session_expired"}}))),d.refreshSessionKey().catch(function(b){if(fr(b)&&d._sdkState.appState==="foreground")throw b})))}}),d}return T(n,e),Object.defineProperty(n.prototype,"ekey",{get:function(){return gg.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),n.prototype.indexOfDeviceToken=function(t,r){return this._deviceTokens.findIndex(function(i){return i.type===t&&i.token===r})},n.prototype.hasDeviceToken=function(t,r){return this.indexOfDeviceToken(t,r)>=0},n.prototype.createRefreshWebsocketCommand=function(t,r){return new HO({authToken:t,expiringSession:!0,requestId:r})},n.prototype._refreshSessionKeyByWebSocket=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return r=this.createRefreshWebsocketCommand(t),[4,this._requestQueue.forceSend(r)];case 1:if(i=l.sent(),a=i.as(BO),s=a.newKey,o=a.error)throw o;return this.session.sessionKey=s??this.session.sessionKey,[2]}})})},n.prototype._refreshSessionKeyByApi=function(t){return g(this,void 0,void 0,function(){var r,i=this;return _(this,function(a){switch(a.label){case 0:return r=new Sy({userId:this._sdkState.userId,authToken:t,services:this.session.services&&this.session.services.length>0?this.session.services:void 0,expiringSession:!0}),[4,Nm(function(s){return g(i,void 0,void 0,function(){var o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(r)];case 1:return o=h.sent(),l=o.as(qO),u=l.key,c=l.services,this.session.sessionKey=u,this.session.services=c,[3,3];case 2:if(d=h.sent(),!this._isSessionRelatedError(d))throw d;return s(d),[3,3];case 3:return[2]}})})},3)];case 1:return a.sent(),[2]}})})},n.prototype._refreshSessionKey=function(t,r){return r===void 0&&(r=!0),g(this,void 0,void 0,function(){var i,a;return _(this,function(s){switch(s.label){case 0:if(this._currentConnectionStateType!==He.CONNECTED)return[3,8];s.label=1;case 1:return s.trys.push([1,3,,8]),[4,this._refreshSessionKeyByWebSocket(t)];case 2:return s.sent(),this.complete(),[2];case 3:i=s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,this._handleSessionRefreshError(i,r)];case 5:return s.sent(),[2];case 6:return s.sent(),[3,7];case 7:return[3,8];case 8:return s.trys.push([8,10,,12]),[4,this._refreshSessionKeyByApi(t)];case 9:return s.sent(),this.complete(),[3,12];case 10:return a=s.sent(),[4,this._handleSessionRefreshError(a,r)];case 11:return s.sent(),[3,12];case 12:return[2]}})})},n.prototype._receiveNewAuthToken=function(){var t,r=this,i=new ar;if(this._isRefreshingAuthToken=!0,this.session.sessionKey=void 0,this.session.authToken=void 0,(t=this.handler)===null||t===void 0?void 0:t.onSessionTokenRequired){var a=null,s=function(){a&&(clearTimeout(a),a=null)},o=function(u){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.resolve(u))},l=function(u){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.reject(u))};a=setTimeout(function(){return l()},1e3*this._sdkState.sessionTokenRefreshTimeout),he(function(){return g(r,void 0,void 0,function(){var u;return _(this,function(c){return!((u=this.handler)===null||u===void 0)&&u.onSessionTokenRequired&&this.handler.onSessionTokenRequired(o,l),[2]})})})}else i.resolve(null);return i.promise},n.prototype._handleSessionRefreshError=function(t,r){return r===void 0&&(r=!1),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return t instanceof k&&(t.isSessionTokenExpiredError||t.code===re.APPLICATION_NOT_FOUND)?(this.session.authToken=void 0,r?[4,this._receiveNewAuthToken()]:[3,6]):[3,6];case 1:return(i=a.sent())?(this.session.authToken=i,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,3];case 2:return a.sent(),[3,5];case 3:return[4,this.clear()];case 4:a.sent(),a.label=5;case 5:return[2];case 6:throw t}})})},n.prototype._isSessionRelatedError=function(t){return t instanceof k&&(t.isSessionExpiredError||t.isSessionInvalidatedError)},Object.defineProperty(n.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),n.prototype.authenticate=function(t,r){var i;return g(this,void 0,void 0,function(){var a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return this.session.authToken=r,a=0,[4,this._cacheContext.preference.get(kp(this._sdkState.appId))];case 1:return(s=c.sent())&&(a=s.configTs),o=new DA({appId:this._sdkState.appId,userId:t,includeUIKitConfig:!!((i=this._sdkState.extensions)!==null&&i!==void 0?i:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:this.isSessionExpiring,configTs:a}),[4,this._requestQueue.commandRouter.send(o)];case 2:return l=c.sent(),(u=l.as(uk).logi).error?[3,5]:this.session.hasChatServicePermission?[3,4]:[4,u.applyTo(this._iid)];case 3:c.sent(),c.label=4;case 4:return[3,6];case 5:throw u.error;case 6:return[2]}})})},n.prototype.login=function(t){var r;return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return i=t.key,a=t.ekey,s=t.services,o=t.userProfile,l=t.deviceTokenLastDeletedAt,u=l===void 0?0:l,this.session.sessionKey=i,this.session.services=s,gg.set(this,a),this._deviceTokenCacheEnabled=(r=o?.appInfo)===null||r===void 0?void 0:r.deviceTokenCache,c=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,c.get(mg)]:[3,5];case 1:return!(d=h.sent())||d.lastDeletedAt<u?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=u,[4,this.saveDeviceToken()]):[3,3];case 2:return h.sent(),[3,4];case 3:this._deviceTokens=d.tokens.map(function(f){return new _g(_g.payloadify(f))}),this._deviceTokenLastDeletedAt=d.lastDeletedAt,h.label=4;case 4:return[3,7];case 5:return[4,c.remove(mg)];case 6:h.sent(),h.label=7;case 7:return[2]}})})},n.prototype.complete=function(){var t=this;this.dispatch("refresh"),this._dispatcher.dispatch(new TA),he(function(){return g(t,void 0,void 0,function(){var r;return _(this,function(i){return this._logger.debug("session refreshed"),!((r=this.handler)===null||r===void 0)&&r.onSessionRefreshed&&this.handler.onSessionRefreshed(),[2]})})})},n.prototype.error=function(t){var r=this;he(function(){return g(r,void 0,void 0,function(){var i;return _(this,function(a){return!((i=this.handler)===null||i===void 0)&&i.onSessionError&&this.handler.onSessionError(t),[2]})})})},n.prototype.close=function(){var t=this;this.dispatch("close"),this._dispatcher.dispatch(new wA),he(function(){return g(t,void 0,void 0,function(){var r;return _(this,function(i){return this._logger.debug("session closed"),!((r=this.handler)===null||r===void 0)&&r.onSessionClosed&&this.handler.onSessionClosed(),[2]})})})},n.prototype.refreshAuthToken=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:if(t=null,!this.isSessionExpiring||this.session.isRefreshing)return[3,9];this.session.isRefreshing=!0,i.label=1;case 1:return i.trys.push([1,7,8,9]),[4,this._receiveNewAuthToken()];case 2:return(t=i.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=t,[4,this._refreshSessionKey(this.session.authToken)]):[3,4];case 3:return i.sent(),[3,6];case 4:return[4,this.clear()];case 5:i.sent(),i.label=6;case 6:return[3,9];case 7:throw i.sent(),r=t?k.sessionTokenRefreshFailed:k.sessionTokenRequestFailed,this._dispatcher.dispatch(new Vv),this.error(r),this._logger.debug("refresh auth token error = ",r),r;case 8:return this.session.isRefreshing=!1,[7];case 9:return[2]}})})},n.prototype.refreshSessionKey=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:if(!this.isSessionExpiring||this.session.isRefreshing)return[3,5];this.session.isRefreshing=!0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this._refreshSessionKey(this.session.authToken)];case 2:return r.sent(),[3,5];case 3:throw r.sent(),t=k.sessionTokenRefreshFailed,this._dispatcher.dispatch(new Vv),this.error(t),t;case 4:return this.session.isRefreshing=!1,[7];case 5:return[2]}})})},n.prototype.setDeviceToken=function(t,r,i){if(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(t,r)<0){var a=new _g({type:t,token:r,device_os:i?.deviceOS,device_manufacturer:i?.deviceManufacturer,system_push_enabled:i?.systemPushEnabled});return this._deviceTokens.push(a),!0}return!1},n.prototype.unsetDeviceToken=function(t,r){if(this._deviceTokenCacheEnabled){var i=this.indexOfDeviceToken(t,r);i>=0&&this._deviceTokens.splice(i,1)}},n.prototype.unsetDeviceTokens=function(t){this._deviceTokenCacheEnabled&&(this._deviceTokens=t?this._deviceTokens.filter(function(r){return r.type!==t}):[])},n.prototype.setDeviceTokenDeletedAt=function(t){t>0&&(this._deviceTokenLastDeletedAt=t)},n.prototype.saveDeviceToken=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(mg,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),gg.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return t.sent(),this._pushNotificationAckManager.clear(),[2]}})})},n}(Sl),kA=function(e,n){var t,r;if(e!==null&&n!==null){var i=Object.keys(e),a=Object.keys(n),s=ce([],ne(new Set(ce(ce([],ne(i),!1),ne(a),!1))),!1),o={};try{for(var l=K(s),u=l.next();!u.done;u=l.next()){var c=u.value,d=typeof e[c],h=typeof n[c];d==="undefined"?o[c]=n[c]:h==="undefined"?o[c]=e[c]:d!==h?o[c]=n[c]:d==="object"&&e[c]&&n[c]?o[c]=kA(e[c],n[c]):o[c]=n[c]}}catch(f){t={error:f}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}return o}return n};(function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"})(gt||(gt={})),function(e){e.DAILY="daily",e.DEFAULT="default",e.REALTIME="realtime"}(I1||(I1={}));var Lp,Mm=100,xy=function(){function e(n){var t=n.deviceId,r=n.cacheContext,i=n.requestQueue;this.queue=[],this.flushWaitQueue=[],this.enabledState=gt.PENDING,this.isFlushing=!1,this._sentLogStats=[],this.deviceId=t,this.cacheContext=r,this.requestQueue=i,this.logInfo={deviceId:t,statLogs:[],generation:1,lastFlushedAt:0},this.limit=Mm}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.enabledState===gt.ENABLED},enumerable:!1,configurable:!0}),e.prototype.init=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this.key=n,[4,this.cacheContext.preference.get(this.key)];case 1:return(t=r.sent())&&(this.logInfo=t),[2]}})})},e.prototype._mergeQueue=function(){this.flushWaitQueue.length>0&&(this.queue=this.queue.concat(this.flushWaitQueue),this.flushWaitQueue=[])},e.prototype._isDuplicateStat=function(n){var t=this._sentLogStats.find(function(r){var i;return r.channelUrl===n.data.channel_url&&r.messageId===((i=n.data.notificationId)!==null&&i!==void 0?i:n.data.message_id)&&r.action===n.data.action});return t||this._sentLogStats.push({channelUrl:n.data.channel_url,messageId:n.data.message_id,action:n.data.action}),!!t},e.prototype._save=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=ce(ce([],ne(this.queue),!1),ne(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.logInfo.deviceId,statLogs:n.map(function(r){return ut.payloadify(r)}),generation:this.logInfo.generation++,lastFlushedAt:this.logInfo.lastFlushedAt})];case 1:return t.sent(),[2]}})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(n){return this.queue=[],this.flushWaitQueue=[],this.logInfo.generation=1,this._save(),[2]})})},e}(),Bd=function(e){function n(t){var r,i,a,s,o=t.type,l=t.data,u=t.ts,c=u===void 0?Date.now():u,d=e.call(this,{type:o,data:l,ts:c})||this;return d.date=new Date(c),d.key="".concat((r=d.date,i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0"),"".concat(i).concat(a).concat(s)),"_").concat(o),d}return T(n,e),n}(ut),RA=function(e){function n(t){var r=t.deviceId,i=t.statLogs,a=e.call(this)||this;return a.method=z.POST,a.path="".concat(RO),a.params={device_id:r,log_entries:i.map(function(s){return ut.payloadify(s)})},a}return T(n,e),n}(H),fk=function(e){function n(t){var r=t.deviceId,i=t.cacheContext,a=t.requestQueue;return e.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return T(n,e),Object.defineProperty(n.prototype,"_isSendable",{get:function(){return this.queue.length!==0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.init.call(this,t+".daily")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return new ut({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},n.prototype.setConfig=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this.statConfig=t,this.statConfig.minInterval=864e5,this._mergeQueue(),r.localCacheStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=gt.DISABLED,[4,this.clear()];case 2:l.sent(),l.label=3;case 3:return this.isEnabled&&this._isSendable?[4,this._getUploadStats()]:[3,9];case 4:i=l.sent(),a=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),s=0,l.label=5;case 5:return s<i.length?(o=i.slice(s,1+this.statConfig.maxStatCountPerRequest),[4,tr(a)]):[3,9];case 6:return l.sent(),[4,this._flush(o)];case 7:l.sent(),l.label=8;case 8:return s+=this.statConfig.maxStatCountPerRequest,[3,5];case 9:return[2]}})})},n.prototype.put=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:(r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,i=ne(r.filter(function(l){return l instanceof Bd&&l.key===t.key}),1),(a=i[0])?a.data=kA(a.data,t.data):r.push(t),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]);case 1:o.sent(),o.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable?[4,this._getUploadStats()]:[3,5]):[3,5];case 3:return s=o.sent(),[4,this._flush(s)];case 4:return[2,o.sent()];case 5:return[2,!0]}})})},n.prototype._getUploadStats=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){return t=this.queue.filter(function(i){if(i instanceof Bd){var a=new Date,s=ne([i.date.getFullYear(),a.getFullYear()],2),o=s[0],l=s[1];if(o<l)return!0;if(o===l){var u=ne([i.date.getMonth(),a.getMonth()],2),c=u[0],d=u[1];if(c<d)return!0;if(c===d){var h=ne([i.date.getDate(),a.getDate()],2);return h[0]<h[1]}}}return!1}),[2,t]})})},n.prototype._flush=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:if(r=!0,!(t.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,o.label=1;case 1:return o.trys.push([1,4,8,9]),i=ce([],ne(t),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new RA({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return o.sent(),this.queue=ce([],ne(t),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return o.sent(),[3,9];case 4:return(s=o.sent())instanceof k?s.code!==re.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return o.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===re.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),o.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,o.label=11;case 11:return[2,r]}})})},n}(xy),pk=function(e){function n(t){var r=t.deviceId,i=t.cacheContext,a=t.requestQueue;return e.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return T(n,e),n.prototype._isSendable=function(t){if(t===void 0&&(t=!1),this.queue.length<this.statConfig.lowerThreshold)return!1;if(t){if(Date.now()-this.logInfo.lastFlushedAt<this.statConfig.minInterval)return!1}else if(this.queue.length<this.statConfig.minStatCount)return!1;return!0},n.prototype._filterQueueByType=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return[2,r?t.filter(function(a){return a.type!==Ze.FEATURE_LOCALCACHE_EVENT}):t.filter(function(a){return a.type===Ze.FEATURE_LOCALCACHE_EVENT})]})})},n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.init.call(this,t+".default")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return i.data=N({message_init_policy:"",starting_point:0},i.data),new ut({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},n.prototype.setConfig=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this.statConfig=t,this._mergeQueue(),r.requestStat||r.localCacheStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,i=void 0,r.requestStat||(i=!1),r.localCacheStat||(i=!0),i===void 0?[3,3]:(a=this,[4,this._filterQueueByType(this.queue,i)])):[3,4];case 1:return a.queue=l.sent(),s=this,[4,this._filterQueueByType(this.flushWaitQueue,i)];case 2:s.flushWaitQueue=l.sent(),this._save(),l.label=3;case 3:return[3,6];case 4:return this.enabledState=gt.DISABLED,[4,this.clear()];case 5:l.sent(),l.label=6;case 6:return this.isEnabled&&this._isSendable(!0)?(o=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,tr(o)]):[3,9];case 7:return l.sent(),[4,this._flush(this.queue)];case 8:l.sent(),l.label=9;case 9:return[2]}})})},n.prototype.put=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:((r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue).push(t),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]);case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable()?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},n.prototype._flush=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:if(r=!0,!(t.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,o.label=1;case 1:return o.trys.push([1,4,8,9]),i=ce([],ne(t),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new RA({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return o.sent(),this.queue=ce([],ne(t),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return o.sent(),[3,9];case 4:return(s=o.sent())instanceof k?s.code!==re.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return o.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===re.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),o.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,o.label=11;case 11:return[2,r]}})})},n}(xy),mk=function(e){function n(t){var r=t.deviceId,i=t.statLogs,a=e.call(this)||this;return a.method=z.POST,a.path="".concat(UO),a.params={device_id:r,log_entries:i.map(function(s){return ut.payloadify(s)})},a}return T(n,e),n}(H),_k=function(e){function n(t){var r=t.deviceId,i=t.cacheContext,a=t.requestQueue;return e.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return T(n,e),Object.defineProperty(n.prototype,"_isSendable",{get:function(){return this.queue.length>=this.statConfig.minStatCount&&this.queue.length>this.statConfig.lowerThreshold||this.logInfo.lastFlushedAt>0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.init.call(this,t+".realtime")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){var a;return i.data=W(N(N({},i.data),{message_id:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,notificationId:void 0})),new ut({type:i.stat_type,ts:i.ts,data:i.data})}),this._sentLogStats=this.queue.map(function(i){var a;return{channelUrl:i.data.channelUrl,messageId:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,action:i.data.action}}),[2]}})})},n.prototype.setConfig=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return this.statConfig=t,this._mergeQueue(),r.notificationStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=gt.DISABLED,[4,this.clear()];case 2:a.sent(),a.label=3;case 3:return this.isEnabled&&this._isSendable?(i=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,tr(i)]):[3,6];case 4:return a.sent(),[4,this._flush(this.queue)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},n.prototype.put=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:(r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,this._isDuplicateStat(t)?[2,!0]:(r.push(t),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]));case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this.isEnabled&&this._isSendable?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},n.prototype._flush=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:if(r=!0,!(t.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,o.label=1;case 1:return o.trys.push([1,4,8,9]),i=ce([],ne(t),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new mk({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return o.sent(),this.queue=ce([],ne(t),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return o.sent(),[3,9];case 4:return(s=o.sent())instanceof k?s.code!==re.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return o.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===re.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),o.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,o.label=11;case 11:return[2,r]}})})},n}(xy),gk=function(){function e(n){var t=n.cacheContext,r=n.requestQueue,i=n.dispatcher,a=n.logger;this._collectRequestStat=!0,this._collectFeatureLocalCacheStat=!0,this._collectionNotificationStat=!0,this._retryCount=0,this.deviceId=Wr(),this.cacheContext=t,this.requestQueue=r,this.dispatcher=i,this.logger=a,this._dailyStatCollector=new fk({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._defaultStatCollector=new pk({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._notificationStatCollector=new _k({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue})}return e.prototype._migration=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return[4,this.cacheContext.preference.get(this.key)];case 1:return(n=a.sent())?(t=[],n.statLogs.forEach(function(s){s.stat_type===Ze.FEATURE_LOCALCACHE&&t.push(new ut({type:s.stat_type,ts:s.ts,data:s.data}))}),[4,this.cacheContext.preference.set(this.key+".daily",{deviceId:n.deviceId,statLogs:t.map(function(s){return ut.payloadify(s)}),generation:n.generation,lastFlushedAt:n.lastFlushedAt})]):[3,6];case 2:return a.sent(),r=[],n.statLogs.forEach(function(s){s.stat_type!==Ze.FEATURE_LOCALCACHE&&s.stat_type!==Ze.NOTIFICATION&&(s.stat_type===Ze.FEATURE_LOCALCACHE_EVENT&&(s.data=N({message_init_policy:"",starting_point:0},s.data)),r.push(new ut({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".default",{deviceId:n.deviceId,statLogs:r.map(function(s){return ut.payloadify(s)}),generation:n.generation,lastFlushedAt:n.lastFlushedAt})];case 3:return a.sent(),i=[],n.statLogs.forEach(function(s){var o;s.stat_type===Ze.NOTIFICATION&&(s.data=W(N(N({},s.data),{message_id:(o=s.data.notificationId)!==null&&o!==void 0?o:s.data.message_id,notificationId:void 0})),i.push(new ut({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".realtime",{deviceId:n.deviceId,statLogs:i.map(function(s){return ut.payloadify(s)}),generation:n.generation,lastFlushedAt:n.lastFlushedAt})];case 4:return a.sent(),[4,this.cacheContext.preference.remove(this.key)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},e.prototype.init=function(n){return g(this,void 0,void 0,function(){var t=this;return _(this,function(r){switch(r.label){case 0:return this.key=n,[4,this._migration()];case 1:return r.sent(),[4,this._dailyStatCollector.init(this.key)];case 2:return r.sent(),[4,this._defaultStatCollector.init(this.key)];case 3:return r.sent(),[4,this._notificationStatCollector.init(this.key)];case 4:return r.sent(),this.commandEventContext||(this.commandEventContext=this.dispatcher.on(function(i){return g(t,void 0,void 0,function(){var a,s,o,l,u,c;return _(this,function(d){return i instanceof za?(a=i.statLog,this.put(a)):i instanceof NA&&(s=i.request,o=i.features,l=i.options,u=i.statConfigInfo,this._retryCount=0,this._collectRequestStat=s,this._collectFeatureLocalCacheStat=o?.localCache,this._collectionNotificationStat=o?.notification,this._statConfig=u,this._dailyStatCollector.setConfig(this._statConfig.default,{localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:l.ingestion}),this._defaultStatCollector.setConfig(this._statConfig.default,{requestStat:this._collectRequestStat,localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:l.ingestion}),this._notificationStatCollector.setConfig((c=this._statConfig.realTime)!==null&&c!==void 0?c:this._statConfig.default,{notificationStat:this._collectionNotificationStat,enabledStat:l.ingestion})),[2]})})})),[2]}})})},e.prototype.put=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return t=!0,n instanceof Bd?this._collectFeatureLocalCacheStat?[4,this._dailyStatCollector.put(n)]:[3,2]:[3,3];case 1:t=r.sent(),r.label=2;case 2:return[3,13];case 3:switch(n.type){case Ze.API_RESULT:case Ze.WEBSOCKET_CONNECT:case Ze.WEBSOCKET_DISCONNECT:return[3,4];case Ze.FEATURE_LOCALCACHE:case Ze.FEATURE_LOCALCACHE_EVENT:return[3,7];case Ze.NOTIFICATION:return[3,10]}return[3,13];case 4:return this._collectRequestStat?[4,this._defaultStatCollector.put(n)]:[3,6];case 5:t=r.sent(),r.label=6;case 6:return[3,13];case 7:return this._collectFeatureLocalCacheStat?[4,this._defaultStatCollector.put(n)]:[3,9];case 8:t=r.sent(),r.label=9;case 9:return[3,13];case 10:return this._collectionNotificationStat?[4,this._notificationStatCollector.put(n)]:[3,12];case 11:t=r.sent(),r.label=12;case 12:return[3,13];case 13:return t?this._retryCount=0:(this._retryCount++,this._retryCount>20&&(this._dailyStatCollector.enabledState=gt.COLLECT_ONLY,this._defaultStatCollector.enabledState=gt.COLLECT_ONLY,this._notificationStatCollector.enabledState=gt.COLLECT_ONLY,this.logger.debug(k.statLogUploadLimitExceededError))),[2]}})})},e.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},e}(),vk=function(){function e(n){var t=n.limit,r=t===void 0?5:t;this.workersByKey={},this.limit=r}return e.prototype.run=function(n,t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.workersByKey[n]||(this.workersByKey[n]=[]),this.workersByKey[n].length<this.limit?(this.workersByKey[n].push(t),[4,t()]):[3,2];case 1:return r=i.sent(),this.workersByKey[n].pop(),[2,r];case 2:throw k.tooManyRequests}})})},e.prototype.clear=function(n){this.workersByKey[n]=[]},e}();(function(e){e.DELIVERY_RECEIPT="delivery_receipt",e.PUSH_ACKNOWLEDGEMENT="push_acknowledgement"})(Lp||(Lp={}));var yk=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t._pushAckedCache={},t}return T(n,e),n.prototype.isAcked=function(t,r){var i,a="".concat(t,"_").concat(r);return(i=this._pushAckedCache[a])!==null&&i!==void 0&&i},n.prototype.markAsAcked=function(t,r){var i="".concat(t,"_").concat(r);this._pushAckedCache[i]=!0},n.prototype.clear=function(){I.of(this._iid).logger.debug("clear push acked cache"),this._pushAckedCache={}},n.prototype.parseData=function(t){var r,i,a,s,o=I.of(this._iid).logger,l=t.sendbird;if(typeof l=="string")try{l=JSON.parse(l)}catch{throw o.info("push notification payload does not contain sendbird payload in JSON format."),k.malformedDataError}if(!l||typeof l!="object")throw o.info("push notification payload does not contain sendbird payload in JSON format."),k.malformedDataError;var u=(r=l.push_tracking_id)!==null&&r!==void 0?r:"",c=l.notification_message_id,d=l.notification_channel_key,h=l.notification_template_key,f=l.notification_event_deadline,m=(i=l.session_key)!==null&&i!==void 0?i:{},y=(a=m?.key)!==null&&a!==void 0?a:"",C=(s=m?.topics)!==null&&s!==void 0?s:[];if(typeof u!="string"||u.length===0)throw o.info("push tracking id is not available"),k.malformedDataError;if(typeof c!="string"||c.length===0)throw o.info("message id is not available"),k.malformedDataError;return{pushTrackingId:u,sessionKey:y,sessionTopics:C,messageId:c,channelKey:d,templateKey:h,notificationEventDeadline:f}},n}(Wt),gu=function(e){this.name=e.name,this._custom=e.custom,this._usedByModerationEngine=e.used_by_moderation_engine},bk=function(e){function n(){var t=e.call(this)||this;return t.method=z.GET,t.path=FO,t}return T(n,e),n}(H),Ek=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.reportCategories=r.categories,i}return T(n,e),n}(j),Ck=function(e){function n(t){var r=e.call(this,t)||this;return r._categories=[],r}return T(n,e),n.prototype.categories=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this._categories.length!==0?[3,2]:[4,this._fetchCategories()];case 1:t.sent(),t.label=2;case 2:return[2,this._categories]}})})},n.prototype._fetchCategories=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid).requestQueue,r=new bk,[4,t.send(r)];case 1:return i=o.sent(),(a=i.as(Ek).reportCategories)&&(s=this._categories).push.apply(s,ce([],ne(a.map(function(l){return new gu(l)})),!1)),[2]}})})},n}(Wt),Sk=function(){function e(){this._enabledRequestDedup=!0,this._requestCache=new Map,this._requestDedupInterval=500}return Object.defineProperty(e.prototype,"requestDedupInterval",{set:function(n){this._requestDedupInterval=n,this._requestDedupInterval<=0?this._enabledRequestDedup=!1:n<50&&(this._requestDedupInterval=50)},enumerable:!1,configurable:!0}),e.prototype.normalizePath=function(n){return n.replace("/v3/sdk/","/v3/")},e.prototype._generateCacheKey=function(n){var t=n.path,r=n.time,i=n.params,a=this.normalizePath(t),s=i?Object.entries(i).sort(function(l,u){var c=ne(l,1)[0],d=ne(u,1)[0];return c.localeCompare(d)}).map(function(l){var u=ne(l,2),c=u[0],d=u[1];return"".concat(c,"=").concat(JSON.stringify(d))}).join("&"):"",o=r?"_".concat(r):"";return"".concat(a,"?").concat(s).concat(o)},e.prototype.requestGetChannel=function(n,t,r,i){var a,s,o=this;if(i===void 0&&(i=!0),!this._enabledRequestDedup)return t();var l=Date.now(),u=this._generateCacheKey({path:n,params:r});if(i)try{for(var c=K(this._requestCache.entries()),d=c.next();!d.done;d=c.next()){var h=ne(d.value,2),f=h[0],m=h[1];if(f.startsWith(u)&&l-m.requestTime<=this._requestDedupInterval)return m.pendingResponse?Promise.resolve(m.pendingResponse):m.promise}}catch(v){a={error:v}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}var y=i?this._generateCacheKey({path:n,time:l,params:r}):u,C=t().then(function(v){var E=o._requestCache.get(y);return E&&(E.pendingResponse=v,E.responseTime=Date.now()),Promise.resolve(v)}).catch(function(v){return Promise.reject(v)}).finally(function(){setTimeout(function(){o._requestCache.delete(y)},o._requestDedupInterval)}),b={requestTime:l,responseTime:null,promise:C,pendingResponse:null};return this._requestCache.set(y,b),C},e.prototype.updatePendingResponse=function(n,t){var r,i;try{for(var a=K(this._requestCache.entries()),s=a.next();!s.done;s=a.next()){var o=ne(s.value,2),l=o[0],u=o[1];if(l.includes(n.url)&&u.pendingResponse&&u.responseTime<t){var c=u.pendingResponse.payload,d=n.constructor.payloadify(n,!0),h=N(N({},c),d);u.pendingResponse=new j(n._iid,h);break}}}catch(f){r={error:f}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},e}(),vo={},I=function(){function e(n,t){var r,i,a,s,o,l,u,c,d;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!vo[n]){vo[n]=this;var h=(r=t.options)!==null&&r!==void 0?r:new K2,f=this.sdkState={appId:t.appId,appVersion:(i=t.appVersion)!==null&&i!==void 0?i:"",appState:"foreground",userId:void 0,extensions:{},api:{host:(a=t.apiHost)!==null&&a!==void 0?a:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:(s=t.websocketHost)!==null&&s!==void 0?s:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new MA,responseTimeout:h.websocketResponseTimeout},sessionTokenRefreshTimeout:h.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var m=this.logger=t.logger;this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var y=this.cacheContext=new SO({encryption:t.encryption,store:t.store,localCacheEnabled:(o=t.localCacheEnabled)!==null&&o!==void 0&&o,localCacheConfig:(l=t.localCacheConfig)!==null&&l!==void 0?l:new Y2});this.debugMode=(u=t.debugMode)!==null&&u!==void 0&&u,this.maxSuperGroupChannelUnreadCount=zs.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=h.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=h.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=h.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var C=this.dispatcher=new AO,b=new wO;this.requestQueue=new dk(n,{session:b,sdkState:f,dispatcher:C,logger:m,useFetchCompat:t.useFetchCompat}),this.pushNotificationAckManager=new yk(n),this.sessionManager=new hk({_iid:n,session:b,cacheContext:y,sdkState:f,dispatcher:C,requestQueue:this.requestQueue,logger:m,pushNotificationAckManager:this.pushNotificationAckManager}),this.connectionManager=new ak(n,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:C,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:(c=t.disableWebSocketCloseEventHandling)!==null&&c!==void 0&&c,logger:m}),this.statManager=new gk({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:this.dispatcher,logger:m}),this.appStateToggleEnabled=(d=t.appStateToggleEnabled)===null||d===void 0||d,this.messageBackgroundSyncThrottleController=new vk({limit:5}),this.reportCategoryManager=new Ck(n),this.requestDeduplicator=new Sk}return vo[n]}return e.of=function(n){if(vo[n])return vo[n];throw k.lostInstance},e.clear=function(n){vo[n]&&delete vo[n]},e.prototype.hasExtension=function(n){return this.sdkState.extensions&&this.sdkState.extensions[n]},e}(),xm=function(){function e(){}return e.prototype.init=function(n,t){var r=t.sdkState,i=t.dispatcher,a=t.sessionManager,s=t.requestQueue,o=t.logger;t.onlineDetector;var l=t.cacheContext;this._iid=n,this._cacheContext=l,this._sdkState=r,this._dispatcher=i,this._sessionManager=a,this._requestQueue=s,this._logger=o},e}(),Xa=function(){function e(n,t){var r;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=n,this.limit=(r=t.limit)!==null&&r!==void 0?r:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return x("number",this.limit)&&this.limit>0},e}(),P;(function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",e.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",e.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",e.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",e.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",e.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",e.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.REFRESH_CHANNEL="REFRESH_CHANNEL",e.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",e.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",e.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_THREAD_INFO_UPDATED="EVENT_THREADINFO_UPDATED",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.EVENT_CHANNEL_CSAT_SUBMITTED="EVENT_CHANNEL_CSAT_SUBMITTED",e.EVENT_CHANNEL_CONVERSATION_HANDEDOFF="EVENT_CHANNEL_CONVERSATION_HANDEDOFF",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"})(P||(P={}));var Ou;N({},P);var Na=function(e){return e.startsWith("EVENT_")||e.startsWith("LOCAL_MESSAGE_")||e===P.SYNC_MESSAGE_FILL||e===P.SYNC_MESSAGE_CHANGELOGS||e===P.SYNC_POLL_CHANGELOGS},_t=function(e){function n(t){var r=t.messages,i=t.source,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=e.call(this)||this;return o.messages=r,o.source=i,o.isWebSocketEventComing=s,o}return T(n,e),n}(st),Oy=function(e){function n(t){var r=t.messageIds,i=t.source,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=e.call(this)||this;return o.messageIds=r,o.source=i,o.isWebSocketEventComing=s,o}return T(n,e),n}(st),UA=function(e){function n(t){var r=t.messageDeletionTimestamp,i=t.channelUrl,a=t.source,s=e.call(this)||this;return s.messageDeletionTimestamp=r,s.channelUrl=i,s.source=a,s}return T(n,e),n}(st),LA=function(e){function n(t){var r=t.event,i=t.source,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=e.call(this)||this;return o.event=r,o.source=i,o.isWebSocketEventComing=s,o}return T(n,e),n}(st),PA=function(e){function n(t){var r=t.event,i=t.source,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=e.call(this)||this;return o.event=r,o.source=i,o.isWebSocketEventComing=s,o}return T(n,e),n}(st),FA=function(e){function n(t){var r=t.reqId,i=t.source,a=e.call(this)||this;return a.reqId=r,a.source=i,a}return T(n,e),n}(st),$A=function(e){function n(t){var r=t.polls,i=t.source,a=e.call(this)||this;return a.polls=r,a.source=i,a}return T(n,e),n}(st),zA=function(e){function n(t){var r=t.event,i=t.source,a=e.call(this)||this;return a.event=r,a.source=i,a}return T(n,e),n}(st),Dy=function(e){function n(t){var r=t.event,i=t.source,a=e.call(this)||this;return a.event=r,a.source=i,a}return T(n,e),n}(st);(function(e){e.OPEN="open",e.CLOSED="closed"})(Ou||(Ou={}));var Tk="removed",Qv=function(e){switch(e){case"open":return Ou.OPEN;case"closed":return Ou.CLOSED;default:return null}},HA=function(e){return!e||!!e.text&&x("string",e.text)},Lf=function(e){function n(t,r){var i,a,s,o,l,u,c,d=this;return(d=e.call(this,t)||this).pollId=0,d.id=0,d.text=null,d.voteCount=0,d.createdBy=null,d.createdAt=0,d.updatedAt=0,d._lastVotedAt=0,d.pollId=(i=r.poll_id)!==null&&i!==void 0?i:0,d.id=(a=r.id)!==null&&a!==void 0?a:0,d.text=(s=r.text)!==null&&s!==void 0?s:null,d.voteCount=(o=r.vote_count)!==null&&o!==void 0?o:0,d.createdBy=(l=r.created_by)!==null&&l!==void 0?l:null,d.createdAt=(u=r.created_at)!==null&&u!==void 0?u:0,d.updatedAt=(c=r.updated_at)!==null&&c!==void 0?c:0,d}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})))},n}(Wt),bi=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b=this;return(b=e.call(this,t)||this).id=0,b.title=null,b.createdAt=0,b.updatedAt=0,b.closeAt=-1,b.status=Ou.CLOSED,b.messageId=0,b.data=null,b.voterCount=-1,b.options=[],b.createdBy=null,b.allowUserSuggestion=!1,b.allowMultipleVotes=!1,b.votedPollOptionIds=[],b.id=(i=r.id)!==null&&i!==void 0?i:0,b.title=(a=r.title)!==null&&a!==void 0?a:null,b.createdAt=(s=r.created_at)!==null&&s!==void 0?s:0,b.updatedAt=(o=r.updated_at)!==null&&o!==void 0?o:0,b.closeAt=(l=r.close_at)!==null&&l!==void 0?l:-1,b.status=(u=Qv(r.status))!==null&&u!==void 0?u:Ou.CLOSED,b.messageId=(c=r.message_id)!==null&&c!==void 0?c:0,b.data=(d=r.data)!==null&&d!==void 0?d:null,b.voterCount=(h=r.voter_count)!==null&&h!==void 0?h:-1,b.options=r.options?r.options.map(function(v){return new Lf(b._iid,v)}):[],b.createdBy=(f=r.created_by)!==null&&f!==void 0?f:null,b.allowUserSuggestion=(m=r.allow_user_suggestion)!==null&&m!==void 0&&m,b.allowMultipleVotes=(y=r.allow_multiple_votes)!==null&&y!==void 0&&y,b.votedPollOptionIds=(C=r.voted_option_ids)!==null&&C!==void 0?C:[],b}return T(n,e),n.prototype._applyPollUpdatePayload=function(t){var r,i,a,s,o,l,u,c,d=this;this.title=(r=t.title)!==null&&r!==void 0?r:this.title,this.updatedAt=(i=t.updated_at)!==null&&i!==void 0?i:this.updatedAt,this.closeAt=(a=t.close_at)!==null&&a!==void 0?a:this.closeAt,this.status=(s=Qv(t.status))!==null&&s!==void 0?s:this.status,this.data=(o=t.data)!==null&&o!==void 0?o:this.data,this.voterCount=(l=t.voter_count)!==null&&l!==void 0?l:this.voterCount,t.options&&(this.options=t.options.map(function(h){return new Lf(d._iid,h)}),this.votedPollOptionIds=t.options.filter(function(h){return h.vote_count>0}).map(function(h){return h.id})),this.allowUserSuggestion=(u=t.allow_user_suggestion)!==null&&u!==void 0?u:this.allowUserSuggestion,this.allowMultipleVotes=(c=t.allow_multiple_votes)!==null&&c!==void 0?c:this.allowMultipleVotes},n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map(function(r){return Lf.payloadify(r)}),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})))},n.prototype.applyPollUpdateEvent=function(t){var r=t._payload.poll;return!(!r||this.id!==r.id||r.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(r),!0)},n.prototype.applyPollVoteEvent=function(t){if(this.id!==t.pollId)return!1;var r=this.options,i=r.map(function(o){return o.id}),a=t._payload,s=Math.floor(a.ts/1e3);return a.updated_vote_counts.forEach(function(o){var l=i.indexOf(o.option_id);if(l>-1){var u=r[l];s>=u._lastVotedAt&&(u.voteCount=o.vote_count,u._lastVotedAt=s)}}),a.req_id&&a.voted_option_ids&&(this.votedPollOptionIds=a.voted_option_ids),typeof a.voter_count=="number"&&(this.voterCount=a.voter_count),!0},n.prototype.serialize=function(){return Wu(this)},n}(Wt),Ja=function(e){function n(t,r,i,a){var s=e.call(this,t,a)||this;return s.channelUrl=r,s.channelType=i,s}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("string",this.channelUrl)&&be(Pe,this.channelType)},n}(Xa),wk=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e},Ak=function(e){function n(t){var r=t.title,i=t.optionTexts,a=t.data,s=t.allowUserSuggestion,o=t.allowMultipleVotes,l=t.closeAt,u=e.call(this)||this;return u.method=z.POST,u.path=Gi,u.params={title:r,options:i,data:a,allow_user_suggestion:s,allow_multiple_votes:o,close_at:l},u}return T(n,e),n}(H),Nk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),Ik=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.pollId,s=e.call(this)||this;return s.method=z.GET,s.path="".concat(Gi,"/").concat(encodeURIComponent(a)),s.params={channel_url:r,channel_type:i},s}return T(n,e),n}(H),Mk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),xk=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.pollId,s=t.pollOptionId,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Gi,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s)),o.params={channel_url:r,channel_type:i},o}return T(n,e),n}(H),Ok=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pollOption=new Lf(t,r),i}return T(n,e),n}(j),Dk=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.timestamp,s=t.token,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/polls/changelogs"),o.params=W({change_ts:a,token:s}),o}return T(n,e),n}(H),kk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.updatedPolls=r.updated.map(function(a){return function(s,o){return new bi(s,o)}(t,a)}),i.deletedPollIds=r.deleted.map(function(a){return a}),i.hasMore=r.has_more,i.nextToken=r.next,i}return T(n,e),n}(j),Rk={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},qA=function(e){return x("string",e.title)&&(n=e.optionTexts,Te("string",n)&&n.every(function(t){return t.trim()!==""}))&&HA(e.data)&&x("boolean",e.allowUserSuggestion,!0)&&x("boolean",e.allowMultipleVotes,!0)&&x("number",e.closeAt,!0);var n},Uk={channelUrl:"",channelType:Pe.BASE,pollId:0,pollOptionId:0},BA=function(e){return x("string",e.channelUrl)&&e.channelUrl!==""&&be(Pe,e.channelType)&&x("number",e.pollId)&&e.pollId>0&&x("number",e.pollOptionId)&&e.pollOptionId>0},Lk={channelUrl:"",channelType:Pe.BASE,pollId:0},GA=function(e){return x("string",e.channelUrl)&&e.channelUrl!==""&&be(Pe,e.channelType)&&x("number",e.pollId)},M1={},Pp=function(){function e(n,t){var r=t.sdkState,i=t.dispatcher,a=t.sessionManager,s=t.requestQueue,o=t.logger;this._iid=n,this._sdkState=r,this._sessionManager=a,this._requestQueue=s,this._dispatcher=i,this._logger=o,M1[n]=this}return e.of=function(n){return M1[n]},e.prototype.buildPollFromSerializedData=function(n){var t=Gs(n);return new bi(this._iid,bi.payloadify(t))},e.prototype.get=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return B(GA(n)).throw(k.invalidParameters),t=new Ik(N({},n)),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,r.as(Mk).poll]}})})},e.prototype.create=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return B(qA(n)).throw(k.invalidParameters),t=new Ak(N({},n)),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,r.as(Nk).poll]}})})},e.prototype.getOption=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return B(BA(n)).throw(k.invalidParameters),t=new xk(N({},n)),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,r.as(Ok).pollOption]}})})},e.prototype.getPollChangeLogs=function(n,t,r,i){return i===void 0&&(i=P.SYNC_POLL_CHANGELOGS),g(this,void 0,void 0,function(){var a,s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return a=new Dk(ae({channelType:t,channelUrl:n,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null})),[4,this._requestQueue.send(a)];case 1:return s=h.sent(),o=s.as(kk),l=o.updatedPolls,u=o.deletedPollIds,c=o.hasMore,d=o.nextToken,l.length>0&&this._dispatcher.dispatch(new $A({polls:l,source:i})),[2,{updatedPolls:l,deletedPollIds:u,hasMore:c,token:d}]}})})},e}(),Pk=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.token,s=t.limit,o=e.call(this)||this;return o.method=z.GET,o.path=Gi,o.params={channel_url:r,channel_type:i,token:a,limit:s},o}return T(n,e),n}(H),Fk=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).polls=((i=r.polls)!==null&&i!==void 0?i:[]).map(function(s){return new bi(t,s)}),a.token=r.next,a}return T(n,e),n}(j),VA=function(e){function n(t,r){return e.call(this,t,r.channelUrl,r.channelType,r)||this}return T(n,e),n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new Pk(N(N({},this),{token:this._token})),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(Fk),s=a.polls,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),$k=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.pollId,s=t.pollOptionId,o=t.token,l=t.limit,u=e.call(this)||this;return u.method=z.GET,u.path="".concat(Gi,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s),"/voters"),u.params={channel_url:r,channel_type:i,token:o,limit:l},u}return T(n,e),n}(H),zk=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).voters=((i=r.voters)!==null&&i!==void 0?i:[]).map(function(s){return new xe(t,s)}),a.token=r.next,a}return T(n,e),n}(j),jA=function(e){function n(t,r){var i=e.call(this,t,r.channelUrl,r.channelType,r)||this;return i.pollId=r.pollId,i.pollOptionId=r.pollOptionId,i}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("number",this.pollId)&&x("number",this.pollOptionId)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new $k(N(N({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(zk),s=a.voters,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),sl,es=function(){function e(n,t,r){var i,a;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=n,this.plainUrl=t.url,this.width=t.width,this.height=t.height,this.realWidth=(i=t.real_width)!==null&&i!==void 0?i:t.width,this.realHeight=(a=t.real_height)!==null&&a!==void 0?a:t.height,this._requireAuth=r}return e.payloadify=function(n){return W(ae(n instanceof e?{url:n.plainUrl,width:n.width,height:n.height,real_width:n.realWidth,real_height:n.realHeight}:{url:"",width:n.maxWidth,height:n.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(e.prototype,"url",{get:function(){var n=I.of(this._iid).sessionManager;return this._requireAuth&&n.ekey?"".concat(this.plainUrl,"?auth=").concat(n.ekey):this.plainUrl},enumerable:!1,configurable:!0}),e}(),Fp=function(e){function n(t){var r=e.call(this)||this;if(r.method=z.POST,r.path="".concat(IO),r.params=W({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var i=0;i<t.thumbnailSizes.length;i++){var a=t.thumbnailSizes[i],s=a.maxWidth,o=a.maxHeight;r.params["thumbnail".concat(i+1)]="".concat(s,",").concat(o)}return r.requestId=t.requestId,r}return T(n,e),n}(H),$p=function(e){function n(t,r){var i,a,s,o,l=this;return(l=e.call(this,t,r)||this).url=r.url,l.fileSize=(i=r.file_size)!==null&&i!==void 0?i:0,l.thumbnails=(s=(a=r.thumbnails)===null||a===void 0?void 0:a.map(function(u){return new es(t,u,!1)}))!==null&&s!==void 0?s:[],l.requireAuth=(o=r.require_auth)!==null&&o!==void 0&&o,l}return T(n,e),n}(j),zp=function(e){function n(t,r){var i,a,s,o,l,u=this;return(u=e.call(this,t)||this).replyCount=0,u.memberCount=0,u.lastRepliedAt=0,u.updatedAt=0,u.replyCount=(i=r.reply_count)!==null&&i!==void 0?i:0,u.memberCount=(a=r.member_count)!==null&&a!==void 0?a:0,u.mostRepliedUsers=r.most_replies&&Te("object",r.most_replies)?r.most_replies.map(function(c){return new xe(u._iid,c)}):[],u.unreadReplyCount=(s=r.unread_message_count)!==null&&s!==void 0?s:0,u.isPushNotificationEnabled=typeof r.push_enabled=="number"?r.push_enabled>0:void 0,u.lastRepliedAt=(o=r.last_replied_at)!==null&&o!==void 0?o:0,u.updatedAt=(l=r.updated_at)!==null&&l!==void 0?l:0,u}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{reply_count:t.replyCount,unread_message_count:t.unreadReplyCount,member_count:t.memberCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map(function(r){return xe.payloadify(r)}):[],push_enabled:typeof t.isPushNotificationEnabled=="boolean"?t.isPushNotificationEnabled?1:0:void 0,last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})))},Object.defineProperty(n.prototype,"_isUpdateRequired",{get:function(){return this.unreadReplyCount===void 0||this.isPushNotificationEnabled===void 0},enumerable:!1,configurable:!0}),n.prototype._updateFrom=function(t){var r,i;this.unreadReplyCount=(r=t.unreadReplyCount)!==null&&r!==void 0?r:this.unreadReplyCount,this.isPushNotificationEnabled=(i=t.isPushNotificationEnabled)!==null&&i!==void 0?i:this.isPushNotificationEnabled},n}(Wt);(function(e){e.ADD="add",e.DELETE="delete"})(sl||(sl={}));var x1,ky=function(e){var n;this.messageId=0,this.operation=null,this.updatedAt=0;var t=x("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,r=e.user_id,i=e.operation?e.operation.toLowerCase():null,a=e.reaction,s=e.updated_at,o=e.count,l=e.sampled_user_ids,u=(n=e.sampled_user_info)!==null&&n!==void 0?n:{};t&&x("string",r)&&x("string",i)&&be(sl,i)&&x("string",a)&&a&&x("number",s)&&(this.messageId=t,this.userId=r,this.key=a,this.operation=i,this.updatedAt=s,this._count=o,this._sampledUserIds=l,this._sampledUserInfoList=u)},vg=function(e){function n(t,r,i){var a,s=this;return(s=e.call(this,t)||this).userId=r,s.nickname=i.nickname,s.plainProfileUrl=i.profile_url,s.requireAuth=(a=i.require_auth_for_profile_image)!==null&&a!==void 0&&a,s}return T(n,e),Object.defineProperty(n.prototype,"profileUrl",{get:function(){var t=I.of(this._iid).sessionManager;return this.requireAuth&&t.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(t.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),n.payloadify=function(t){return{nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth}},n}(Wt),mc=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f=this;(f=e.call(this,t)||this)._sampledUserInfoList=[],f._count=0,f._hasCurrentUserReacted=!1;var m=r.key,y=ce([],ne((o=(s=r.sampled_user_ids)!==null&&s!==void 0?s:r.user_ids)!==null&&o!==void 0?o:[]),!1),C=(u=(l=r.last_ts)!==null&&l!==void 0?l:r.updated_at)!==null&&u!==void 0?u:0,b=(c=r.is_self_included)!==null&&c!==void 0?c:y.includes(I.of(t).sdkState.userId),v=(d=r.sampled_user_info)!==null&&d!==void 0?d:{};x("string",m)&&m&&Te("string",y)&&y.length>0&&x("number",C)&&(f.key=m,f._sampledUserIds=y,f._updatedAt=C,f._count=(h=r.count)!==null&&h!==void 0?h:y.length,f._hasCurrentUserReacted=b,Object.keys(v).forEach(function(A){f._sampledUserInfoList.push(new vg(t,A,v[A]))}));var E={};try{for(var S=K(f.sampledUserIds),w=S.next();!w.done;w=S.next())E[w.value]=f.updatedAt}catch(A){i={error:A}}finally{try{w&&!w.done&&(a=S.return)&&a.call(S)}finally{if(i)throw i.error}}return f._version=E,f}return T(n,e),Object.defineProperty(n.prototype,"isEmpty",{get:function(){return this._count===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"userIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sampledUserIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sampledUserInfoList",{get:function(){return this._sampledUserInfoList},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"updatedAt",{get:function(){return this._updatedAt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasCurrentUserReacted",{get:function(){return this._hasCurrentUserReacted},enumerable:!1,configurable:!0}),n.payloadify=function(t){var r={};return t._sampledUserInfoList.forEach(function(i){r[i.userId]=vg.payloadify(i)}),W(ae({key:t.key,sampled_user_ids:t._sampledUserIds,sampled_user_info:r,count:t._count,is_self_included:t._hasCurrentUserReacted,last_ts:t._updatedAt}))},n.prototype.applyEvent=function(t){var r=this;if(t.key===this.key&&this.updatedAt<=t.updatedAt)if(t._sampledUserIds)this._sampledUserIds=t._sampledUserIds,this._sampledUserInfoList=[],Object.keys(t._sampledUserInfoList).forEach(function(a){r._sampledUserInfoList.push(new vg(r._iid,a,t._sampledUserInfoList[a]))}),this._count=t._count,t._hasCurrentUserReacted!==void 0&&(this._hasCurrentUserReacted=t._hasCurrentUserReacted),this._updatedAt=t.updatedAt;else{if(!this._version[t.userId]||this._version[t.userId]<=t.updatedAt){var i=this._sampledUserIds.indexOf(t.userId);switch(t.operation){case sl.ADD:i<0&&this._sampledUserIds.push(t.userId);break;case sl.DELETE:i>=0&&this._sampledUserIds.splice(i,1)}this._count=this._sampledUserIds.length,this._version[t.userId]=t.updatedAt}this._updatedAt=Math.max(this.updatedAt,t.updatedAt)}},n}(Wt),O1=function(){function e(n){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=n.url,n.secure_url&&(this.secureUrl=n.secure_url),n.type&&(this.type=n.type),n.width&&(this.width=n.width),n.height&&(this.height=n.height),n.alt&&(this.alt=n.alt)}return e.payloadify=function(n){var t,r;return W(ae({url:n.url,secure_url:n.secureUrl,type:n.type,width:(t=n.width)!==null&&t!==void 0?t:0,height:(r=n.height)!==null&&r!==void 0?r:0,alt:n.alt}))},e}(),D1=function(){function e(n){this.title=null,this.url=null,this.description=null,this.defaultImage=null,n["og:title"]&&(this.title=n["og:title"]),n["og:url"]&&(this.url=n["og:url"]),n["og:description"]&&(this.description=n["og:description"]),n["og:image"]&&(this.defaultImage=new O1(n["og:image"]))}return e.payloadify=function(n){return W(ae({"og:title":n.title,"og:url":n.url,"og:description":n.description,"og:image":n.defaultImage?O1.payloadify(n.defaultImage):null}))},e}(),Ei=function(){function e(n){var t,r;this.volume=0,this.name=(t=n.name)!==null&&t!==void 0?t:"default",this.volume=(r=n.volume)!==null&&r!==void 0?r:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(n){return W(ae({name:n.name,volume:n.volume}))},e}();(function(e){e.GOOD="good",e.BAD="bad"})(x1||(x1={}));var As=function(){function e(n){this.id=n.id,this.rating=n.rating,this.comment=n.comment}return e._getStatus=function(n){return n?"id"in n?"SUBMITTED":"NO_FEEDBACK":"NOT_APPLICABLE"},e._isSubmitted=function(n){return e._getStatus(n)==="SUBMITTED"},e._getPayloadByStatus=function(n){return n==="NO_FEEDBACK"?{}:null},e.payloadify=function(n){return W(ae({id:n.id,rating:n.rating,comment:n.comment}))},e}(),Du=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).isBlockedByMe=!1,a.role=be(gi,r.role)?r.role:gi.NONE,a.isBlockedByMe=(i=r.is_blocked_by_me)!==null&&i!==void 0&&i,a}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})))},n}(xe),nr=function(){function e(n){this.key=n.key,this.value=Te("string",n.value)?ce([],ne(n.value),!1):[]}return e.payloadify=function(n){var t;return W(ae({key:n.key,value:(t=n.value)!==null&&t!==void 0?t:[]}))},e}(),QA=function(e){switch(e){case vt.BASE:return"";case vt.USER:return"MESG";case vt.FILE:return"FILE";case vt.ADMIN:return"ADMM"}},KA=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f=this;(f=e.call(this,t)||this).channelType=Pe.BASE,f.messageType=vt.BASE,f.mentionType=null,f.mentionedUsers=null,f.mentionedUserIds=null,f.metaArrays=[],f.extendedMessage={},f.createdAt=0,f.updatedAt=0,f.channelUrl=r.channel_url,f.channelType=be(Pe,r.channel_type)?r.channel_type:Pe.GROUP,r.channel&&(r.channel.channel_url&&(f.channelUrl=r.channel.channel_url),r.channel.channel_type&&(f.channelType=r.channel.channel_type)),f.data=(i=r.data)!==null&&i!==void 0?i:"",f.customType=(a=r.custom_type)!==null&&a!==void 0?a:"",f.mentionType=be($n,r.mention_type)?r.mention_type:null,f.mentionedUsers=r.mentioned_users?r.mentioned_users.map(function(v){return new xe(f._iid,v)}):null,f.mentionedUserIds=(s=r.mentioned_user_ids)!==null&&s!==void 0?s:null,f.mentionedUsers&&!f.mentionedUserIds&&(f.mentionedUserIds=f.mentionedUsers.map(function(v){return v.userId}));var m=(o=r.metaarray)!==null&&o!==void 0?o:{},y=(l=r.metaarray_key_order)!==null&&l!==void 0?l:Object.keys(m).sort(function(v,E){return v.localeCompare(E)});f.metaArrays=[];for(var C=0;C<y.length;C++){var b=y[C];f.metaArrays.push(new nr({key:b,value:m[b]||[]}))}return r.sorted_metaarray&&(f.metaArrays=r.sorted_metaarray.map(function(v){return new nr(v)})),f.extendedMessage=(u=r.extended_message)!==null&&u!==void 0?u:{},f.extendedMessagePayload=r.extended_message_payload,f.createdAt=(d=(c=r.created_at)!==null&&c!==void 0?c:r.ts)!==null&&d!==void 0?d:0,f.updatedAt=(h=r.updated_at)!==null&&h!==void 0?h:0,f}return T(n,e),n.payloadify=function(t){var r,i;return W(ae(N(N({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,type:QA(t.messageType),data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:(r=t.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return xe.payloadify(a)}),sorted_metaarray:(i=t.metaArrays)===null||i===void 0?void 0:i.map(function(a){return nr.payloadify(a)}),extended_message:t.extendedMessage,extended_message_payload:t.extendedMessagePayload,created_at:t.createdAt,updated_at:t.updatedAt})))},n.prototype.isIdentical=function(t){return!0},n.prototype.isEqual=function(t){return Q2(this,t)},n.prototype.isUserMessage=function(){return this.messageType===vt.USER},n.prototype.isFileMessage=function(){return this.messageType===vt.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},n.prototype.isMultipleFilesMessage=function(){return this.messageType===vt.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},n.prototype.isAdminMessage=function(){return this.messageType===vt.ADMIN},n.prototype.serialize=function(){return Wu(this)},n.prototype.getMetaArraysByKeys=function(t){return this.metaArrays.filter(function(r){return t.includes(r.key)})},n}(Wt),WA=function(e){function n(t,r){var i,a,s,o=this;return(o=e.call(this,t)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",o.channelType=(a=r.channel_type)!==null&&a!==void 0?a:Pe.GROUP,o.reader=new xe(o._iid,r.user),o.readAt=r.ts,o.isExcluded=(s=r.is_excluded)!==null&&s!==void 0&&s,o}return T(n,e),n}(Wt),Hk=function(e){function n(t){var r=t.channelUrl;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r}})||this}return T(n,e),n}(sr),qk=function(e){function n(t){var r=e.call(this)||this,i=t.channelUrl,a=t.channelType,s=t.userId,o=t.notificationIds,l=t.messageId,u=t.isExcluded,c=t.uniqueId;return r.method=z.PUT,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/messages/mark_as_read"),r.params=W(ae({user_id:s,message_ids:o,message_id:l,is_excluded:u,unique_id:c})),r}return T(n,e),n}(H),YA=function(e){function n(t,r,i){var a=e.call(this,t,"READ",i)||this;return a.readStatus=new WA(t,i),a}return T(n,e),n}(pt),Bk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.readAt=r.ts,i.unreadMessageCount=r.unread_message_count,i.totalUnreadCount=r.total_unread_count,i.channelUrl=r.channel_url,i.userId=r.user_id,i.isExcluded=r.is_excluded,i.uniqueId=r.unique_id,i}return T(n,e),n}(j),Gk=function(e){function n(t){var r=t.channelUrl,i=t.messageId;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r,parent_message_id:i}})||this}return T(n,e),n}(sr),Vk=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.pushEnabled,o=e.call(this)||this;return o.method=z.PUT,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/thread_push"),o.params={push_enabled:s},o}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var jk=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.rating,o=t.comment,l=e.call(this)||this;return l.method=z.POST,l.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks"),l.params={rating:s,comment:o},l}return T(n,e),n}(H),Qk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.feedback=new As(r),i}return T(n,e),n}(j),Kk=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.feedbackId,o=t.rating,l=t.comment,u=e.call(this)||this;return u.method=z.PUT,u.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),u.params={rating:o,comment:l},u}return T(n,e),n}(H),Wk=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.feedback=new As(r),i}return T(n,e),n}(j),Yk=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.feedbackId,o=e.call(this)||this;return o.method=z.DELETE,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),o}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.feedback=new As(r),i}T(n,e)})(j);var xo,k1,Kv=function(e){function n(t,r){var i,a,s,o,l,u=this;return(u=e.call(this,t)||this).plainUrl="",u.fileName=null,u.mimeType=null,u.fileSize=0,u.thumbnails=[],u._requireAuth=!1,u.plainUrl=(i=r.url)!==null&&i!==void 0?i:"",u.fileName=(a=r.file_name)!==null&&a!==void 0?a:null,u.mimeType=(s=r.file_type)!==null&&s!==void 0?s:null,u.fileSize=(o=r.file_size)!==null&&o!==void 0?o:0,u._requireAuth=(l=r.require_auth)!==null&&l!==void 0&&l,u.thumbnails=r.thumbnails?r.thumbnails.map(function(c){var d;return new es(u._iid,typeof c=="string"?{url:c,width:0,height:0}:N(N({},c),{url:((d=c.url)!==null&&d!==void 0?d:"").split("auth=")[0]}),u._requireAuth)}):[],u}return T(n,e),n.payloadify=function(t){var r;return W(ae({url:t.plainUrl,file_name:t.fileName,file_type:t.mimeType,file_size:t.fileSize,thumbnails:(r=t.thumbnails)===null||r===void 0?void 0:r.map(function(i){var a;return{url:((a=i.plainUrl)!==null&&a!==void 0?a:"").split("auth=")[0],width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),require_auth:t._requireAuth}))},Object.defineProperty(n.prototype,"url",{get:function(){var t=I.of(this._iid).sessionManager;return this._requireAuth&&t.ekey?"".concat(this.plainUrl,"?auth=").concat(t.ekey):this.plainUrl},enumerable:!1,configurable:!0}),n}(Wt),ZA=function(e){var n=e.channelUrl,t=e.channelType,r=e.parentMessage;this.channelUrl=n,this.channelType=t,this.parentMessage=r};(function(e){e.NUMBER="number",e.ENUM="enum",e.TEXT="text",e.REGEX="regex",e.DECIMAL_PLACE="decimal_place"})(xo||(xo={})),function(e){e.TEXT="text",e.TEXTAREA="textarea",e.NUMBER="number",e.PHONE="phone",e.EMAIL="email",e.CHIP="chip"}(k1||(k1={}));var xs,$r,R1=function(){function e(n,t){var r=t.id,i=t.name,a=t.items,s=t.version,o=t.is_submitted;this.messageId=n,this.id=r,this.name=i,this.items=a.map(function(l){return new U1(l)}).sort(function(l,u){return l.sortOrder-u.sortOrder}),this.version=s??1,this._isSubmitted=o}return Object.defineProperty(e.prototype,"isSubmitted",{get:function(){var n;return(n=this._isSubmitted)!==null&&n!==void 0?n:this.items.some(function(t){return Array.isArray(t.submittedValues)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSubmittable",{get:function(){return this.items.every(function(n){return n.required?!!(Array.isArray(n.draftValues)&&n.draftValues.length>0)&&n.isValid(n.draftValues):!(Array.isArray(n.draftValues)&&n.draftValues.length>0)||n.isValid(n.draftValues)})},enumerable:!1,configurable:!0}),e.payloadify=function(n){return W(ae({id:n.id,name:n.name,items:n.items.map(function(t){return U1.payloadify(t)}),version:n.version,is_submitted:n._isSubmitted}))},e.isMessageFormPayload=function(n){return!!n?.message_form},e}(),U1=function(){function e(n){var t=n.id,r=n.name,i=n.required,a=n.sort_order,s=n.placeholder,o=n.style,l=n.item_type,u=n.validators,c=n.value,d=n.values;this.id=t,this.name=r,this.required=i,this.sortOrder=a,this.placeholder=s,Object.keys(o).length===0?this.style={layout:l}:this.style=W({layout:o.layout,options:o.options,defaultOptions:o.default_options,resultCount:o.result_count}),d?this.submittedValues=d:c&&(this.submittedValues=[c]),this._validators=u}return e.prototype.isValid=function(n){var t=this;return n.every(function(r){var i=function(a,s){return s.every(function(o){switch(o.key){case xo.NUMBER:var l=Number(a);return!(isNaN(l)||o.min&&typeof o.min!="number"||o.max&&typeof o.max!="number"||typeof o.min=="number"&&l<o.min||typeof o.max=="number"&&l>o.max);case xo.ENUM:return typeof a=="string"&&(!(o.enums&&Array.isArray(o.enums)&&o.enums.length>0&&!o.enums.includes(a))||o.allow_other);case xo.TEXT:return!(typeof a!="string"||typeof o.min_length=="number"&&a.length<o.min_length||typeof o.max_length=="number"&&a.length>o.max_length);case xo.REGEX:return!(typeof a!="string"||o.regex&&(typeof o.regex!="string"||!new RegExp(o.regex).test(a)));case xo.DECIMAL_PLACE:return a.length!==0&&(l=Number(a),!(isNaN(l)||(!o.max_decimal_place||typeof o.max_decimal_place=="number")&&o.max_decimal_place&&!function(u,c){var d=u.toString(),h=d.indexOf(".");return h===-1||d.slice(h+1).length<=c}(l,o.max_decimal_place)));default:return!0}})}(r,t._validators);return i})},e.payloadify=function(n){return W(ae({id:n.id,name:n.name,required:n.required,sort_order:n.sortOrder,placeholder:n.placeholder,style:W({layout:n.style.layout,options:n.style.options,default_options:n.style.defaultOptions,result_count:n.style.resultCount}),item_type:n.style.layout,validators:n._validators,values:n.submittedValues}))},e}(),Zk=function(e){function n(t){var r=e.call(this)||this;return r.method=z.POST,r.path="".concat(PO,"/").concat(t.formId,"/submit"),r.params=W({message_id:t.messageId,items:t.items}),r}return T(n,e),n}(H);(function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"})(xs||(xs={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}($r||($r={}));var $o,Vn=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f=this;return(f=e.call(this,t,r)||this).parentMessage=null,f.silent=!1,f.isOperatorMessage=!1,f.threadInfo=null,f.reactions=[],f.appleCriticalAlertOptions=null,f.scheduledInfo=null,f.suggestedReplies=null,f.myFeedback=null,f.myFeedbackStatus="NOT_APPLICABLE",f.messageForm=null,f._isContinuousMessages=!1,f._scheduledStatus=null,f._poll=null,f.messageId=(a=(i=r.msg_id)!==null&&i!==void 0?i:r.message_id)!==null&&a!==void 0?a:0,f.parentMessageId=(s=typeof r.parent_message_id=="string"?parseInt(r.parent_message_id):r.parent_message_id)!==null&&s!==void 0?s:0,f.threadInfo=r.thread_info?new zp(f._iid,r.thread_info):null,r.reactions_summary?f.reactions=r.reactions_summary.map(function(m){return new mc(t,m)}):r.reactions?f.reactions=r.reactions.map(function(m){return new mc(t,m)}):f.reactions=[],f.ogMetaData=r.og_tag?new D1(r.og_tag):null,f.silent=(o=r.silent)!==null&&o!==void 0&&o,f.isOperatorMessage=(l=r.is_op_msg)!==null&&l!==void 0&&l,f.appleCriticalAlertOptions=r.apple_critical_alert_options?new Ei(r.apple_critical_alert_options):null,typeof r.scheduled_message_id=="number"&&typeof r.scheduled_at=="number"&&r.scheduled_status&&(f.scheduledInfo={scheduledMessageId:r.scheduled_message_id,scheduledAt:r.scheduled_at},f._scheduledStatus=r.scheduled_status),f._isContinuousMessages=(u=r.is_continuous_messages)!==null&&u!==void 0&&u,f.myFeedback=As._isSubmitted(r.feedback)?new As(r.feedback):null,f.myFeedbackStatus=As._getStatus(r.feedback),f.suggestedReplies=(d=(c=r.extended_message_payload)===null||c===void 0?void 0:c.suggested_replies)!==null&&d!==void 0?d:null,f.messageForm=R1.isMessageFormPayload(r.extended_message_payload)?new R1(f.messageId,r.extended_message_payload.message_form):null,f.message=(h=r.message)!==null&&h!==void 0?h:"",f._poll=r.poll?new bi(f._iid,r.poll):null,f}return T(n,e),n.payloadify=function(t){var r,i;return W(ae(N(N({},e.payloadify.call(this,t)),{message_id:t.messageId,parent_message_id:t.parentMessageId,thread_info:t.threadInfo?zp.payloadify(t.threadInfo):null,reactions_summary:t.reactions.map(function(a){return mc.payloadify(a)}),og_tag:t.ogMetaData?D1.payloadify(t.ogMetaData):null,silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,scheduled_message_id:(r=t.scheduledInfo)===null||r===void 0?void 0:r.scheduledMessageId,scheduled_at:(i=t.scheduledInfo)===null||i===void 0?void 0:i.scheduledAt,scheduled_status:t._scheduledStatus,feedback:t.myFeedback?As.payloadify(t.myFeedback):As._getPayloadByStatus(t.myFeedbackStatus),message:t.message,poll:t._poll?bi.payloadify(t._poll):null})))},n._getParentMessageInfoPayload=function(t){return W(ae({type:QA(t.messageType),ts:t.createdAt,user:t.sender?Du.payloadify(t.sender):null,message:t.message,file:{url:t.plainUrl,name:t.name,type:t.type,require_auth:t.requireAuth},files:Array.isArray(t.fileInfoList)?t.fileInfoList.map(function(r){return Kv.payloadify(r)}):null}))},n.prototype.isIdentical=function(t){return this.messageId===t.messageId},n.prototype.applyThreadInfoUpdateEvent=function(t){return this.messageId===t.targetMessageId&&(t.threadInfo._isUpdateRequired&&this.threadInfo&&t.threadInfo._updateFrom(this.threadInfo),this.threadInfo=t.threadInfo,!0)},n.prototype._findReactionIndex=function(t){for(var r=0;r<this.reactions.length;r++)if(this.reactions[r].key===t)return r;return-1},n.prototype.applyReactionEvent=function(t){var r=I.of(this._iid).sdkState;if(this.messageId===t.messageId)switch(t.operation){case sl.ADD:t.userId===r.userId&&(t._hasCurrentUserReacted=!0),(i=this._findReactionIndex(t.key))!==-1?this.reactions[i].applyEvent(t):t._sampledUserIds?this.reactions.push(new mc(this._iid,{key:t.key,sampled_user_ids:t._sampledUserIds,sampled_user_info:t._sampledUserInfoList,count:t._count,is_self_included:t._hasCurrentUserReacted,last_ts:t.updatedAt})):this.reactions.push(new mc(this._iid,{key:t.key,user_ids:[t.userId],updated_at:t.updatedAt}));break;case sl.DELETE:var i;(i=this._findReactionIndex(t.key))!==-1&&(t._sampledUserIds?t._count===0?this.reactions.splice(i,1):(t.userId===r.userId&&(t._hasCurrentUserReacted=!1),this.reactions[i].applyEvent(t)):(this.reactions[i].applyEvent(t),this.reactions[i].isEmpty&&this.reactions.splice(i,1)))}},n.prototype.applyParentMessage=function(t){if(!this.parentMessage)return this.parentMessage=t,!0;if(this.parentMessageId===t.messageId){var r=this.parentMessage.updatedAt;if(t.updatedAt>=r)return this.parentMessage=t,!0}return!1},n.prototype.applyPoll=function(t){return!(this._poll&&this._poll.id===t.id&&this._poll.updatedAt>t.updatedAt)&&(this._poll=t,!0)},Object.defineProperty(n.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),n.prototype._triggerThreadInfoUpdatedEvent=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){return(t=I.of(this._iid).dispatcher).dispatch(new ZA({channelType:Pe.GROUP,channelUrl:this.channelUrl,parentMessage:this})),t.dispatch(new _t({messages:[this],source:P.EVENT_MESSAGE_THREADINFO_UPDATED})),[2]})})},n.prototype.markThreadAsRead=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=I.of(this._iid).requestQueue,r=new Gk({channelUrl:this.channelUrl,messageId:this.messageId}),[4,t.send(r)];case 1:return i.sent(),this.threadInfo&&this.threadInfo.unreadReplyCount!==0?(this.threadInfo.unreadReplyCount=0,[4,this._triggerThreadInfoUpdatedEvent()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.setPushNotificationEnabled=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return r=I.of(this._iid).requestQueue,i=new Vk({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,pushEnabled:t}),[4,r.send(i)];case 1:return a.sent(),this.threadInfo&&this.threadInfo.isPushNotificationEnabled!==t&&(this.threadInfo.isPushNotificationEnabled=t),[2]}})})},n.prototype.submitMessageForm=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:if(r=I.of(this._iid).requestQueue,i=null,a=null,s=this.messageForm,!t&&s){if(!s.isSubmittable)throw new k({code:re.INVALID_PARAMETER,message:"The form is not submittable. Please check all form items are valid before submitting."});if(s.isSubmitted)throw new k({code:re.INVALID_PARAMETER,message:"The form has already been submitted."});i=s.id,a=s.items.reduce(function(u,c){return u.push({form_item_id:c.id,values:Array.isArray(c.draftValues)?c.draftValues:[]}),u},[])}else t&&(i=t.formId,a=Object.entries(t.answers).reduce(function(u,c){var d=ne(c,2),h=d[0],f=d[1],m=Number(h);if(Number.isNaN(m))throw new k({code:re.INVALID_PARAMETER,message:"Keys in answers must be numeric string."});return u.push({form_item_id:m,value:f}),u},[]));if(!i||!a)throw new k({code:re.INVALID_PARAMETER,message:"Missing one or more required inputs: formId, answers."});return o=new Zk({messageId:this.messageId,formId:i,items:a}),[4,r.send(o)];case 1:return l.sent(),[2]}})})},n.prototype.submitFeedback=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=I.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new jk({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,rating:t.rating,comment:t.comment}),[4,i.send(s)];case 1:return o=u.sent(),l=o.as(Qk),this.myFeedback=l.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new _t({messages:[this],source:P.EVENT_MESSAGE_FEEDBACK_ADDED})),[2]}})})},n.prototype.updateFeedback=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=I.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new Kk({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:t.id,rating:t.rating,comment:t.comment}),[4,i.send(s)];case 1:return o=u.sent(),l=o.as(Wk),this.myFeedback=l.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new _t({messages:[this],source:P.EVENT_MESSAGE_FEEDBACK_UPDATED})),[2]}})})},n.prototype.deleteFeedback=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=I.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new Yk({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:t}),[4,i.send(s)];case 1:return o.sent(),this.myFeedback=null,this.myFeedbackStatus="NO_FEEDBACK",a.dispatch(new _t({messages:[this],source:P.EVENT_MESSAGE_FEEDBACK_DELETED})),[2]}})})},n}(KA),xt=function(e){function n(t,r){var i,a,s,o,l=this;if((l=e.call(this,t,r)||this).reqId="",l.replyToChannel=!1,l.errorCode=0,l.sender=r.user?new Du(l._iid,r.user):r.sender_id,l.reqId=(a=(i=r.req_id)!==null&&i!==void 0?i:r.request_id)!==null&&a!==void 0?a:"",l.replyToChannel=(s=r.is_reply_to_channel)!==null&&s!==void 0&&s,r.request_state&&be(rt,r.request_state)&&(l.sendingStatus=r.request_state),!l.sendingStatus)if(l.messageId>0)l.sendingStatus=rt.SUCCEEDED;else if(l.scheduledInfo)switch(r.scheduled_status&&(l._scheduledStatus=r.scheduled_status),r.scheduled_status){case $r.SENT:case $r.IN_QUEUE:l.sendingStatus=rt.SUCCEEDED;break;case $r.PENDING:l.sendingStatus=rt.SCHEDULED;break;case $r.FAILED:case $r.REMOVED:l.sendingStatus=rt.FAILED;break;case $r.CANCELED:l.sendingStatus=rt.CANCELED}else l.sendingStatus=rt.PENDING;return l.errorCode=(o=r.error_code)!==null&&o!==void 0?o:0,l._messageToken=r.mesg_token,l}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{user:Du.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode,mesg_token:t._messageToken})))},Object.defineProperty(n.prototype,"isResendable",{get:function(){return(this.sendingStatus===rt.FAILED||this.sendingStatus===rt.CANCELED)&&EO(this.errorCode)},enumerable:!1,configurable:!0}),n.prototype.isIdentical=function(t){return this.messageId>0&&t.messageId>0?this.messageId===t.messageId:this.reqId===t.reqId},n}(Vn),hh={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:Un.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Om=function(e){return x("number",e.prevResultSize)&&x("number",e.nextResultSize)&&x("boolean",e.isInclusive)&&x("boolean",e.reverse)&&x("string",e.messageTypeFilter)&&be(Un,e.messageTypeFilter)&&Te("string",e.customTypesFilter,!0)&&Te("string",e.senderUserIdsFilter,!0)&&x("boolean",e.includeMetaArray)&&x("boolean",e.includeReactions)&&x("boolean",e.includeParentMessageInfo)},ol=function(e){function n(t,r){var i,a,s,o=this;if((o=e.call(this,t,r)||this).translations={},o.messageType=vt.ADMIN,o.translations=(i=r.translations)!==null&&i!==void 0?i:{},r.parent_message_info){var l=r.parent_message_info;o.parentMessage=Zn(t,W(ae(N(N({},l),{message_id:o.parentMessageId,channel_url:o.channelUrl,channel_type:o.channelType,file:l.file,url:(a=l.file)===null||a===void 0?void 0:a.url,require_auth:(s=l.file)===null||s===void 0?void 0:s.require_auth}))))}return o}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{translations:t.translations,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},n.prototype.getThreadedMessagesByTimestamp=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},hh),r),B(this.messageId>0&&x("number",t)&&Om(i)).throw(k.invalidParameters),[4,un.of(this._iid).getThreadedMessagesByTimestamp(this,t,i)];case 1:return[2,a.sent()]}})})},n}(Vn),L1=function(){function e(n){var t,r;this.detail={},this.type=(t=n.type)!==null&&t!==void 0?t:"",this.vendor=(r=n.vendor)!==null&&r!==void 0?r:"",n.detail&&x("object",n.detail)&&!Array.isArray(n.detail)&&(this.detail=n.detail)}return e.payloadify=function(n){return W(ae({type:n.type,vendor:n.vendor,detail:n.detail}))},e}(),P1=function(){function e(n){this.status=n.status,n.original_message_info&&(this.originalMessageInfo={createdAt:n.original_message_info.ts,messageId:n.original_message_info.id})}return e.payloadify=function(n){return W({status:n.status,original_message_info:n.originalMessageInfo?{id:n.originalMessageInfo.messageId,ts:n.originalMessageInfo.createdAt}:void 0})},e}(),kn=function(e){function n(t,r){var i,a,s,o,l,u,c,d=this;if((d=e.call(this,t,r)||this).messageParams=null,d.mentionedMessageTemplate=void 0,d.translations={},d.translationTargetLanguages=[],d.messageSurvivalSeconds=-1,d.plugins=[],d.messageType=vt.USER,d.translations=(s=r.translations)!==null&&s!==void 0?s:{},d.translationTargetLanguages=(o=r.target_langs)!==null&&o!==void 0?o:[],Object.keys(d.translations).length===0&&d.translationTargetLanguages.length>0)try{for(var h=K(d.translationTargetLanguages),f=h.next();!f.done;f=h.next()){var m=f.value;d.translations[m]=""}}catch(C){i={error:C}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}if(d.mentionedMessageTemplate=r.mentioned_message_template,d.messageSurvivalSeconds=(l=r.message_survival_seconds)!==null&&l!==void 0?l:-1,d.plugins=r.plugins?r.plugins.map(function(C){return new L1(C)}):[],r.parent_message_info){var y=r.parent_message_info;d.parentMessage=Zn(t,W(ae(N(N({},y),{created_at:y.ts,message_id:d.parentMessageId,channel_url:d.channelUrl,channel_type:d.channelType,file:y.file,url:(u=y.file)===null||u===void 0?void 0:u.url,require_auth:(c=y.file)===null||c===void 0?void 0:c.require_auth}))))}return r.review_info&&(d.messageReviewInfo=new P1(r.review_info)),d}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,mentioned_message_template:t.mentionedMessageTemplate,plugins:t.plugins.map(function(r){return L1.payloadify(r)}),parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null,review_info:t.messageReviewInfo?P1.payloadify(t.messageReviewInfo):void 0})))},n.prototype.getThreadedMessagesByTimestamp=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},hh),r),B(this.messageId>0&&x("number",t)&&Om(i)).throw(k.invalidParameters),[4,un.of(this._iid).getThreadedMessagesByTimestamp(this,t,i)];case 1:return[2,a.sent()]}})})},n}(xt),qr=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h=this;if((h=e.call(this,t,r)||this).messageParams=null,h.fileInfoList=[],h.messageSurvivalSeconds=-1,h.messageType=vt.FILE,h.data=(s=(a=(i=r.file)===null||i===void 0?void 0:i.data)!==null&&a!==void 0?a:r.custom)!==null&&s!==void 0?s:"",h.fileInfoList=(l=(o=r.files)===null||o===void 0?void 0:o.map(function(m){return new Kv(t,m)}))!==null&&l!==void 0?l:[],h.messageSurvivalSeconds=(u=r.message_survival_seconds)!==null&&u!==void 0?u:-1,r.parent_message_info){var f=r.parent_message_info;h.parentMessage=Zn(t,W(ae(N(N({},f),{created_at:f.ts,message_id:h.parentMessageId,channel_url:h.channelUrl,channel_type:h.channelType,file:f.file,url:(c=f.file)===null||c===void 0?void 0:c.url,require_auth:(d=f.file)===null||d===void 0?void 0:d.require_auth}))))}return h}return T(n,e),n.prototype.getThreadedMessagesByTimestamp=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},hh),r),B(this.messageId>0&&x("number",t)&&Om(i)).throw(k.invalidParameters),[4,un.of(this._iid).getThreadedMessagesByTimestamp(this,t,i)];case 1:return[2,a.sent()]}})})},n.payloadify=function(t){var r,i,a,s,o,l;return W(ae(N(N({},e.payloadify.call(this,t)),{file:{name:(i=(r=t.fileInfoList[0])===null||r===void 0?void 0:r.fileName)!==null&&i!==void 0?i:"",size:(s=(a=t.fileInfoList[0])===null||a===void 0?void 0:a.fileSize)!==null&&s!==void 0?s:0,type:(l=(o=t.fileInfoList[0])===null||o===void 0?void 0:o.mimeType)!==null&&l!==void 0?l:"",data:t.data},files:Array.isArray(t.fileInfoList)?t.fileInfoList.map(function(u){return Kv.payloadify(u)}):null,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},n._isMultipleFilesMessagePayload=function(t){var r=t.files;return Array.isArray(r)&&r.length>=2},n._isMultipleFilesMessageSerializedData=function(t){var r=t.fileInfoList;return Array.isArray(r)},n}(xt);(function(e){e.SENT="SENT",e.READ="READ"})($o||($o={}));var ll=function(e){function n(t,r){var i,a,s=this;if((s=e.call(this,t,r)||this).notificationData=null,s.notificationId=r.notification_message_id,s.messageType=vt.ADMIN,s.messageStatus=(i=r.message_status)!==null&&i!==void 0?i:$o.SENT,s.priority=(a=r.priority)!==null&&a!==void 0?a:Pv.NORMAL,s.notificationEventDeadline=r.notification_event_deadline,s.extendedMessage.sub_type===0)try{var o=JSON.parse(s.extendedMessage.sub_data),l=o.label,u=o.tags,c=u===void 0?[]:u,d=o.template_key,h=o.template_variables;s.notificationData={label:l,tags:c,templateKey:d,templateVariables:h}}catch{}return s}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{notification_message_id:t.notificationId,message_status:t.messageStatus,priority:t.priority,notification_event_deadline:t.notificationEventDeadline})))},n.prototype.isIdentical=function(t){return this.notificationId===t.notificationId},n}(KA),F1=function(e){if(e.notificationId)return ll.payloadify(e);switch(e.messageType){case vt.USER:return kn.payloadify(e);case vt.FILE:return e.fileInfoList?qr.payloadify(e):qt.payloadify(e);case vt.ADMIN:return ol.payloadify(e);default:throw k.unknown}},Zn=function(e,n){if(n.notification_message_id)return new ll(e,n);switch(n.type){case"MESG":return new kn(e,n);case"FILE":return qr._isMultipleFilesMessagePayload(n)?new qr(e,n):new qt(e,n);case"ADMM":case"BRDM":return new ol(e,n);default:return null}},qt=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b,v=this;(v=e.call(this,t,r)||this).messageParams=null,v.plainUrl="",v.requireAuth=!1,v.thumbnails=[],v.messageSurvivalSeconds=-1,v.messageType=vt.FILE;var E=r.file;if(v.plainUrl=((a=(i=E?.url)!==null&&i!==void 0?i:r.url)!==null&&a!==void 0?a:"").split("?auth=")[0],v.name=(o=(s=E?.name)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:"File",v.size=(u=(l=E?.size)!==null&&l!==void 0?l:r.size)!==null&&u!==void 0?u:0,v.data=(d=(c=E?.data)!==null&&c!==void 0?c:r.custom)!==null&&d!==void 0?d:"",v.type=E?(h=E.type)!==null&&h!==void 0?h:"":(f=r.type)!==null&&f!==void 0?f:"",v.requireAuth=(m=r.require_auth)!==null&&m!==void 0&&m,v.thumbnails=r.thumbnails?r.thumbnails.map(function(w){var A;return new es(v._iid,typeof w=="string"?{url:w,width:0,height:0}:N(N({},w),{url:((A=w.url)!==null&&A!==void 0?A:"").split("auth=")[0]}),v.requireAuth)}):[],v.messageSurvivalSeconds=(y=r.message_survival_seconds)!==null&&y!==void 0?y:-1,r.parent_message_info){var S=r.parent_message_info;v.parentMessage=Zn(t,W(ae(N(N({},S),{created_at:S.ts,message_id:v.parentMessageId,channel_url:v.channelUrl,channel_type:v.channelType,file:S.file,url:(C=S.file)===null||C===void 0?void 0:C.url,require_auth:(b=S.file)===null||b===void 0?void 0:b.require_auth}))))}return v}return T(n,e),n.payloadify=function(t){var r;return W(ae(N(N({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:(r=t.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{url:i.plainUrl,width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},Object.defineProperty(n.prototype,"url",{get:function(){var t=I.of(this._iid).sessionManager;return this.requireAuth&&t.ekey?"".concat(this.plainUrl,"?auth=").concat(t.ekey):this.plainUrl},enumerable:!1,configurable:!0}),n.prototype.getThreadedMessagesByTimestamp=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},hh),r),B(this.messageId>0&&x("number",t)&&Om(i)).throw(k.invalidParameters),[4,un.of(this._iid).getThreadedMessagesByTimestamp(this,t,i)];case 1:return[2,a.sent()]}})})},n}(xt),Gd=function(e){function n(t,r){var i=r.file,a=r.fileUrl,s=r.fileName,o=r.fileSize,l=r.mimeType,u=r.thumbnailSizes,c=r._uploadedMetaData,d=r._thumbnails,h=e.call(this,t)||this;return h._plainUrl=a,h.file=i,h.fileName=s,h.fileSize=o,h.mimeType=l,h.thumbnailSizes=u,h._uploadedMetaData=c,h._thumbnails=d,h}return T(n,e),n.getPlainUrl=function(t){return t instanceof n?t._plainUrl:t.fileUrl},Object.defineProperty(n.prototype,"fileUrl",{get:function(){var t,r=I.of(this._iid).sessionManager;return this._plainUrl&&(!((t=this._uploadedMetaData)===null||t===void 0)&&t.requireAuth)&&r.ekey?"".concat(this._plainUrl,"?auth=").concat(r.ekey):this._plainUrl},set:function(t){this._plainUrl=t},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_thumbnails:this._thumbnails,_uploadedMetaData:this._uploadedMetaData}},n}(Wt),Xk=function(e){function n(t){var r,i,a,s,o=[];return t.mentionType===$n.USERS&&(t.mentionedUserIds?o=t.mentionedUserIds:t.mentionedUsers&&(o=t.mentionedUsers.map(function(l){return l.userId}))),e.call(this,{code:"FILE",ackRequired:!0,payload:W(ae({channel_url:t.channelUrl,files:t.files?JA(t.files):null,url:t.url,name:(r=t.fileName)!==null&&r!==void 0?r:"",type:(i=t.mimeType)!==null&&i!==void 0?i:"",size:(a=t.fileSize)!==null&&a!==void 0?a:0,custom:t.data,custom_type:t.customType,thumbnails:(s=t._thumbnails)===null||s===void 0?void 0:s.map(function(l){return es.payloadify(l)}),require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:o,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==qi.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage,message:t.message}))})||this}return T(n,e),n}(sr),Jk=function(e){function n(t){var r,i,a=this;a=e.call(this)||this;var s=[];return t.mentionType===$n.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map(function(o){return o.userId}))),a.method=z.POST,a.path="".concat(Re(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),a.params=W(ae({message_type:vt.FILE,user_id:t.userId,files:t.files?JA(t.files):null,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:s,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:(r=t._thumbnails)===null||r===void 0?void 0:r.map(function(o){return es.payloadify(o)}),require_auth:t.requireAuth,sorted_metaarray:(i=t.metaArrays)===null||i===void 0?void 0:i.map(function(o){return nr.payloadify(o)}),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId?t.parentMessageId:null,apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,reply_to_channel:t.isReplyToChannel,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage})),a}return T(n,e),n}(H),XA=function(e){function n(t,r,i){var a,s,o,l,u=this;(u=e.call(this,t,"FILE",i)||this).message=i.files&&i.files.length>=2?new qr(t,i):new qt(t,i);var c=I.of(t).sdkState;return u.isMentioned=Iu(u.message.mentionType,(o=(a=u.message.mentionedUserIds)!==null&&a!==void 0?a:(s=u.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(d){return d.userId}))!==null&&o!==void 0?o:[],c.userId),u.forceUpdateLastMessage=(l=i.force_update_last_message)!==null&&l!==void 0&&l,u}return T(n,e),n}(pt),eR=function(e){function n(t,r){var i,a,s,o,l=this;(l=e.call(this,t,r)||this).message=r.files&&r.files.length>=2?new qr(t,r):new qt(t,r);var u=I.of(t).sdkState;return l.isMentioned=Iu(l.message.mentionType,(s=(i=l.message.mentionedUserIds)!==null&&i!==void 0?i:(a=l.message.mentionedUsers)===null||a===void 0?void 0:a.map(function(c){return c.userId}))!==null&&s!==void 0?s:[],u.userId),l.forceUpdateLastMessage=(o=r.force_update_last_message)!==null&&o!==void 0&&o,l}return T(n,e),n}(j);function JA(e){return e.map(function(n){var t,r;return W(ae({url:Gd.getPlainUrl(n),file_name:n.fileName,file_type:n.mimeType,file_size:n.fileSize,thumbnails:(t=n._thumbnails)===null||t===void 0?void 0:t.map(function(i){return es.payloadify(i)}),require_auth:(r=n._uploadedMetaData)===null||r===void 0?void 0:r.requireAuth}))})}var sn;(function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"})(sn||(sn={}));var tR=function(){function e(n,t){var r=t.sdkState,i=t.dispatcher,a=t.requestQueue,s=t.onlineDetector,o=t.cacheContext,l=this;this._queueMap=new Map,this._iid=n,this._sdkState=r,this._requestQueue=a,this._cacheContext=o,this._dispatcher=i,this._dispatcher.on(function(u){u instanceof Zr&&(l._connectionState=u.stateType)}),this._onlineDetector=s}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===He.CONNECTED||this._connectionState===He.CONNECTING||this._connectionState===He.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(n,t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=this._createSendFileMessageRequestParams(n,t),this._shouldSendThroughWebSocket?(i=new Xk(r),[4,this._requestQueue.send(i)]):[3,2];case 1:return a=s.sent(),[2,a.as(XA).message];case 2:return i=new Jk(N(N({},r),{userId:this._sdkState.userId})),[4,this._requestQueue.send(i)];case 3:return a=s.sent(),[2,a.as(eR).message]}})})},e.prototype._createSendFileMessageRequestParams=function(n,t){var r=N(N({},t.params),{channelUrl:n.url,channelType:n.channelType,reqId:t.requestId,url:""});if(t.multipleFileUploadInfo){var i=t.params;r.files=i.fileInfoList}else i=t.params,r.url=i.fileUrl,r.requireAuth=i.requireAuth;return r},e.prototype._resolveMessageQueue=function(n){var t;return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m,y;return _(this,function(C){switch(C.label){case 0:if(!(r=this._queueMap.get(n.url)))return[3,21];if(r.isResolving)return[3,20];r.isResolving=!0,i=[],a=!0,C.label=1;case 1:C.trys.push([1,15,16,17]),s=K(r.messageQueue),o=s.next(),C.label=2;case 2:if(o.done)return[3,14];switch(l=o.value,l.state){case sn.PENDING:case sn.UPLOADING:return[3,3];case sn.UPLOADED:return[3,4];case sn.FAILED:return[3,12]}return[3,13];case 3:return a=!1,i.push(l),[3,13];case 4:if(!a)return[3,10];C.label=5;case 5:return C.trys.push([5,8,,9]),l.state=sn.SENDING,[4,this._sendFileMessage(n,l)];case 6:return u=C.sent(),l.deferred.resolve(u),[4,tr(100)];case 7:return C.sent(),[3,9];case 8:return c=C.sent(),l.deferred.reject(c),[3,9];case 9:return[3,11];case 10:i.push(l),C.label=11;case 11:return[3,13];case 12:return d=(t=l.error)!==null&&t!==void 0?t:k.unknown,l.deferred.reject(d.code===re.REQUEST_CANCELED?k.fileUploadCanceled:d),[3,13];case 13:return o=s.next(),[3,2];case 14:return[3,17];case 15:return h=C.sent(),m={error:h},[3,17];case 16:try{o&&!o.done&&(y=s.return)&&y.call(s)}finally{if(m)throw m.error}return[7];case 17:return f=r.isResolveRequestPending,r.messageQueue=i,r.isResolving=!1,r.isResolveRequestPending=!1,f?[4,this._resolveMessageQueue(n)]:[3,19];case 18:C.sent(),C.label=19;case 19:return[3,21];case 20:r.isResolveRequestPending=!0,C.label=21;case 21:return[2]}})})},e.prototype._uploadNextPendingItem=function(n){var t;return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h;return _(this,function(f){switch(f.label){case 0:return(r=this._queueMap.get(n.url))&&(i=r.messageQueue.find(function(m){return m.state===sn.PENDING}))?i.multipleFileUploadInfo?(a=i.multipleFileUploadInfo,s=a.uploadIndex,o=a.uploadCount,l=a.requestHandler,h=i.params,u=h.fileInfoList[s],!Kn(u.file)||!((t=u._uploadedMetaData)===null||t===void 0)&&t.isUploaded?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(n,r,i)]):[3,4]:[3,9];case 1:return f.sent(),[3,3];case 2:i.state=s<o-1?sn.PENDING:sn.UPLOADED,f.label=3;case 3:return c=h.fileInfoList[s],d=i.multipleFileUploadInfo.uploadIndex++,i.multipleFileUploadInfo.isCopy||l==null||l._triggerOnFileUploaded(i.requestId,d,c,i.error),[3,7];case 4:return h=i.params,Kn(h.file)?[4,this._tryUploadNextItemAndUpdateItemState(n,r,i)]:[3,6];case 5:return f.sent(),[3,7];case 6:h.thumbnailSizes=[],i.state=sn.UPLOADED,f.label=7;case 7:return this._uploadNextPendingItem(n),[4,this._resolveMessageQueue(n)];case 8:f.sent(),f.label=9;case 9:return[2]}})})},e.prototype._tryUploadNextItemAndUpdateItemState=function(n,t,r){return g(this,void 0,void 0,function(){var i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(i=c.sent(),!I.of(this._iid).sessionManager.currentUser||!i)return r.error=k.connectionRequired,r.state=sn.FAILED,[2];if(!(t.uploadQueue.length<6))return[3,9];r.state=sn.UPLOADING,t.uploadQueue.push(r),c.label=2;case 2:return c.trys.push([2,7,,8]),r.multipleFileUploadInfo?(a=r.multipleFileUploadInfo,s=a.uploadIndex,o=a.uploadCount,l=r.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(n,r,l)]):[3,4];case 3:return c.sent(),r.state=s<o-1?sn.PENDING:sn.UPLOADED,[3,6];case 4:return l=r.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(n,r,l)];case 5:c.sent(),r.state=sn.UPLOADED,c.label=6;case 6:return[3,8];case 7:switch((u=c.sent()).code){case re.REQUEST_FAILED:r.error=new k({code:re.NETWORK_ERROR,message:"Failed to upload a file."});break;case re.REQUEST_CANCELED:r.error=k.fileUploadCanceled;break;default:r.error=u}return r.state=sn.FAILED,[3,8];case 8:this._dequeueUploadItem(t,r),c.label=9;case 9:return[2]}})})},e.prototype._dequeueUploadItem=function(n,t){var r=n.uploadQueue.findIndex(function(i){return i.requestId===t.requestId});r>=0&&n.uploadQueue.splice(r,1)},e.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(n,t,r){var i,a,s;return g(this,void 0,void 0,function(){var o,l,u,c,d,h,f,m,y,C;return _(this,function(b){switch(b.label){case 0:return o=new Fp({file:r.file,channelUrl:n.url,thumbnailSizes:r.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(o)];case 1:return l=b.sent(),u=l.as($p),c=u.url,d=u.fileSize,h=d===void 0?r.fileSize:d,f=u.thumbnails,m=f===void 0?[]:f,y=u.requireAuth,C=y!==void 0&&y,r.fileName=(i=r.fileName)!==null&&i!==void 0?i:r.file.name,r.mimeType=(a=r.mimeType)!==null&&a!==void 0?a:r.file.type,r.fileSize=(s=r.fileSize)!==null&&s!==void 0?s:r.file.size,r.fileUrl=c,r.fileSize=h,r.requireAuth=C,r._thumbnails=m,[2]}})})},e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(n,t,r){var i,a,s;return g(this,void 0,void 0,function(){var o,l,u,c,d,h,f,m,y,C,b;return _(this,function(v){switch(v.label){case 0:return o=t.multipleFileUploadInfo.uploadIndex,l=r.fileInfoList[o],u=new Fp({file:l.file,channelUrl:n.url,thumbnailSizes:l.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(u)];case 1:return c=v.sent(),d=c.as($p),h=d.url,f=d.fileSize,m=f===void 0?l.fileSize:f,y=d.thumbnails,C=d.requireAuth,b=C!==void 0&&C,l.fileName=(i=l.fileName)!==null&&i!==void 0?i:l.file.name,l.mimeType=(a=l.mimeType)!==null&&a!==void 0?a:l.file.type,l.fileSize=(s=l.fileSize)!==null&&s!==void 0?s:l.file.size,l.file=void 0,l.fileUrl=h,l.fileSize=m,l._thumbnails=y,l._uploadedMetaData=N(N({},l._uploadedMetaData),{requireAuth:b,isUploaded:!0}),l instanceof Gd||(r.fileInfoList[o]=new Gd(this._iid,l)),[2]}})})},e.prototype.request=function(n,t,r,i){return i===void 0&&(i={}),g(this,void 0,void 0,function(){var a,s,o,l,u;return _(this,function(c){return this._queueMap.has(n.url)||(a={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(n.url,a)),s=this._queueMap.get(n.url),o=new ar,l={requestId:t,params:r,state:sn.PENDING,deferred:o},function(d){return"fileInfoList"in d}(r)&&(u=N({uploadIndex:0,uploadCount:r.fileInfoList.length},i),l.multipleFileUploadInfo=u),s.messageQueue.push(l),this._uploadNextPendingItem(n),[2,o.promise]})})},e.prototype.cancel=function(n,t){var r,i,a=this._queueMap.get(n.url);if(a){var s=t?[a.messageQueue.find(function(m){return m.requestId===t})]:ce([],ne(a.messageQueue),!1);try{for(var o=K(s),l=o.next();!l.done;l=o.next()){var u=l.value;if(u)switch(u.state){case sn.PENDING:if(u.state=sn.FAILED,u.error=k.requestCanceled,u.multipleFileUploadInfo&&!u.multipleFileUploadInfo.isCopy){var c=u.multipleFileUploadInfo,d=c.uploadIndex,h=c.requestHandler,f=u.params.fileInfoList[d];h?._triggerOnFileUploaded(u.requestId,d,f,k.fileUploadCanceled)}this._resolveMessageQueue(n);break;case sn.UPLOADING:this._requestQueue.cancel(u.requestId),this._dispatcher.dispatch(new Mp({requestId:u.requestId}))}}}catch(m){r={error:m}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}else t&&(this._requestQueue.cancel(t),this._dispatcher.dispatch(new Mp({requestId:t})))},e}(),$1,ui,pd={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:Un.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:Fn.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},z1=function(e){return x("number",e.prevResultSize)&&x("number",e.nextResultSize)&&x("boolean",e.isInclusive)&&x("boolean",e.reverse)&&x("string",e.messageTypeFilter)&&be(Un,e.messageTypeFilter)&&Te("string",e.customTypesFilter,!0)&&Te("string",e.senderUserIdsFilter,!0)&&be(Fn,e.replyType)&&x("boolean",e.includeMetaArray)&&x("boolean",e.includeReactions)&&x("boolean",e.includeParentMessageInfo)&&x("boolean",e.includeThreadInfo)&&x("boolean",e.showSubchannelMessagesOnly)},Wv={replyType:Fn.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},H1=function(e){return be(Fn,e.replyType)&&x("boolean",e.includeReactions)&&x("boolean",e.includeMetaArray)&&x("boolean",e.includeParentMessageInfo)&&x("boolean",e.includeThreadInfo)};(function(e){e.MESSAGE="message"})($1||($1={})),function(e){e.INTERNAL_BACKSYNC="internal_backsync",e.INTERNAL_FILL_GAP="internal_fill_gap",e.EXTERNAL_LEGACY="external_legacy",e.EXTERNAL_COLLECTION="external_collection"}(ui||(ui={}));var Yv,nR=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.includeMetaArray,o=t.includeReactions,l=t.includeThreadInfo,u=t.includeParentMessageInfo,c=e.call(this)||this;return c.method=z.GET,c.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a)),c.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions_summary:o!=null&&o,include_thread_info:l,include_parent_message_info:u,include_poll_details:!0},c}return T(n,e),n}(H),rR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=r?Zn(t,N({},r)):null,i}return T(n,e),n}(j),Jh=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.timestamp,s=t.token,o=t.prevResultSize,l=t.nextResultSize,u=t.isInclusive,c=t.reverse,d=t.messageTypeFilter,h=t.customTypesFilter,f=t.senderUserIdsFilter,m=t.replyType,y=t.includeMetaArray,C=t.includeReactions,b=t.parentMessageId,v=t.includeThreadInfo,E=t.includeParentMessageInfo,S=t.showSubchannelMessagesOnly,w=t.checkingHasNext,A=t.checkingContinuousMessages,D=t.sdkSource,O=e.call(this)||this;return O.method=z.GET,O.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages"),O.params=W(ae({is_sdk:!0,prev_limit:o,next_limit:l,include:u,reverse:c,message_ts:a,message_id:s,message_type:d??null,custom_types:h,sender_ids:f,include_reply_type:m,with_sorted_meta_array:y,include_reactions_summary:C,parent_message_id:b,include_thread_info:v,include_parent_message_info:E,show_subchannel_message_only:S,include_poll_details:!0,checking_has_next:w,checking_continuous_messages:A,sdk_source:D})),O}return T(n,e),n}(H),ef=function(e){function n(t,r){var i=e.call(this,t,r)||this;return r.is_continuous_messages!==void 0&&(i.isContinuousMessages=r.is_continuous_messages),r.has_next!==void 0&&(i.hasNext=r.has_next),i.messages=r.messages.map(function(a){return Zn(t,a)}),i}return T(n,e),n}(j),iR=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.timestamp,s=t.token,o=t.replyType,l=t.includeMetaArray,u=t.includeReactions,c=t.includeThreadInfo,d=t.includeParentMessageInfo,h=e.call(this)||this;return h.method=z.GET,h.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/changelogs"),h.params={change_ts:a,token:s,with_sorted_meta_array:l,include_reactions_summary:u,include_thread_info:c,include_reply_type:o,include_parent_message_info:d,include_poll_details:!0},h}return T(n,e),n}(H),aR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.updatedMessages=r.updated.map(function(a){return Zn(t,a)}),i.deletedMessagesInfo=r.deleted.map(function(a){return{messageId:a.message_id,deletedAt:a.deleted_at}}),i.hasMore=r.has_more,i.nextToken=r.next,i.forceUseNextToken=r.force_use_next_token||!1,i}return T(n,e),n}(j),sR=function(e){function n(t){var r=t.channelUrl,i=t.scheduledMessageId,a=e.call(this)||this;return a.method=z.GET,a.path="".concat(Jn,"/").concat(encodeURIComponent(r),"/scheduled_messages/").concat(encodeURIComponent(i)),a.params={},a}return T(n,e),n}(H),oR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=r?Zn(t,N({},r)):null,i}return T(n,e),n}(j);(function(e){e.MUTED="muted",e.BANNED="banned"})(Yv||(Yv={}));var q1=function(){function e(n){var t,r,i,a;this.restrictionType=null,be(Yv,n.restriction_type)&&(this.restrictionType=n.restriction_type),this.description=(t=n.description)!==null&&t!==void 0?t:null,this.endAt=(i=(r=n.end_at)!==null&&r!==void 0?r:n.muted_end_at)!==null&&i!==void 0?i:-1,this.remainingDuration=(a=n.remaining_duration)!==null&&a!==void 0?a:-1}return e.payloadify=function(n){return W(ae({restriction_type:n.restrictionType,description:n.description,end_at:n.endAt,remaining_duration:n.remainingDuration}))},e}(),wl=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.restrictionInfo=new q1(r),i}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),q1.payloadify(t.restrictionInfo))))},n}(xe);(function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).isMuted=!1,a.isMuted=(i=r.is_muted)!==null&&i!==void 0&&i,a}return T(n,e),n})(xe);var Sr=function(){function e(){this._onPending=Ne,this._onFailed=Ne,this._onSucceeded=Ne}return e.prototype._trigger=function(n){switch(n?.sendingStatus){case rt.PENDING:n.errorCode===0&&this._onPending(n);break;case rt.SCHEDULED:case rt.SUCCEEDED:this._onSucceeded(n)}},e.prototype._triggerFailed=function(n,t){switch(t?.sendingStatus){case rt.FAILED:case rt.CANCELED:this._onFailed(n,t.scheduledInfo?null:t)}},e.prototype.onPending=function(n){return this._onPending=n,this},e.prototype.onFailed=function(n){return this._onFailed=n,this},e.prototype.onSucceeded=function(n){return this._onSucceeded=n,this},e}(),Dm={data:void 0,customType:void 0,mentionType:$n.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1,pollId:void 0},km=function(e){return x("string",e.data,!0)&&x("string",e.customType,!0)&&be($n,e.mentionType)&&Te("string",e.mentionedUserIds,!0)&&Te(xe,e.mentionedUsers,!0)&&Te(nr,e.metaArrays,!0)&&x("number",e.parentMessageId,!0)&&x("boolean",e.isReplyToChannel)&&be(qi,e.pushNotificationDeliveryOption,!0)&&x(Ei,e.appleCriticalAlertOptions,!0)&&x("boolean",e.isPinnedMessage,!0)&&x("number",e.pollId,!0)},B1=function(e){return{isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,pollId:e.pollId}},eN=N(N({},Dm),{message:"",mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,extendedMessagePayload:void 0});function tN(e){var n,t,r;return(n=e.messageParams)!==null&&n!==void 0?n:ae(N(N({},e),{mentionType:e.mentionType,mentionedUserIds:(t=e.mentionedUserIds)!==null&&t!==void 0?t:(r=e.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),mentionedMessageTemplate:e.mentionedMessageTemplate,translationTargetLanguages:Object.keys(e.translations),pushNotificationDeliveryOption:qi.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var Wo,Zv=function(e){var n;return W(ae({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:(n=e.poll)===null||n===void 0?void 0:n.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations),extendedMessagePayload:e.extendedMessagePayload}))},nN=function(e){return km(e)&&x("string",e.message)&&x("string",e.mentionedMessageTemplate,!0)&&Te("string",e.translationTargetLanguages,!0)&&x("object",e.extendedMessagePayload,!0)};(function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"})(Wo||(Wo={}));var Pf=function(e){return typeof window<"u"&&"Blob"in window&&typeof Blob<"u"&&e instanceof Blob},yg=function(e){return e===Wo.BLOB||e===Wo.FILE},G1=function(e){return{file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption}},V1=N(N({},Dm),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1,message:void 0});function rN(e){var n,t,r,i;return(n=e.messageParams)!==null&&n!==void 0?n:ae(N(N({},e),{fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,mentionType:e.mentionType,mentionedUserIds:(t=e.mentionedUserIds)!==null&&t!==void 0?t:(r=e.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return a.userId}),pushNotificationDeliveryOption:qi.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(i=e.thumbnails)===null||i===void 0?void 0:i.map(function(a){return{maxWidth:a.width,maxHeight:a.height}}),requireAuth:e.requireAuth,isPinnedMessage:!1,_thumbnails:e.thumbnails,message:e.message}))}var md,Xv=function(e,n){var t,r;return e.messageParams?(!e.url&&Kn(n)&&(e.messageParams.file=n),e.messageParams):W(ae({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,file:n,fileUrl:e.url,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:(t=e.thumbnails)===null||t===void 0?void 0:t.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),message:e.message,pollId:(r=e.poll)===null||r===void 0?void 0:r.id}))},j1=function(e){return km(e)&&(Kn(e.file)||x("string",e.fileUrl))&&x("string",e.fileName,!0)&&x("string",e.mimeType,!0)&&x("number",e.fileSize,!0)&&x("string",e.message,!0)&&(e.thumbnailSizes===null||e.thumbnailSizes===void 0||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every(function(n){return x("object",n)&&n.maxWidth>0&&n.maxHeight>0}))},Ry={data:void 0,customType:void 0,mentionType:$n.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},Uy=function(e){return x("string",e.data,!0)&&x("string",e.customType,!0)&&be($n,e.mentionType)&&Te("string",e.mentionedUserIds,!0)&&Te(xe,e.mentionedUsers,!0)&&Te(nr,e.metaArrays,!0)&&be(qi,e.pushNotificationDeliveryOption,!0)&&x(Ei,e.appleCriticalAlertOptions,!0)},iN=N(N({},Ry),{message:void 0,mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,pollId:void 0}),aN=function(e){return Uy(e)&&x("string",e.mentionedMessageTemplate,!0)&&x("string",e.message,!0)&&Te("string",e.translationTargetLanguages,!0)&&x("number",e.pollId,!0)},lR=N({},Ry),uR=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.token,s=t.limit,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Re(i),"/").concat(encodeURIComponent(r),"/operators"),o.params={token:a,limit:s},o}return T(n,e),n}(H),cR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.operators=r.operators.map(function(a){return new xe(t,a)}),i.token=r.next,i}return T(n,e),n}(j),dR=function(e){function n(t,r,i,a){return e.call(this,t,r,i,a)||this}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:(t=[],this._hasNext?(this._isLoading=!0,r=I.of(this._iid).requestQueue,i=new uR(N(N({},this),{channelUrl:this.channelUrl,token:this._token})),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=u.sent(),s=a.as(cR),o=s.operators,l=s.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,o];case 2:return[2,t];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),hR=function(e){function n(t,r,i,a){var s,o,l,u,c,d,h,f,m,y,C=this;return(C=e.call(this,t,r,i,a)||this).reverse=!1,C.messageTypeFilter=Un.ALL,C.customTypesFilter=null,C.senderUserIdsFilter=null,C.replyType=Fn.NONE,C.includeMetaArray=!1,C.includeReactions=!1,C.includeParentMessageInfo=!1,C.includeThreadInfo=!1,C.showSubchannelMessagesOnly=!1,C._edge=Number.MAX_SAFE_INTEGER,C.reverse=(s=a.reverse)!==null&&s!==void 0&&s,C.messageTypeFilter=(o=a.messageTypeFilter)!==null&&o!==void 0?o:Un.ALL,C.customTypesFilter=(l=a.customTypesFilter)!==null&&l!==void 0?l:null,C.senderUserIdsFilter=(u=a.senderUserIdsFilter)!==null&&u!==void 0?u:null,C.replyType=(c=a.replyType)!==null&&c!==void 0?c:Fn.NONE,C.includeMetaArray=(d=a.includeMetaArray)!==null&&d!==void 0&&d,C.includeReactions=(h=a.includeReactions)!==null&&h!==void 0&&h,C.includeParentMessageInfo=(f=a.includeParentMessageInfo)!==null&&f!==void 0&&f,C.includeThreadInfo=(m=a.includeThreadInfo)!==null&&m!==void 0&&m,C.showSubchannelMessagesOnly=(y=a.showSubchannelMessagesOnly)!==null&&y!==void 0&&y,C}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("boolean",this.reverse)&&be(Un,this.messageTypeFilter)&&be(Fn,this.replyType)&&Te("string",this.customTypesFilter,!0)&&Te("string",this.senderUserIdsFilter,!0)&&x("boolean",this.includeMetaArray)&&x("boolean",this.includeReactions)&&x("boolean",this.includeParentMessageInfo)&&x("boolean",this.includeThreadInfo)&&x("boolean",this.showSubchannelMessagesOnly)},n.prototype.load=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,un.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,ae({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return t=r.sent(),this._edge=Math.min.apply(Math,ce([Number.MAX_SAFE_INTEGER],ne(t.map(function(i){return i.createdAt})),!1)),this._hasNext=t.length>=this.limit,this._isLoading=!1,[2,t];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),fR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.limit,o=t.token;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={limit:s,token:o},r}return T(n,e),n}(H),pR=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.mutedUsers=[];var a=r.next,s=r.muted_list;return i.token=a,s&&s.length>0&&(i.mutedUsers=s.map(function(o){return new wl(t,o)})),i}return T(n,e),n}(j),mR=function(e){function n(t,r,i,a){return e.call(this,t,r,i,a)||this}return T(n,e),n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new fR(N(N({},this),{token:this._token})),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(pR),s=a.mutedUsers,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),_R=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.limit,o=t.token;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=W({limit:s,token:o}),r}return T(n,e),n}(H),gR=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.bannedUsers=[];var a=r.next,s=r.banned_list;return i.token=a,s&&s.length>0&&(i.bannedUsers=s.map(function(o){return new wl(t,o.user)})),i}return T(n,e),n}(j),vR=function(e){function n(t,r,i,a){return e.call(this,t,r,i,a)||this}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new _R(N(N({},this),{token:this._token})),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(gR),s=a.bannedUsers,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja);(function(e){e.SPAM="spam",e.HARASSING="harassing",e.SUSPICIOUS="suspicious",e.INAPPROPRIATE="inappropriate"})(md||(md={}));var yR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.operatorUserIds;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var bR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.operatorUserIds;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var ER=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.userId;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/mute/").concat(s),r}return T(n,e),n}(H),CR=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.isMuted=!1,i.startAt=0,i.endAt=0;var a=r.is_muted,s=r.start_at,o=r.end_at,l=r.remaining_duration,u=r.description;return i.isMuted=a,i.startAt=s,i.endAt=o,i.remainingDuration=l,i.description=u,i}return T(n,e),n}(j),Q1=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.keys;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={keys:s,include_ts:!0},r}return T(n,e),n}(H),K1=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return T(n,e),n}(j),SR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.metadata;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0},r}return T(n,e),n}(H),TR=function(e){function n(t,r){var i,a,s=this;return(s=e.call(this,t,r)||this).metaData=(i=r.metadata)!==null&&i!==void 0?i:{},s.ts=(a=r.ts)!==null&&a!==void 0?a:null,s}return T(n,e),n}(j),wR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.metadata,o=t.upsert;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0,upsert:o!=null&&o},r}return T(n,e),n}(H),AR=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return T(n,e),n}(j),NR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return T(n,e),n}(pt),IR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.key;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metadata/").concat(s),r.params={include_ts:!0},r}return T(n,e),n}(H),MR=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.ts;return i.ts=a,i}return T(n,e),n}(j),xR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={include_ts:!0},r}return T(n,e),n}(H),OR=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.ts;return i.ts=a,i}return T(n,e),n}(j),W1=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.keys;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={keys:s},r}return T(n,e),n}(H),Y1=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.metaCounter=r,i}return T(n,e),n}(j),DR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.metaCounter;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s},r}return T(n,e),n}(H),kR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.metaCounter=r,i}return T(n,e),n}(j),bg=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.metaCounter,o=t.upsert,l=o!==void 0&&o,u=t.mode,c=u===void 0?"set":u;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s,upsert:l,mode:c},r}return T(n,e),n}(H),Eg=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.metaCounter=r,i}return T(n,e),n}(j),RR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return T(n,e),n}(pt),UR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.key;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metacounter/").concat(s),r.params={},r}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var LR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={},r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var PR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.userId,o=t.seconds,l=t.description;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={user_id:s,seconds:o,description:l},r}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var FR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new wl(t,i.data),a}return T(n,e),n}(pt),$R=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.userId;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/mute/").concat(encodeURIComponent(s)),r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var zR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new wl(t,i.data),a}return T(n,e),n}(pt),HR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.userId,o=t.seconds,l=t.description;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=W({user_id:s,seconds:o,description:l}),r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var qR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new wl(t,i.data),i.data.member_count&&(a.memberCount=i.data.member_count),i.data.joined_member_count&&(a.joinedMemberCount=i.data.joined_member_count),a}return T(n,e),n}(pt),BR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.userId;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/ban/").concat(encodeURIComponent(s)),r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var GR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new wl(t,i.data),a}return T(n,e),n}(pt),Z1=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.freezing;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/freeze"),r.params={freeze:s},r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var VR=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.freeze=i.data.freeze,a}return T(n,e),n}(pt),Ly=function(e){return e instanceof gu?e._custom?"custom":e.name:e},Py=function(e){if(e instanceof gu&&e._custom)return e.name},jR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.category,o=t.userId,l=t.description;return(r=e.call(this)||this).method=z.POST,r.path="".concat(eA(a),"/").concat(encodeURIComponent(i)),r.params=W({report_category:Ly(s),reporting_user_id:o,report_description:l,custom_report_category_name:Py(s)}),r}return T(n,e),n}(H),QR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.category,o=t.userId,l=t.offendingUserId,u=t.description;return(r=e.call(this)||this).method=z.POST,r.path="".concat($v,"/users/").concat(l),r.params=W({channel_url:i,channel_type:a===Pe.OPEN?"open_channels":"group_channels",report_category:Ly(s),reporting_user_id:o,report_description:u,custom_report_category_name:Py(s)}),r}return T(n,e),n}(H),KR=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType,s=t.category,o=t.userId,l=t.offendingUserId,u=t.messageId,c=t.description;return(r=e.call(this)||this).method=z.POST,r.path="".concat(eA(a),"/").concat(encodeURIComponent(i),"/messages/").concat(u),r.params=W({report_category:Ly(s),reporting_user_id:o,report_description:c,offending_user_id:l,custom_report_category_name:Py(s)}),r}return T(n,e),n}(H),WR=function(e){function n(t){var r=[];return t.mentionType===$n.USERS&&(t.mentionedUserIds?r=t.mentionedUserIds:t.mentionedUsers&&(r=t.mentionedUsers.map(function(i){return i.userId}))),e.call(this,{code:"MESG",ackRequired:!0,payload:W(ae({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:r,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==qi.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage,extended_message_payload:t.extendedMessagePayload}))})||this}return T(n,e),n}(sr),sN=function(e){function n(t,r,i){var a,s,o,l,u=this;(u=e.call(this,t,"MESG",i)||this).message=new kn(t,i);var c=I.of(t).sdkState;return u.isMentioned=Iu(u.message.mentionType,(o=(a=u.message.mentionedUserIds)!==null&&a!==void 0?a:(s=u.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(d){return d.userId}))!==null&&o!==void 0?o:[],c.userId),u.forceUpdateLastMessage=(l=i.force_update_last_message)!==null&&l!==void 0&&l,u}return T(n,e),n}(pt),X1=function(e){function n(t){var r=null;return t.mentionType===$n.USERS&&(t.mentionedUserIds?r=t.mentionedUserIds:t.mentionedUsers&&(r=t.mentionedUsers.map(function(i){return i.userId}))),e.call(this,{code:"MEDI",ackRequired:!0,payload:W(ae({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:r,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,poll_id:t.pollId}))})||this}return T(n,e),n}(sr),Jv=function(e){function n(t,r,i){var a,s,o,l,u,c=this;(c=e.call(this,t,"MEDI",i)||this).message=new kn(t,i);var d=I.of(t).sdkState;return c.mentionCountChange=Cy({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(o=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&o!==void 0?o:[]},ae({mentionType:c.message.mentionType,mentionedUserIds:(l=c.message.mentionedUserIds)!==null&&l!==void 0?l:(u=c.message.mentionedUsers)===null||u===void 0?void 0:u.map(function(h){return h.userId})}),d.userId),c}return T(n,e),n}(pt),J1=function(e){function n(t){var r=null;return t.mentionType===$n.USERS&&(t.mentionedUserIds?r=t.mentionedUserIds:t.mentionedUsers&&(r=t.mentionedUsers.map(function(i){return i.userId}))),e.call(this,{code:"FEDI",ackRequired:!0,payload:W(ae({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:r,apple_critical_alert_options:t.appleCriticalAlertOptions}))})||this}return T(n,e),n}(sr),e0=function(e){function n(t,r,i){var a,s,o,l,u,c=this;(c=e.call(this,t,"FEDI",i)||this).message=new qt(t,i);var d=I.of(t).sdkState;return c.mentionCountChange=Cy({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(o=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&o!==void 0?o:[]},ae({mentionType:c.message.mentionType,mentionedUserIds:(l=c.message.mentionedUserIds)!==null&&l!==void 0?l:(u=c.message.mentionedUsers)===null||u===void 0?void 0:u.map(function(h){return h.userId})}),d.userId),c}return T(n,e),n}(pt),YR=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.reactionKey,o=e.call(this)||this;return o.method=z.POST,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),o.params={reaction:s},o}return T(n,e),n}(H),ZR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.reactionEvent=new ky(r),i}return T(n,e),n}(j),XR=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.reactionKey,o=e.call(this)||this;return o.method=z.DELETE,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),o.params={reaction:s},o}return T(n,e),n}(H),JR=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.reactionEvent=new ky(N({},r)),i}return T(n,e),n}(j),eU=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=t.translationTargetLanguages,o=e.call(this)||this;return o.method=z.POST,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a),"/translation"),o.params={target_langs:s},o}return T(n,e),n}(H),tU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=new kn(t,r),i}return T(n,e),n}(j),nU=function(e){function n(t){var r,i=this;i=e.call(this)||this;var a=[];t.mentionType===$n.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map(function(l){return l.userId})));var s=t.channelType,o=t.channelUrl;return i.method=z.POST,i.path="".concat(Re(s),"/").concat(encodeURIComponent(o),"/scheduled_messages"),i.params=W(ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Nu.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=t.metaArrays)===null||r===void 0?void 0:r.map(function(l){return nr.payloadify(l)}),apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),i}return T(n,e),n}(H),oN=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=new kn(t,r),i}return T(n,e),n}(j),rU=function(e){function n(t){var r,i,a=this;a=e.call(this)||this;var s=[];t.mentionType===$n.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map(function(u){return u.userId})));var o=t.channelType,l=t.channelUrl;return a.method=z.POST,a.path="".concat(Re(o),"/").concat(encodeURIComponent(l),"/scheduled_messages"),a.params=ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Nu.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:(r=t._thumbnails)===null||r===void 0?void 0:r.map(function(u){return es.payloadify(u)}),custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=t.metaArrays)===null||i===void 0?void 0:i.map(function(u){return nr.payloadify(u)}),apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption}),a}return T(n,e),n}(H),iU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=new qt(t,r),i}return T(n,e),n}(j),aU=function(e){function n(t){var r=t.pollId,i=t.title,a=t.data,s=t.allowUserSuggestion,o=t.allowMultipleVotes,l=t.closeAt,u=e.call(this)||this;return u.method=z.PUT,u.path="".concat(Gi,"/").concat(encodeURIComponent(r)),u.params={title:i,data:a,allow_user_suggestion:s,allow_multiple_votes:o,close_at:l},u}return T(n,e),n}(H),sU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),oU=function(e){function n(t){var r=t.pollId,i=e.call(this)||this;return i.method=z.DELETE,i.path="".concat(Gi,"/").concat(encodeURIComponent(r)),i}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var lU=function(e){function n(t){var r=t.pollId,i=e.call(this)||this;return i.method=z.PUT,i.path="".concat(Gi,"/").concat(encodeURIComponent(r),"/close"),i}return T(n,e),n}(H),uU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),cU=function(e){function n(t){var r=t.channelUrl,i=t.channelType,a=t.pollId,s=t.optionText,o=e.call(this)||this;return o.method=z.POST,o.path="".concat(Gi,"/").concat(encodeURIComponent(a),"/options"),o.params={channel_url:r,channel_type:i,text:s},o}return T(n,e),n}(H),dU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),hU=function(e){function n(t){var r=t.pollId,i=t.pollOptionId,a=t.optionText,s=e.call(this)||this;return s.method=z.PUT,s.path="".concat(Gi,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),s.params={text:a},s}return T(n,e),n}(H),fU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.poll=new bi(t,r),i}return T(n,e),n}(j),pU=function(e){function n(t){var r=t.pollId,i=t.pollOptionId,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Gi,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var mU=function(e){function n(t){var r=t.reqId,i=t.channelType,a=t.channelUrl,s=t.pollId,o=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:W({req_id:r,channel_type:i===Pe.OPEN?"open_channels":"group_channels",channel_url:a,poll_id:s,option_ids:o})})||this}return T(n,e),n}(sr),lN=function(e){function n(t,r,i){var a=e.call(this,t,"VOTE",i)||this;return a.event=new wk(i),a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return T(n,e),n}(pt),uN=100,cN="GroupChannel",_U="url",dN=100,Fy="Message",gU="messageId",hN="NotificationMessage",vU="notificationId",yU="Poll",bU="pollId",EU="FeedChannel",CU="url",fN="UserInfo",SU="userId";function TU(e){var n,t,r;return(n=e.messageParams)!==null&&n!==void 0?n:ae(N(N({},e),{isReplyToChannel:!1,mentionedUserIds:(t=e.mentionedUserIds)!==null&&t!==void 0?t:(r=e.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),pushNotificationDeliveryOption:qi.DEFAULT,isPinnedMessage:!1,fileInfoList:e.fileInfoList.map(function(i){var a;return{fileUrl:i.plainUrl,fileName:i.fileName,fileSize:i.fileSize,mimeType:i.mimeType,thumbnailSizes:(a=i.thumbnails)===null||a===void 0?void 0:a.map(function(s){return{maxWidth:s.width,maxHeight:s.height}}),_thumbnails:i.thumbnails,_uploadedMetaData:{requireAuth:i._requireAuth,isUploaded:!0}}})}))}var wU=N(N({},Dm),{fileInfoList:[],message:""}),AU=function(e){return(Kn(e.file)||x("string",e.fileUrl))&&x("string",e.fileName,!0)&&x("string",e.mimeType,!0)&&x("number",e.fileSize,!0)&&(e.thumbnailSizes===void 0||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every(function(n){return n.maxWidth>0&&n.maxHeight>0}))},Ff=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t._onFileUploaded=Ne,t}return T(n,e),n.prototype._triggerOnFileUploaded=function(t,r,i,a){this._onFileUploaded(t,r,i,a)},n.prototype.onFileUploaded=function(t){return this._onFileUploaded=t,this},n.prototype.onPending=function(t){return e.prototype.onPending.call(this,t),this},n.prototype.onFailed=function(t){return e.prototype.onFailed.call(this,t),this},n.prototype.onSucceeded=function(t){return e.prototype.onSucceeded.call(this,t),this},n}(Sr),NU=function(e){function n(t,r){var i=e.call(this,t)||this;return i.message=null,i.message=Zn(t,r.message),i}return T(n,e),n}(Wt),IU=function(e){function n(t){var r=this,i=t.channelType,a=t.channelUrl,s=t.limit,o=t.token,l=t.includeReactions,u=t.includeMetaArray,c=t.includeParentMessageInfo,d=t.includeThreadInfo,h=t.includePollDetails;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(i),"/").concat(encodeURIComponent(a),"/pinned_messages"),r.params=W({limit:s,token:o,include_reactions_summary:l,with_sorted_meta_array:u,include_thread_info:d,include_parent_message_info:c,include_poll_details:h}),r}return T(n,e),n}(H),MU=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.pinned_messages,s=r.has_more,o=r.next;return i.pinnedMessages=a.map(function(l){return new NU(t,l)}),i.hasMore=s,i.token=o,i}return T(n,e),n}(j),xU=function(e){function n(t,r,i,a){var s=e.call(this,t,r,i,a)||this;return s.includeMetaArray=a.includeMetaArray,s.includeReactions=a.includeReactions,s.includeParentMessageInfo=a.includeParentMessageInfo,s.includeThreadInfo=a.includeThreadInfo,s.includePollDetails=a.includePollDetails,s}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("boolean",this.includeMetaArray,!0)&&x("boolean",this.includeReactions,!0)&&x("boolean",this.includeParentMessageInfo,!0)&&x("boolean",this.includeThreadInfo,!0)&&x("boolean",this.includePollDetails,!0)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new IU(N(N({},this),{token:this._token})),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=u.sent(),a=i.as(MU),s=a.pinnedMessages,o=a.hasMore,l=a.token,this._token=l,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),OU=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=e.call(this)||this;return s.method=z.POST,s.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var DU=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.messageId,s=e.call(this)||this;return s.method=z.DELETE,s.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var In,kU=2;(function(e){e.SEND="send",e.RESEND="resend",e.COPY="copy"})(In||(In={}));var bt,eC=function(e){function n(t,r){var i,a,s,o,l,u,c,d=this;return(d=e.call(this,t)||this)._name="",d._createdAt=0,d.pinnedMessageIds=[],d.channelType=Pe.BASE,d.coverUrl="",d.customType="",d.data="",d.isFrozen=!1,d.isEphemeral=!1,d.creator=null,d._messageCollectionLastAccessedAt=0,d._url=r.channel_url,d._name=(i=r.name)!==null&&i!==void 0?i:"",d._createdAt=1e3*r.created_at,d.coverUrl=(a=r.cover_url)!==null&&a!==void 0?a:"",d.customType=(s=r.custom_type)!==null&&s!==void 0?s:"",d.data=(o=r.data)!==null&&o!==void 0?o:"",d.isFrozen=(l=r.freeze)!==null&&l!==void 0&&l,d.isEphemeral=(u=r.is_ephemeral)!==null&&u!==void 0&&u,d.creator=r.created_by?new xe(d._iid,r.created_by):null,r.metadata&&Object.keys(r.metadata).length>0&&r.ts?(d._cachedMetaData=new Map,Object.keys(r.metadata).forEach(function(h){d._cachedMetaData.set(h,{value:r.metadata[h],isRemoved:!1,updatedAt:r.ts})})):typeof r.metadata=="string"&&(d._cachedMetaData=new Map(Object.entries(JSON.parse(r.metadata)))),d.pinnedMessageIds=(c=r.pinned_message_ids)!==null&&c!==void 0?c:[],d}return T(n,e),Object.defineProperty(n.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return N(N({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},n.payloadify=function(t,r){r===void 0&&(r=!1);var i=N(N({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?xe.payloadify(t.creator):null,created_at:t.createdAt/1e3,metadata:t.cachedMetaData,pinned_message_ids:t.pinnedMessageIds});return r?i:W(ae(i))},n.prototype.isGroupChannel=function(){return this.channelType===Pe.GROUP},n.prototype.isOpenChannel=function(){return this.channelType===Pe.OPEN},n.prototype.isFeedChannel=function(){return this.channelType===Pe.FEED},Object.defineProperty(n.prototype,"cachedMetaData",{get:function(){var t={};return this._cachedMetaData&&this._cachedMetaData.forEach(function(r,i){r.isRemoved||(t[i]=r.value)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),n.prototype._serializeCachedMetaData=function(){return this._cachedMetaData?{cachedMetaData:JSON.stringify(Object.fromEntries(this._cachedMetaData))}:{}},n.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},n.prototype._update=function(t){Object.assign(this,t)},n.prototype._upsertCachedMetaData=function(t,r){var i=this;Object.keys(t).forEach(function(a){i._cachedMetaData||(i._cachedMetaData=new Map);var s=i._cachedMetaData.get(a);(!s||s.updatedAt<=r)&&i._cachedMetaData.set(a,{value:t[a],isRemoved:!1,updatedAt:r})})},n.prototype._updateCachedMetaData=function(t,r){var i=this,a=!1;return this._cachedMetaData?this._cachedMetaData.forEach(function(s,o){var l;s.updatedAt<=r&&(i._cachedMetaData.set(o,{value:(l=t[o])!==null&&l!==void 0?l:s.value,isRemoved:!t[o],updatedAt:r}),a=!0)}):(this._cachedMetaData=new Map,Object.keys(t).forEach(function(s){i._cachedMetaData.set(s,{value:t[s],isRemoved:!1,updatedAt:r})}),a=!0),{isUpdated:a}},n.prototype._removeFromCachedMetaData=function(t,r){var i=this;this._cachedMetaData&&t.forEach(function(a){var s=i._cachedMetaData.get(a);s&&s.updatedAt<r&&(s.isRemoved=!0,s.updatedAt=r)})},n.prototype._clearCachedMetaData=function(){this._cachedMetaData&&this._cachedMetaData.clear()},n.prototype._runIfHandleableWithGroupChannel=function(t){this.isGroupChannel()?t(this):this.isFeedChannel()&&t(this.groupChannel)},n.prototype._generateRequestId=function(){return"rq-".concat(Wr())},n.prototype.isIdentical=function(t){return t&&this.url===t.url},n.prototype.isEqual=function(t){return Q2(this,t)},n.prototype.createOperatorListQuery=function(t){return t===void 0&&(t={}),new dR(this._iid,this.url,this.channelType,t)},n.prototype.createMutedUserListQuery=function(t){return t===void 0&&(t={}),new mR(this._iid,this.url,this.channelType,t)},n.prototype.createBannedUserListQuery=function(t){return t===void 0&&(t={}),new vR(this._iid,this.url,this.channelType,t)},n.prototype.createPreviousMessageListQuery=function(t){return t===void 0&&(t={}),new hR(this._iid,this.url,this.channelType,t)},n.prototype.createPinnedMessageListQuery=function(t){return t===void 0&&(t={}),new xU(this._iid,this.url,this.channelType,t)},n.prototype.addOperators=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(Te("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new yR({channelUrl:this.url,channelType:this.channelType,operatorUserIds:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.removeOperators=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(Te("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new bR({channelUrl:this.url,channelType:this.channelType,operatorUserIds:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.getMyMutedInfo=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h;return _(this,function(f){switch(f.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new ER({channelUrl:this.url,channelType:this.channelType,userId:r.userId}),[4,i.send(a)];case 1:return s=f.sent(),o=s.as(CR),l=o.isMuted,u=o.startAt,c=o.endAt,d=o.remainingDuration,h=o.description,[2,{isMuted:l,startAt:u,endAt:c,remainingDuration:d,description:h}]}})})},n.prototype.getMetaData=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(Te("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new Q1({channelUrl:this.url,channelType:this.channelType,keys:t}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(K1),o=s.metadata,l=s.ts,this._upsertCachedMetaData(o,l),[2,o]}})})},n.prototype.getAllMetaData=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid).requestQueue,r=new Q1({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,t.send(r)];case 1:return i=l.sent(),a=i.as(K1),s=a.metadata,o=a.ts,this._updateCachedMetaData(s,o),[2,s]}})})},n.prototype.createMetaData=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=I.of(this._iid).requestQueue,i=new SR({channelUrl:this.url,channelType:this.channelType,metadata:t}),[4,r.send(i)];case 1:return a=o.sent(),s=a.as(TR).metaData,this._upsertCachedMetaData(s,0),[2,s]}})})},n.prototype.updateMetaData=function(t,r){return r===void 0&&(r=!1),g(this,void 0,void 0,function(){var i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return i=I.of(this._iid).requestQueue,a=new wR({channelUrl:this.url,channelType:this.channelType,metadata:t,upsert:r}),[4,i.send(a)];case 1:return s=c.sent(),o=s.as(AR),l=o.metadata,u=o.ts,this._upsertCachedMetaData(l,u),[2,l]}})})},n.prototype.deleteMetaData=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return B(x("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new IR({channelUrl:this.url,channelType:this.channelType,key:t}),[4,r.send(i)];case 1:return a=o.sent(),s=a.as(MR).ts,this._removeFromCachedMetaData([t],s),[2]}})})},n.prototype.deleteAllMetaData=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid).requestQueue,r=new xR({channelUrl:this.url,channelType:this.channelType}),[4,t.send(r)];case 1:return i=s.sent(),a=i.as(OR).ts,this._removeFromCachedMetaData(ce([],ne(this._cachedMetaData.keys()),!1),a),[2]}})})},n.prototype.getMetaCounters=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return B(Te("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new W1({channelUrl:this.url,channelType:this.channelType,keys:t}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(Y1).metaCounter]}})})},n.prototype.getAllMetaCounters=function(){return g(this,void 0,void 0,function(){var t,r,i;return _(this,function(a){switch(a.label){case 0:return t=I.of(this._iid).requestQueue,r=new W1({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,t.send(r)];case 1:return i=a.sent(),[2,i.as(Y1).metaCounter]}})})},n.prototype.createMetaCounters=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=I.of(this._iid).requestQueue,i=new DR({channelUrl:this.url,channelType:this.channelType,metaCounter:t}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(kR).metaCounter]}})})},n.prototype.updateMetaCounters=function(t,r){return r===void 0&&(r=!1),g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return i=I.of(this._iid).requestQueue,a=new bg({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:r}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(Eg).metaCounter]}})})},n.prototype.increaseMetaCounters=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=I.of(this._iid).requestQueue,i=new bg({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:!1,mode:"increase"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(Eg).metaCounter]}})})},n.prototype.decreaseMetaCounters=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=I.of(this._iid).requestQueue,i=new bg({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:!1,mode:"decrease"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(Eg).metaCounter]}})})},n.prototype.deleteMetaCounter=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(x("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new UR({channelUrl:this.url,channelType:this.channelType,key:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.deleteAllMetaCounters=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=I.of(this._iid).requestQueue,r=new LR({channelUrl:this.url,channelType:this.channelType}),[4,t.send(r)];case 1:return i.sent(),[2]}})})},n.prototype.muteUser=function(t,r,i){return g(this,void 0,void 0,function(){return _(this,function(a){return[2,this.muteUserWithUserId(t.userId,r,i)]})})},n.prototype.muteUserWithUserId=function(t,r,i){return g(this,void 0,void 0,function(){var a,s;return _(this,function(o){switch(o.label){case 0:return B(x("string",t)&&x("number",r,!0)&&x("string",i,!0)).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new PR({channelUrl:this.url,channelType:this.channelType,userId:t,seconds:r,description:i}),[4,a.send(s)];case 1:return o.sent(),[2]}})})},n.prototype.unmuteUser=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2,this.unmuteUserWithUserId(t.userId)]})})},n.prototype.unmuteUserWithUserId=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(x("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new $R({channelUrl:this.url,channelType:this.channelType,userId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.banUser=function(t,r,i){return g(this,void 0,void 0,function(){return _(this,function(a){return[2,this.banUserWithUserId(t.userId,r,i)]})})},n.prototype.banUserWithUserId=function(t,r,i){return g(this,void 0,void 0,function(){var a,s;return _(this,function(o){switch(o.label){case 0:return B(x("string",t)&&x("number",r,!0)&&x("string",i,!0)).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new HR({channelUrl:this.url,channelType:this.channelType,userId:t,seconds:r,description:i}),[4,a.send(s)];case 1:return o.sent(),[2]}})})},n.prototype.unbanUser=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2,this.unbanUserWithUserId(t.userId)]})})},n.prototype.unbanUserWithUserId=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(x("string",t)).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new BR({channelUrl:this.url,channelType:this.channelType,userId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.freeze=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=I.of(this._iid).requestQueue,r=new Z1({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,t.send(r)];case 1:return i.sent(),this.isFrozen=!0,[2]}})})},n.prototype.unfreeze=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=I.of(this._iid).requestQueue,r=new Z1({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,t.send(r)];case 1:return i.sent(),this.isFrozen=!1,[2]}})})},n.prototype.getMessagesByMessageId=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},pd),r),B(x("number",t)&&z1(i)).throw(k.invalidParameters),[4,un.of(this._iid).getMessagesByMessageId(this.url,this.channelType,t,i)];case 1:return[2,a.sent()]}})})},n.prototype.getMessagesByTimestamp=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},pd),r),B(x("number",t)&&z1(i)).throw(k.invalidParameters),[4,un.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,t,i)];case 1:return[2,a.sent()]}})})},n.prototype.getMessageChangeLogsSinceTimestamp=function(t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},Wv),r),B(x("number",t)&&H1(i)).throw(k.invalidParameters),[4,un.of(this._iid).getMessageChangelogs(this.url,this.channelType,t,i)];case 1:return[2,a.sent()]}})})},n.prototype.getMessageChangeLogsSinceToken=function(t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},Wv),r),B(x("string",t)&&H1(i)).throw(k.invalidParameters),[4,un.of(this._iid).getMessageChangelogs(this.url,this.channelType,t,i)];case 1:return[2,a.sent()]}})})},n.prototype._createPendingSendableMessagePayload=function(t,r,i){var a,s=I.of(this._iid).sessionManager;return W(ae({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:t.parentMessageId,data:t.data,custom_type:t.customType,mention_type:t.mentionType,sorted_metaarray:t.metaArrays?t.metaArrays.map(function(o){return nr.payloadify(o)}):null,apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,created_at:i,user:s.currentUser?Du.payloadify(s.currentUser):null,req_id:r,request_state:rt.PENDING,mentioned_user_ids:t.mentionedUserIds,mentioned_users:(a=t.mentionedUsers)===null||a===void 0?void 0:a.map(function(o){return xe.payloadify(o)})}))},n.prototype._createPendingUserMessage=function(t,r,i){var a,s,o={};if(t.translationTargetLanguages)try{for(var l=K(t.translationTargetLanguages),u=l.next();!u.done;u=l.next())o[u.value]=""}catch(h){a={error:h}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}var c=W(N(N({},this._createPendingSendableMessagePayload(t,r,i)),{type:vt.USER,message:t.message,translations:o,extended_message_payload:t.extendedMessagePayload})),d=new kn(this._iid,c);return d.messageParams=t,d},n.prototype._createPendingScheduledUserMessage=function(t,r,i){var a=this._createPendingUserMessage(t,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:t.scheduledAt,scheduledMessageParams:t},a},n.prototype._createPendingFileMessage=function(t,r,i){var a,s,o,l,u,c,d,h=W(N(N({},this._createPendingSendableMessagePayload(t,r,i)),{type:vt.FILE,url:t.fileUrl,file:{name:(a=t.fileName)!==null&&a!==void 0?a:(s=t.file)===null||s===void 0?void 0:s.name,size:(o=t.fileSize)!==null&&o!==void 0?o:(l=t.file)===null||l===void 0?void 0:l.size,type:(u=t.mimeType)!==null&&u!==void 0?u:(c=t.file)===null||c===void 0?void 0:c.type,data:t.data},thumbnails:(d=t._thumbnails)===null||d===void 0?void 0:d.map(function(m){return es.payloadify(m)}),message:t.message})),f=new qt(this._iid,h);return f.messageParams=t,f},n.prototype._createPendingMultipleFilesMessage=function(t,r,i){var a=W(N(N({},this._createPendingSendableMessagePayload(t,r,i)),{type:vt.FILE,file:t.fileInfoList.length>0?{name:t.fileInfoList[0].fileName,size:t.fileInfoList[0].fileSize,type:t.fileInfoList[0].mimeType,data:t.data}:void 0,message:t.message})),s=new qr(this._iid,a);return s.messageParams=t,s},n.prototype._validateFailedFileMessageHasFile=function(t,r){var i;return!!t.url||Kn(r)||Kn((i=t.messageParams)===null||i===void 0?void 0:i.file)},n.prototype._createPendingScheduledFileMessage=function(t,r,i){var a=this._createPendingFileMessage(t,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:t.scheduledAt,scheduledMessageParams:t},a},n.prototype._markMessageAsFailed=function(t,r,i){i===void 0&&(i=!1),t.errorCode=r.code,r.code===re.REQUEST_CANCELED||r.code===re.FILE_UPLOAD_CANCEL_FAILED?t.sendingStatus=rt.CANCELED:i||(t.sendingStatus=rt.FAILED)},n.prototype.sendUserMessage=function(t){var r=N(N({},eN),t);return B(nN(r)).throw(k.invalidParameters),this._sendUserMessage(r)},n.prototype._sendUserMessage=function(t,r,i){var a=this;r===void 0&&(r=In.SEND);var s=I.of(this._iid),o=s.dispatcher,l=s.requestQueue,u=i??this._generateRequestId(),c=Date.now(),d=new Sr;return tr(2).then(function(){var h=a._createPendingUserMessage(t,u,c);o.dispatch(new _t({messages:[h],source:r===In.RESEND?P.LOCAL_MESSAGE_RESEND_STARTED:P.EVENT_MESSAGE_SENT_PENDING})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(m){return[2,d._trigger(h)]})})});var f=new WR(N(N({},t),{channelUrl:a.url,channelType:a.channelType,reqId:u}));l.send(f).then(function(m){var y=m.as(sN).message;o.dispatch(new _t({messages:[y],source:P.EVENT_MESSAGE_SENT_SUCCESS})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(C){return[2,d._trigger(y)]})})})}).catch(function(m){if(fr(m))throw m;tr(2).then(function(){var y=a._createPendingUserMessage(t,u,c),C=I.of(a._iid).cacheContext,b=C.localCacheEnabled&&C.localCacheConfig.enableAutoResend&&Ap(m.code);a._markMessageAsFailed(y,m,b),o.dispatch(new _t({messages:[y],source:y.sendingStatus===rt.PENDING?P.REQUEST_RESEND_MESSAGE:P.EVENT_MESSAGE_SENT_FAILED})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(v){return[2,d._triggerFailed(m,y)]})})})})})}),d},n.prototype._autoResendUserMessage=function(t){return B(t instanceof kn&&!!t.messageParams).throw(k.invalidParameters),this._sendUserMessage(t.messageParams,In.SEND,t.reqId)},n.prototype.resendUserMessage=function(t){var r;return g(this,void 0,void 0,function(){var i,a;return _(this,function(s){return B(t instanceof kn&&!t.scheduledInfo).throw(k.invalidParameters),i=new ar,a=(r=t.messageParams)!==null&&r!==void 0?r:Zv(t),this._sendUserMessage(a,In.RESEND,t.reqId).onFailed(function(o){return i.reject(o)}).onSucceeded(function(o){return i.resolve(o)}),[2,i.promise]})})},n.prototype.updateUserMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return i=N(N({},iN),r),B(x("number",t)&&aN(i)).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new X1(N({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return o=l.sent(),[2,o.as(Jv).message]}})})},n.prototype.copyUserMessage=function(t,r){var i,a,s;return g(this,void 0,void 0,function(){var o,l;return _(this,function(u){return B(t instanceof n&&r instanceof kn&&r.sendingStatus===rt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(k.invalidParameters),B(!r.poll).throw(k.notSupportedError),o=new ar,l=(i=r.messageParams)!==null&&i!==void 0?i:ae(N(N({},r),{mentionType:r.mentionType,mentionedUserIds:(a=r.mentionedUserIds)!==null&&a!==void 0?a:(s=r.mentionedUsers)===null||s===void 0?void 0:s.map(function(c){return c.userId}),translationTargetLanguages:Object.keys(r.translations),pushNotificationDeliveryOption:qi.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),t._sendUserMessage(l).onSucceeded(function(c){o.resolve(c)}).onFailed(function(c){return o.reject(c)}),[2,o.promise]})})},n.prototype.translateUserMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return B(t instanceof kn&&t.messageId>0&&Te("string",r)).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new eU({channelType:this.channelType,channelUrl:this.url,messageId:t.messageId,translationTargetLanguages:r}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(tU).message]}})})},n.prototype._createScheduledUserMessage=function(t,r){var i=this,a=I.of(this._iid).requestQueue,s=Date.now(),o=this._generateRequestId();tr(2).then(function(){var u=i._createPendingScheduledUserMessage(t,o,s);he(function(){return g(i,void 0,void 0,function(){return _(this,function(c){return[2,r._trigger(u)]})})})});var l=new nU(N({reqId:o,channelType:this.channelType,channelUrl:this.url},t));a.send(l).then(function(u){var c=u.as(oN).message;he(function(){return g(i,void 0,void 0,function(){return _(this,function(d){return[2,r._trigger(c)]})})})}).catch(function(u){if(fr(u))throw u;tr(2).then(function(){var c=i._createPendingScheduledUserMessage(t,o,s);i._markMessageAsFailed(c,u),he(function(){return g(i,void 0,void 0,function(){return _(this,function(d){return[2,r._triggerFailed(u,c)]})})})})})},n.prototype.sendFileMessage=function(t){var r=N(N({},V1),t);return B(j1(r)).throw(k.invalidParameters),this._sendFileMessage(r)},n.prototype.sendMultipleFilesMessage=function(t){var r,i=N(N({},wU),t),a=I.of(this._iid);B(function(o,l){return l===void 0&&(l=XD),km(o)&&x("string",o.message,!0)&&Array.isArray(o.fileInfoList)&&o.fileInfoList.length>=2&&o.fileInfoList.length<=l&&o.fileInfoList.every(function(u){return AU(u)})}(i,(r=a.appInfo)===null||r===void 0?void 0:r.multipleFilesMessageFileCountLimit)).throw(k.invalidParameters);var s=!!t.fileInfoList.find(function(o){var l=a.appInfo.uploadSizeLimit;return o.file instanceof Blob&&o.file.size>l||o.fileSize>l});return B(!s).throw(k.fileSizeLimitExceededError),this._sendMultipleFilesMessage(i)},n.prototype._sendFileMessage=function(t,r,i){var a=this;r===void 0&&(r=In.SEND);var s=I.of(this._iid).dispatcher,o=un.of(this._iid).fileMessageQueue,l=i??this._generateRequestId(),u=Date.now(),c=new Sr;return tr(2).then(function(){var d=a._createPendingFileMessage(t,l,u);s.dispatch(new _t({messages:[d],source:r===In.RESEND?P.LOCAL_MESSAGE_RESEND_STARTED:P.EVENT_MESSAGE_SENT_PENDING})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(h){return[2,c._trigger(d)]})})}),o.request(a,l,t).then(function(h){s.dispatch(new _t({messages:[h],source:P.EVENT_MESSAGE_SENT_SUCCESS})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(f){return[2,c._trigger(h)]})})})}).catch(function(h){if(fr(h))throw h;tr(2).then(function(){var f=a._createPendingFileMessage(t,l,u),m=I.of(a._iid).cacheContext,y=m.localCacheEnabled&&m.localCacheConfig.enableAutoResend&&Ap(h.code);a._markMessageAsFailed(f,h,y),s.dispatch(new _t({messages:[f],source:f.sendingStatus===rt.PENDING?P.REQUEST_RESEND_MESSAGE:h.code===re.FILE_UPLOAD_CANCEL_FAILED?P.LOCAL_MESSAGE_CANCELED:P.EVENT_MESSAGE_SENT_FAILED})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(C){return[2,c._triggerFailed(h,f)]})})})})})}),c},n.prototype._autoResendFileMessage=function(t){B(t instanceof qt&&!!t.messageParams).throw(k.invalidParameters);var r=I.of(this._iid).logger;return r.debug("autoResendFileMessage pending",t),this._sendFileMessage(t.messageParams,In.SEND,t.reqId).onFailed(function(i){r.debug("autoResendFileMessage failed",i)}).onSucceeded(function(i){r.debug("autoResendFileMessage success",i)})},n.prototype._sendMultipleFilesMessage=function(t,r,i){var a=this,s=I.of(this._iid).dispatcher,o=un.of(this._iid).fileMessageQueue,l=i??this._generateRequestId(),u=Date.now(),c=new Ff;return tr(2).then(function(){var d=a._createPendingMultipleFilesMessage(t,l,u);s.dispatch(new _t({messages:[d],source:r===In.RESEND?P.LOCAL_MESSAGE_RESEND_STARTED:P.EVENT_MESSAGE_SENT_PENDING})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(h){return[2,c._trigger(d)]})})}),o.request(a,l,t,{requestHandler:c,isCopy:r===In.COPY}).then(function(h){s.dispatch(new _t({messages:[h],source:P.EVENT_MESSAGE_SENT_SUCCESS})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(f){return[2,c._trigger(h)]})})})}).catch(function(h){if(fr(h))throw h;tr(2).then(function(){var f=a._createPendingMultipleFilesMessage(t,l,u);a._markMessageAsFailed(f,h),s.dispatch(new _t({messages:[f],source:P.EVENT_MESSAGE_SENT_FAILED})),he(function(){return g(a,void 0,void 0,function(){return _(this,function(m){return[2,c._triggerFailed(h,f)]})})})})})}),c},n.prototype._createScheduledFileMessage=function(t,r,i,a){var s=this,o=I.of(this._iid).requestQueue,l=new rU(N(N({reqId:i,channelType:this.channelType,channelUrl:this.url},t),{fileUrl:t.fileUrl,requireAuth:t.requireAuth}));o.send(l).then(function(u){var c=u.as(iU).message;he(function(){return g(s,void 0,void 0,function(){return _(this,function(d){return[2,r._trigger(c)]})})})}).catch(function(u){if(fr(u))throw u;tr(2).then(function(){var c=s._createPendingScheduledFileMessage(t,i,a);s._markMessageAsFailed(c,u),he(function(){return g(s,void 0,void 0,function(){return _(this,function(d){return[2,r._triggerFailed(u,c)]})})})})})},n.prototype.sendFileMessages=function(t){var r,i;B(t.every(function(u){return j1(N(N({},V1),u))})).throw(k.invalidParameters);var a=new Sr;try{for(var s=K(t),o=s.next();!o.done;o=s.next()){var l=o.value;this.sendFileMessage(l).onPending(function(u){return a._trigger(u)}).onFailed(function(u,c){return a._triggerFailed(u,c)}).onSucceeded(function(u){return a._trigger(u)})}}catch(u){r={error:u}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},n.prototype.resendFileMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){return i=this._validateFailedFileMessageHasFile(t,r),B(t instanceof qt&&i&&!t.scheduledInfo).throw(k.invalidParameters),a=new ar,s=Xv(t,r),this._sendFileMessage(s,In.RESEND,t.reqId).onFailed(function(l){return a.reject(l)}).onSucceeded(function(l){return a.resolve(l)}),[2,a.promise]})})},n.prototype.resendMessage=function(t,r){var i,a;if(B(t instanceof xt&&!t.scheduledInfo&&t.isResendable).throw(k.invalidParameters),t.isUserMessage()){var s=(i=t.messageParams)!==null&&i!==void 0?i:Zv(t);return this._sendUserMessage(s,In.RESEND,t.reqId)}if(t.isFileMessage()){var o=this._validateFailedFileMessageHasFile(t,r);return B(o).throw(k.invalidParameters),s=(a=t.messageParams)!==null&&a!==void 0?a:Xv(t,r),this._sendFileMessage(s,In.RESEND,t.reqId)}if(t.isMultipleFilesMessage())throw k.channelTypeNotSupportedError},n.prototype.updateFileMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return i=N(N({},lR),r),B(x("number",t)&&function(u){return Uy(u)}(i)).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new J1(N({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return o=l.sent(),[2,o.as(e0).message]}})})},n.prototype.uploadFile=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return r=I.of(this._iid).requestQueue,i=Wr(),(a=new Fp({file:t.file,channelUrl:this.url,thumbnailSizes:t.thumbnailSizes,requestId:i})).uploadProgressHandler=t.progressHandler,t.uploadStartedHandler&&t.uploadStartedHandler(i),[4,r.send(a)];case 1:return s=c.sent(),o=s.as($p),l=o.url,u=o.thumbnails,[2,{requestId:i,url:l,thumbnails:u}]}})})},n.prototype.cancelUploadingFileMessage=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(x("string",t)).throw(k.invalidParameters),un.of(this._iid).fileMessageQueue.cancel(this,t),[2,!0]})})},n.prototype.copyFileMessage=function(t,r){var i,a,s;return g(this,void 0,void 0,function(){var o,l;return _(this,function(u){return B(t instanceof n&&r instanceof qt&&r.sendingStatus===rt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(k.invalidParameters),o=new ar,l=ae(N(N({},r),{fileUrl:r.url,fileName:r.name,fileSize:r.size,mimeType:r.type,mentionType:r.mentionType,mentionedUserIds:(i=r.mentionedUserIds)!==null&&i!==void 0?i:(a=r.mentionedUsers)===null||a===void 0?void 0:a.map(function(c){return c.userId}),pushNotificationDeliveryOption:qi.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(s=r.thumbnails)===null||s===void 0?void 0:s.map(function(c){return{maxWidth:c.width,maxHeight:c.height}}),requireAuth:r.requireAuth,isPinnedMessage:!1})),t._sendFileMessage(l).onSucceeded(function(c){return o.resolve(c)}).onFailed(function(c){return o.reject(c)}),[2,o.promise]})})},n.prototype.copyMessage=function(t,r){B(t instanceof n&&r instanceof xt&&r.sendingStatus===rt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(k.invalidParameters);var i=r,a=t;if(i.isUserMessage()){B(!i.poll).throw(k.notSupportedError);var s=tN(i);return a._sendUserMessage(s)}if(i.isFileMessage())return s=rN(i),a._sendFileMessage(s);if(r.isMultipleFilesMessage())throw k.channelTypeNotSupportedError},n.prototype.deleteMessage=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(t instanceof Vn).throw(k.invalidParameters),t.messageId>0?(r=I.of(this._iid).requestQueue,i=new rA({channelType:this.channelType,channelUrl:this.url,messageId:t.messageId,messageToken:t instanceof xt?t._messageToken:void 0}),[4,r.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},n.prototype.addReaction=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return B(t instanceof Vn&&t.messageId>0&&x("string",r)).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new YR({channelType:this.channelType,channelUrl:this.url,messageId:t.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(ZR).reactionEvent]}})})},n.prototype.deleteReaction=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return B(t instanceof Vn&&t.messageId>0&&x("string",r)).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new XR({channelType:this.channelType,channelUrl:this.url,messageId:t.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(JR).reactionEvent]}})})},n.prototype._updateUserMessageMetaArray=function(t,r,i,a){return g(this,void 0,void 0,function(){var s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return s=I.of(this._iid),o=s.dispatcher,l=s.requestQueue,u=new X1({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,l.send(u)];case 1:return c=h.sent(),d=c.as(Jv).message,o.dispatch(new _t({messages:[d],source:P.EVENT_MESSAGE_UPDATED})),[2,d]}})})},n.prototype._updateFileMessageMetaArray=function(t,r,i,a){return g(this,void 0,void 0,function(){var s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return s=I.of(this._iid),o=s.dispatcher,l=s.requestQueue,u=new J1({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,l.send(u)];case 1:return c=h.sent(),d=c.as(e0).message,o.dispatch(new _t({messages:[d],source:P.EVENT_MESSAGE_UPDATED})),[2,d]}})})},n.prototype.createMessageMetaArrayKeys=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){return B(t instanceof Vn&&t.messageId>0&&Te("string",r)).throw(k.invalidParameters),i=r.map(function(s){return new nr({key:s})}),t instanceof qt?[2,this._updateFileMessageMetaArray(t.messageId,i,"add",!0)]:[2,this._updateUserMessageMetaArray(t.messageId,i,"add",!0)]})})},n.prototype.deleteMessageMetaArrayKeys=function(t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){return B(t instanceof Vn&&t.messageId>0&&Te("string",r)).throw(k.invalidParameters),i=r.map(function(s){return new nr({key:s})}),t instanceof qt?[2,this._updateFileMessageMetaArray(t.messageId,i,"remove",!0)]:[2,this._updateUserMessageMetaArray(t.messageId,i,"remove",!0)]})})},n.prototype.addMessageMetaArrayValues=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return B(t instanceof Vn&&t.messageId>0&&r.every(function(a){return a instanceof nr})).throw(k.invalidParameters),t instanceof qt?[2,this._updateFileMessageMetaArray(t.messageId,r,"add",!0)]:[2,this._updateUserMessageMetaArray(t.messageId,r,"add",!0)]})})},n.prototype.removeMessageMetaArrayValues=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return B(t instanceof Vn&&t.messageId>0&&r.every(function(a){return a instanceof nr})).throw(k.invalidParameters),t instanceof qt?[2,this._updateFileMessageMetaArray(t.messageId,r,"remove",!0)]:[2,this._updateUserMessageMetaArray(t.messageId,r,"remove",!0)]})})},n.prototype.report=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return B((be(md,t)||t instanceof gu)&&x("string",r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.requestQueue,o=new jR({channelUrl:this.url,channelType:this.channelType,userId:a.userId,category:t,description:r}),[4,s.send(o)];case 1:return l.sent(),[2]}})})},n.prototype.reportUser=function(t,r,i){return g(this,void 0,void 0,function(){var a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(t instanceof xe&&(be(md,r)||r instanceof gu)&&x("string",i)).throw(k.invalidParameters),a=I.of(this._iid),s=a.sdkState,o=a.requestQueue,l=new QR({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:t.userId,category:r,description:i}),[4,o.send(l)];case 1:return u.sent(),[2]}})})},n.prototype.reportMessage=function(t,r,i){return g(this,void 0,void 0,function(){var a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(t instanceof xt&&(be(md,r)||r instanceof gu)&&x("string",i)).throw(k.invalidParameters),a=I.of(this._iid),s=a.sdkState,o=a.requestQueue,l=new KR({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:t.sender.userId,messageId:t.messageId,category:r,description:i,messageToken:t._messageToken}),[4,o.send(l)];case 1:return u.sent(),[2]}})})},n.prototype.updatePoll=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return B(x("number",t)&&function(l){return x("string",l.title,!0)&&HA(l.data)&&x("boolean",l.allowUserSuggestion,!0)&&x("boolean",l.allowMultipleVotes,!0)&&x("number",l.closeAt,!0)}(r)).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new aU(N({pollId:t},r)),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(sU).poll]}})})},n.prototype.deletePoll=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=x("number",t),B(r).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new oU({pollId:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.closePoll=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=x("number",t),B(r).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new lU({pollId:t}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(uU).poll]}})})},n.prototype.addPollOption=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return i=x("number",t)&&x("string",r)&&r.trim()!=="",B(i).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new cU({channelUrl:this.url,channelType:this.channelType,pollId:t,optionText:r}),[4,a.send(s)];case 1:return o=l.sent(),[2,o.as(dU).poll]}})})},n.prototype.updatePollOption=function(t,r,i){return g(this,void 0,void 0,function(){var a,s,o,l;return _(this,function(u){switch(u.label){case 0:return a=x("number",t)&&x("number",r)&&x("string",i)&&i.trim()!=="",B(a).throw(k.invalidParameters),s=I.of(this._iid).requestQueue,o=new hU({pollId:t,pollOptionId:r,optionText:i}),[4,s.send(o)];case 1:return l=u.sent(),[2,l.as(fU).poll]}})})},n.prototype.deletePollOption=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return i=x("number",t)&&x("number",r),B(i).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new pU({pollId:t,pollOptionId:r}),[4,a.send(s)];case 1:return o.sent(),[2]}})})},n.prototype.votePoll=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return i=x("number",t)&&Te("number",r),B(i).throw(k.invalidParameters),a=I.of(this._iid),s=a.requestQueue,o=a.dispatcher,l=new mU({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:t,pollOptionIds:r}),[4,s.send(l)];case 1:return u=d.sent(),c=u.as(lN).event,o.dispatch(new Dy({event:c,source:P.EVENT_POLL_VOTED})),[2,c]}})})},n.prototype.getPollChangeLogsSinceTimestamp=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return B(x("number",t)).throw(k.invalidParameters),[4,Pp.of(this._iid).getPollChangeLogs(this.url,this.channelType,t)];case 1:return[2,r.sent()]}})})},n.prototype.getPollChangeLogsSinceToken=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return B(x("string",t,!0)),[4,Pp.of(this._iid).getPollChangeLogs(this.url,this.channelType,t)];case 1:return[2,r.sent()]}})})},n.prototype.createPollListQuery=function(t){return t===void 0&&(t=10),new VA(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:t})},n.prototype.createPollVoterListQuery=function(t,r,i){return i===void 0&&(i=20),new jA(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:t,pollOptionId:r,limit:i})},n.prototype.pinMessage=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(x("number",t)&&t>0).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new OU({channelType:this.channelType,channelUrl:this.url,messageId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n.prototype.unpinMessage=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return B(x("number",t)&&t>0).throw(k.invalidParameters),r=I.of(this._iid).requestQueue,i=new DU({channelType:this.channelType,channelUrl:this.url,messageId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},n}(Wt),$y=function(e){function n(t){t===void 0&&(t={});var r=e.call(this)||this;return Object.keys(t).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=t[i])}),r}return T(n,e),n}(function(){this.onConnected=Ne,this.onReconnectStarted=Ne,this.onReconnectSucceeded=Ne,this.onReconnectFailed=Ne,this.onDisconnected=Ne}),t0=function(e){function n(t){t===void 0&&(t={});var r=e.call(this)||this;return Object.keys(t).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=t[i])}),r}return T(n,e),n}(function(){this.onSessionExpired=Ne,this.onSessionTokenRequired=function(e){return e(null)},this.onSessionError=Ne,this.onSessionRefreshed=Ne,this.onSessionClosed=Ne}),RU=function(e){function n(t){t===void 0&&(t={});var r=e.call(this)||this;return Object.keys(t).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=t[i])}),r}return T(n,e),n}(function(){this.onFriendsDiscovered=Ne,this.onTotalUnreadMessageCountChanged=Ne,this.onTotalUnreadMessageCountUpdated=Ne}),UU=function(e){function n(t){var r=t.limit,i=t.token,a=t.userIdsFilter,s=t.metaDataKeyFilter,o=t.metaDataValuesFilter,l=t.nicknameStartsWithFilter,u=e.call(this)||this;return u.method=z.GET,u.path=Fe,u.params=W({limit:r,token:i,user_ids:a,metadatakey:s,metadatavalues_in:o,nickname_startswith:l}),u}return T(n,e),n}(H),LU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.users=r.users.map(function(a){return new xe(t,a)}),i.next=r.next,i}return T(n,e),n}(j),PU=function(e){function n(t,r){var i,a,s,o=this;return(o=e.call(this,t,r)||this).userIdsFilter=null,o.metaDataKeyFilter=null,o.metaDataValuesFilter=null,o.nicknameStartsWithFilter=null,o.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,o.metaDataKeyFilter=(a=r.metaDataKeyFilter)!==null&&a!==void 0?a:null,o.metaDataValuesFilter=(s=r.metaDataValuesFilter)!==null&&s!==void 0?s:null,o.nicknameStartsWithFilter=r.nicknameStartsWithFilter||null,o}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&Te("string",this.userIdsFilter,!0)&&x("string",this.metaDataKeyFilter,!0)&&Te("string",this.metaDataValuesFilter,!0)&&x("string",this.nicknameStartsWithFilter,!0)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new UU(ae(N(N({},this),{token:this._token}))),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(LU),s=a.users,o=a.next,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),FU=function(e){function n(t){var r=t.userId,i=t.limit,a=t.token,s=t.userIdsFilter,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Fe,"/").concat(r,"/block"),o.params=W({limit:i,token:a,user_ids:s}),o}return T(n,e),n}(H),$U=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.users=r.users.map(function(a){return new xe(t,a)}),i.next=r.next,i}return T(n,e),n}(j),zU=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).userIdsFilter=null,a.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,a}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&Te("string",this.userIdsFilter,!0)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new FU(ae(N(N({},this),{userId:r.userId,token:this._token}))),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=c.sent(),o=s.as($U),l=o.users,u=o.next,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,l];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),HU=function(e){function n(t){var r=t.userId,i=t.limit,a=t.token,s=e.call(this)||this;return s.method=z.GET,s.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friends"),s.params={limit:i,token:a},s}return T(n,e),n}(H),qU=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.hasMore=r.has_more,i.users=r.users.map(function(a){return new xe(t,a)}),i.next=r.next,i}return T(n,e),n}(j),BU=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new HU(N(N({},this),{userId:r.userId,token:this._token})),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=d.sent(),o=s.as(qU),l=o.users,u=o.hasMore,c=o.next,this._token=c,this._hasNext=u,this._isLoading=!1,[2,l];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),tf={},fh=function(){function e(n){var t=n.dbname,r=n.itemSizeLimit,i=r===void 0?1048576:r,a=n.cacheLimit,s=a===void 0?256:a,o=n.blockHashBase,l=o===void 0?2:o,u=n.blockHashMultiplier,c=u===void 0?10:u,d=n.blockHashConstant,h=d===void 0?11:d,f=n.transactionApplyDelay,m=f===void 0?200:f,y=n.disableLogger,C=y!==void 0&&y;return tf[t]||(this.itemSizeLimit=i,this.cacheLimit=s,this.blockHashBase=l,this.blockHashMultiplier=c,this.blockHashConstant=h,this.transactionApplyDelay=m,this.disableLogger=C,tf[t]=this),tf[t]}return e.get=function(n){return tf[n]},e}();(function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"})(bt||(bt={}));var zo,Ve=function(e){function n(t){var r=t.code,i=r===void 0?bt.UNKNOWN_ERROR:r,a=t.message,s=a===void 0?"Unknown error occurred.":a,o=e.call(this,s)||this;return o.code=i,Object.setPrototypeOf(o,n.prototype),o}return T(n,e),Object.defineProperty(n,"storeNotDefined",{get:function(){return new n({code:bt.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeNotAvailable",{get:function(){return new n({code:bt.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeNotAvailableInPrivateBrowsing",{get:function(){return new n({code:bt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeIsFull",{get:function(){return new n({code:bt.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeNotInitialized",{get:function(){return new n({code:bt.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeKeyTypeIsInvalid",{get:function(){return new n({code:bt.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeBrokenIntegrity",{get:function(){return new n({code:bt.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeBrokenBlob",{get:function(){return new n({code:bt.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeEncryptionInvalid",{get:function(){return new n({code:bt.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeItemSizeExceeded",{get:function(){return new n({code:bt.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeReadFailed",{get:function(){return new n({code:bt.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"storeWriteFailed",{get:function(){return new n({code:bt.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"databaseSchemaNotOnUpgrade",{get:function(){return new n({code:bt.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionNotReady",{get:function(){return new n({code:bt.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionKeyNotMatch",{get:function(){return new n({code:bt.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionQueryNotValid",{get:function(){return new n({code:bt.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionInsertDuplicate",{get:function(){return new n({code:bt.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionKeyNotFound",{get:function(){return new n({code:bt.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionKeyNotGiven",{get:function(){return new n({code:bt.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionWriteFailed",{get:function(){return new n({code:bt.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"collectionItemSizeExceeded",{get:function(){return new n({code:bt.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"indexTableIsRequired",{get:function(){return new n({code:bt.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"indexTypesNotMatch",{get:function(){return new n({code:bt.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"compareTypesNotMatch",{get:function(){return new n({code:bt.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"circularReferenceFound",{get:function(){return new n({code:bt.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),n}(Error);(function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"})(zo||(zo={}));var tC,cr=function(e,n){if(n===void 0&&(n=new WeakMap),typeof e=="object"&&e!==null){if(n.has(e))throw Ve.circularReferenceFound;var t;return n.set(e,!0),Array.isArray(e)?t=e.map(function(r){return cr(r,n)}):e instanceof RegExp||e instanceof Date?t=e:(t={},Object.keys(e).forEach(function(r){t[r]=cr(e[r],n)})),n.delete(e),t}return e},Ha=function(e,n){if(n==null)return 1;if(e==null)return-1;if(typeof e!=typeof n)throw Ve.compareTypesNotMatch;var t=0;switch(typeof e){case"boolean":case"number":t=e-n;break;case"string":t=e.localeCompare(n)}return t},nC=function(e,n){for(var t=0,r=0;r<e.length;r++)t=e.charCodeAt(r)+(t<<6)+(t<<16)-t;return(t>>>0)%n},nf=function(e){return new Promise(function(n){setTimeout(function(){return n()},e)})},Yo=function(e,n){if(!n)return!1;if(typeof e!="function"){for(var t in e)if(["/and","&&"].includes(t)){if(e[t].some(function(l){return!Yo(l,n)}))return!1}else if(["/or","||"].includes(t)){if(e[t].every(function(l){return!Yo(l,n)}))return!1}else if(t==="/where"){if(!(0,e[t])(n))return!1}else{var r=t;if(typeof e[r]=="object"){var i=e[r];for(var a in i)switch(a){case"/eq":case"=":if((s=n[r])!==(o=i[a]))return!1;break;case"/neq":case"!=":if((s=n[r])===(o=i[a]))return!1;break;case"/gt":case">":var s=n[r],o=i[a];if(!(Ha(s,o)>0))return!1;break;case"/gte":case">=":if(s=n[r],o=i[a],!(Ha(s,o)>=0))return!1;break;case"/lt":case"<":if(s=n[r],o=i[a],!(Ha(s,o)<0))return!1;break;case"/lte":case"<=":if(s=n[r],o=i[a],!(Ha(s,o)<=0))return!1;break;case"/in":if(s=n[r],!(o=i[a]).includes(s))return!1;break;case"/nin":if(s=n[r],(o=i[a]).includes(s))return!1;break;case"/contain":if(s=n[r],o=i[a],!s.includes(o))return!1;break;case"/regex":if(s=n[r],!(o=i[a]).test(s))return!1;break;case"/where":if(s=n[r],!(0,i[a])(s))return!1}}else if(typeof e[r]=="function"){if(!e[r](n[r]))return!1}else if(e[r]!==n[r])return!1}return!0}return e(n)},Pc=function(){},rC=function(){return Promise.resolve()},GU=function(e){return e},iC=function(e,n){n()};(function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"})(tC||(tC={}));var Zo,jn,Yi,VU=function(){function e(n){var t=n.initialPrevValue,r=t===void 0?null:t,i=n.initialNextValue,a=i===void 0?null:i,s=n.iterator,o=n.map,l=o===void 0?GU:o,u=n.backward,c=u===void 0?rC:u,d=n.forward,h=d===void 0?rC:d,f=n.complete,m=f===void 0?Pc:f;this._prevValue=r,this._nextValue=a,this._error=null,this._map=l,this._backward=c,this._forward=h,this._iterator=s,this._complete=m}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:if(!this.hasPrevious)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),n=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=i.sent()||null,this._nextValue=n,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},e.prototype.next=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:if(!this.hasNext)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),n=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=i.sent()||null,this._prevValue=n,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),n0=function(){function e(n){var t=n.condition,r=t===void 0?{}:t,i=n.backward,a=i!==void 0&&i,s=n.blockManager,o=n.indexer;this.condition=r,this.backward=a,this._blockManager=s,this._indexer=o}return e.prototype.findOptimizedStartPosition=function(){var n=this,t=["=","/eq",">",">=","/gt","/gte"],r=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var i=this._indexer.origin.length-1;if(typeof this.condition!="function")for(f=0;f<this._indexer.fields.length;f++){var a=this._indexer.fields[f],s=1;if(a[0]==="-"&&(a=a.slice(1),s=-1),this.condition[a]){if(typeof this.condition[a]=="object"){var o=s>0?r:t;for(var l in this.condition[a])if(o.includes(l)){for(var u=i;u>=0;u--)if(s*Ha(this._indexer.origin[u].columnValues[f],this.condition[a][l])<=0){i=u;break}}}else for(u=i;u>=0;u--)if(s*Ha(this._indexer.origin[u].columnValues[f],this.condition[a])<=0){i=u;break}}}return Math.min(i+1,this._indexer.origin.length-1)}var c=0;if(typeof this.condition!="function")for(var d=function(m){var y=h._indexer.fields[m],C=1;if(y[0]==="-"&&(y=y.slice(1),C=-1),h.condition[y]){if(typeof h.condition[y]=="object")Object.keys(h.condition[y]).forEach(function(v){if((C>0?t:r).includes(v)){for(var E=c;E<n._indexer.origin.length;E++)if(C*Ha(n._indexer.origin[E].columnValues[m],n.condition[y][v])>=0){c=E;break}}});else for(var b=c;b<h._indexer.origin.length;b++)if(C*Ha(h._indexer.origin[b].columnValues[m],h.condition[y])>=0){c=b;break}}},h=this,f=0;f<this._indexer.fields.length;f++)d(f);return Math.max(c-1,0)},e.prototype.each=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:if(t=this.findOptimizedStartPosition(),r=0,this.backward&&this._indexer.origin[t]&&(r=this._indexer.origin[t].keys.length-1),i=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[++r]){if(!u._indexer.origin[++t])return!1;r=0}return!0}return!1},a=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[--r]){if(!u._indexer.origin[--t])return!1;r=u._indexer.origin[t].keys.length-1}return!0}return!1},s=null,!this._indexer.origin[t])return[3,4];o=this.backward?a:i,c.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[r])];case 2:if((l=c.sent())&&Yo(this.condition,l))return s=l,[3,4];c.label=3;case 3:if(o())return[3,1];c.label=4;case 4:return[4,new Promise(function(d){var h=new VU({initialNextValue:cr(s),iterator:n,forward:function(){return g(u,void 0,void 0,function(){var f,m;return _(this,function(y){switch(y.label){case 0:f=this.backward?a:i,y.label=1;case 1:return f()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[r])]:[3,3];case 2:return(m=y.sent())&&Yo(this.condition,m)?[2,cr(m)]:[3,1];case 3:return[2,null]}})})},backward:function(){return g(u,void 0,void 0,function(){var f,m;return _(this,function(y){switch(y.label){case 0:f=this.backward?i:a,y.label=1;case 1:return f()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[r])]:[3,3];case 2:return(m=y.sent())&&Yo(this.condition,m)?[2,cr(m)]:[3,1];case 3:return[2,null]}})})},complete:d});n(h)})];case 5:return[2,c.sent()]}})})},e}(),jU=function(){function e(n){var t=n.condition,r=t===void 0?{}:t,i=n.backward,a=i!==void 0&&i,s=n.mutex,o=n.blockManager,l=n.indexer;this._mutex=s,this._iterator=new n0({condition:r,backward:a,blockManager:o,indexer:l})}return e.prototype.fetch=function(n){return n===void 0&&(n={}),g(this,void 0,void 0,function(){var t,r,i,a,s=this;return _(this,function(o){switch(o.label){case 0:if(t=Math.max(n.offset||0,0),(r=typeof n.limit=="number"?n.limit:Number.MAX_SAFE_INTEGER)===0)return[2,[]];if(r<0)throw Ve.collectionQueryNotValid;o.label=1;case 1:return o.trys.push([1,4,,5]),i=[],[4,this._mutex.lock()];case 2:return o.sent(),[4,this._iterator.each(function(l){return g(s,void 0,void 0,function(){return _(this,function(u){return l.error?l.stop():l.hasNext?t===0?(i.push(l.nextValue),0<r&&r<=i.length?l.stop():l.next()):(t--,l.next()):l.stop(),[2]})})})];case 3:return o.sent(),this._mutex.unlock(),[2,i];case 4:throw a=o.sent(),this._mutex.unlock(),a;case 5:return[2]}})})},e.prototype.count=function(){return g(this,void 0,void 0,function(){var n,t,r=this;return _(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),n=0,[4,this._mutex.lock()];case 1:return i.sent(),[4,this._iterator.each(function(a){return g(r,void 0,void 0,function(){return _(this,function(s){return a.error?a.stop():a.hasNext?(n++,a.next()):a.stop(),[2]})})})];case 2:return i.sent(),this._mutex.unlock(),[2,n];case 3:throw t=i.sent(),this._mutex.unlock(),t;case 4:return[2]}})})},e}(),zy=function(e){return"".concat("nest","@").concat(e)},ul=function(e,n){return"".concat(zy(e),"/").concat(n)},Cg=function(e,n){return"".concat(ul(e,n),".metadata")},r0=function(e,n){return"".concat(ul(e,n),"/block.")},aC=function(e,n){return"".concat(ul(e,n),"/blob.")},QU=function(){function e(n){var t=n.dbname,r=n.collectionName,i=n.store;this.dbname=t,this.collectionName=r,this.store=i}return e.prototype.get=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return[4,this.store.get(n)];case 1:return(t=d.sent())?(r=t.data,i=t.type,typeof fetch>"u"?[3,4]:[4,fetch(r)]):[3,5];case 2:return[4,d.sent().blob()];case 3:return[2,d.sent()];case 4:for(a=[],s=atob(r.split(",")[1]),o=0;o<s.length;o+=512){for(l=s.slice(o,o+512),u=new Array(l.length),c=0;c<l.length;c++)u[c]=l.charCodeAt(c);a.push(new Uint8Array(u))}return[2,new Blob(a,{type:i})];case 5:return[2,null]}})})},e.prototype.save=function(n,t){return t===void 0&&(t="".concat(Date.now())),g(this,void 0,void 0,function(){var r,i,a,s,o=this;return _(this,function(l){switch(l.label){case 0:return[4,new Promise(function(u){var c=function(h,f,m,y){return y===void 0&&(y=0),"".concat(aC(h,f)).concat(m,".").concat(y)}(o.dbname,o.collectionName,t),d=new FileReader;d.onload=function(){u({blobId:c,data:d.result,type:n.type})},d.readAsDataURL(n)})];case 1:return r=l.sent(),i=r.blobId,a=r.data,s=r.type,[4,this.store.set({key:i,value:{data:a,type:s}})];case 2:return l.sent(),[2,i]}})})},e.prototype.remove=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this.store.remove(n)];case 1:return t.sent(),[2]}})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){var n,t,r=this;return _(this,function(i){switch(i.label){case 0:return n=aC(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return t=i.sent(),[4,Promise.all(t.filter(function(a){return a.startsWith(n)}).map(function(a){return g(r,void 0,void 0,function(){return _(this,function(s){switch(s.label){case 0:return[4,this.store.remove(a)];case 1:return[2,s.sent()]}})})}))];case 2:return i.sent(),[2]}})})},e}();(function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"})(Zo||(Zo={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(jn||(jn={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(Yi||(Yi={}));var _d,Bn,sC=[jn.PENDING,jn.VOLATILE],rf={},pr=function(){function e(n){var t=n.dbname,r=n.limit,i=r===void 0?256:r;return rf[t]||(this.dbname=t,this._items=[],this._limit=i,rf[t]=this),rf[t]}return e.get=function(n){return rf[n]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(n,t,r){return r===void 0&&(r=Yi.DEFAULT),g(this,void 0,void 0,function(){var i,a;return _(this,function(s){switch(s.label){case 0:return(i=this.get(t))?[3,2]:[4,n.get(t)];case 1:return(a=s.sent())&&(i={key:t,value:a,state:r===Yi.PERSISTENT?jn.PERSISTENT:jn.VOLATILE},this.put(i)),[3,3];case 2:r===Yi.PERSISTENT&&(i.state=jn.PERSISTENT),s.label=3;case 3:return[2,i]}})})},e.prototype.get=function(n,t){t===void 0&&(t=Yi.DEFAULT);var r=this._items.map(function(a){return a.key}).indexOf(n);if(r>-1){var i=this._items[r];return t===Yi.PERSISTENT&&(i.state=jn.PERSISTENT),t!==Yi.NO_CACHE&&this.put(i),i}return null},e.prototype.put=function(n){var t,r;if(this._limit>0){var i=this._items.map(function(d){return d.key}).indexOf(n.key);if(i>-1)sC.includes(this._items[i].state)&&sC.includes(n.state)?(this._items.splice(i,1),this._items.push(n)):(this._items[i].state=n.state,this._items[i].value=n.value);else{this._items.push(n);var a=this._items.filter(function(d){return d.state===jn.VOLATILE}),s=a.length-this._limit;if(s>0){var o=[];try{for(var l=K(this._items),u=l.next();!u.done;u=l.next()){var c=u.value;c.state===jn.VOLATILE&&s>0?s--:o.push(c)}}catch(d){t={error:d}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}this._items=o}}}},e.prototype.remove=function(n){var t=this._items.map(function(r){return r.key}).indexOf(n);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(n){this._items=this._items.filter(function(t){return!n(t)})},e.prototype.clearForDatabase=function(n){this.clearByCondition(function(t){return t.key.startsWith(zy(n))})},e.prototype.clear=function(n){n===void 0&&(n=!1),this._items=n?[]:this._items.filter(function(t){return t.state!==jn.VOLATILE})},e}(),KU=function(){function e(n){var t=n.dbname,r=n.collectionName,i=n.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=r,this.metadataKey=function(a,s){return"".concat(ul(a,s),"/trans.metadata")}(t,r),this.recordsetKey=function(a,s){return"".concat(ul(a,s),"/trans.recordset")}(t,r),this._store=i}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(n){return n===void 0&&(n=[]),g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=r.sent()||[]).push.apply(t,ce([],ne(n),!1)),[2,this._reduceRecordSet(t)]}})})},e.prototype._reduceRecordSet=function(n){for(var t=[],r={},i=n.length-1;i>=0;i--){for(var a=n[i],s=[],o=a.requests.length-1;o>=0;o--){var l=a.requests[o],u=l.data;r[u.key]||(s.unshift(l),r[u.key]=!0)}s.length>0&&(a.requests=s,t.unshift(a))}return t},e.prototype._applyRecord=function(n,t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:r=pr.get(this.dbname),i=t.generation,a=t.requests,s=null,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this._store.setMany(a.map(function(f){return N(N({},f.data),{generation:i})}))];case 2:for(o=h.sent(),l=0;l<a.length;l++)o[l]instanceof Error&&(s||(s=o[l]),u=a[l].data,r.put(N(N({},u),{state:jn.PERSISTENT})));return[3,4];case 3:return c=h.sent(),s=c,[3,4];case 4:return s?[3,6]:(d=n.filter(function(f){return f.generation!==i}),[4,this._store.set({key:this.recordsetKey,value:d})]);case 5:return h.sent(),this._onWrite.forEach(function(f){f(a.map(function(m){return m.data}))}),[3,7];case 6:this._onError.forEach(function(f){s&&f(s)}),h.label=7;case 7:return[2]}})})},e.prototype.init=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return n=this,[4,this._store.get(this.metadataKey)];case 1:return n._metadata=u.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=u.sent(),u.label=3;case 3:u.trys.push([3,8,9,10]),r=K(t),i=r.next(),u.label=4;case 4:return i.done?[3,7]:(a=i.value,[4,this._applyRecord(t,a)]);case 5:u.sent(),u.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return s=u.sent(),o={error:s},[3,10];case 9:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 10:return[2]}})})},e.prototype.on=function(n,t,r){switch(n){case Zo.COMMIT:this._onCommit.set(t,r);break;case Zo.WRITE:this._onWrite.set(t,r);break;case Zo.ERROR:this._onError.set(t,r)}},e.prototype.requestWrite=function(n,t){this._requests.push({data:n,options:t}),pr.get(this.dbname).put(N({state:jn.PENDING},n))},e.prototype.requestMultipleWrite=function(n,t){var r,i,a=pr.get(this.dbname);try{for(var s=K(n),o=s.next();!o.done;o=s.next()){var l=o.value;this._requests.push({data:l,options:t}),a.put(N({state:jn.PENDING},l))}}catch(u){r={error:u}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},e.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(n){return pr.get(this.dbname).clearByCondition(function(t){return t.state===jn.PENDING}),this._requests=[],[2]})})},e.prototype.commit=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u,c,d,h,f=this;return _(this,function(m){switch(m.label){case 0:if(!((n=this._requests).length>0))return[3,4];for(t=[],r={},l=n.length-1;l>=0;l--)i=n[l],c=i.data,r[c.key]||(r[c.key]=!0,t.unshift(i));return a={generation:this.generation,requests:t},[4,this._getReducedRecordset([a])];case 1:return s=m.sent(),[4,this._store.set({key:this.recordsetKey,value:s})];case 2:return m.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(m.sent(),o=pr.get(this.dbname),l=0;l<t.length;l++)u=t[l],c=u.data,d=u.options,o.put(N(N({},c),{state:d&&d.persistent?jn.PERSISTENT:jn.VOLATILE}));this._requests=[],this._onCommit.forEach(function(y){y(n.map(function(C){return C.data}))}),h=fh.get(this.dbname),setTimeout(function(){try{f._applyRecord(s,a)}catch(y){f._onError.forEach(function(C){return C(y)})}},h.transactionApplyDelay),m.label=4;case 4:return[2]}})})},e}(),$f=function(){function e(n){var t=n.blockId,r=n.keyName,i=n.items,a=i===void 0?[]:i,s=n.limit;this.blockId=t,this.keyName=r,this.limit=s,this._items=ce([],ne(a),!1)}return e.createFromCacheItem=function(n){return n?new e(n.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this._items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(n){var t=this,r=this._items.find(function(i){var a=i[t.keyName];return n===a});return r??null},e.prototype.has=function(n){var t=this;return this._items.map(function(r){return r[t.keyName]}).includes(n)},e.prototype.add=function(n){var t=this,r=this._items.map(function(i){return i[t.keyName]}).indexOf(n[this.keyName]);return r<0?this._items.length<this.limit&&(this._items.push(n),!0):(this._items[r]=n,!0)},e.prototype.remove=function(n){for(var t=0;t<this._items.length;t++)if(this._items[t][this.keyName]===n)return this._items.splice(t,1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),WU=function(){function e(n){var t=n.dbname,r=n.collectionName,i=n.metadata,a=n.hashFunction,s=a===void 0?nC:a,o=n.transaction,l=n.store;this.dbname=t,this.collectionName=r,this.hashFunction=s,this.metadata=i,this._transaction=o,this._store=l}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(n,t){return t===void 0&&(t=this.metadata.blockLevel),r=this.dbname,i=this.collectionName,a=t,s="".concat(function(o,l,u){var c=u.base*Math.pow(u.multiplier,l)+u.constant;return(u.hashFunction||nC)(o,c)}(n,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(r0(r,i)).concat(a,".").concat(s);var r,i,a,s},e.prototype._findBlock=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:t=pr.get(this.dbname),r=this.metadata.blockLevel,o.label=1;case 1:return r>0?(i=this.createBlockId(n,r),[4,t.find(this._store,i)]):[3,4];case 2:if((a=o.sent())&&(s=$f.createFromCacheItem(a),s?.getItemByKey(n)))return[2,s];o.label=3;case 3:return r--,[3,1];case 4:return[2,null]}})})},e.prototype.getFromBlock=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,this._findBlock(n)];case 1:return[2,(t=r.sent())?t.getItemByKey(n):null]}})})},e.prototype.putToBlock=function(n,t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return r=fh.get(this.dbname),i=this.createBlockId(n),a=Math.floor(this._store.itemSizeLimit/r.itemSizeLimit),[4,pr.get(this.dbname).find(this._store,i)];case 1:return s=l.sent(),(o=s?$f.createFromCacheItem(s):new $f({blockId:i,keyName:this.keyName,items:[],limit:a}))!=null&&o.add(t)?(this._transaction.requestWrite({key:o.blockId,value:o.serialize()}),[2,!0]):[2,!1]}})})},e.prototype.removeFromBlock=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,this._findBlock(n)];case 1:return(t=r.sent())&&t.remove(n)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}})})},e.prototype.clearAllBlocks=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:return n=r0(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=i.sent(),r=t.filter(function(a){return a.startsWith(n)}),[4,this._store.removeMany(r)];case 2:return i.sent(),[4,this._transaction.clear()];case 3:return i.sent(),pr.get(this.dbname).clearByCondition(function(a){return a.key.startsWith(n)}),[2]}})})},e}(),ds=function(){function e(n){var t=n.dbname,r=n.collectionName,i=n.keyName,a=n.fields,s=n.transaction,o=n.store,l=this;this._origin=[],this._table=[];var u=function(c,d,h){return"".concat(ul(c,d),"/index.").concat(h)}(t,r,a.join(">"));this.dbname=t,this.collectionName=r,this.keyName=i,this.fields=a,this.indexerKey=u,this._store=o,this._transaction=s,this._transaction.on(Zo.COMMIT,this.indexerKey,function(){return l.commit()}),this._transaction.on(Zo.ERROR,this.indexerKey,function(){return l.abort()})}return e.createKey=function(n){return n.join(">")},e.parseKey=function(n){return n.split(">")},e.prototype._addItem=function(n){var t=n[this.keyName],r=this.getColumnValues(n),i=ne(this.indexOf(r),2),a=i[0];return i[1]?!this._table[a].keys.includes(t)&&(this._table[a].keys.push(t),!0):(this._table.splice(a,0,{columnValues:r,keys:[t]}),!0)},e.prototype._removeItem=function(n){var t=n[this.keyName],r=this.getColumnValues(n),i=ne(this.indexOf(r),2),a=i[0];if(i[1]){var s=this._table[a].keys.indexOf(t);if(s>-1)return this._table[a].keys.splice(s,1),this._table[a].keys.length===0&&this._table.splice(a,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(n){var t,r,i,a,s=[];try{for(var o=K(this.fields),l=o.next();!l.done;l=o.next()){var u=l.value;if(u[0]==="-"&&(u=u.slice(1)),i=n[u],a=void 0,a=typeof i,i!==null&&a!=="undefined"&&a!=="boolean"&&a!=="number"&&a!=="string")throw Ve.indexTypesNotMatch;s.push(n[u])}}catch(c){t={error:c}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return s},e.prototype.diff=function(n,t){for(var r in this.fields){var i=this.fields[r][0]==="-"?-1:1,a=Ha(n[r],t[r]);if(a!==0)return i*a}return 0},e.prototype.indexOf=function(n){if(this._table.length>0){for(var t=0,r=this._table.length-1;t<=r;){var i=Math.floor((t+r)/2),a=this.diff(n,this._table[i].columnValues);if(a>0)t=i+1;else{if(!(a<0))return[i,!0];r=i-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b;return _(this,function(v){switch(v.label){case 0:return[4,(n=pr.get(this.dbname)).find(this._store,this.indexerKey,Yi.PERSISTENT)];case 1:return(t=v.sent())?[3,11]:(r=r0(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:i=v.sent(),v.label=3;case 3:v.trys.push([3,8,9,10]),a=K(i),s=a.next(),v.label=4;case 4:return s.done?[3,7]:(o=s.value).startsWith(r)?[4,n.find(this._store,o,Yi.NO_CACHE)]:[3,6];case 5:if(l=v.sent(),u=$f.createFromCacheItem(l))try{for(C=void 0,c=K(u.items),d=c.next();!d.done;d=c.next())h=d.value,this._addItem(h)}catch(E){C={error:E}}finally{try{d&&!d.done&&(b=c.return)&&b.call(c)}finally{if(C)throw C.error}}v.label=6;case 6:return s=a.next(),[3,4];case 7:return[3,10];case 8:return f=v.sent(),m={error:f},[3,10];case 9:try{s&&!s.done&&(y=a.return)&&y.call(a)}finally{if(m)throw m.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=cr(this._origin),v.label=12;case 12:return[2]}})})},e.prototype.drop=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return pr.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return n.sent(),[2]}})})},e.prototype.addItem=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return this._addItem(n)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.removeItem=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return this._removeItem(n)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(n){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},e.prototype.commit=function(){this._origin=this._table,this._table=cr(this._origin)},e.prototype.abort=function(){this._table=cr(this._origin)},e}(),Hp=function(){return typeof document<"u"&&typeof navigator<"u"&&navigator.product!=="ReactNative"},oC=function(){var e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),(n==="x"?t:3&t|8).toString(16)})};(function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE"})(_d||(_d={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock"}(Bn||(Bn={}));var ki,Sg={},Hy=function(){function e(n,t){t===void 0&&(t={});var r=this;return this._state=_d.PROCESSING,this._queue=[],this._activationQueue=[],Sg[n]&&!t.forceCreate||(this.nodeId=oC(),this.key=n,Hp()&&(t.startAsInvisible?this.registerNode():document.visibilityState==="visible"?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",function(){document.visibilityState==="visible"&&r.claimHost()}),window.addEventListener("message",function(i){var a,s,o=i.data;if(o?.isNestDbMessage){var l=o.nodeId,u=o.requestId,c=o.key,d=o.op,h=o.data;if(l!==r.nodeId&&c===r.key)switch(d){case Bn.NEWNODE:r._sendSync();break;case Bn.CLAIM_HOST:r._sendSync(),r._hostId=l;break;case Bn.SYNC_HOST:if(!r.isInSync){r._activationTimeout&&clearTimeout(r._activationTimeout);var f=h,m=f.currentItemRequestId,y=f.queue,C=function(S){var w=r._queue.findIndex(function(A){return A.requestId===S.requestId});w<0&&r._requestLock({isNestDbMessage:!0,nodeId:S.nodeId,requestId:S.requestId,key:r.key,op:Bn.REQUEST_LOCK,ts:S.ts})};try{for(var b=K(y),v=b.next();!v.done;v=b.next())C(v.value)}catch(S){a={error:S}}finally{try{v&&!v.done&&(s=b.return)&&s.call(b)}finally{if(a)throw a.error}}r._currentItem=r._queue.find(function(S){return S.requestId===m}),r._completeSync()}break;case Bn.REMOVENODE:r._queue=r._queue.filter(function(S){return S.nodeId!==o.nodeId}),r._currentItem&&r._currentItem.nodeId===o.nodeId&&(r._currentItem=void 0,r._acquire(r._queue[0]));break;case Bn.REQUEST_LOCK:r._requestLock(o);break;case Bn.ACQUIRE_LOCK:var E=r._queue.find(function(S){return S.requestId===u});r._acquire(E);break;case Bn.RELEASE_LOCK:r._release(u)}}}),window.addEventListener("beforeunload",function(){r._send(Bn.REMOVENODE)})),Sg[n]=this),Sg[n]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==_d.DONE},enumerable:!1,configurable:!0}),e.prototype._send=function(n,t){var r;t===void 0&&(t={});var i={isNestDbMessage:!0,nodeId:this.nodeId,requestId:(r=t?.requestId)!==null&&r!==void 0?r:oC(),key:this.key,op:n,data:t.data,ts:Date.now()};return Hp()&&window.postMessage(i,"*"),i},e.prototype._acquire=function(n){n?(this._currentItem=n,this._currentItem.onAcquired&&this._currentItem.onAcquired(n.requestId)):this._currentItem=void 0},e.prototype._release=function(n){if(this._currentItem&&this._currentItem.requestId===n){var t=this._currentItem;this._currentItem=void 0,t.nodeId===this.nodeId&&this._send(Bn.RELEASE_LOCK,{requestId:t.requestId});var r=this._queue.findIndex(function(i){return i.requestId===n});r>-1&&this._queue.splice(r,1),t.onReleased&&t.onReleased(n)}},e.prototype._requestLock=function(n){var t=this;return new Promise(function(r){for(var i={nodeId:n.nodeId,requestId:n.requestId,ts:n.ts,onAcquired:function(o){t.isHost&&t._send(Bn.ACQUIRE_LOCK,{requestId:o}),r()},onReleased:function(){t._acquire(t._queue[0])}},a=!1,s=0;s<t._queue.length;s++)if(t._queue[s].ts>i.ts){t._queue.splice(s,0,i),a=!0;break}a||t._queue.push(i),t._currentItem||t._acquire(t._queue[0])})},e.prototype._sendSync=function(){var n;this.isHost&&this._send(Bn.SYNC_HOST,{data:{currentItemRequestId:(n=this._currentItem)===null||n===void 0?void 0:n.requestId,queue:this._queue.map(function(t){return{nodeId:t.nodeId,requestId:t.requestId,ts:t.ts}})}})},e.prototype._waitUntilSyncCompleted=function(){return g(this,void 0,void 0,function(){var n=this;return _(this,function(t){return this.isHost&&!this.isInSync?[2,new Promise(function(r){n._activationQueue.push(r)})]:[2]})})},e.prototype._waitSync=function(){var n=this;this.isInSync||(this._activationTimeout=setTimeout(function(){n._completeSync()},8))},e.prototype._completeSync=function(){this.isInSync||(this._state=_d.DONE,this._activationQueue.forEach(function(n){return n()}),this._activationQueue=[])},e.prototype.registerNode=function(){this._send(Bn.NEWNODE),this._waitSync()},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(Bn.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),n=this._send(Bn.REQUEST_LOCK),[4,this._requestLock(n)];case 2:return t.sent(),[2]}})})},e.prototype.unlock=function(){var n;!((n=this._currentItem)===null||n===void 0)&&n.requestId&&this._release(this._currentItem.requestId)},e}(),Tg=function(){function e(n){var t=n.dbname,r=n.collectionName,i=n.keyName,a=n.keyHash,s=n.indexes,o=n.store,l=this;this._state=zo.INIT,this._indexers=[],this.dbname=t,this.name=r,this.keyName=i,this.indexes=ce([[i]],ne(s.filter(function(u){return ds.createKey(u)!==l.keyName})),!1),this._keyHash=a,this._store=o,this._mutex=new Hy(function(u,c){return"".concat(ul(u,c),".lock")}(t,r)),this._blobContainer=new QU({dbname:t,collectionName:r,store:o}),this._transaction=new KU({dbname:t,collectionName:r,store:o})}return e.metadataOf=function(n,t,r){return g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=Cg(n,t),[4,r.get(i)];case 1:return[2,a.sent()]}})})},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===zo.READY},enumerable:!1,configurable:!0}),e.prototype.init=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u,c,d,h,f,m,y=this;return _(this,function(C){switch(C.label){case 0:return[4,this._mutex.lock()];case 1:C.sent(),C.label=2;case 2:return C.trys.push([2,9,,10]),n=fh.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return t=C.sent(),this._metadata=t||{keyName:this.keyName,blockLevel:1,blockHashBase:n.blockHashBase,blockHashMultiplier:n.blockHashMultiplier,blockHashConstant:n.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:C.sent(),this._blockManager=new WU({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=ce([],ne(this.indexes),!1),i=[],a=r.map(function(b){return ds.createKey(b)}),s=t?t.indexes.map(function(b){return ds.createKey(b)}):[];try{for(o=K(s),l=o.next();!l.done;l=o.next())u=l.value,a.includes(u)||i.push(ds.parseKey(u))}catch(b){f={error:b}}finally{try{l&&!l.done&&(m=o.return)&&m.call(o)}finally{if(f)throw f.error}}return(c=[]).push.apply(c,ce([],ne(r.map(function(b){var v=new ds({dbname:y.dbname,collectionName:y.name,keyName:y.keyName,fields:b,transaction:y._transaction,store:y._store});return y._indexers.push(v),v.ensure()})),!1)),c.push.apply(c,ce([],ne(i.map(function(b){return new ds({dbname:y.dbname,collectionName:y.name,keyName:y.keyName,fields:b,transaction:y._transaction,store:y._store}).drop()})),!1)),[4,Promise.all(c)];case 5:return C.sent(),[4,this._transaction.commit()];case 6:return C.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(d=Cg(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata})]);case 7:C.sent(),C.label=8;case 8:return this._state=zo.READY,this._mutex.unlock(),[3,10];case 9:throw h=C.sent(),this._mutex.unlock(),h;case 10:return[2]}})})},e.prototype.close=function(){this._state=zo.CLOSED},e.prototype._hasPropertyOfKeyName=function(n){var t=n[this.keyName];return typeof t=="string"&&!!t},e.prototype._getIndexerBy=function(n){var t,r;n===void 0&&(n=null),n||(n=[this.keyName]);var i=ds.createKey(n);try{for(var a=K(this._indexers),s=a.next();!s.done;s=a.next()){var o=s.value;if(i===ds.createKey(o.fields))return o}}catch(l){t={error:l}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}throw Ve.indexTableIsRequired},e.prototype._upgradeBlockLevel=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=Cg(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:n,value:this._metadata})];case 1:return t.sent(),[2]}})})},e.prototype._requestInsert=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=n[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return l.sent()?[3,13]:[4,this._blockManager.putToBlock(t,n)];case 2:return l.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return l.sent(),[4,this._blockManager.putToBlock(t,n)];case 4:l.sent(),l.label=5;case 5:l.trys.push([5,10,11,12]),r=K(this._indexers),i=r.next(),l.label=6;case 6:return i.done?[3,9]:[4,i.value.addItem(n)];case 7:l.sent(),l.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return a=l.sent(),s={error:a},[3,12];case 11:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}return[7];case 12:return[3,14];case 13:throw Ve.collectionInsertDuplicate;case 14:return[2]}})})},e.prototype._requestUpsert=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h,f,m;return _(this,function(y){switch(y.label){case 0:return t=n[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(r=y.sent())?[3,13]:[4,this._blockManager.putToBlock(t,n)];case 2:return y.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return y.sent(),[4,this._blockManager.putToBlock(t,n)];case 4:y.sent(),y.label=5;case 5:y.trys.push([5,10,11,12]),i=K(this._indexers),a=i.next(),y.label=6;case 6:return a.done?[3,9]:[4,(u=a.value).addItem(n)];case 7:y.sent(),y.label=8;case 8:return a=i.next(),[3,6];case 9:return[3,12];case 10:return s=y.sent(),d={error:s},[3,12];case 11:try{a&&!a.done&&(h=i.return)&&h.call(i)}finally{if(d)throw d.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(t,n)];case 14:y.sent(),y.label=15;case 15:y.trys.push([15,21,22,23]),o=K(this._indexers),l=o.next(),y.label=16;case 16:return l.done?[3,20]:(u=l.value).diff(u.getColumnValues(r),u.getColumnValues(n))===0?[3,19]:[4,u.removeItem(r)];case 17:return y.sent(),[4,u.addItem(n)];case 18:y.sent(),y.label=19;case 19:return l=o.next(),[3,16];case 20:return[3,23];case 21:return c=y.sent(),f={error:c},[3,23];case 22:try{l&&!l.done&&(m=o.return)&&m.call(o)}finally{if(f)throw f.error}return[7];case 23:return[2]}})})},e.prototype._requestUpdate=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return t=n[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(r=c.sent())?[4,this._blockManager.putToBlock(t,n)]:[3,11];case 2:c.sent(),c.label=3;case 3:c.trys.push([3,9,10,11]),i=K(this._indexers),a=i.next(),c.label=4;case 4:return a.done?[3,8]:(s=a.value).diff(s.getColumnValues(r),s.getColumnValues(n))===0?[3,7]:[4,s.removeItem(r)];case 5:return c.sent(),[4,s.addItem(n)];case 6:c.sent(),c.label=7;case 7:return a=i.next(),[3,4];case 8:return[3,11];case 9:return o=c.sent(),l={error:o},[3,11];case 10:try{a&&!a.done&&(u=i.return)&&u.call(i)}finally{if(l)throw l.error}return[7];case 11:return[2]}})})},e.prototype._requestRemove=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return[4,this._blockManager.getFromBlock(n)];case 1:return(t=l.sent())?[4,this._blockManager.removeFromBlock(n)]:[3,10];case 2:l.sent(),l.label=3;case 3:l.trys.push([3,8,9,10]),r=K(this._indexers),i=r.next(),l.label=4;case 4:return i.done?[3,7]:[4,i.value.removeItem(t)];case 5:l.sent(),l.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return a=l.sent(),s={error:a},[3,10];case 9:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}return[7];case 10:return[2]}})})},e.prototype._requestClear=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a;return _(this,function(s){switch(s.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),n=K(this._indexers),t=n.next(),s.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:s.sent(),s.label=5;case 5:return t=n.next(),[3,3];case 6:return[3,9];case 7:return r=s.sent(),i={error:r},[3,9];case 8:try{t&&!t.done&&(a=n.return)&&a.call(n)}finally{if(i)throw i.error}return[7];case 9:return[2]}})})},e.prototype.getByKey=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(n)];case 3:return t=i.sent(),this._mutex.unlock(),[2,cr(t)];case 4:throw r=i.sent(),this._mutex.unlock(),r;case 5:return[3,7];case 6:throw Ve.collectionNotReady;case 7:return[2]}})})},e.prototype.query=function(n){if(n===void 0&&(n={}),this.isReady)return new jU({condition:n.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(n.index),backward:!!n.backward});throw Ve.collectionNotReady},e.prototype.insertOne=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(n))throw Ve.collectionKeyNotGiven;return[4,this._requestInsert(cr(n))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,n];case 5:return t=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Ve.collectionNotReady;case 9:return[2]}})})},e.prototype.insertMany=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),n.some(function(d){return!u._hasPropertyOfKeyName(d)}))throw Ve.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),t=K(n),r=t.next(),c.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestInsert(cr(i))]);case 5:c.sent(),c.label=6;case 6:return r=t.next(),[3,4];case 7:return[3,10];case 8:return a=c.sent(),o={error:a},[3,10];case 9:try{r&&!r.done&&(l=t.return)&&l.call(t)}finally{if(o)throw o.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,n];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Ve.collectionNotReady;case 16:return[2]}})})},e.prototype.upsertOne=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(n))throw Ve.collectionKeyNotGiven;return[4,this._requestUpsert(cr(n))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,n];case 5:return t=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Ve.collectionNotReady;case 9:return[2]}})})},e.prototype.upsertMany=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:c.sent(),c.label=2;case 2:if(c.trys.push([2,12,,14]),n.some(function(d){return!u._hasPropertyOfKeyName(d)}))throw Ve.collectionKeyNotGiven;c.label=3;case 3:c.trys.push([3,8,9,10]),t=K(n),r=t.next(),c.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestUpsert(cr(i))]);case 5:c.sent(),c.label=6;case 6:return r=t.next(),[3,4];case 7:return[3,10];case 8:return a=c.sent(),o={error:a},[3,10];case 9:try{r&&!r.done&&(l=t.return)&&l.call(t)}finally{if(o)throw o.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return c.sent(),this._mutex.unlock(),[2,n];case 12:return s=c.sent(),[4,this._transaction.clear()];case 13:throw c.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Ve.collectionNotReady;case 16:return[2]}})})},e.prototype.update=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(n))throw Ve.collectionKeyNotGiven;return[4,this._requestUpdate(cr(n))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,n];case 5:return t=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Ve.collectionNotReady;case 9:return[2]}})})},e.prototype.updateIf=function(n,t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m,y,C,b=this;return _(this,function(v){switch(v.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:v.sent(),v.label=2;case 2:return v.trys.push([2,13,,15]),r=n.where,i=r===void 0?{}:r,a=n.index,s=a===void 0?null:a,o=n.backward,l=o!==void 0&&o,u=[],[4,new n0({condition:i,blockManager:this._blockManager,backward:l,indexer:this._getIndexerBy(s)}).each(function(E){return g(b,void 0,void 0,function(){var S;return _(this,function(w){if(E.error)throw E.stop(),E.error;return E.hasNext?(S=E.nextValue,Yo(i,S)&&t.set&&(typeof t.set!="function"?Object.keys(t.set).forEach(function(A){var D;S[A]=(D=t.set)===null||D===void 0?void 0:D[A]}):t.set(S),u.push(S)),E.next()):E.stop(),[2]})})})];case 3:v.sent(),v.label=4;case 4:v.trys.push([4,9,10,11]),c=K(u),d=c.next(),v.label=5;case 5:return d.done?[3,8]:(h=d.value,[4,this._requestUpdate(cr(h))]);case 6:v.sent(),v.label=7;case 7:return d=c.next(),[3,5];case 8:return[3,11];case 9:return f=v.sent(),y={error:f},[3,11];case 10:try{d&&!d.done&&(C=c.return)&&C.call(c)}finally{if(y)throw y.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return v.sent(),this._mutex.unlock(),[2,u];case 13:return m=v.sent(),[4,this._transaction.clear()];case 14:throw v.sent(),this._mutex.unlock(),m;case 15:return[3,17];case 16:throw this._transaction.clear(),Ve.collectionNotReady;case 17:return[2]}})})},e.prototype.remove=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,5,,7]),[4,this._requestRemove(n)];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[3,7];case 5:return t=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Ve.collectionNotReady;case 9:return[2]}})})},e.prototype.removeIf=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h,f,m,y,C=this;return _(this,function(b){switch(b.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:b.sent(),b.label=2;case 2:return b.trys.push([2,13,,14]),t=n.where,r=t===void 0?{}:t,i=n.index,a=i===void 0?null:i,s=n.backward,o=s!==void 0&&s,l=[],[4,new n0({condition:r,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(a)}).each(function(v){return g(C,void 0,void 0,function(){var E,S;return _(this,function(w){if(v.error)throw v.stop(),v.error;return v.hasNext?(E=v.nextValue,Yo(r,E)&&(S=E[this.keyName],l.push(S)),v.next()):v.stop(),[2]})})})];case 3:b.sent(),b.label=4;case 4:b.trys.push([4,9,10,11]),u=K(l),c=u.next(),b.label=5;case 5:return c.done?[3,8]:(d=c.value,[4,this._requestRemove(d)]);case 6:b.sent(),b.label=7;case 7:return c=u.next(),[3,5];case 8:return[3,11];case 9:return h=b.sent(),m={error:h},[3,11];case 10:try{c&&!c.done&&(y=u.return)&&y.call(u)}finally{if(m)throw m.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return b.sent(),this._mutex.unlock(),[2,l];case 13:throw f=b.sent(),this._mutex.unlock(),f;case 14:return[3,16];case 15:throw this._transaction.clear(),Ve.collectionNotReady;case 16:return[2]}})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return n=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),n;case 7:return[3,9];case 8:throw Ve.collectionNotReady;case 9:return[2]}})})},e.prototype.getBlob=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._blobContainer.get(n)];case 1:return[2,t.sent()]}})})},e.prototype.saveBlob=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._blobContainer.save(n,t)];case 1:return[2,r.sent()]}})})},e.prototype.removeBlob=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(n)];case 1:return t.sent(),[2]}})})},e.prototype.removeAllBlobs=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this._blobContainer.clear()];case 1:return n.sent(),[2]}})})},e}(),wg="[NESTDB]",af=!0,To=function(){function e(){}return e.off=function(){af=!1},e.log=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];af&&console.log.apply(console,ce(["".concat(wg,"[LOG]")],ne(n),!1))},e.warning=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];af&&console.warn.apply(console,ce(["".concat(wg,"[WARNING]")],ne(n),!1))},e.error=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];af&&console.error.apply(console,ce(["".concat(wg,"[ERROR]")],ne(n),!1))},e}(),YU=[{},{a:700400,n:"error"}],Rm=function(){function e(n){var t,r,i;this.encryption=(t=n.encryption)!==null&&t!==void 0?t:W2,this.itemSizeLimit=(r=n.itemSizeLimit)!==null&&r!==void 0?r:4194304,this.metadataBuffer=(i=n.metadataBuffer)!==null&&i!==void 0?i:256}return Object.defineProperty(e.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),e.prototype._getRawKey=function(n,t){return t===void 0&&(t=""),"".concat(n).concat(t)},e.prototype._generateShardPostfixArray=function(n){return n===void 0&&(n=1),ce([],ne(Array(n).keys()),!1)},e.prototype._shardify=function(n){var t=this,r=n.key,i=n.value,a=JSON.stringify(this.encryption.encrypt(i)),s=Math.ceil(a.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(s).map(function(o){var l={key:t._getRawKey(r,".".concat(o)),data:a.substring(o*t.adjustedItemSizeLimit,(o+1)*t.adjustedItemSizeLimit)};return o===0&&(l.metadata={shards:s}),l})},e.prototype._resetIfEncryptionChanged=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u,c=this;return _(this,function(d){switch(d.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(n=d.sent(),t={encrypted:YU.map(function(h){var f;return(f=c.encryption)===null||f===void 0?void 0:f.encrypt(h)})},!n)return[3,8];if(!n.encrypted||!Array.isArray(n.encrypted))return[3,6];for(a in r=n.encrypted,i=[],r)i.push(a);s=0,d.label=2;case 2:return s<i.length?(a=i[s])in r?(o=a,l=JSON.stringify(n.encrypted[o]),u=JSON.stringify(t.encrypted[o]),l===u?[3,4]:(To.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return d.sent(),[3,5];case 4:return s++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:d.sent(),d.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:t})];case 9:return d.sent(),[2]}})})},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),e.prototype.usage=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return n=0,[4,this._getAllRawKeys()];case 1:t=c.sent(),c.label=2;case 2:c.trys.push([2,7,8,9]),r=K(t),i=r.next(),c.label=3;case 3:return i.done?[3,6]:(a=i.value,[4,this._getRaw(a)]);case 4:(s=c.sent())&&(n+=JSON.stringify(s).length),c.label=5;case 5:return i=r.next(),[3,3];case 6:return[3,9];case 7:return o=c.sent(),l={error:o},[3,9];case 8:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(l)throw l.error}return[7];case 9:return[2,n]}})})},e.prototype.getAllKeys=function(){return g(this,void 0,void 0,function(){var n=this;return _(this,function(t){switch(t.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,t.sent().filter(function(r){return r.endsWith(".0")}).map(function(r){return r.replace(/\.0$/,"")}).filter(function(r){return!n._reservedKeys.includes(r)})]}})})},e.prototype.get=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:return t=this._getRawKey(n,".0"),[4,this._getRaw(t)];case 1:if(!(r=u.sent()))return[3,7];u.label=2;case 2:return u.trys.push([2,6,,7]),i=r.data,(a=r.metadata)!=null&&a.shards&&a.shards>1?[4,Promise.all(this._generateShardPostfixArray(a?.shards).map(function(c){return g(l,void 0,void 0,function(){var d,h;return _(this,function(f){switch(f.label){case 0:return c>0?(d=this._getRawKey(n,".".concat(c)),[4,this._getRaw(d)]):[3,2];case 1:if(!(h=f.sent()))throw Ve.storeBrokenIntegrity;return[2,h.data];case 2:return[2,i]}})})}))]:[3,4];case 3:return o=u.sent(),[3,5];case 4:o=[i],u.label=5;case 5:return s=o,[2,this.encryption.decrypt(JSON.parse(s.join("")))];case 6:return u.sent(),[2,null];case 7:return[2,null]}})})},e.prototype.set=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return t=this._shardify(n),[4,this._setRaw(t)];case 1:return r.sent(),[2,N({},n.value)]}})})},e.prototype.setMany=function(n){return g(this,void 0,void 0,function(){var t,r=this;return _(this,function(i){switch(i.label){case 0:return t=[],[4,this._setRaw(t.concat.apply(t,ce([],ne(n.map(function(a){return r._shardify(a)})),!1)))];case 1:return i.sent(),[2,n.map(function(a){return a.value})]}})})},e.prototype.remove=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o=this;return _(this,function(l){switch(l.label){case 0:return t=this._getRawKey(n,".0"),[4,this._getRaw(t)];case 1:return(r=l.sent())?(i=r.metadata,a=this._generateShardPostfixArray(i?.shards).map(function(u){return o._getRawKey(n,".".concat(u))}),[4,this._removeRaw(a)]):[3,3];case 2:return l.sent(),(s=pr.get(this.dbname))==null||s.remove(n),[2,!0];case 3:return[2,!1]}})})},e.prototype.removeMany=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:t=pr.get(this.dbname),r=[],i=function(m){var y,C,b;return _(this,function(v){switch(v.label){case 0:return y=a._getRawKey(m,".0"),[4,a._getRaw(y)];case 1:return(C=v.sent())&&(b=C.metadata,r.push.apply(r,ce([],ne(a._generateShardPostfixArray(b?.shards).map(function(E){return h._getRawKey(m,".".concat(E))})),!1))),t?.remove(m),[2]}})},a=this,f.label=1;case 1:f.trys.push([1,6,7,8]),s=K(n),o=s.next(),f.label=2;case 2:return o.done?[3,5]:(l=o.value,[5,i(l)]);case 3:f.sent(),f.label=4;case 4:return o=s.next(),[3,2];case 5:return[3,8];case 6:return u=f.sent(),c={error:u},[3,8];case 7:try{o&&!o.done&&(d=s.return)&&d.call(s)}finally{if(c)throw c.error}return[7];case 8:return r.length>0?[4,this._removeRaw(r)]:[3,10];case 9:f.sent(),f.label=10;case 10:return[2,n]}})})},e.prototype.clear=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){return(n=pr.get(this.dbname))==null||n.clearForDatabase(this.dbname),[2]})})},e}(),lr={},Oo=function(e){function n(t){t===void 0&&(t={});var r,i=this;i=e.call(this,N(N({},t),{itemSizeLimit:(r=t.itemSizeLimit)!==null&&r!==void 0?r:4194304}))||this;var a=t.delay,s=a===void 0?1:a;return i.delay=s,i.observer={},i}return T(n,e),Object.defineProperty(n.prototype,"rawData",{get:function(){return lr[this.dbname]},set:function(t){lr[this.dbname]=t},enumerable:!1,configurable:!0}),n.prototype._getAllRawKeys=function(){return g(this,void 0,void 0,function(){return _(this,function(t){if(lr[this.dbname])return[2,Object.keys(lr[this.dbname])];throw Ve.storeNotAvailable})})},n.prototype._getRaw=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return lr[this.dbname]?[4,nf(this.delay)]:[3,2];case 1:return r.sent(),[2,lr[this.dbname][t]?N({key:t},lr[this.dbname][t]):null];case 2:throw Ve.storeNotAvailable}})})},n.prototype._setRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return lr[this.dbname]?[4,nf(this.delay)]:[3,2];case 1:d.sent();try{for(r=K(t),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,o=a.data,l=a.metadata,lr[this.dbname][s]=Object.freeze({data:o,metadata:l})}catch(h){u={error:h}}finally{try{i&&!i.done&&(c=r.return)&&c.call(r)}finally{if(u)throw u.error}}return[3,3];case 2:throw Ve.storeNotAvailable;case 3:return[2]}})})},n.prototype._removeRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return lr[this.dbname]?[4,nf(this.delay)]:[3,2];case 1:l.sent();try{for(r=K(t),i=r.next();!i.done;i=r.next())a=i.value,lr[this.dbname][a]&&delete lr[this.dbname][a]}catch(u){s={error:u}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}}return[3,3];case 2:throw Ve.storeNotAvailable;case 3:return[2]}})})},n.prototype.observe=function(t,r,i){var a=this;this.observer[t]||(this.observer[t]={}),r.forEach(function(s){return a.observer[t][s]=i})},n.prototype.checkAvailability=function(){return g(this,void 0,void 0,function(){return _(this,function(t){return[2]})})},n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this.dbname=t,lr[this.dbname]||(lr[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},n.prototype.set=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){if((r=this.observer[t.key])&&typeof r.set=="function"&&(i=r.set()))throw i;return[2,e.prototype.set.call(this,t)]})})},n.prototype.setMany=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){try{for(r=K(t),i=r.next();!i.done;i=r.next())if(a=i.value,(s=this.observer[a.key])&&typeof s.set=="function"&&(o=s.set()))throw o}catch(d){l={error:d}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(l)throw l.error}}return[2,e.prototype.setMany.call(this,t)]})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return t.sent(),[4,nf(this.delay)];case 2:return t.sent(),lr[this.dbname]={},[2]}})})},n}(Rm),lC="NestDBStore";(function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.CLOSED=3]="CLOSED"})(ki||(ki={}));var Zi,ZU=function(e){function n(t){t===void 0&&(t={});var r,i=this;return(i=e.call(this,N(N({},t),{itemSizeLimit:(r=t.itemSizeLimit)!==null&&r!==void 0?r:104857600}))||this)._storeName=lC,i._state=ki.UNINITIALIZED,i._openJobQueue=[],i._window=typeof window<"u"?window:void 0,i._indexedDb=i._window?i._window.indexedDB||i._window.mozIndexedDB||i._window.webkitIndexedDB||i._window.msIndexedDB:void 0,i}return T(n,e),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),n.prototype.isTransactionInactiveError=function(t){return t instanceof Error&&t.message.includes("The transaction is inactive")},n.prototype._putToObjectStore=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return[2,new Promise(function(a,s){var o=t.put(r);o.addEventListener("success",function(l){a(l.target.result)}),o.addEventListener("error",function(){s("Failed to write.")})})]})})},n.prototype._deleteFromObjectStore=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return[2,new Promise(function(a,s){var o=t.delete(r);o.addEventListener("success",function(){return a(r)}),o.addEventListener("error",function(l){return s(l.target.error)})})]})})},n.prototype._openDatabase=function(t){var r=this;return new Promise(function(i,a){if(r._indexedDb){r._state=ki.OPENING;var s=r._indexedDb.open(t);s.addEventListener("upgradeneeded",function(o){o.target.result.createObjectStore(lC,{keyPath:"key"})}),s.addEventListener("success",function(o){r._state=ki.OPEN,r._database=o.target.result,r._openJobQueue.forEach(function(l){return l()}),r._openJobQueue=[],r._database.onclose=function(){r._database=void 0,r._state=ki.OPENING,setTimeout(function(){r._openDatabase(t)},5)},i(r._database)}),s.addEventListener("error",function(o){r._state=ki.UNINITIALIZED,a(o.target.error)})}else a(Ve.storeNotAvailable)})},n.prototype._getObjectStore=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return this._database?[2,this._database.transaction(this._storeName,t).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case ki.UNINITIALIZED:case ki.OPEN:return[3,2];case ki.OPENING:case ki.CLOSED:return[3,3]}return[3,4];case 2:throw Ve.storeNotInitialized;case 3:return[2,new Promise(function(a){r._openJobQueue.push(function(){return a(r._getObjectStore(t))})})];case 4:return[4,this._getObjectStore(t)];case 5:return[2,i.sent()]}})})},n.prototype._getAllRawKeys=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return t=r.sent(),[4,new Promise(function(i,a){var s=t.getAllKeys();s.addEventListener("success",function(o){i(o.target.result)}),s.addEventListener("error",function(o){return a(o.target.error)})})];case 2:return[2,r.sent()]}})})},n.prototype._getRaw=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return r=i.sent(),[4,new Promise(function(a,s){var o=r.get(t);o.addEventListener("success",function(l){var u;a((u=l?.target)===null||u===void 0?void 0:u.result)}),o.addEventListener("error",function(l){return s(l.target.error)})})];case 2:return[2,i.sent()]}})})},n.prototype._setRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=h.sent(),h.label=2;case 2:return h.trys.push([2,4,,15]),[4,Promise.all(t.map(function(f){return d._putToObjectStore(r,f)}))];case 3:return h.sent(),[3,15];case 4:if(i=h.sent(),!this.isTransactionInactiveError(i))return[3,13];h.label=5;case 5:h.trys.push([5,10,11,12]),a=K(t),s=a.next(),h.label=6;case 6:return s.done?[3,9]:(o=s.value,[4,this._putToObjectStore(r,o)]);case 7:h.sent(),h.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return l=h.sent(),u={error:l},[3,12];case 11:try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(u)throw u.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},n.prototype._removeRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=h.sent(),h.label=2;case 2:return h.trys.push([2,4,,15]),[4,Promise.all(t.map(function(f){return d._deleteFromObjectStore(r,f)}))];case 3:return h.sent(),[3,15];case 4:if(i=h.sent(),!this.isTransactionInactiveError(i))return[3,13];h.label=5;case 5:h.trys.push([5,10,11,12]),a=K(t),s=a.next(),h.label=6;case 6:return s.done?[3,9]:(o=s.value,[4,this._deleteFromObjectStore(r,o)]);case 7:h.sent(),h.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return l=h.sent(),u={error:l},[3,12];case 11:try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(u)throw u.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},n.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},n.prototype.checkAvailability=function(){return g(this,void 0,void 0,function(){var t,r=this;return _(this,function(i){switch(i.label){case 0:if(!((t=typeof window<"u"?window:null)!=null&&t.indexedDB||t?.mozIndexedDB||t?.webkitIndexedDB||t?.msIndexedDB))return[3,6];if(this._indexedDb=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB,!this._window||!Hp())return[3,4];if(!(Hp()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(t.PointerEvent||t.MSPointerEvent))throw Ve.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise(function(a,s){if(r._indexedDb)try{var o=r._indexedDb.open("_testMozilla");o.onerror=function(){return s(Ve.storeNotAvailableInPrivateBrowsing)},o.onsuccess=function(l){if(l.target.result.close(),r._indexedDb){var u=r._indexedDb.deleteDatabase("_testMozilla");u.onerror=function(){return a()},u.onsuccess=function(){return a()}}else s(Ve.storeNotAvailable)}}catch{s(Ve.storeNotAvailableInPrivateBrowsing)}else s(Ve.storeNotAvailable)})];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:throw Ve.storeNotAvailable;case 5:return[3,7];case 6:throw Ve.storeNotAvailable;case 7:return[2]}})})},n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this.dbname=t,[4,this.checkAvailability()];case 1:return r.sent(),[4,this._openDatabase(t)];case 2:return r.sent(),[4,this._resetIfEncryptionChanged()];case 3:return r.sent(),[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return r.sent(),[4,this._getObjectStore("readwrite")];case 2:return t=r.sent(),[4,new Promise(function(i,a){var s=t.clear();s.addEventListener("success",function(){return i()}),s.addEventListener("error",function(o){return a(o.target.error)})})];case 3:return[2,r.sent()]}})})},n}(Rm),XU=function(e){function n(t){var r=this,i=t.AsyncStorage,a=t.itemSizeLimit,s=a===void 0?2097152:a,o=gO(t,["AsyncStorage","itemSizeLimit"]);return(r=e.call(this,N(N({},o),{itemSizeLimit:s}))||this)._asyncStorage=i,r}return T(n,e),n.prototype._isBelonging=function(t){return t.startsWith("".concat(this.dbname,"/"))},n.prototype._getActualKey=function(t){return"".concat(this.dbname,"/").concat(t)},n.prototype._getAllRawKeys=function(){return g(this,void 0,void 0,function(){var t,r=this;return _(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return t=i.sent(),[2,t.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},n.prototype._getRaw=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(t))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},n.prototype._setRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:r=[];try{for(i=K(t),a=i.next();!a.done;a=i.next())s=a.value,o=s.key,s.data.length<=this.adjustedItemSizeLimit&&r.push([this._getActualKey(o),JSON.stringify(s)])}catch(d){l={error:d}}finally{try{a&&!a.done&&(u=i.return)&&u.call(i)}finally{if(l)throw l.error}}return[4,this._asyncStorage.multiSet(r)];case 1:return c.sent(),[2]}})})},n.prototype._removeRaw=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.multiRemove(t.map(function(a){return r._getActualKey(a)}))];case 1:return i.sent(),[2]}})})},n.prototype.checkAvailability=function(){return g(this,void 0,void 0,function(){return _(this,function(t){if(!this._asyncStorage)throw Ve.storeNotAvailable;return[2]})})},n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this.dbname=t,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return t=r.sent(),[4,this.removeMany(t)];case 3:return r.sent(),[2]}})})},n}(Rm),JU=function(e){function n(t){var r,i=this;return(i=e.call(this,N(N({},t),{itemSizeLimit:(r=t.itemSizeLimit)!==null&&r!==void 0?r:6291456}))||this)._mmkv=t.MMKV,i}return T(n,e),n.prototype._isBelonging=function(t){return t.startsWith("".concat(this.dbname,"/"))},n.prototype._getActualKey=function(t){return"".concat(this.dbname,"/").concat(t)},n.prototype._getAllRawKeys=function(){return g(this,void 0,void 0,function(){var t,r=this;return _(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return t=i.sent(),[2,t.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},n.prototype._getRaw=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getString(this._getActualKey(t))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},n.prototype._setRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){try{for(r=K(t),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,a.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(s),JSON.stringify(a))}catch(c){o={error:c}}finally{try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}}return[2]})})},n.prototype._removeRaw=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o;return _(this,function(l){try{for(r=K(t),i=r.next();!i.done;i=r.next())a=i.value,this._mmkv.delete(this._getActualKey(a))}catch(u){s={error:u}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}}return[2]})})},n.prototype.checkAvailability=function(){return g(this,void 0,void 0,function(){return _(this,function(t){if(!this._mmkv)throw Ve.storeNotAvailable;return[2]})})},n.prototype.init=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this.dbname=t,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return t=r.sent(),[4,this.removeMany(t)];case 3:return r.sent(),[2]}})})},n}(Rm);(function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"})(Zi||(Zi={}));var Pi,e4=function(){function e(n){var t=n.name,r=n.version,i=n.store,a=n.config;this.name=t,this._version=r,this._state=Zi.INIT,this._config=a||new fh({dbname:t}),this._store=i,this._event={success:Pc,error:Pc,storeReplaced:Pc,upgrade:iC},this._collections=new Map,this._globalMutex=new Hy("".concat(this.name,".lock")),this._config.disableLogger&&To.off(),new pr({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),e.prototype._initializeCollection=function(n,t){var r;return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return a=this._collections.get(n),t?(i=new Tg({dbname:this.name,collectionName:n,keyName:t.keyName,indexes:(r=t.index)!==null&&r!==void 0?r:[[t.keyName]],store:this._store}),[3,3]):[3,1];case 1:return a&&a.state===zo.READY?[3,3]:[4,Tg.metadataOf(this.name,n,this._store)];case 2:(s=o.sent())&&(i=new Tg({dbname:this.name,collectionName:n,keyName:s.keyName,indexes:s.indexes,store:this._store})),o.label=3;case 3:return i?(this._collections.set(n,i),[4,i.init()]):[3,5];case 4:o.sent(),o.label=5;case 5:return[2]}})})},e.prototype.estimateUsage=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,(t=this._store,g(void 0,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,t.usage()];case 1:return[2,r.sent()]}})}))];case 1:return[2,n.sent()]}var t})})},e.prototype.commitSchema=function(n){return g(this,void 0,void 0,function(){var t=this;return _(this,function(r){switch(r.label){case 0:return this._state!==Zi.OPENING?[3,2]:[4,Promise.all(n.map(function(i){return g(t,void 0,void 0,function(){return _(this,function(a){switch(a.label){case 0:return[4,this._initializeCollection(i.collectionName,i)];case 1:return a.sent(),[2]}})})}))];case 1:return r.sent(),[3,3];case 2:throw Ve.databaseSchemaNotOnUpgrade;case 3:return[2]}})})},e.prototype.open=function(){var n;return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:return[4,this._globalMutex.lock()];case 1:if(f.sent(),this._state===Zi.OPENED)return[3,20];this._state=Zi.OPENING,f.label=2;case 2:return f.trys.push([2,13,,20]),[4,this._store.init(this.name)];case 3:return f.sent(),m=this.name,t="".concat(zy(m),".metadata"),r={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:i=(n=f.sent())!==null&&n!==void 0?n:r,f.label=5;case 5:f.trys.push([5,10,11,12]),a=K(i.collectionNames),s=a.next(),f.label=6;case 6:return s.done?[3,9]:(o=s.value,[4,this._initializeCollection(o)]);case 7:f.sent(),f.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return l=f.sent(),c={error:l},[3,12];case 11:try{s&&!s.done&&(d=a.return)&&d.call(a)}finally{if(c)throw c.error}return[7];case 12:return[2,new Promise(function(y,C){var b=function(E){i.version<h._version?h._event.upgrade(i.version,function(S){return g(h,void 0,void 0,function(){var w;return _(this,function(A){switch(A.label){case 0:if(S)return[3,5];i.version++,i.collectionNames=Array.from(this._collections.keys()),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,this._store.set({key:t,value:i})];case 2:return A.sent(),E({continued:!0}),[3,4];case 3:return w=A.sent(),E({continued:!1,err:w}),[3,4];case 4:return[3,6];case 5:E({continued:!1,err:S}),A.label=6;case 6:return[2]}})})}):E({continued:!1})},v=function(E){var S=E.continued,w=S!==void 0&&S,A=E.err,D=A===void 0?null:A;w?setTimeout(function(){return b(v)},10):D?(To.error(D.message),h._globalMutex.unlock(),h._event.error(D),C(D)):Promise.all(i.collectionNames.map(function(O){return h._initializeCollection(O)})).then(function(){h._state=Zi.OPENED,h._globalMutex.unlock(),h._event.success(),y()}).catch(function(O){To.error(O.message),h._globalMutex.unlock(),h._event.error(O),C(O)})};b(v)})];case 13:switch(u=f.sent(),u.code){case bt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,14];case bt.STORE_NOT_AVAILABLE:return[3,16]}return[3,18];case 14:return To.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new Oo({}),this._globalMutex.unlock(),this._event.error(u),this._event.storeReplaced(this._store),[4,this.open()];case 15:return f.sent(),[3,19];case 16:return To.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new Oo({}),this._globalMutex.unlock(),this._event.error(u),this._event.storeReplaced(this._store),[4,this.open()];case 17:return f.sent(),[3,19];case 18:throw To.error(u.message),this._globalMutex.unlock(),this._event.error(u),u;case 19:return[3,20];case 20:return[2]}var m})})},e.prototype.close=function(){this._collections.forEach(function(n){return n.close()}),this._state=Zi.CLOSED},e.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map(function(t){return t.clear()}))];case 1:return n.sent(),[2]}})})},e.prototype.reset=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return(n=pr.get(this.name))&&n.clearForDatabase(this.name),[4,this._store.clear()];case 1:return t.sent(),[2]}})})},e.prototype.on=function(n,t){this._event[n]=t},e.prototype.off=function(n){typeof this._event[n]=="function"&&(n==="upgrade"?this._event[n]=iC:this._event[n]=Pc)},e.prototype.collection=function(n){var t=this._collections.get(n);if(t)return t;throw Ve.collectionNotReady},e}();(function(e){e[e.VERBOSE=0]="VERBOSE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.NONE=5]="NONE"})(Pi||(Pi={}));var bn,pN=function(){function e(){this.level=Pi.WARN}return e.prototype.verbose=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.level<=Pi.VERBOSE&&console.log.apply(console,ce(["[verbose]"],ne(n),!1))},e.prototype.debug=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.level<=Pi.DEBUG&&console.log.apply(console,ce(["[debug]"],ne(n),!1))},e.prototype.info=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.level<=Pi.INFO&&console.log.apply(console,ce(["[info]"],ne(n),!1))},e.prototype.warn=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.level<=Pi.WARN&&console.warn.apply(console,ce(["[warn]"],ne(n),!1))},e.prototype.error=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.level<=Pi.ERROR&&console.error.apply(console,ce(["[error]"],ne(n),!1))},e}(),Wa=function(){function e(n){var t,r,i,a;this.messageTypeFilter=(t=n?.messageTypeFilter)!==null&&t!==void 0?t:Un.ALL,this.customTypesFilter=(r=n?.customTypesFilter)!==null&&r!==void 0?r:null,this.senderUserIdsFilter=(i=n?.senderUserIdsFilter)!==null&&i!==void 0?i:null,this.replyType=(a=n?.replyType)!==null&&a!==void 0?a:Fn.NONE}return e.prototype.clone=function(){var n=new e,t=JSON.parse(JSON.stringify(this));return Object.keys(t).forEach(function(r){n[r]=t[r]}),n},e.prototype.match=function(n){switch(this.messageTypeFilter){case Un.USER:if(n.messageType!==vt.USER)return!1;break;case Un.FILE:if(n.messageType!==vt.FILE)return!1;break;case Un.ADMIN:if(n.messageType!==vt.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(n.customType)||this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0&&(!(n instanceof xt)||!this.senderUserIdsFilter.includes(n.sender.userId)))return!1;if(n instanceof Vn)switch(this.replyType){case Fn.NONE:if(n.parentMessageId>0)return!1;break;case Fn.ONLY_REPLY_TO_CHANNEL:if(n instanceof xt&&n.parentMessageId>0&&!n.replyToChannel)return!1}return!0},e}();(function(e){e.CHANNEL_LATEST="channel_latest",e.NEWEST_CHILD_MESSAGE="newest_child_message"})(bn||(bn={}));var gd,ra=function(e){switch(e){case bn.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case bn.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},t4=function(){return["channelUrl","-createdAt","-notificationId"]},n4=N(N({},eN),{scheduledAt:void 0}),r4=function(e){return nN(e)&&x("number",e.scheduledAt,!0)},i4=N(N({},Dm),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),a4=function(e){return km(e)&&x("number",e.scheduledAt)&&(Kn(e.file)||x("string",e.fileUrl))&&x("string",e.fileName,!0)&&x("string",e.mimeType,!0)&&x("number",e.fileSize,!0)&&(e.thumbnailSizes===null||e.thumbnailSizes===void 0||e.thumbnailSizes.every(function(n){return x("object",n)&&n.maxWidth>0&&n.maxHeight>0}))},mN="UnsentMessage",s4="reqId",sf={},cl=function(e){function n(t){var r=e.call(this,t)||this;return r._mutex=new Hy("unsendmessagecache.lock"),sf[t]=r,r}return T(n,e),Object.defineProperty(n.prototype,"_cacheContext",{get:function(){return I.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),n.of=function(t,r){return r===void 0&&(r=!1),sf[t]&&!r||(sf[t]=new n(t)),sf[t]},Object.defineProperty(n.prototype,"collection",{get:function(){var t=this._cacheContext.nestdb,r=t?.collection(mN);if(!r)throw k.databaseError;return r},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n.prototype._serialize=function(t){if(t.messageId>0)throw k.invalidParameters;var r,i=N({},t.serialize());return t instanceof kn?(t.messageParams&&(i.messageParams=B1(t.messageParams)),t.scheduledInfo&&t.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=(r=t.scheduledInfo.scheduledMessageParams,N(N({},B1(r)),{scheduledAt:r.scheduledAt})))):t instanceof qt?(t.messageParams&&(i.messageParams=G1(t.messageParams)),t.scheduledInfo&&t.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=function(a){return N(N({},G1(a)),{scheduledAt:a.scheduledAt})}(t.scheduledInfo.scheduledMessageParams))):t instanceof qr&&t.messageParams&&(i.messageParams=function(a){return W({fileInfoList:a.fileInfoList.map(function(s){return{file:s.file,fileUrl:Gd.getPlainUrl(s),fileName:s.fileName,fileSize:s.fileSize,mimeType:s.mimeType,thumbnailSizes:s.thumbnailSizes,_thumbnails:s._thumbnails,_uploadedMetaData:s._uploadedMetaData}}),isReplyToChannel:a.isReplyToChannel,pushNotificationDeliveryOption:a.pushNotificationDeliveryOption})}(t.messageParams)),i},n.prototype._deserialize=function(t){return t=N(N({},t),{messageId:parseInt(t.messageId)}),un.of(this._iid).buildMessageFromSerializedData(t)},n.prototype._deserializeWithMessageCreateParams=function(t){var r,i,a;return g(this,void 0,void 0,function(){var s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:return s=un.of(this._iid),o=this._deserialize(t),t.messageParams?o instanceof kn?(u=t.messageParams,o.messageParams=s.buildUserMessageCreateParamsFromSerializedData(u,o),[3,6]):[3,1]:[3,6];case 1:return o instanceof qt?(u=t.messageParams).fileKey&&typeof u.fileKey=="string"&&yg((r=u.fileType)!==null&&r!==void 0?r:"")?(l=u,[4,this.collection.getBlob(u.fileKey)]):[3,3]:[3,4];case 2:l.file=(i=f.sent())!==null&&i!==void 0?i:void 0,f.label=3;case 3:return o.messageParams=s.buildFileMessageCreateParamsFromSerializedData(u,o),[3,6];case 4:return o instanceof qr&&(u=t.messageParams)&&u.fileInfoList?(o.messageParams=s.buildMultipleFilesMessageCreateParamsFromSerializedData(u,o),[4,Promise.all(o.messageParams.fileInfoList.map(function(m){return g(h,void 0,void 0,function(){var y,C,b,v,E;return _(this,function(S){switch(S.label){case 0:return typeof((C=m._uploadedMetaData)===null||C===void 0?void 0:C.fileKey)=="string"&&yg((v=(b=m._uploadedMetaData)===null||b===void 0?void 0:b.fileType)!==null&&v!==void 0?v:"")?(y=m,[4,this.collection.getBlob(m._uploadedMetaData.fileKey)]):[3,2];case 1:y.file=(E=S.sent())!==null&&E!==void 0?E:void 0,S.label=2;case 2:return[2]}})})}))]):[3,6];case 5:f.sent(),f.label=6;case 6:return o.scheduledInfo&&t.scheduledInfo&&t.scheduledInfo.scheduledMessageParams?o instanceof kn?(c=t.scheduledInfo.scheduledMessageParams,o.scheduledInfo.scheduledMessageParams=s.buildScheduledUserMessageCreateParamsFromSerializedData(c,o),[3,10]):[3,7]:[3,10];case 7:return o instanceof qt?(c=t.scheduledInfo.scheduledMessageParams).fileKey&&typeof c.fileKey=="string"&&typeof c.fileType=="string"&&yg(c.fileType)?(d=c,[4,this.collection.getBlob(c.fileKey)]):[3,9]:[3,10];case 8:d.file=(a=f.sent())!==null&&a!==void 0?a:void 0,f.label=9;case 9:o.scheduledInfo.scheduledMessageParams=s.buildScheduledFileMessageCreateParamsFromSerializedData(c,o),f.label=10;case 10:return[2,o]}})})},n.prototype._getFileInfoBlobKey=function(t,r){return"".concat(t,".").concat(r)},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(t))]:[3,2];case 1:if(r=i.sent())return[2,this._deserializeWithMessageCreateParams(r)];i.label=2;case 2:return[2,void 0]}})})},n.prototype.fetch=function(t){var r=t.channelUrl,i=t.filter,a=i===void 0?new Wa:i,s=t.order,o=s===void 0?bn.CHANNEL_LATEST:s,l=t.sendingStatus,u=t.backward,c=u!==void 0&&u,d=t.parentMessageId;return g(this,void 0,void 0,function(){var h,f,m,y,C=this;return _(this,function(b){switch(b.label){case 0:return this.localCacheEnabled?(h=ra(o),f={"/where":function(v){return!!(o!==bn.NEWEST_CHILD_MESSAGE||d&&v.parentMessageId!==0&&v.parentMessageId===d)&&a.match(C._deserialize(v))}},r&&(f.channelUrl=r),l&&(f.sendingStatus=l),m={where:f,index:h,backward:c},[4,this.collection.query(m)]):[3,3];case 1:return[4,b.sent().fetch({})];case 2:return y=b.sent(),[2,Promise.all(y.map(function(v){return g(C,void 0,void 0,function(){return _(this,function(E){switch(E.label){case 0:return[4,this._deserializeWithMessageCreateParams(v)];case 1:return[2,E.sent()]}})})}))];case 3:return[2,[]]}})})},n.prototype.getAllChildMessages=function(t,r){return r===void 0&&(r=new Wa),g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this.fetch({filter:r,order:bn.NEWEST_CHILD_MESSAGE,channelUrl:t.channelUrl,backward:!1,parentMessageId:t.messageId})];case 1:return[2,i.sent()]}})})},n.prototype.upsert=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(t.map(function(a){return g(r,void 0,void 0,function(){var s;return _(this,function(o){switch(o.label){case 0:return a instanceof qt||a instanceof qr?[4,this._mutex.lock()]:[3,4];case 1:return o.sent(),[4,this.saveBlob(a)];case 2:return o.sent(),[4,this._mutex.unlock()];case 3:o.sent(),o.label=4;case 4:return s=this._serialize(a),[4,this.collection.upsertOne(s)];case 5:return o.sent(),[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},n.prototype.upsertChildMessages=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(t.map(function(a){return g(r,void 0,void 0,function(){var s;return _(this,function(o){switch(o.label){case 0:return s=[],a.threadInfo&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=o.sent(),o.label=2;case 2:return s.length>0?(s.forEach(function(l){return l.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:o.sent(),o.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},n.prototype.remove=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),r=K(t),i=r.next(),u.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=u.sent(),o={error:s},[3,8];case 7:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 8:return[2]}})})},n.prototype.removeMessagesOfChannel=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:t}})]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.saveBlob=function(t){return g(this,void 0,void 0,function(){var r,i,a,s=this;return _(this,function(o){switch(o.label){case 0:return t instanceof qt?t.messageParams&&(a=t.messageParams).file&&Pf(a.file)?[4,this.collection.saveBlob(a.file,t.reqId)]:[3,2]:[3,5];case 1:i=o.sent(),a.fileKey=i,a.fileType=Wo.BLOB,o.label=2;case 2:return t.scheduledInfo&&t.scheduledInfo.scheduledMessageParams&&(r=t.scheduledInfo.scheduledMessageParams).file&&Pf(r.file)?[4,this.collection.saveBlob(r.file,t.reqId)]:[3,4];case 3:i=o.sent(),r.fileKey=i,r.fileType=Wo.BLOB,o.label=4;case 4:return[3,7];case 5:return t instanceof qr&&(a=t.messageParams)&&a.fileInfoList&&Array.isArray(a.fileInfoList)?[4,Promise.all(a.fileInfoList.map(function(l,u){return g(s,void 0,void 0,function(){var c;return _(this,function(d){switch(d.label){case 0:return l.file&&Pf(l.file)?[4,this.collection.saveBlob(l.file,this._getFileInfoBlobKey(t.reqId,u))]:[3,2];case 1:c=d.sent(),l._uploadedMetaData||(l._uploadedMetaData={}),l._uploadedMetaData.fileKey=c,l._uploadedMetaData.fileType=Wo.BLOB,d.label=2;case 2:return[2]}})})}))]:[3,7];case 6:o.sent(),o.label=7;case 7:return[2]}})})},n}(Wt),of={},Ho=function(e){function n(t){var r=e.call(this,t)||this;return of[t]=r,r}return T(n,e),Object.defineProperty(n.prototype,"_sdkState",{get:function(){return I.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_cacheContext",{get:function(){return I.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_unsentMessageCache",{get:function(){return cl.of(this._iid)},enumerable:!1,configurable:!0}),n.of=function(t,r){return r===void 0&&(r=!1),of[t]&&!r||(of[t]=new n(t)),of[t]},Object.defineProperty(n.prototype,"collection",{get:function(){var t=this._cacheContext.nestdb;return B(!!t).throw(k.databaseError),t.collection(Fy)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n.prototype._serialize=function(t){return N(N({},t.serialize()),{messageId:"".concat(t.messageId)})},n.prototype._deserialize=function(t){return t=N(N({},t),{messageId:parseInt(t.messageId)}),un.of(this._iid).buildMessageFromSerializedData(t)},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(t))]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},n.prototype.fetch=function(t){var r=t.channelUrl,i=t.token,a=t.limit,s=a===void 0?100:a,o=t.filter,l=o===void 0?new Wa:o,u=t.order,c=u===void 0?bn.CHANNEL_LATEST:u,d=t.backward,h=d!==void 0&&d,f=t.parentMessageId,m=t.isPollOnly,y=m!==void 0&&m,C=t.exactMatch,b=C!==void 0&&C,v=t.inclusive,E=v===void 0||v;return g(this,void 0,void 0,function(){var S,w,A,D=this;return _(this,function(O){switch(O.label){case 0:return this.localCacheEnabled?(S=ra(c),w={where:{channelUrl:r,"/where":function(M){if(i!=null&&i!=="")switch(c){case bn.CHANNEL_LATEST:if(b&&M.createdAt!==i)return!1;if(h){if(E&&M.createdAt<i||!E&&M.createdAt<=i)return!1}else if(E&&M.createdAt>i||!E&&M.createdAt>=i)return!1;break;case bn.NEWEST_CHILD_MESSAGE:if(!f||M.parentMessageId===0||M.parentMessageId!==f)return!1}return!(y&&!M._poll)&&l.match(D._deserialize(M))}},index:S,backward:h},[4,this.collection.query(w)]):[3,3];case 1:return[4,O.sent().fetch({limit:s??void 0})];case 2:return A=O.sent(),[2,Promise.all(A.map(function(M){return g(D,void 0,void 0,function(){return _(this,function(F){return[2,this._deserialize(M)]})})}))];case 3:return[2,[]]}})})},n.prototype.getAllChildMessages=function(t,r){return r===void 0&&(r=new Wa),g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this.fetch({channelUrl:t.channelUrl,token:Date.now(),limit:null,backward:!1,filter:r,order:bn.NEWEST_CHILD_MESSAGE,parentMessageId:t.messageId})];case 1:return[2,i.sent()]}})})},n.prototype.upsert=function(t){var r;return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(t)]:[3,13];case 1:f.sent(),f.label=2;case 2:f.trys.push([2,7,8,9]),i=K(t),a=i.next(),f.label=3;case 3:return a.done?[3,6]:(s=a.value,!((r=s.threadInfo)===null||r===void 0)&&r._isUpdateRequired?[4,this.get(s.messageId)]:[3,5]);case 4:(o=f.sent())!=null&&o.threadInfo&&s.threadInfo._updateFrom(o.threadInfo),f.label=5;case 5:return a=i.next(),[3,3];case 6:return[3,9];case 7:return l=f.sent(),c={error:l},[3,9];case 8:try{a&&!a.done&&(d=i.return)&&d.call(i)}finally{if(c)throw c.error}return[7];case 9:return u=t.map(function(m){return h._serialize(m)}),[4,this.collection.upsertMany(u)];case 10:return f.sent(),[4,this.upsertChildMessages(t)];case 11:return f.sent(),[4,this._unsentMessageCache.upsertChildMessages(t)];case 12:f.sent(),f.label=13;case 13:return[2]}})})},n.prototype.upsertChildMessages=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(t.map(function(a){return g(r,void 0,void 0,function(){var s,o;return _(this,function(l){switch(l.label){case 0:return s=[],!((o=a.threadInfo)===null||o===void 0)&&o.replyCount&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=l.sent(),l.label=2;case 2:return s.length>0?(s.forEach(function(u){return u.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:l.sent(),l.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},n.prototype.remove=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),r=K(t),i=r.next(),u.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove("".concat(a))]);case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=u.sent(),o={error:s},[3,8];case 7:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 8:return[2]}})})},n.prototype.removeMessagesOfChannel=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:t},index:ra(bn.CHANNEL_LATEST)})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},n.prototype.removeUnderOffset=function(t,r,i){return i===void 0&&(i=!1),g(this,void 0,void 0,function(){return _(this,function(a){switch(a.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:t,createdAt:i?{"<=":r}:{"<":r}},index:ra(bn.CHANNEL_LATEST)})]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.countBetween=function(t,r,i){return g(this,void 0,void 0,function(){var a,s=this;return _(this,function(o){switch(o.label){case 0:return this.localCacheEnabled?(a=ra(bn.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:t,"/where":function(l){var u=s._deserialize(l);return i.includes(u.createdAt)&&r.match(u)}},index:a}).count()]):[3,2];case 1:return[2,o.sent()];case 2:return[2,0]}})})},n.prototype.saveBlobs=function(t){return g(this,void 0,void 0,function(){var r=this;return _(this,function(i){switch(i.label){case 0:return[4,Promise.all(t.map(function(a){return g(r,void 0,void 0,function(){var s,o;return _(this,function(l){switch(l.label){case 0:return a instanceof qt&&a.messageParams&&(s=a.messageParams).file&&Pf(s.file)?[4,this.collection.saveBlob(s.file,a.reqId)]:[3,2];case 1:o=l.sent(),s.fileKey=o,l.label=2;case 2:return[2]}})})}))];case 1:return i.sent(),[2]}})})},n.prototype._getGroupChannelPreferenceSize=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=0,[4,(i=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync"))];case 1:return a=u.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync.meta"))];case 2:return s=u.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs"))];case 3:return o=u.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs.meta"))];case 4:return l=u.sent(),a&&(r+=JSON.stringify(a).length),s&&(r+=JSON.stringify(s).length),o&&(r+=JSON.stringify(o).length),l&&(r+=JSON.stringify(l).length),[2,r]}})})},n}(Wt),lf={},o4=function(e){function n(t){var r=e.call(this,t)||this;return lf[t]=r,r}return T(n,e),Object.defineProperty(n.prototype,"_sdkState",{get:function(){return I.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_cacheContext",{get:function(){return I.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),n.of=function(t,r){return r===void 0&&(r=!1),lf[t]&&!r||(lf[t]=new n(t)),lf[t]},Object.defineProperty(n.prototype,"collection",{get:function(){var t=this._cacheContext.nestdb;return B(!!t).throw(k.databaseError),t.collection(hN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n.prototype._serialize=function(t){return N({},t.serialize())},n.prototype._deserialize=function(t){return un.of(this._iid).buildMessageFromSerializedData(t)},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(t)]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},n.prototype.fetch=function(t){var r=t.channelUrl,i=t.token,a=t.limit,s=a===void 0?100:a,o=t.filter,l=o===void 0?new Wa:o,u=t.backward,c=u!==void 0&&u,d=t.exactMatch,h=d!==void 0&&d,f=t.inclusive,m=f===void 0||f;return g(this,void 0,void 0,function(){var y,C=this;return _(this,function(b){switch(b.label){case 0:return this.localCacheEnabled?(y={where:{channelUrl:r,"/where":function(v){if(i){if(h&&v.createdAt!==i)return!1;if(c){if(m&&v.createdAt<i||!m&&v.createdAt<=i)return!1}else if(m&&v.createdAt>i||!m&&v.createdAt>=i)return!1}return l.match(C._deserialize(v))}},index:["channelUrl","-createdAt","-notificationId"],backward:c},[4,this.collection.query(y)]):[3,3];case 1:return[4,b.sent().fetch({limit:s??void 0})];case 2:return[2,b.sent().map(function(v){return C._deserialize(v)})];case 3:return[2,[]]}})})},n.prototype.upsert=function(t){return g(this,void 0,void 0,function(){var r,i=this;return _(this,function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=t.map(function(s){return i._serialize(s)}),[4,this.collection.upsertMany(r)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},n.prototype.remove=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),r=K(t),i=r.next(),u.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=u.sent(),o={error:s},[3,8];case 7:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 8:return[2]}})})},n.prototype.markAsReadByTimestamp=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:t,messageStatus:$o.SENT,createdAt:{"<":r}}},{set:{messageStatus:$o.READ}})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},n.prototype.markAsReadByMessageIds=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:t,notificationId:{"/in":r},messageStatus:$o.SENT}},{set:{messageStatus:$o.READ}})]:[3,2];case 1:return[2,i.sent().length];case 2:return[2,0]}})})},n.prototype.removeMessagesOfChannel=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:t},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(t,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},n.prototype.removeUnderOffset=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:t,createdAt:{"<":r}},index:ra(bn.CHANNEL_LATEST)})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.countBetween=function(t,r,i){return g(this,void 0,void 0,function(){var a,s=this;return _(this,function(o){switch(o.label){case 0:return this.localCacheEnabled?(a=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:t,"/where":function(l){var u=s._deserialize(l);return i.includes(u.createdAt)&&r.match(u)}},index:a}).count()]):[3,2];case 1:return[2,o.sent()];case 2:return[2,0]}})})},n}(Wt),_c={},_N=function(e){function n(t){var r=e.call(this,t)||this;return r._observers=new Map,r._dispatcherContext=r._dispatcher.on(function(i){return g(r,void 0,void 0,function(){var a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M,F=this;return _(this,function(U){switch(U.label){case 0:return i instanceof _t?(a=i.messages,M=i.source,c=i.isWebSocketEventComing,s=a.filter(function($){return $ instanceof Vn&&$.channelType!==Pe.OPEN&&$.messageId>0}),o=a.filter(function($){return $ instanceof Vn&&$.channelType!==Pe.OPEN&&$.messageId===0}),l=a.filter(function($){return $ instanceof ll}),s.length>0?[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._messageCache.upsert(s)];case 1:return $.sent(),[4,this._unsentMessageCache.remove(s.map(function(J){return J instanceof xt?J.reqId:null}).filter(function(J){return J!==null}))];case 2:return $.sent(),[2]}})})})]:[3,2]):[3,7];case 1:U.sent(),c||this._broadcastUpdateEvent(s,M),U.label=2;case 2:return o.length>0?[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._unsentMessageCache.upsert(o)];case 1:return $.sent(),[2]}})})})]:[3,4];case 3:U.sent(),c||this._broadcastUpdateEvent(o,M),U.label=4;case 4:return l.length>0?[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._notificationCache.upsert(l)];case 1:return $.sent(),[2]}})})})]:[3,6];case 5:U.sent(),c||this._broadcastUpdateEvent(l,M),U.label=6;case 6:return[3,24];case 7:return i instanceof Oy?(u=i.messageIds,M=i.source,c=i.isWebSocketEventComing,d=u.filter(function($){return typeof $=="number"}),h=u.filter(function($){return typeof $=="string"}),[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return d.length>0?[4,this._messageCache.remove(d)]:[3,2];case 1:$.sent(),$.label=2;case 2:return h.length>0?[4,this._notificationCache.remove(h)]:[3,4];case 3:$.sent(),$.label=4;case 4:return[2]}})})})]):[3,9];case 8:return U.sent(),c||this._broadcastRemoveEvent(u,M),[3,24];case 9:return i instanceof FA?(f=i.reqId,M=i.source,[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._unsentMessageCache.remove([f])];case 1:return $.sent(),[2]}})})})]):[3,11];case 10:return U.sent(),this._broadcastRemoveUnsentEvent(f,M),[3,24];case 11:return i instanceof $A?(m=i.polls,M=i.source,this._cacheContext.localCacheEnabled?(y=m.map(function($){return $.messageId}),[4,Promise.all(y.map(function($){return F._messageCache.get($)}))]):[3,14]):[3,15];case 12:return(C=U.sent().filter(function($){return $})).length>0&&m.forEach(function($){var J=C.find(function(ee){return ee.messageId===$.messageId});J&&J.applyPoll($)}),[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._messageCache.upsert(C)];case 1:return[2,$.sent()]}})})})];case 13:U.sent(),U.label=14;case 14:return this._broadcastPollChangeLogEvent(m,M),[3,24];case 15:return i instanceof zA?(b=i.event,M=i.source,[4,this._messageCache.get(b.messageId)]):[3,19];case 16:return(v=U.sent())&&v.isUserMessage()&&v.poll&&v.poll.applyPollUpdateEvent(b)?[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._messageCache.upsert([v])];case 1:return[2,$.sent()]}})})})]:[3,18];case 17:U.sent(),U.label=18;case 18:return this._broadcastPollUpdateEvent(b,M),[3,24];case 19:return i instanceof Dy?(E=i.event,M=i.source,[4,this._messageCache.get(E.messageId)]):[3,23];case 20:return(S=U.sent())&&S.isUserMessage()&&S.poll&&S.poll.applyPollVoteEvent(E)?[4,Ct(function(){return g(F,void 0,void 0,function(){return _(this,function($){switch($.label){case 0:return[4,this._messageCache.upsert([S])];case 1:return[2,$.sent()]}})})})]:[3,22];case 21:U.sent(),U.label=22;case 22:return this._broadcastPollVoteEvent(E,M),[3,24];case 23:i instanceof LA?(w=i.event,M=i.source,w.messageId>0&&this._broadcastReactionUpdateEvent(w,M)):i instanceof PA?(A=i.event,M=i.source,this._broadcastThreadUpdateEvent(A,M)):i instanceof UA&&(D=i.messageDeletionTimestamp,O=i.channelUrl,M=i.source,this._broadcastMessageRetentionEvent(D,O,M)),U.label=24;case 24:return[2]}})})}),r}return T(n,e),Object.defineProperty(n.prototype,"_cacheContext",{get:function(){return I.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_dispatcher",{get:function(){return I.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_messageCache",{get:function(){return Ho.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_unsentMessageCache",{get:function(){return cl.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_notificationCache",{get:function(){return o4.of(this._iid)},enumerable:!1,configurable:!0}),n.of=function(t,r){var i;return r===void 0&&(r=!1),_c[t]&&!r||(_c[t]&&((i=_c[t]._dispatcherContext)===null||i===void 0||i.close()),_c[t]=new n(t)),_c[t]},n.prototype._broadcastUpdateEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onUpdate&&l.onUpdate(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastPollChangeLogEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onPollChangeLogUpdate&&l.onPollChangeLogUpdate(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastPollUpdateEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onPollUpdate&&l.onPollUpdate(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastPollVoteEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onPollVote&&l.onPollVote(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastRemoveEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onRemove&&l.onRemove(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastRemoveUnsentEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onRemoveUnsent&&l.onRemoveUnsent(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastReactionUpdateEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onReactionUpdate&&l.onReactionUpdate(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastThreadUpdateEvent=function(t,r){var i,a;try{for(var s=K(this._observers.values()),o=s.next();!o.done;o=s.next()){var l=o.value;l.onThreadInfoUpdate&&l.onThreadInfoUpdate(t,r)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},n.prototype._broadcastMessageRetentionEvent=function(t,r,i){var a,s;try{for(var o=K(this._observers.values()),l=o.next();!l.done;l=o.next()){var u=l.value;u.onDeletedByRetentionPolicy&&u.onDeletedByRetentionPolicy(t,r,i)}}catch(c){a={error:c}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}},n.prototype.subscribe=function(t,r){this._observers.set(t,r)},n.prototype.unsubscribe=function(t){this._observers.delete(t)},n.prototype.unsubscribeAll=function(){this._observers.clear()},n}(Wt),uC={},i0=function(e){function n(t,r){var i=r.sdkState,a=r.cacheContext,s=e.call(this,t)||this;return s._users=new Map,s._sdkState=i,s._cacheContext=a,uC[t]=s,s}return T(n,e),n.of=function(t){return uC[t]},Object.defineProperty(n.prototype,"collection",{get:function(){var t=this._cacheContext.nestdb;return B(!!t).throw(k.databaseError),t.collection(fN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"users",{get:function(){return ce([],ne(this._users.values()),!1)},enumerable:!1,configurable:!0}),n.prototype._serialize=function(t,r){return N(N({},t.serialize()),{updatedAt:r})},n.prototype._deserialize=function(t){return xe._buildUserFromSerializedData(t)},n.prototype.isCachedInMemory=function(t){return this._users.has(t)},n.prototype.getUserInfoFromCache=function(t){if(this._users.has(t))return this._users.get(t)},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return this._users.has(t)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(t)]:[3,2];case 1:if(r=a.sent())return i=this._deserialize(r),this._users.set(i.userId,i),[2,i];a.label=2;case 2:return[2,void 0];case 3:return[2,this._users.get(t)]}})})},n.prototype.fetch=function(t){var r=t.limit,i=r===void 0?100:r,a=t.backward,s=a!==void 0&&a;return g(this,void 0,void 0,function(){var o,l,u,c=this;return _(this,function(d){switch(d.label){case 0:if(!this.localCacheEnabled)return[2,[]];d.label=1;case 1:return d.trys.push([1,4,,5]),o={index:["-userId","-updatedAt"],backward:s},[4,this.collection.query(o)];case 2:return[4,d.sent().fetch({limit:i})];case 3:return l=d.sent(),(u=l.map(function(h){return c._deserialize(h)})).forEach(function(h){c._users.has(h.userId)||c._users.set(h.userId,h)}),[2,u];case 4:return d.sent(),[2,[]];case 5:return[2]}})})},n.prototype.upsert=function(t,r){return g(this,void 0,void 0,function(){var i,a;return _(this,function(s){switch(s.label){case 0:if(!this.localCacheEnabled)return[3,2];if(i=this._serialize(t,r),a=this._users.get(t.userId)){if(a._hashValue===t._hashValue)return[2];if(a._updatedAt>r)return[2]}return this._users.set(t.userId,xe._buildUserFromSerializedData(i)),[4,this.collection.upsertOne(i)];case 1:s.sent(),s.label=2;case 2:return[2]}})})},n.prototype.remove=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return this._users.has(t)&&this._users.delete(t),this.localCacheEnabled?[4,this.collection.remove(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},n.prototype.clearMemoryCache=function(){this._users.clear()},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n}(Wt),l4=function(e){function n(t){var r=this,i=t.reverse,a=i!==void 0&&i,s=t.limit,o=s===void 0?20:s,l=t.keys,u=t.token;return(r=e.call(this)||this).method=z.GET,r.path="".concat(J2),r.params=W({token:u,limit:o,reverse:a,order:Fv.UPDATED_AT,show_ui_template:!0,show_color_variables:!0,keys:l}),r}return T(n,e),n}(H),u4=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.next,s=r.has_more,o=s!==void 0&&s,l=r.templates;return i.nextToken=a,i.hasMore=o,i.templates=l.map(function(u){return{template:JSON.stringify(u)}}),i}return T(n,e),n}(j),c4=function(e){function n(t){var r=this,i=t.key;return(r=e.call(this)||this).method=z.GET,r.path="".concat(J2,"/").concat(i),r}return T(n,e),n}(H),d4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.template=JSON.stringify(r),i}return T(n,e),n}(j),cC={},un=function(){function e(n,t){var r=t.sdkState,i=t.dispatcher,a=t.requestQueue,s=t.onlineDetector,o=t.cacheContext;this._iid=n,this._sdkState=r,this._requestQueue=a,this._dispatcher=i,this._cacheContext=o,Ho.of(n),cl.of(n),_N.of(n),this.fileMessageQueue=new tR(n,{sdkState:r,dispatcher:i,requestQueue:a,onlineDetector:s,cacheContext:o}),cC[n]=this}return e.of=function(n){return cC[n]},e.prototype._setSenderInfo=function(n){if(this._cacheContext.localCacheEnabled&&(n.messageType===vt.USER||n.messageType===vt.FILE)){var t=n.sender;if(t){var r=i0.of(this._iid).getUserInfoFromCache(t.user_id);r&&(n.sender=xe.payloadify(r))}}},e.prototype.buildMessageFromSerializedData=function(n){var t=Gs(n);if(t.notificationId)return new ll(this._iid,ll.payloadify(t));switch(this._setSenderInfo(t),t.messageType){case vt.USER:return new kn(this._iid,kn.payloadify(t));case vt.FILE:return qr._isMultipleFilesMessageSerializedData(t)?new qr(this._iid,qr.payloadify(t)):new qt(this._iid,qt.payloadify(t));case vt.ADMIN:return new ol(this._iid,ol.payloadify(t))}throw k.invalidParameters},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(n,t){return W(ae({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:n.pollId}))},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(n,t){var r;return W(ae({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:n.file,fileKey:n.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:(r=t.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),fileType:n.fileType,requireAuth:t.requireAuth}))},e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(n,t){var r=this;return W({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,fileInfoList:n.fileInfoList.map(function(i){return new Gd(r._iid,i)})})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(n,t){return N(N({},this.buildUserMessageCreateParamsFromSerializedData(n,t)),{scheduledAt:n.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(n,t){return N(N({},this.buildFileMessageCreateParamsFromSerializedData(n,t)),{scheduledAt:n.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(n){var t=Gs(n);return new Du(this._iid,Du.payloadify(t))},e.prototype.getMessage=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=new nR(n),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,r.as(rR).message]}})})},e.prototype.getScheduledMessage=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=new sR(n),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,r.as(oR).message]}})})},e.prototype.getMessagesByMessageId=function(n,t,r,i,a){return a===void 0&&(a=P.REQUEST_MESSAGE),g(this,void 0,void 0,function(){var s,o,l;return _(this,function(u){switch(u.label){case 0:return s=new Jh(N(N(N({channelType:t,channelUrl:n,token:String(r)},pd),i),{sdkSource:ui.EXTERNAL_LEGACY})),[4,this._requestQueue.send(s)];case 1:return o=u.sent(),l=o.as(ef).messages,this._dispatcher.dispatch(new _t({messages:l,source:a})),[2,l]}})})},e.prototype.getMessagesByTimestamp=function(n,t,r,i,a){return a===void 0&&(a=P.REQUEST_MESSAGE),g(this,void 0,void 0,function(){var s,o,l;return _(this,function(u){switch(u.label){case 0:return s=new Jh(N(N(N({channelType:t,channelUrl:n,timestamp:r},pd),i),{sdkSource:ui.EXTERNAL_LEGACY})),[4,this._requestQueue.send(s)];case 1:return o=u.sent(),l=o.as(ef).messages,this._dispatcher.dispatch(new _t({messages:l,source:a})),[2,l]}})})},e.prototype._getMessagesByTimestampForCollection=function(n,t,r,i,a,s,o,l){return a===void 0&&(a=P.REQUEST_MESSAGE),g(this,void 0,void 0,function(){var u,c,d,h,f,m;return _(this,function(y){switch(y.label){case 0:return u=new Jh(N(N(N({channelType:t,channelUrl:n,timestamp:r},pd),i),{checkingHasNext:s,checkingContinuousMessages:o,sdkSource:l})),[4,this._requestQueue.send(u)];case 1:return c=y.sent(),d=c.as(ef),h=d.messages,f=d.isContinuousMessages,m=d.hasNext,this._dispatcher.dispatch(new _t({messages:h,source:a})),[2,{messages:h,isContinuousMessages:f,hasNext:m}]}})})},e.prototype.getThreadedMessagesByTimestamp=function(n,t,r,i){return i===void 0&&(i=P.REQUEST_THREADED_MESSAGE),g(this,void 0,void 0,function(){var a,s,o,l;return _(this,function(u){switch(u.label){case 0:return a=new Jh(N(N(N({channelUrl:n.channelUrl,channelType:n.channelType,timestamp:t},hh),r),{replyType:Fn.ALL,parentMessageId:n.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(a)];case 1:return s=u.sent(),o=s.as(ef).messages,(l=o.slice(1)).forEach(function(c){c.parentMessage=n}),this._dispatcher.dispatch(new _t({messages:l,source:i})),[2,{parentMessage:o[0],threadedMessages:l}]}})})},e.prototype.getMessageTemplatesByToken=function(n,t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=new l4(N({token:n},t)),[4,this._requestQueue.send(r)];case 1:return i=u.sent(),a=i.as(u4),s=a.hasMore,o=a.nextToken,l=a.templates,[2,{hasMore:s,token:o,templates:l}]}})})},e.prototype.getMessageTemplate=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=new c4({key:n}),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,{template:r.as(d4).template}]}})})},e.prototype.getMessageChangelogs=function(n,t,r,i,a){return a===void 0&&(a=P.REQUEST_MESSAGE_CHANGELOGS),g(this,void 0,void 0,function(){var s,o,l,u,c,d,h,f,m;return _(this,function(y){switch(y.label){case 0:return s=new iR(W(ae(N(N({channelType:t,channelUrl:n,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null},Wv),i)))),[4,this._requestQueue.send(s)];case 1:return o=y.sent(),l=o.as(aR),u=l.updatedMessages,c=l.deletedMessagesInfo,d=l.hasMore,h=l.nextToken,f=l.forceUseNextToken,m=c.map(function(C){return C.messageId}),u.length>0&&this._dispatcher.dispatch(new _t({messages:u,source:a})),m.length>0&&this._dispatcher.dispatch(new Oy({messageIds:m,source:a})),[2,{updatedMessages:u,deletedMessageIds:m,hasMore:d,token:h,forceUseNextToken:f}]}})})},e}(),gN=function(e){function n(t,r){var i=e.call(this,t)||this;i.targetMessageId=0;var a=r.thread_info,s=r.parent_message_id,o=r.channel_url,l=r.channel_type;return a&&x("object",a)&&x("number",s)&&x("string",o)&&x("string",l)&&(i.threadInfo=new zp(t,a),i.targetMessageId=s,i.channelUrl=o,i.channelType=l),i}return T(n,e),n}(Wt),h4={channelUrl:"",channelType:Pe.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},f4=function(e){function n(t){var r=t.channelCustomType,i=t.keyword,a=t.limit,s=t.reverse,o=t.exactMatch,l=t.channelUrl,u=t.order,c=t.messageTimestampFrom,d=t.messageTimestampTo,h=t.advancedQuery,f=t.targetFields,m=t.nextToken,y=e.call(this)||this;return y.method=z.GET,y.path="".concat(OO,"/messages"),y.params=W({custom_type:r,query:i,limit:a,reverse:s,exact_match:o,channel_url:l,message_ts_from:c,message_ts_to:d,sort_field:u,advanced_query:h,target_fields:f,after:m}),y}return T(n,e),n}(H),p4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.messages=r.results.map(function(a){return Zn(t,a)}),i.hasNext=r.has_next,i.nextToken=r.end_cursor,i.totalCount=r.total_count,i}return T(n,e),n}(j);(function(e){e.SCORE="score",e.TIMESTAMP="ts"})(gd||(gd={}));var m4=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f=this;return(f=e.call(this,t,r)||this).keyword="",f.reverse=!1,f.exactMatch=!1,f.channelUrl=null,f.channelCustomType=null,f.messageTimestampFrom=null,f.messageTimestampTo=null,f.order=gd.SCORE,f.advancedQuery=!1,f.targetFields=null,f._nextToken="",f.totalCount=-1,f.keyword=r.keyword,f.reverse=(i=r.reverse)!==null&&i!==void 0&&i,f.exactMatch=(a=r.exactMatch)!==null&&a!==void 0&&a,f.channelUrl=(s=r.channelUrl)!==null&&s!==void 0?s:null,f.channelCustomType=(o=r.channelCustomType)!==null&&o!==void 0?o:null,f.messageTimestampFrom=(l=r.messageTimestampFrom)!==null&&l!==void 0?l:null,f.messageTimestampTo=(u=r.messageTimestampTo)!==null&&u!==void 0?u:null,f.order=(c=r.order)!==null&&c!==void 0?c:gd.SCORE,f.advancedQuery=(d=r.advancedQuery)!==null&&d!==void 0&&d,f.targetFields=(h=r.targetFields)!==null&&h!==void 0?h:null,f}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("string",this.keyword)&&this.keyword.length>0&&x("boolean",this.reverse)&&x("boolean",this.exactMatch)&&x("string",this.channelUrl,!0)&&x("string",this.channelCustomType,!0)&&x("number",this.messageTimestampFrom,!0)&&x("number",this.messageTimestampTo,!0)&&be(gd,this.order)&&x("boolean",this.advancedQuery)&&Te("string",this.targetFields,!0)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new f4(ae(N(N({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=c.sent(),a=i.as(p4),s=a.messages,o=a.hasNext,l=a.nextToken,u=a.totalCount,this._nextToken=l,this._hasNext=o,this._isLoading=!1,this.totalCount=u,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),_4=function(e){function n(t){var r=t.channelType,i=t.channelUrl,a=t.limit,s=t.token,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Re(r),"/").concat(encodeURIComponent(i),"/messages/parent_thread_message"),o.params=W(ae({limit:a,token:s})),o}return T(n,e),n}(H),g4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.token=r.next,i.messages=r.messages.map(function(a){return Zn(t,a)}),i}return T(n,e),n}(j),v4=function(e){function n(t,r,i,a){var s=e.call(this,t,r,i,a)||this;return s._edge="",s}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)},n.prototype.load=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new _4({channelType:this.channelType,channelUrl:this.channelUrl,token:this._edge,limit:this.limit}),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(g4),s=a.messages,o=a.token,this._edge=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),y4={channelUrl:"",scheduledMessageId:0},b4={reverse:!1,limit:20},E4=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.name="message",t}return T(n,e),n.prototype.init=function(t,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,o=r.requestQueue,l=r.logger,u=r.onlineDetector,c=r.cacheContext;e.prototype.init.call(this,t,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:o,logger:l,onlineDetector:u,cacheContext:c}),this._manager=new un(t,{sdkState:i,dispatcher:a,requestQueue:o,onlineDetector:u,cacheContext:c})},n.prototype.buildMessageFromSerializedData=function(t){return this._manager.buildMessageFromSerializedData(t)},n.prototype.buildSenderFromSerializedData=function(t){return this._manager.buildSenderFromSerializedData(t)},n.prototype.getMessage=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return r=N(N({},h4),t),B(function(s){return x("string",s.channelUrl)&&be(Pe,s.channelType)&&x("number",s.messageId)&&x("boolean",s.includeReactions,!0)&&x("boolean",s.includeMetaArray,!0)&&x("boolean",s.includeParentMessageInfo,!0)&&x("boolean",s.includeThreadInfo,!0)}(r)).throw(k.invalidParameters),[4,this._manager.getMessage(r)];case 1:if((i=a.sent())instanceof Vn||i instanceof ll||i===null)return[2,i];throw"Unknown message type is given."}})})},n.prototype.getScheduledMessage=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},y4),t),B(function(a){return x("string",a.channelUrl)&&a.channelUrl!==""&&x("number",a.scheduledMessageId)&&a.scheduledMessageId>0}(r)).throw(k.invalidParameters),[2,this._manager.getScheduledMessage(r)]})})},n.prototype.getMessageTemplatesByToken=function(t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i;return _(this,function(a){return i=N(N({},b4),r),B(x("string",t,!0)&&function(s){return x("boolean",s.reverse,!0)&&x("number",s.limit,!0)&&Te("string",s.keys,!0)}(i)).throw(k.invalidParameters),[2,this._manager.getMessageTemplatesByToken(t,i)]})})},n.prototype.getMessageTemplate=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(x("string",t)).throw(k.invalidParameters),[2,this._manager.getMessageTemplate(t)]})})},n}(xm),C4=function(e,n){this.pollId=0,this.messageId=0,this.pollId=n.poll.id,this.messageId=n.poll.message_id,this._iid=e,this._payload=n},S4=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.name="poll",t}return T(n,e),n.prototype.init=function(t,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,o=r.requestQueue,l=r.logger,u=r.onlineDetector,c=r.cacheContext;e.prototype.init.call(this,t,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:o,logger:l,onlineDetector:u,cacheContext:c}),this._manager=new Pp(t,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:o,logger:l,onlineDetector:u,cacheContext:c})},n.prototype.create=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},Rk),t),B(qA(r)).throw(k.invalidParameters),[2,this._manager.create(r)]})})},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},Lk),t),B(GA(r)).throw(k.invalidParameters),[2,this._manager.get(r)]})})},n.prototype.getOption=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},Uk),t),B(BA(r)).throw(k.invalidParameters),[2,this._manager.getOption(r)]})})},n.prototype.buildPollFromSerializedData=function(t){return this._manager.buildPollFromSerializedData(t)},n}(xm),Dt,vd,a0;(function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"})(Dt||(Dt={})),function(e){e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(vd||(vd={})),function(e){e.CREATED_AT="created_at",e.SCHEDULED_AT="scheduled_at"}(a0||(a0={}));var Vd,zf=function(e){switch(e){case Dt.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case Dt.CHRONOLOGICAL:return["-createdAt","syncIndex"];case Dt.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},vN=function(e){function n(t){var r=t.message,i=e.call(this)||this;return i.message=r,i}return T(n,e),n}(st),dC={},Fc=function(){function e(n,t){var r=t.localCacheEnabled,i=t.enableAutoResend,a=t.dispatcher,s=t.sdkState,o=t.logger,l=this;this._iid=n,dC[n]=this,this._localCacheEnabled=r,this._enableAutoResend=i,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=a,this._logger=o,this._sdkState=s,this._localCacheEnabled&&a.on(function(u){if(u instanceof Zr)switch(u.stateType){case He.CONNECTED:l._isProcessingAutoResend||l.processAutoResendRegisteredPendingMessages().then(function(){return l._processNextAutoResend()});break;case He.INTERNAL_DISCONNECTED:case He.EXTERNAL_DISCONNECTED:l._isProcessingAutoResend=!1}})}return e.of=function(n){return dC[n]},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return g(this,void 0,void 0,function(){var n=this;return _(this,function(t){switch(t.label){case 0:return this._enableAutoResend?[4,Ct(function(){return g(n,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:r=u.sent();try{for(i=K(r),a=i.next();!a.done;a=i.next())(s=a.value).errorCode===0&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",s.reqId),s.sendingStatus=rt.FAILED,s.errorCode=re.ACK_TIMEOUT,this._dispatcher.dispatch(new _t({messages:[s],source:P.LOCAL_MESSAGE_FAILED})))}catch(c){o={error:c}}finally{try{a&&!a.done&&(l=i.return)&&l.call(i)}finally{if(o)throw o.error}}return[2]}})})})]:[2];case 1:return t.sent(),[2]}})})},e.prototype.processAutoResendRegisteredPendingMessages=function(){return g(this,void 0,void 0,function(){var n=this;return _(this,function(t){switch(t.label){case 0:return[4,Ct(function(){return g(n,void 0,void 0,function(){var r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:r=d.sent();try{for(i=K(r),a=i.next();!a.done;a=i.next())s=a.value,this._enableAutoResend&&s.errorCode&&Ap(s.errorCode)&&(o=new Date().getTime(),l=s.createdAt+2592e5,this._enableAutoResend&&o<=l?this._autoResendQueue.map(function(h){return h.reqId}).indexOf(s.reqId)<0&&this._autoResendQueue.push(s):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(l).toLocaleString()),s.sendingStatus=rt.FAILED,this._dispatcher.dispatch(new _t({messages:[s],source:P.LOCAL_MESSAGE_FAILED}))))}catch(h){u={error:h}}finally{try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}}return[2]}})})})];case 1:return t.sent(),[2]}})})},e.prototype.completeCurrentAndProcessNextAutoResend=function(n){if(this._localCacheEnabled&&this._enableAutoResend&&(n.sendingStatus===rt.SUCCEEDED||n.sendingStatus===rt.FAILED&&!Ap(n.errorCode))){var t=this.indexOf(n);t>=0&&this._autoResendQueue.splice(t,1),t===0&&this._processNextAutoResend()}},e.prototype._fetchAllCachedPendingMessages=function(){return g(this,void 0,void 0,function(){var n,t;return _(this,function(r){switch(r.label){case 0:return n=cl.of(this._iid),(t=new Wa).replyType=Fn.ALL,[4,n.fetch({sendingStatus:rt.PENDING,backward:!0,filter:t})];case 1:return[2,r.sent()]}})})},e.prototype.indexOf=function(n){return this._autoResendQueue.length>0?this._autoResendQueue.map(function(t){return t.reqId}).indexOf(n.reqId):-1},e.prototype._processNextAutoResend=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){if(this._localCacheEnabled&&this._enableAutoResend&&this._sdkState.appState==="foreground")try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),n=this._autoResendQueue[0],this._dispatcher.dispatch(new vN({message:n})),this._logger.debug("processing auto-resend for message request id: ",n.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(r){this._logger.warn("process auto-resend error: ",r),this._isProcessingAutoResend=!1}return[2]})})},e}();(function(e){e[e.USER_BLOCK=20001]="USER_BLOCK",e[e.USER_UNBLOCK=2e4]="USER_UNBLOCK",e[e.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"})(Vd||(Vd={}));var Ia,qp=function(){function e(n){this.category=n.cat,this.data=n.data}return e.getDataAsUserBlockEvent=function(n,t){var r=t.data,i=r.blocker,a=r.blockee;return{blocker:new xe(n,i),blockee:new xe(n,a)}},e.getDataAsFriendDiscoveredEvent=function(n,t){var r=t.data.friend_discoveries;return{friendDiscoveries:Array.isArray(r)?r.map(function(i){return new xe(n,i)}):[]}},e}(),yN=function(e){function n(t,r){var i=r.userId,a=e.call(this)||this;return a._iid=t,a.userId=i,a}return T(n,e),n}(st),bN=function(e){function n(){return e.call(this)||this}return T(n,e),n}(st),EN=function(e){function n(t){var r=t.configTs,i=e.call(this)||this;return i.configTs=r,i}return T(n,e),n}(st),CN=function(e){function n(t,r,i){var a=e.call(this,t,"USEV",i)||this;return a.event=new qp(i),a}return T(n,e),n}(pt),SN=function(e){function n(t){var r=t.appConfigsInfo,i=t.configTs,a=e.call(this)||this;return a.appConfigsInfo={},a.configTs=0,a.appConfigsInfo=r,a.configTs=i,a}return T(n,e),n}(st);(function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"})(Ia||(Ia={}));var Ya=function(e){function n(t,r,i,a){var s=e.call(this)||this;return s._state=Ia.IDLE,s._retryCount=0,s._retryLimit=3,s.priority=0,s._worker=r,s}return T(n,e),Object.defineProperty(n.prototype,"isIdle",{get:function(){return this._state===Ia.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRunning",{get:function(){return this._state===Ia.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isDone",{get:function(){return this._state===Ia.END},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),n.prototype._run=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:if(!this.isRunning)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._worker(t)];case 2:return r=a.sent(),this._retryCount=0,this.dispatch("progress",r),r.hasNext?this._run(r.nextToken):this.end(),[3,4];case 3:return i=a.sent(),this.dispatch("error",i),this._retryCount<this._retryLimit?(this._retryCount++,this._run(t)):this.stop(),[3,4];case 4:return[2]}})})},n.prototype.start=function(t){this.isIdle&&(this._state=Ia.RUNNING,this._run(t))},n.prototype.stop=function(){this._state=Ia.IDLE,this.dispatch("stop")},n.prototype.end=function(){this._state=Ia.END,this.dispatch("end")},n}(Sl),T4=function(e){return["-lastMessageUpdatedAt","-createdAt","syncIndex"]},hC=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return T(n,e),n}(st),TN=function(e){this.key=e.key,this.url=e.url},wN=function(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map(function(n){return new TN(n)}):[]},w4=function(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map(function(n){return new wN(n)}):[]},A4={profileImage:void 0,profileUrl:void 0,nickname:void 0},fC=function(e){return{v2:function(){return g(void 0,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,e.commitSchema([{collectionName:cN,keyName:_U,index:[zf(Dt.LATEST_LAST_MESSAGE),zf(Dt.CHRONOLOGICAL),zf(Dt.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:Fy,keyName:gU,index:[ra(bn.CHANNEL_LATEST),ra(bn.NEWEST_CHILD_MESSAGE)]},{collectionName:mN,keyName:s4,index:[ra(bn.CHANNEL_LATEST),ra(bn.NEWEST_CHILD_MESSAGE)]},{collectionName:yU,keyName:bU}])];case 1:return[2,n.sent()]}})})},v3:function(){return g(void 0,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,e.commitSchema([{collectionName:EU,keyName:CU,index:[T4()]}])];case 1:return[2,n.sent()]}})})},v4:function(){return g(void 0,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,e.commitSchema([{collectionName:hN,keyName:vU,index:[t4()]}])];case 1:return[2,n.sent()]}})})},v5:function(){return g(void 0,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,e.commitSchema([{collectionName:fN,keyName:SU,index:[["-userId","-updatedAt"]]}])];case 1:return[2,n.sent()]}})})}}},pC=function(e){var n=new pN;return function(t,r){return g(void 0,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:switch(t){case 1:case 2:case 3:case 4:return[3,1];case 5:return[3,2];case 6:return[3,4];case 7:return[3,11]}return[3,15];case 1:return r(),[3,16];case 2:return[4,e.reset()];case 3:return l.sent(),r(),[3,16];case 4:return l.trys.push([4,9,,10]),i=fC(e),a=i.v2,s=i.v3,o=i.v4,[4,a()];case 5:return l.sent(),[4,s()];case 6:return l.sent(),[4,o()];case 7:return l.sent(),[4,e.collection(Fy).removeIf({where:{channelType:Pe.OPEN}})];case 8:return l.sent(),[3,10];case 9:return l.sent(),n.warn("Failed to migrate to v2, v3, v4"),[3,10];case 10:return r(),[3,16];case 11:return l.trys.push([11,13,,14]),[4,(0,fC(e).v5)()];case 12:return l.sent(),[3,14];case 13:return l.sent(),n.warn("Failed to migrate to v5"),[3,14];case 14:return r(),[3,16];case 15:r(),l.label=16;case 16:return[2]}})})}},N4=function(){return typeof document<"u"?document.visibilityState:"visible"},I4=function(e){function n(t){var r=t.getVisibilityState,i=r===void 0?N4:r,a=t.initialState,s=a===void 0?"visible":a,o=t.isEnabled,l=o===void 0||o,u=t.pauseCheckDelay,c=u===void 0?3e4:u,d=e.call(this)||this;return d._pauseCheckDelay=3e4,d._currentState="visible",d._getVisibilityState=i,d._pauseCheckDelay=c,d._currentState=s,d._isEnabled=l,d._boundToggleState=d._toggleState.bind(d),d}return T(n,e),Object.defineProperty(n.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isAvailable",{get:function(){return typeof window<"u"&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),n.prototype._toggleState=function(){var t=this,r=this._getVisibilityState();r!=="hidden"?this._currentState==="hidden"&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):this._currentState!=="hidden"&&(this._pauseDelayTimer=setTimeout(function(){t._pauseDelayTimer=void 0,t.dispatch("pause")},this._pauseCheckDelay)),this._currentState=r},n.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},n.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},n}(Sl),M4=function(){function e(n){var t=n.logger,r=n.connectionDelegate,i=r===void 0?null:r,a=this;this._onlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.reconnect()},this._offlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.disconnect()},this.unsubscribes=[],this._onlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("online",s),function(){return window.removeEventListener("online",s,!1)}},this._offlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("offline",s),function(){return window.removeEventListener("offline",s,!1)}},this.logger=t,i&&(this.connectionDelegate=i)}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return typeof window<"u"&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&typeof navigator<"u"&&navigator.onLine!==void 0},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(n){n&&typeof n=="function"&&(this._onlineListener=n)},e.prototype.setOfflineListener=function(n){n&&typeof n=="function"&&(this._offlineListener=n)},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},e.prototype.stop=function(){var n=this;this.unsubscribes.forEach(function(t){try{t?.()}catch(r){n.logger.warn(r.message)}}),this.unsubscribes=[]},e.prototype.isOnline=function(){return g(this,void 0,void 0,function(){return _(this,function(n){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise(function(t){fetch("https://www.google.com",{method:z.GET,mode:"no-cors"}).then(function(){return t(!0)}).catch(function(){return t(!1)})})]})})},e}(),x4=function(e){function n(t){var r,i=this;return(i=e.call(this)||this).method=z.GET,i.path=$O,i.params=W(ae({ts:typeof t.token=="number"?t.token:void 0,token:typeof t.token=="string"?t.token:void 0,limit:(r=t.limit)!==null&&r!==void 0?r:100})),i}return T(n,e),n}(H),O4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.configs=r.configs,i.hasMore=r.has_more,i.nextToken=r.next,i.ts=r.ts,i}return T(n,e),n}(j),mC=function(e){function n(t){var r=t.userId,i=t.nickname,a=t.profileUrl,s=t.profileImage,o=t.preferredLanguages,l=e.call(this)||this;return l.method=z.PUT,l.path="".concat(Fe,"/").concat(encodeURIComponent(r)),l.params=W(ae({nickname:i,profile_url:a,profile_file:s,preferred_languages:o})),l}return T(n,e),n}(H),_C=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.user=new xe(t,N({},r)),i}return T(n,e),n}(j),D4=function(e){function n(t){var r=t.userId,i=t.token,a=t.deviceOS,s=t.deviceManufacturer,o=t.systemPushEnabled,l=e.call(this)||this;return l.method=z.POST,l.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/apns"),l.params=W({apns_device_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:o}),l}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.token=r.token,i.type=r.type?ln[r.type.toLowerCase()]:ln.UNKNOWN,i.user=new xe(t,r.user),i}T(n,e)})(j);var k4=function(e){function n(t){var r=t.userId,i=t.token,a=t.deviceOS,s=t.deviceManufacturer,o=t.systemPushEnabled,l=e.call(this)||this;return l.method=z.POST,l.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/gcm"),l.params=W({gcm_reg_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:o}),l}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.token=r.token,i.type=r.type?ln[r.type.toLowerCase()]:ln.UNKNOWN,i.user=new xe(t,r.user),i}T(n,e)})(j);var R4=function(e){function n(t){var r=t.userId,i=t.token,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/apns/").concat(encodeURIComponent(i)),a}return T(n,e),n}(H),U4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.token=r.token,i.user=new xe(t,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}return T(n,e),n}(j),L4=function(e){function n(t){var r=t.userId,i=t.token,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/gcm/").concat(encodeURIComponent(i)),a}return T(n,e),n}(H),P4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.token=r.token,i.user=new xe(t,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}return T(n,e),n}(j),F4=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.DELETE,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/apns"),i}return T(n,e),n}(H),$4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.type=r.type?ln[r.type.toLowerCase()]:ln.UNKNOWN,i.user=new xe(t,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}return T(n,e),n}(j),z4=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.DELETE,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/gcm"),i}return T(n,e),n}(H),H4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.type=r.type?ln[r.type.toLowerCase()]:ln.UNKNOWN,i.user=new xe(t,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}return T(n,e),n}(j),q4=function(e){function n(t){var r=t.userId,i=t.type,a=t.token,s=t.ts,o=e.call(this)||this;return o.method=z.GET,o.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/").concat(encodeURIComponent(i),"/device_tokens"),o.params={created_ts:s,token:a},o}return T(n,e),n}(H),B4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pushTokens={type:r.type?ln[r.type.toLowerCase()]:ln.UNKNOWN,deviceTokens:r.device_tokens,hasMore:r.has_more,token:r.token},i}return T(n,e),n}(j),G4=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),i}return T(n,e),n}(H),V4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.autoAccept=r.auto_accept,i}return T(n,e),n}(j),j4=function(e){function n(t){var r=t.userId,i=t.willAutoAccept,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),a.params={auto_accept:i},a}return T(n,e),n}(H),Q4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.autoAccept=r.auto_accept,i}return T(n,e),n}(j),K4=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),i}return T(n,e),n}(H),W4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return T(n,e),n}(j),Y4=function(e){function n(t){var r=t.userId,i=t.doNotDisturbOn,a=t.startHour,s=t.startMin,o=t.endHour,l=t.endMin,u=t.timezone,c=e.call(this)||this;return c.method=z.PUT,c.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),c.params={do_not_disturb:i,start_hour:a,start_min:s,end_hour:o,end_min:l,timezone:u},c}return T(n,e),n}(H),Z4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return T(n,e),n}(j),X4=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),i}return T(n,e),n}(H),J4=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return T(n,e),n}(j),eL=function(e){function n(t){var r=t.userId,i=t.snoozeOn,a=t.startTs,s=t.endTs,o=e.call(this)||this;return o.method=z.PUT,o.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),o.params={snooze_enabled:i,snooze_start_ts:a,snooze_end_ts:s},o}return T(n,e),n}(H),tL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return T(n,e),n}(j),nL=function(e){function n(t){var r=t.userId,i=t.blockedUserId,a=e.call(this)||this;return a.method=z.POST,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/block"),a.params={target_id:i},a}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.user=new xe(t,r),i}T(n,e)})(j);var rL=function(e){function n(t){var r=t.userId,i=t.unblockedUserId,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/block/").concat(encodeURIComponent(i)),a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var iL=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),i}return T(n,e),n}(H),aL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return T(n,e),n}(j),sL=function(e){function n(t){var r=t.userId,i=t.pushTriggerOption,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference"),a.params={push_trigger_option:i},a}return T(n,e),n}(H),oL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return T(n,e),n}(j),lL=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/template"),i}return T(n,e),n}(H),uL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.name=r.name,i}return T(n,e),n}(j),cL=function(e){function n(t){var r=t.userId,i=t.templateName,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push/template"),a.params={name:i},a}return T(n,e),n}(H),dL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.name=r.name,i}return T(n,e),n}(j),hL=function(e){function n(t){var r=t.userId,i=t.token,a=e.call(this)||this;return a.method=z.GET,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friends/changelogs"),a.params={token:i},a}return T(n,e),n}(H),fL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.changelogs={addedUsers:r.added.map(function(a){return new xe(t,a)}),updatedUsers:r.updated.map(function(a){return new xe(t,a)}),deletedUserIds:r.deleted,hasMore:r.has_more,token:r.next},i}return T(n,e),n}(j),pL=function(e){function n(t){var r=t.userId,i=t.discoveries,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discoveries:i.map(function(s){return{friend_discovery_key:s.friendDiscoveryKey,friend_name:s.friendName}})},a}return T(n,e),n}(H),mL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.friendDiscoveryRequestId=r.friend_discovery_request_id,i}return T(n,e),n}(j),_L=function(e){function n(t){var r=t.userId,i=t.discoveryKeys,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discovery_keys:i},a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var gL=function(e){function n(t){var r=t.userId,i=t.userIds,a=e.call(this)||this;return a.method=z.POST,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return T(n,e),n}(H),vL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.users=r.users.map(function(a){return new xe(t,a)}),i}return T(n,e),n}(j),yL=function(e){function n(t){var r=t.userId,i=t.userIds,a=e.call(this)||this;return a.method=z.DELETE,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var bL=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(r,"/allow_friend_discovery"),i.params={},i}return T(n,e),n}(H),EL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.allowFriendDiscovery=r.allow_friend_discovery,i}return T(n,e),n}(j),CL=function(e){function n(t){var r=t.userId,i=t.allowFriendDiscovery,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(r,"/allow_friend_discovery"),a.params={allow_friend_discovery:i},a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var Bp,SL=function(e){function n(){var t=e.call(this)||this;return t.method=z.GET,t.path=Z2,t}return T(n,e),n}(H),TL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.emojiContainer=new w4(r),i}return T(n,e),n}(j),wL=function(e){function n(t){var r=t.categoryId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Z2,"/").concat(r),i}return T(n,e),n}(H),AL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.emojiCategory=new wN(r),i}return T(n,e),n}(j),NL=function(e){function n(t){var r=t.key,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(DO,"/").concat(r),i}return T(n,e),n}(H),IL=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.emoji=new TN(r),i}return T(n,e),n}(j),ML=function(e){function n(){var t=e.call(this)||this;return t.method=z.GET,t.path="".concat(kO),t}return T(n,e),n}(H),xL=function(e){function n(t,r){var i,a=this,s=r??{};return(a=e.call(this,t,r)||this).uikitConfiguration={string:JSON.stringify(s),json:s},a.updatedAt=(i=r?.updated_at)!==null&&i!==void 0?i:0,a}return T(n,e),n}(j);(function(e){e.DELIVERED="DELIVERED",e.CLICKED="CLICKED"})(Bp||(Bp={}));var gc,gC=function(e){function n(t){var r=t.deviceToken,i=t.pushTrackingId,a=t.messageId,s=t.allowedPushNotification,o=t.channelKey,l=t.templateKey,u=t.eventType,c=t.notificationEventDeadline,d=e.call(this)||this;return d.method=z.POST,d.path=LO,d.params=W({device_token:r,push_tracking_id:i,message_id:a,allowed_push_notification:s,channel_key:o,template_key:l,event_type:u,notification_event_deadline:c}),d}return T(n,e),n}(H),OL=function(){function e(n,t,r){var i=this;this._storeInitialized=!1,this._iid=n,this.options=t;var a=I.of(n),s=a.sdkState,o=a.cacheContext,l=a.dispatcher,u=a.sessionManager,c=a.requestQueue,d=a.logger,h=a.userEventHandlers,f=a.appStateToggleEnabled;this._onlineDetector=new M4({logger:d,connectionDelegate:{reconnect:function(){return g(i,void 0,void 0,function(){var y,C,b,v,E,S;return _(this,function(w){switch(w.label){case 0:if(y=I.of(n),C=y.sdkState,b=y.connectionManager,(v=y.sessionManager).session.hasSession)return[3,5];w.label=1;case 1:return w.trys.push([1,3,,4]),[4,b.connect(v.session.authToken)];case 2:return w.sent(),[3,4];case 3:if(E=w.sent(),fr(E))throw E;return d.debug("connect failed by reconnect event = ",E),[3,4];case 4:return[3,9];case 5:if(C.appState!=="foreground")return[3,9];w.label=6;case 6:return w.trys.push([6,8,,9]),[4,b.resetAndReconnect()];case 7:return w.sent(),[3,9];case 8:if(S=w.sent(),fr(S))throw S;return d.debug("resetAndReconnect failed by reconnect event = ",S),[3,9];case 9:return l.dispatch(new hC),[2]}})})},disconnect:function(){Ct(function(){return g(i,void 0,void 0,function(){var y,C,b;return _(this,function(v){switch(v.label){case 0:return y=I.of(n),C=y.connectionManager,b=y.dispatcher,[4,C.disconnect()];case 1:return v.sent(),b.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:re.NETWORK_ERROR,error_description:"cause=network_closed"}}))),[2]}})})})}}});var m=new Fc(n,{localCacheEnabled:o.localCacheEnabled,enableAutoResend:o.localCacheConfig.enableAutoResend,dispatcher:l,sdkState:s,logger:d});r.forEach(function(y){y.init(n,{sdkState:s,cacheContext:o,dispatcher:l,sessionManager:u,requestQueue:c,logger:d,onlineDetector:i._onlineDetector}),i[y.name]=y}),this._appStateChangeDetector=new I4({isEnabled:f}),this._appStateChangeDetector.on("resume",function(){d.debug("the page resumes from freeze"),i.setForegroundState()}).on("pause",function(){d.debug("the page freezes"),i.setBackgroundState()}),l.on(function(y){var C;if(y instanceof Zr)y.stateType===He.CONNECTED&&m.processNonAutoResendRegisteredPendingMessages();else if(y instanceof pt){if(y.code==="USEV"){var b=y.as(CN).event;if(b.category===Vd.FRIEND_DISCOVERED){var v=qp.getDataAsFriendDiscoveredEvent(n,b).friendDiscoveries;he(function(){return g(i,void 0,void 0,function(){return _(this,function(A){return[2,h.forEach(function(D){D.onFriendsDiscovered&&D.onFriendsDiscovered(v)})]})})})}}}else if(y instanceof Ny){var E=I.of(i._iid).subscribedUnreadMessageCount,S=!1,w=y.ts;typeof w=="number"&&w>E.ts&&(E.all!==y.all&&(S=!0),E.all=y.all>=0?y.all:0,y.customTypes&&Object.keys(y.customTypes).forEach(function(A){E.customTypes[A]!==y.customTypes[A]&&(S=!0),E.customTypes[A]=y.customTypes[A]}),S=S&&E.ts>0,E.ts=w),S&&he(function(){return g(i,void 0,void 0,function(){return _(this,function(A){return[2,h.forEach(function(D){D.onTotalUnreadMessageCountChanged&&D.onTotalUnreadMessageCountChanged({groupChannelCount:E.all,feedChannelCount:E.feed,customTypeUnreadCount:E.customTypes}),D.onTotalUnreadMessageCountUpdated&&D.onTotalUnreadMessageCountUpdated(E.all,E.customTypes)})]})})})}else y instanceof AA?(o.preference.set(i._getUserProfileCacheKey(s.userId),jv.payloadify(y.userProfile)),!((C=y.userProfile.appInfo.notificationInfo)===null||C===void 0)&&C.isEnabled&&o.preference.set(Iy(i.appId),{value:!0})):y instanceof IA?y.configSyncNeeded&&Ct(function(){return g(i,void 0,void 0,function(){return _(this,function(A){switch(A.label){case 0:return[4,this._getAppConfigsInfo()];case 1:return A.sent(),[2]}})})}):y instanceof EN?o.preference.set(kp(i.appId),{configTs:y.configTs}):y instanceof Mu&&y.error&&y.error.isSessionInvalidatedError&&(d.debug("session revoked."),i._internalDisconnect(y.error))})}return e.init=function(n){var t=n.appId,r=n.appVersion,i=n.modules,a=i===void 0?[]:i,s=n.options,o=s===void 0?new K2:s,l=n.debugMode,u=l!==void 0&&l,c=n.customApiHost,d=n.customWebSocketHost,h=n.newInstance,f=h!==void 0&&h,m=n.logLevel,y=n.localCacheEnabled,C=y!==void 0&&y,b=n.localCacheConfig,v=b===void 0?new Y2:b,E=n.localCacheEncryption,S=n.useAsyncStorageStore,w=S===void 0?null:S,A=n.useMMKVStorageStore,D=A===void 0?null:A,O=n.appStateToggleEnabled,M=O===void 0||O;if(!gc||f){var F="su-".concat(Wr()),U=E??{encrypt:function(Q){return Q},decrypt:function(Q){return Q}},$=new pN;$.level=m??Pi.WARN;var J=new Oo({encryption:U});u||(Hv()?D?J=new JU({MMKV:D,encryption:U}):w&&(J=new XU({AsyncStorage:w,encryption:U}),$.warn("AsyncStorage store is deprecated due to the small size limit. Please use MMKVStorage store instead.")):J=new ZU({encryption:U})),new I(F,{appId:t,appVersion:r,options:o,apiHost:c??"https://api-".concat(t,".sendbird.com"),websocketHost:d??"wss://ws-".concat(t,".sendbird.com"),store:J,encryption:U,logger:$,localCacheEnabled:C,localCacheConfig:v,debugMode:u,appStateToggleEnabled:M});var ee=[new E4,new S4],ve=new e(F,o,ce(ce([],ne(a),!1),ne(ee),!1));return gc||(gc=ve),ve}return gc},Object.defineProperty(e,"instance",{get:function(){return gc},enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return j2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return I.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var n=I.of(this._iid).appInfo;return n??null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var n;return(n=I.of(this._iid).sdkState.appVersion)!==null&&n!==void 0?n:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return!!I.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return I.of(this._iid).logger.level},set:function(n){I.of(this._iid).logger.level=n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return I.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var n=I.of(this._iid).cacheContext;return n.localCacheEnabled?n.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return I.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var n;return(n=I.of(this._iid).sessionManager.currentUser)!==null&&n!==void 0?n:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var n=I.of(this._iid).connectionManager;return n.isConnected?li.OPEN:n.isConnecting?li.CONNECTING:li.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var n=I.of(this._iid),t=n.connectedAt;return n.connectionManager.isConnected?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){var n;return(n=this._fcmPushToken)!==null&&n!==void 0?n:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:function(){var n;return(n=this._apnsPushToken)!==null&&n!==void 0?n:null},enumerable:!1,configurable:!0}),e.prototype._getNestDBVersion=function(){return 8},e.prototype._getPreferenceVersion=function(){return 9},e.prototype._getPreferenceCacheKey=function(n){return"sendbird@".concat(this.appId,"/").concat(n,".pref")},e.prototype._getUserProfileCacheKey=function(n){return"sendbird@".concat(this.appId,"/").concat(n,".profile")},e.prototype._internalDisconnect=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid),r=t.connectionManager,i=t.sdkState,a=t.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),a.cancelAll(),[4,r.logout(n)];case 1:return s.sent(),[4,this.clearCachedData()];case 2:return s.sent(),i.appState="foreground",[2]}})})},e.prototype._getAppConfigsInfo=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:return n=I.of(this._iid),t=n.requestQueue,r=n.dispatcher,i=n.cacheContext,a=n.sdkState,s={},[4,i.preference.get(kp(a.appId))];case 1:return(l=c.sent())&&(o=l.configTs),new Ya("appConfigsInfo",function(d){return g(u,void 0,void 0,function(){var h,f,m,y,C,b,v,E;return _(this,function(S){switch(S.label){case 0:return h={hasNext:!0,nextToken:d},f=new x4({token:d}),[4,t.send(f)];case 1:return m=S.sent(),y=m.as(O4),C=y.configs,b=y.hasMore,v=y.nextToken,E=y.ts,Object.keys(C).forEach(function(w){s[w]=C[w]}),h.hasNext=b,h.nextToken=v,b||r.dispatch(new SN({appConfigsInfo:s,configTs:E})),[2,h]}})})}).start(o),[2]}})})},e.prototype.getMemoryStoreForDebugging=function(){var n=I.of(this._iid),t=n.debugMode,r=n.cacheContext;if(t)return r.store instanceof Oo?r.store:null;throw k.debugModeRequired},e.prototype.addExtension=function(n,t){var r=I.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(n)>-1&&r.extensions&&(r.extensions[n]=t)},e.prototype.addSendbirdExtensions=function(n,t,r){var i,a,s=I.of(this._iid),o=s.logger,l=s.sdkState,u=new RegExp(GO);if(n.length===0)return o.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(n.find(function(y){return!u.test(y.version)}))return o.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(r)try{for(var c=K(Object.entries(r)),d=c.next();!d.done;d=c.next()){var h=ne(d.value,2),f=h[0],m=h[1];if(/&|=/.test(f)||/&|=/.test(m))return o.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(y){i={error:y}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}return l.sendbirdRuntimeEnvironment={sendbirdExtensions:n,deviceOS:t,customData:r},!0},e.prototype.setOnlineListener=function(n){this._onlineDetector.setOnlineListener(n)},e.prototype.setOfflineListener=function(n){this._onlineDetector.setOfflineListener(n)},e.prototype._safeInitializeStore=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:t=I.of(this._iid).cacheContext,r.label=1;case 1:return r.trys.push([1,3,,5]),[4,t.store.init(n)];case 2:return r.sent(),this._storeInitialized=!0,[3,5];case 3:return r.sent(),t.replaceStore(new Oo),[4,this._safeInitializeStore(n)];case 4:return r.sent(),[3,5];case 5:return[2]}})})},e.prototype.initializeCache=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:if(t=I.of(this._iid),r=t.sdkState,i=t.cacheContext,a=t.dispatcher,s=t.logger,r.userId&&r.userId===n)return[3,13];o="sendbird@".concat(r.appId,"/").concat(n,".db"),d.label=1;case 1:return d.trys.push([1,9,11,13]),i.localCacheEnabled?i.nestdb&&i.nestdb.state!==Zi.CLOSED&&i.nestdb.name===o?[3,3]:(l="sendbird@".concat(r.appId,"/").concat(n,".db"),(u=i.nestdb=new e4({name:l,version:this._getNestDBVersion(),store:i.store,config:new fh({dbname:l,cacheLimit:64,itemSizeLimit:61440})})).on("upgrade",pC(u)),u.on("storeReplaced",function(h){i.replaceStore(h),i.localCacheEnabled=!1,u.on("upgrade",pC(u))}),[4,u.open()]):[3,6];case 2:return d.sent(),this._storeInitialized=!0,a.dispatch(new yN(this._iid,{userId:n})),[3,5];case 3:return[4,this._safeInitializeStore(o)];case 4:d.sent(),d.label=5;case 5:return r.userId=n,[3,8];case 6:return[4,this._safeInitializeStore(o)];case 7:d.sent(),r.userId=n,d.label=8;case 8:return[3,13];case 9:return c=d.sent(),s.warn("Nest DB Open Failed. ",c),i.store instanceof Oo||(i.replaceStore(new Oo),i.localCacheEnabled=!1),[4,this._safeInitializeStore(o)];case 10:throw d.sent(),r.userId=n,k.databaseError;case 11:return[4,this._setupPreference(n)];case 12:return d.sent(),[7];case 13:return[2]}})})},e.prototype.getCacheDataSize=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return(n=I.of(this._iid).cacheContext).localCacheEnabled&&n.nestdb?[4,n.nestdb.estimateUsage()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,0]}})})},e.prototype.clearCachedData=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return(n=I.of(this._iid).cacheContext).localCacheEnabled&&n.nestdb?[4,n.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._storeInitialized?[4,n.preference.clear()]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}})})},e.prototype.clearCachedMessages=function(n){return g(this,void 0,void 0,function(){var t,r,i=this;return _(this,function(a){switch(a.label){case 0:return B(Te("string",n)).throw(k.invalidParameters),t=Ho.of(this._iid),r=cl.of(this._iid),t&&r?[4,Promise.all(n.map(function(s){return g(i,void 0,void 0,function(){return _(this,function(o){switch(o.label){case 0:return[4,t.removeMessagesOfChannel(s)];case 1:return o.sent(),[4,r.removeMessagesOfChannel(s)];case 2:return o.sent(),[2]}})})}))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype._setupPreference=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.cacheContext,a=t.statManager,[4,i.preference.init(this._getPreferenceCacheKey(n),this._getPreferenceVersion())];case 1:return o.sent(),[4,i.preference.get(this._getUserProfileCacheKey(n))];case 2:return(s=o.sent())&&new jv(this._iid,s).apply(),[4,a.init("sendbird@".concat(r.appId,"/").concat(n,".statlog"))];case 3:return o.sent(),[2]}})})},e.prototype._ready=function(n,t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(x("string",n)&&x("string",t,!0)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.cacheContext,o=i.connectionManager,l=r.errorForOtherUser,a.userId&&a.userId!==n?l?[3,2]:[4,o.logout()]:[3,3];case 1:return c.sent(),[3,3];case 2:throw l;case 3:return c.trys.push([3,5,,6]),[4,this.initializeCache(n)];case 4:return c.sent(),I.of(this._iid).dispatcher.dispatch(new bN),[3,6];case 5:return c.sent(),u=I.of(this._iid).logger,s.localCacheEnabled=!1,u.warn("Cache initialization failed - cache is not available."),[3,6];case 6:return[2]}})})},e.prototype.authenticateFeed=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this.authenticate(n,t)];case 1:return[2,r.sent()]}})})},e.prototype.authenticate=function(n,t,r){var i;return r===void 0&&(r=wp.SESSION_TOKEN),g(this,void 0,void 0,function(){var a,s,o;return _(this,function(l){switch(l.label){case 0:return a=I.of(this._iid),s=a.sessionManager,o=a.connectionManager,[4,this._ready(n,t,{errorForOtherUser:o.isConnected?k.alreadyConnectedAsAnotherUser:void 0})];case 1:return l.sent(),!((i=s.session.services)===null||i===void 0)&&i.includes(Np.CHAT)?[3,3]:(s.handler||t&&r!==wp.ACCESS_TOKEN||this.setSessionHandler(new t0),[4,s.authenticate(n,t)]);case 2:l.sent(),l.label=3;case 3:return[2,this.currentUser]}})})},e.prototype.connect=function(n,t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._ready(n,t)];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,I.of(this._iid).connectionManager.connect(t)];case 3:return r.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}})})},e.prototype.reconnect=function(){var n=I.of(this._iid),t=n.connectionManager,r=n.sdkState,i=n.sessionManager,a=n.dispatcher,s=i.session.hasSession;return s&&(a.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:0,error_description:"cause=explicit_reconnect"}}))),this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then(function(){r.appState="foreground"}).catch(function(){})),s},e.prototype.disconnect=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this._internalDisconnect()];case 1:return n.sent(),[2]}})})},e.prototype.disconnectWebSocket=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:return n=I.of(this._iid),t=n.connectionManager,r=n.requestQueue,n.dispatcher.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:0,error_description:"cause=explicit_disconnect_websocket"}}))),this._appStateChangeDetector.stop(),this._onlineDetector.stop(),r.cancelAll(),[4,t.disconnectWebSocket(!0)];case 1:return i.sent(),[2]}})})},e.prototype.setBackgroundState=function(){var n=I.of(this._iid),t=n.connectionManager,r=n.sdkState,i=n.logger,a=n.dispatcher;r.appState==="foreground"&&(r.appState="background",i.debug("going background state"),a.dispatch(new za(new ut({type:Ze.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:re.WEBSOCKET_CONNECTION_CLOSED,error_description:"cause=background"}}))),t.background().catch(function(s){i.debug("setBackgroundState error = ",s)}))},e.prototype.setForegroundState=function(){var n=I.of(this._iid),t=n.connectionManager,r=n.sdkState,i=n.dispatcher,a=n.logger;r.appState==="background"&&(r.appState="foreground",a.debug("going foreground state"),t.resetAndReconnect().catch(function(s){a.debug("setForgroundState error = ",s)}),i.dispatch(new hC))},e.prototype.setSessionHandler=function(n){B(n instanceof t0).throw(k.invalidParameters),I.of(this._iid).sessionManager.handler=n},e.prototype.addUserEventHandler=function(n,t){B(x("string",n)&&t instanceof RU).throw(k.invalidParameters),I.of(this._iid).userEventHandlers.set(n,t)},e.prototype.removeUserEventHandler=function(n){I.of(this._iid).userEventHandlers.delete(n)},e.prototype.removeAllUserEventHandler=function(){I.of(this._iid).userEventHandlers.clear()},e.prototype.addConnectionHandler=function(n,t){B(x("string",n)&&t instanceof $y).throw(k.invalidParameters),I.of(this._iid).connectionHandlers.set(n,t)},e.prototype.removeConnectionHandler=function(n){I.of(this._iid).connectionHandlers.delete(n)},e.prototype.removeAllConnectionHandler=function(){I.of(this._iid).connectionHandlers.clear()},e.prototype.createApplicationUserListQuery=function(n){return n===void 0&&(n={}),new PU(this._iid,n)},e.prototype.createBlockedUserListQuery=function(n){return n===void 0&&(n={}),new zU(this._iid,n)},e.prototype.createFriendListQuery=function(n){return n===void 0&&(n={}),new BU(this._iid,n)},e.prototype.createMessageSearchQuery=function(n){return new m4(this._iid,n)},e.prototype.createPollListQuery=function(n){return new VA(this._iid,N({},n))},e.prototype.createPollVoterListQuery=function(n){return new jA(this._iid,N({},n))},e.prototype.buildUserFromSerializedData=function(n){var t=Gs(n);return new xe(this._iid,xe.payloadify(t))},e.prototype.updateCurrentUserInfo=function(n){return n===void 0&&(n={}),g(this,void 0,void 0,function(){var t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return t=N(N({},A4),n),B(function(c){return Kn(c.profileImage,!0)&&x("string",c.profileUrl,!0)&&x("string",c.nickname,!0)}(t)).throw(k.invalidParameters),this.currentUser?(r=I.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new mC(N({userId:i.userId},t)),[4,a.send(s)]):[3,2];case 1:return o=u.sent(),l=o.as(_C).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=l.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=l.profileUrl)),[2,l];case 2:throw k.connectionRequired}})})},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return B(Te("string",n)).throw(k.invalidParameters),this.currentUser?(t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new mC({userId:r.userId,preferredLanguages:n}),[4,i.send(a)]):[3,2];case 1:return s=l.sent(),o=s.as(_C).user,this.currentUser&&(this.currentUser.preferredLanguages=o.preferredLanguages),[2,o];case 2:throw k.connectionRequired}})})},e.prototype.registerFCMPushTokenForCurrentUser=function(n,t){var r,i;return g(this,void 0,void 0,function(){var a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:if(B(x("string",n)&&x("string",t?.deviceManufacturer,!0)).throw(k.invalidParameters),t?.deviceOS&&B(be(Ms,t.deviceOS.platform,!0)&&x("string",t.deviceOS.version,!0)).throw(k.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=t?.deviceOS)===null||r===void 0?void 0:r.platform)||Ms.ANDROID,"-").concat(((i=t?.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:t?.deviceManufacturer,systemPushEnabled:t?.systemPushEnabled},h.label=1;case 1:return h.trys.push([1,4,,5]),s=I.of(this._iid),o=s.sessionManager,l=s.sdkState,u=s.requestQueue,o.hasDeviceToken(ln.FCM,n)?[2,er.SUCCESS]:(c=new k4({userId:l.userId,token:n,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,u.send(c)]);case 2:return h.sent(),[4,Ct(function(){return g(d,void 0,void 0,function(){return _(this,function(f){switch(f.label){case 0:return o.setDeviceToken(ln.FCM,n,a),[4,o.saveDeviceToken()];case 1:return f.sent(),[2]}})})})];case 3:return h.sent(),this._fcmPushToken="",[2,er.SUCCESS];case 4:return h.sent(),[2,er.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=n,[2,er.PENDING];case 7:return[2]}})})},e.prototype.unregisterFCMPushTokenForCurrentUser=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:if(B(x("string",n)).throw(k.invalidParameters),!this.currentUser)return[3,6];c.label=1;case 1:return c.trys.push([1,4,,5]),t=I.of(this._iid),r=t.sessionManager,i=t.sdkState,a=t.requestQueue,s=new L4({userId:i.userId,token:n}),[4,a.send(s)];case 2:return o=c.sent(),l=o.as(P4).lastDeletedAt,[4,Ct(function(){return g(u,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:return r.unsetDeviceToken(ln.FCM,n),r.setDeviceTokenDeletedAt(l),[4,r.saveDeviceToken()];case 1:return d.sent(),[2]}})})})];case 3:return c.sent(),this._fcmPushToken="",[2,er.SUCCESS];case 4:return c.sent(),[2,er.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=n,[2,er.PENDING];case 7:return[2]}})})},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:return this.currentUser?(n=I.of(this._iid),t=n.sessionManager,r=n.sdkState,i=n.requestQueue,a=new z4({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=u.sent(),o=s.as(H4).lastDeletedAt,[4,Ct(function(){return g(l,void 0,void 0,function(){return _(this,function(c){switch(c.label){case 0:return t.unsetDeviceTokens(ln.FCM),t.setDeviceTokenDeletedAt(o),[4,t.saveDeviceToken()];case 1:return c.sent(),[2]}})})})];case 2:u.sent(),u.label=3;case 3:return[2]}})})},e.prototype.registerAPNSPushTokenForCurrentUser=function(n,t){var r,i;return g(this,void 0,void 0,function(){var a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:if(B(x("string",n)&&x("string",t?.deviceManufacturer,!0)).throw(k.invalidParameters),t?.deviceOS&&B(be(Ms,t.deviceOS.platform,!0)&&x("string",t.deviceOS.version,!0)).throw(k.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=t?.deviceOS)===null||r===void 0?void 0:r.platform)||Ms.IOS,"-").concat(((i=t?.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:t?.deviceManufacturer,systemPushEnabled:t?.systemPushEnabled},h.label=1;case 1:return h.trys.push([1,4,,5]),s=I.of(this._iid),o=s.sessionManager,l=s.sdkState,u=s.requestQueue,o.hasDeviceToken(ln.APNS,n)?[2,er.SUCCESS]:(c=new D4({userId:l.userId,token:n,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,u.send(c)]);case 2:return h.sent(),[4,Ct(function(){return g(d,void 0,void 0,function(){return _(this,function(f){switch(f.label){case 0:return o.setDeviceToken(ln.APNS,n,a),[4,o.saveDeviceToken()];case 1:return f.sent(),[2]}})})})];case 3:return h.sent(),this._apnsPushToken="",[2,er.SUCCESS];case 4:return h.sent(),[2,er.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=n,[2,er.PENDING];case 7:return[2]}})})},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:if(B(x("string",n)).throw(k.invalidParameters),!this.currentUser)return[3,6];c.label=1;case 1:return c.trys.push([1,4,,5]),t=I.of(this._iid),r=t.sessionManager,i=t.sdkState,a=t.requestQueue,s=new R4({userId:i.userId,token:n}),[4,a.send(s)];case 2:return o=c.sent(),l=o.as(U4).lastDeletedAt,[4,Ct(function(){return g(u,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:return r.unsetDeviceToken(ln.APNS,n),r.setDeviceTokenDeletedAt(l),[4,r.saveDeviceToken()];case 1:return d.sent(),[2]}})})})];case 3:return c.sent(),this._apnsPushToken="",[2,er.SUCCESS];case 4:return c.sent(),[2,er.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=n,[2,er.PENDING];case 7:return[2]}})})},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:return this.currentUser?(n=I.of(this._iid),t=n.sessionManager,r=n.sdkState,i=n.requestQueue,a=new F4({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=u.sent(),o=s.as($4).lastDeletedAt,[4,Ct(function(){return g(l,void 0,void 0,function(){return _(this,function(c){switch(c.label){case 0:return t.unsetDeviceTokens(ln.APNS),t.setDeviceTokenDeletedAt(o),[4,t.saveDeviceToken()];case 1:return c.sent(),[2]}})})})];case 2:u.sent(),u.label=3;case 3:return[2]}})})},e.prototype.markPushNotificationAsDelivered=function(n,t){var r;return t===void 0&&(t=!0),g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A;return _(this,function(D){switch(D.label){case 0:if(i=I.of(this._iid),a=i.logger,s=i.sessionManager,o=i.requestQueue,l=i.pushNotificationAckManager,a.debug("markPushNotificationAsDelivered:",n),u=Bp.DELIVERED,c=l.parseData(n),d=c.pushTrackingId,h=c.sessionTopics,f=c.sessionKey,m=c.messageId,y=c.channelKey,C=c.templateKey,b=c.notificationEventDeadline,!f||!h.includes(Lp.PUSH_ACKNOWLEDGEMENT))throw a.info("Can't use markPushNotificationAsDelivered() feature."),k.malformedDataError;if(l.isAcked(d,u))return a.info("already delivered push notification:",d),[2];v=!!y,E=t&&v,S=(r=s.deviceTokens[0])===null||r===void 0?void 0:r.token,w=new gC({deviceToken:S??"",pushTrackingId:d,eventType:u,messageId:m,channelKey:y,templateKey:C,notificationEventDeadline:b,allowedPushNotification:E}),f&&(w.headers["Session-Key"]=f),D.label=1;case 1:return D.trys.push([1,3,,4]),[4,o.send(w)];case 2:return D.sent(),l.markAsAcked(d,u),[3,4];case 3:throw A=D.sent(),a.debug("failed to mark push notification as delivered. push tracking id: ".concat(d,". error: ").concat(A)),A;case 4:return[2]}})})},e.prototype.markPushNotificationAsClicked=function(n){var t;return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E;return _(this,function(S){switch(S.label){case 0:if(r=I.of(this._iid),i=r.logger,a=r.sessionManager,s=r.requestQueue,o=r.pushNotificationAckManager,i.debug("markPushNotificationAsClicked:",n),l=Bp.CLICKED,u=o.parseData(n),c=u.pushTrackingId,d=u.sessionTopics,h=u.sessionKey,f=u.messageId,m=u.channelKey,y=u.templateKey,C=u.notificationEventDeadline,!h||!d.includes(Lp.PUSH_ACKNOWLEDGEMENT))throw i.info("Can't use markPushNotificationAsClicked() feature."),k.malformedDataError;if(o.isAcked(c,l))return i.info("already clicked push notification:",c),[2];b=(t=a.deviceTokens[0])===null||t===void 0?void 0:t.token,v=new gC({deviceToken:b??"",pushTrackingId:c,eventType:l,messageId:f,channelKey:m,templateKey:y,notificationEventDeadline:C}),h&&(v.headers["Session-Key"]=h),S.label=1;case 1:return S.trys.push([1,3,,4]),[4,s.send(v)];case 2:return S.sent(),o.markAsAcked(c,l),[3,4];case 3:throw E=S.sent(),i.debug("failed to mark push notification as clicked. push tracking id: ".concat(c,". error: ").concat(E)),E;case 4:return[2]}})})},e.prototype.getChannelInvitationPreference=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a;return _(this,function(s){switch(s.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new G4({userId:t.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,{autoAccept:a.as(V4).autoAccept}]}})})},e.prototype.setChannelInvitationPreference=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return B(x("boolean",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new j4({userId:r.userId,willAutoAccept:n}),[4,i.send(a)];case 1:return s=o.sent(),[2,{autoAccept:s.as(Q4).autoAccept}]}})})},e.prototype.getDoNotDisturb=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a;return _(this,function(s){switch(s.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new K4({userId:t.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(W4).preference]}})})},e.prototype.setDoNotDisturb=function(n,t,r,i,a,s){return t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=""),g(this,void 0,void 0,function(){var o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return B(x("boolean",n)&&x("number",t)&&x("number",r)&&x("number",i)&&x("number",a)&&x("string",s)).throw(k.invalidParameters),o=I.of(this._iid),l=o.sdkState,u=o.requestQueue,c=new Y4({userId:l.userId,doNotDisturbOn:n,startHour:t,startMin:r,endHour:i,endMin:a,timezone:s}),[4,u.send(c)];case 1:return d=h.sent(),[2,d.as(Z4).preference]}})})},e.prototype.getSnoozePeriod=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a;return _(this,function(s){switch(s.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new X4({userId:t.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(J4).snoozePeriod]}})})},e.prototype.setSnoozePeriod=function(n,t,r){return t===void 0&&(t=0),r===void 0&&(r=0),g(this,void 0,void 0,function(){var i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(x("boolean",n)&&x("number",t)&&x("number",r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.requestQueue,o=new eL({userId:a.userId,snoozeOn:n,startTs:t,endTs:r}),[4,s.send(o)];case 1:return l=u.sent(),[2,l.as(tL).snoozePeriod]}})})},e.prototype.getMyPushTokensByToken=function(n,t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m;return _(this,function(y){switch(y.label){case 0:return B(x("string",n)&&be(ln,t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.sdkState,a=r.requestQueue,s=r.sessionManager,o=new q4({userId:i.userId,type:t,token:n}),[4,a.send(o)];case 1:l=y.sent(),u=l.as(B4).pushTokens;try{for(c=K(u.deviceTokens),d=c.next();!d.done;d=c.next())h=d.value,s.setDeviceToken(u.type,h)}catch(C){f={error:C}}finally{try{d&&!d.done&&(m=c.return)&&m.call(c)}finally{if(f)throw f.error}}return[4,s.saveDeviceToken()];case 2:return y.sent(),[2,u]}})})},e.prototype.getPushTriggerOption=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new iL({userId:t.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(aL).pushTriggerOption]}})})},e.prototype.setPushTriggerOption=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(be(Ro,n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new sL({userId:r.userId,pushTriggerOption:n}),[4,i.send(a)];case 1:return[2,s.sent().as(oL).pushTriggerOption]}})})},e.prototype.getPushTemplate=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new lL({userId:t.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(uL).name]}})})},e.prototype.setPushTemplate=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(be(Lv,n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new cL({userId:r.userId,templateName:n}),[4,i.send(a)];case 1:return[2,s.sent().as(dL).name]}})})},e.prototype.blockUser=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(n instanceof xe||x("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new nL({userId:r.userId,blockedUserId:n instanceof xe?n.userId:n}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},e.prototype.blockUserWithUserId=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this.blockUser(n)]})})},e.prototype.unblockUser=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(n instanceof xe||x("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new rL({userId:r.userId,unblockedUserId:n instanceof xe?n.userId:n}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},e.prototype.unblockUserWithUserId=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this.unblockUser(n)]})})},e.prototype.getFriendChangeLogsByToken=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return B(x("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new hL({userId:r.userId,token:n}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(fL).changelogs]}})})},e.prototype.getAllowFriendDiscovery=function(){return g(this,void 0,void 0,function(){var n,t,r,i,a;return _(this,function(s){switch(s.label){case 0:return n=I.of(this._iid),t=n.sdkState,r=n.requestQueue,i=new bL({userId:t.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(EL).allowFriendDiscovery]}})})},e.prototype.setAllowFriendDiscovery=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(x("boolean",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new CL({userId:r.userId,allowFriendDiscovery:n}),[4,i.send(a)];case 1:return s.sent(),[2,n]}})})},e.prototype.uploadFriendDiscoveries=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new pL({userId:r.userId,discoveries:n}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(mL).friendDiscoveryRequestId]}})})},e.prototype.deleteFriendDiscovery=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this.deleteFriendDiscoveries([n])]})})},e.prototype.deleteFriendDiscoveries=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(Te("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new _L({userId:r.userId,discoveryKeys:n}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},e.prototype.addFriends=function(n){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return B(Te("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new gL({userId:r.userId,userIds:n}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(vL).users]}})})},e.prototype.deleteFriend=function(n){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this.deleteFriends([n])]})})},e.prototype.deleteFriends=function(n){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return B(Te("string",n)).throw(k.invalidParameters),t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new yL({userId:r.userId,userIds:n}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},e.prototype.getAllEmoji=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:return n=I.of(this._iid).requestQueue,t=new SL,[4,n.send(t)];case 1:return r=i.sent(),[2,r.as(TL).emojiContainer]}})})},e.prototype.getEmojiCategory=function(n){return g(this,void 0,void 0,function(){var t,r,i;return _(this,function(a){switch(a.label){case 0:return t=I.of(this._iid).requestQueue,r=new wL({categoryId:n}),[4,t.send(r)];case 1:return i=a.sent(),[2,i.as(AL).emojiCategory]}})})},e.prototype.getEmoji=function(n){return g(this,void 0,void 0,function(){var t,r,i;return _(this,function(a){switch(a.label){case 0:return t=I.of(this._iid).requestQueue,r=new NL({key:n}),[4,t.send(r)];case 1:return i=a.sent(),[2,i.as(IL).emoji]}})})},e.prototype.getUIKitConfiguration=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return n=I.of(this._iid),B(n.hasExtension("sb_uikit")).throw(k.notSupportedError),t=n.requestQueue,r=new ML,[4,t.send(r)];case 1:return i=a.sent(),[2,i.as(xL).uikitConfiguration]}})})},e.prototype.getReportCategoryInfoList=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).reportCategoryManager.categories()];case 1:return[2,n.sent()]}})})},e}(),Ln=function(){return Ln=Object.assign||function(n){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},Ln.apply(this,arguments)};function ku(e,n,t){if(t||arguments.length===2)for(var r=0,i=n.length,a;r<i;r++)(a||!(r in n))&&(a||(a=Array.prototype.slice.call(n,0,r)),a[r]=n[r]);return e.concat(a||Array.prototype.slice.call(n))}var DL=function(n,t,r,i){var a=r?r.call(i,n,t):void 0;if(a!==void 0)return!!a;if(n===t)return!0;if(typeof n!="object"||!n||typeof t!="object"||!t)return!1;var s=Object.keys(n),o=Object.keys(t);if(s.length!==o.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),u=0;u<s.length;u++){var c=s[u];if(!l(c))return!1;var d=n[c],h=t[c];if(a=r?r.call(i,d,h,c):void 0,a===!1||a===void 0&&d!==h)return!1}return!0};const kL=ZS(DL);var Pt="-ms-",yd="-moz-",yt="-webkit-",AN="comm",Um="rule",qy="decl",RL="@import",NN="@keyframes",UL="@layer",IN=Math.abs,By=String.fromCharCode,s0=Object.assign;function LL(e,n){return On(e,0)^45?(((n<<2^On(e,0))<<2^On(e,1))<<2^On(e,2))<<2^On(e,3):0}function MN(e){return e.trim()}function Ma(e,n){return(e=n.exec(e))?e[0]:e}function Ge(e,n,t){return e.replace(n,t)}function Hf(e,n,t){return e.indexOf(n,t)}function On(e,n){return e.charCodeAt(n)|0}function Ru(e,n,t){return e.slice(n,t)}function Xi(e){return e.length}function xN(e){return e.length}function $c(e,n){return n.push(e),e}function PL(e,n){return e.map(n).join("")}function vC(e,n){return e.filter(function(t){return!Ma(t,n)})}var Lm=1,Uu=1,ON=0,Ci=0,fn=0,Yu="";function Pm(e,n,t,r,i,a,s,o){return{value:e,root:n,parent:t,type:r,props:i,children:a,line:Lm,column:Uu,length:s,return:"",siblings:o}}function _s(e,n){return s0(Pm("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},n)}function Ll(e){for(;e.root;)e=_s(e.root,{children:[e]});$c(e,e.siblings)}function FL(){return fn}function $L(){return fn=Ci>0?On(Yu,--Ci):0,Uu--,fn===10&&(Uu=1,Lm--),fn}function Hi(){return fn=Ci<ON?On(Yu,Ci++):0,Uu++,fn===10&&(Uu=1,Lm++),fn}function Xo(){return On(Yu,Ci)}function qf(){return Ci}function Fm(e,n){return Ru(Yu,e,n)}function o0(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function zL(e){return Lm=Uu=1,ON=Xi(Yu=e),Ci=0,[]}function HL(e){return Yu="",e}function Ag(e){return MN(Fm(Ci-1,l0(e===91?e+2:e===40?e+1:e)))}function qL(e){for(;(fn=Xo())&&fn<33;)Hi();return o0(e)>2||o0(fn)>3?"":" "}function BL(e,n){for(;--n&&Hi()&&!(fn<48||fn>102||fn>57&&fn<65||fn>70&&fn<97););return Fm(e,qf()+(n<6&&Xo()==32&&Hi()==32))}function l0(e){for(;Hi();)switch(fn){case e:return Ci;case 34:case 39:e!==34&&e!==39&&l0(fn);break;case 40:e===41&&l0(e);break;case 92:Hi();break}return Ci}function GL(e,n){for(;Hi()&&e+fn!==57;)if(e+fn===84&&Xo()===47)break;return"/*"+Fm(n,Ci-1)+"*"+By(e===47?e:Hi())}function VL(e){for(;!o0(Xo());)Hi();return Fm(e,Ci)}function jL(e){return HL(Bf("",null,null,null,[""],e=zL(e),0,[0],e))}function Bf(e,n,t,r,i,a,s,o,l){for(var u=0,c=0,d=s,h=0,f=0,m=0,y=1,C=1,b=1,v=0,E="",S=i,w=a,A=r,D=E;C;)switch(m=v,v=Hi()){case 40:if(m!=108&&On(D,d-1)==58){Hf(D+=Ge(Ag(v),"&","&\f"),"&\f",IN(u?o[u-1]:0))!=-1&&(b=-1);break}case 34:case 39:case 91:D+=Ag(v);break;case 9:case 10:case 13:case 32:D+=qL(m);break;case 92:D+=BL(qf()-1,7);continue;case 47:switch(Xo()){case 42:case 47:$c(QL(GL(Hi(),qf()),n,t,l),l);break;default:D+="/"}break;case 123*y:o[u++]=Xi(D)*b;case 125*y:case 59:case 0:switch(v){case 0:case 125:C=0;case 59+c:b==-1&&(D=Ge(D,/\f/g,"")),f>0&&Xi(D)-d&&$c(f>32?bC(D+";",r,t,d-1,l):bC(Ge(D," ","")+";",r,t,d-2,l),l);break;case 59:D+=";";default:if($c(A=yC(D,n,t,u,c,i,o,E,S=[],w=[],d,a),a),v===123)if(c===0)Bf(D,n,A,A,S,a,d,o,w);else switch(h===99&&On(D,3)===110?100:h){case 100:case 108:case 109:case 115:Bf(e,A,A,r&&$c(yC(e,A,A,0,0,i,o,E,i,S=[],d,w),w),i,w,d,o,r?S:w);break;default:Bf(D,A,A,A,[""],w,0,o,w)}}u=c=f=0,y=b=1,E=D="",d=s;break;case 58:d=1+Xi(D),f=m;default:if(y<1){if(v==123)--y;else if(v==125&&y++==0&&$L()==125)continue}switch(D+=By(v),v*y){case 38:b=c>0?1:(D+="\f",-1);break;case 44:o[u++]=(Xi(D)-1)*b,b=1;break;case 64:Xo()===45&&(D+=Ag(Hi())),h=Xo(),c=d=Xi(E=D+=VL(qf())),v++;break;case 45:m===45&&Xi(D)==2&&(y=0)}}return a}function yC(e,n,t,r,i,a,s,o,l,u,c,d){for(var h=i-1,f=i===0?a:[""],m=xN(f),y=0,C=0,b=0;y<r;++y)for(var v=0,E=Ru(e,h+1,h=IN(C=s[y])),S=e;v<m;++v)(S=MN(C>0?f[v]+" "+E:Ge(E,/&\f/g,f[v])))&&(l[b++]=S);return Pm(e,n,t,i===0?Um:o,l,u,c,d)}function QL(e,n,t,r){return Pm(e,n,t,AN,By(FL()),Ru(e,2,-2),0,r)}function bC(e,n,t,r,i){return Pm(e,n,t,qy,Ru(e,0,r),Ru(e,r+1,-1),r,i)}function DN(e,n,t){switch(LL(e,n)){case 5103:return yt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return yt+e+e;case 4789:return yd+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return yt+e+yd+e+Pt+e+e;case 5936:switch(On(e,n+11)){case 114:return yt+e+Pt+Ge(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return yt+e+Pt+Ge(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return yt+e+Pt+Ge(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return yt+e+Pt+e+e;case 6165:return yt+e+Pt+"flex-"+e+e;case 5187:return yt+e+Ge(e,/(\w+).+(:[^]+)/,yt+"box-$1$2"+Pt+"flex-$1$2")+e;case 5443:return yt+e+Pt+"flex-item-"+Ge(e,/flex-|-self/g,"")+(Ma(e,/flex-|baseline/)?"":Pt+"grid-row-"+Ge(e,/flex-|-self/g,""))+e;case 4675:return yt+e+Pt+"flex-line-pack"+Ge(e,/align-content|flex-|-self/g,"")+e;case 5548:return yt+e+Pt+Ge(e,"shrink","negative")+e;case 5292:return yt+e+Pt+Ge(e,"basis","preferred-size")+e;case 6060:return yt+"box-"+Ge(e,"-grow","")+yt+e+Pt+Ge(e,"grow","positive")+e;case 4554:return yt+Ge(e,/([^-])(transform)/g,"$1"+yt+"$2")+e;case 6187:return Ge(Ge(Ge(e,/(zoom-|grab)/,yt+"$1"),/(image-set)/,yt+"$1"),e,"")+e;case 5495:case 3959:return Ge(e,/(image-set\([^]*)/,yt+"$1$`$1");case 4968:return Ge(Ge(e,/(.+:)(flex-)?(.*)/,yt+"box-pack:$3"+Pt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+yt+e+e;case 4200:if(!Ma(e,/flex-|baseline/))return Pt+"grid-column-align"+Ru(e,n)+e;break;case 2592:case 3360:return Pt+Ge(e,"template-","")+e;case 4384:case 3616:return t&&t.some(function(r,i){return n=i,Ma(r.props,/grid-\w+-end/)})?~Hf(e+(t=t[n].value),"span",0)?e:Pt+Ge(e,"-start","")+e+Pt+"grid-row-span:"+(~Hf(t,"span",0)?Ma(t,/\d+/):+Ma(t,/\d+/)-+Ma(e,/\d+/))+";":Pt+Ge(e,"-start","")+e;case 4896:case 4128:return t&&t.some(function(r){return Ma(r.props,/grid-\w+-start/)})?e:Pt+Ge(Ge(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Ge(e,/(.+)-inline(.+)/,yt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Xi(e)-1-n>6)switch(On(e,n+1)){case 109:if(On(e,n+4)!==45)break;case 102:return Ge(e,/(.+:)(.+)-([^]+)/,"$1"+yt+"$2-$3$1"+yd+(On(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~Hf(e,"stretch",0)?DN(Ge(e,"stretch","fill-available"),n,t)+e:e}break;case 5152:case 5920:return Ge(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,a,s,o,l,u){return Pt+i+":"+a+u+(s?Pt+i+"-span:"+(o?l:+l-+a)+u:"")+e});case 4949:if(On(e,n+6)===121)return Ge(e,":",":"+yt)+e;break;case 6444:switch(On(e,On(e,14)===45?18:11)){case 120:return Ge(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+yt+(On(e,14)===45?"inline-":"")+"box$3$1"+yt+"$2$3$1"+Pt+"$2box$3")+e;case 100:return Ge(e,":",":"+Pt)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ge(e,"scroll-","scroll-snap-")+e}return e}function Gp(e,n){for(var t="",r=0;r<e.length;r++)t+=n(e[r],r,e,n)||"";return t}function KL(e,n,t,r){switch(e.type){case UL:if(e.children.length)break;case RL:case qy:return e.return=e.return||e.value;case AN:return"";case NN:return e.return=e.value+"{"+Gp(e.children,r)+"}";case Um:if(!Xi(e.value=e.props.join(",")))return""}return Xi(t=Gp(e.children,r))?e.return=e.value+"{"+t+"}":""}function WL(e){var n=xN(e);return function(t,r,i,a){for(var s="",o=0;o<n;o++)s+=e[o](t,r,i,a)||"";return s}}function YL(e){return function(n){n.root||(n=n.return)&&e(n)}}function ZL(e,n,t,r){if(e.length>-1&&!e.return)switch(e.type){case qy:e.return=DN(e.value,e.length,t);return;case NN:return Gp([_s(e,{value:Ge(e.value,"@","@"+yt)})],r);case Um:if(e.length)return PL(t=e.props,function(i){switch(Ma(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Ll(_s(e,{props:[Ge(i,/:(read-\w+)/,":"+yd+"$1")]})),Ll(_s(e,{props:[i]})),s0(e,{props:vC(t,r)});break;case"::placeholder":Ll(_s(e,{props:[Ge(i,/:(plac\w+)/,":"+yt+"input-$1")]})),Ll(_s(e,{props:[Ge(i,/:(plac\w+)/,":"+yd+"$1")]})),Ll(_s(e,{props:[Ge(i,/:(plac\w+)/,Pt+"input-$1")]})),Ll(_s(e,{props:[i]})),s0(e,{props:vC(t,r)});break}return""})}}var XL={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},kr={},Lu=typeof process<"u"&&kr!==void 0&&(kr.REACT_APP_SC_ATTR||kr.SC_ATTR)||"data-styled",kN="active",RN="data-styled-version",$m="6.1.18",Gy=`/*!sc*/
`,Vp=typeof window<"u"&&typeof document<"u",JL=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&kr!==void 0&&kr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&kr.REACT_APP_SC_DISABLE_SPEEDY!==""?kr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&kr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&kr!==void 0&&kr.SC_DISABLE_SPEEDY!==void 0&&kr.SC_DISABLE_SPEEDY!==""&&kr.SC_DISABLE_SPEEDY!=="false"&&kr.SC_DISABLE_SPEEDY),e5={},zm=Object.freeze([]),Pu=Object.freeze({});function UN(e,n,t){return t===void 0&&(t=Pu),e.theme!==t.theme&&e.theme||n||t.theme}var LN=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),t5=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,n5=/(^-|-$)/g;function EC(e){return e.replace(t5,"-").replace(n5,"")}var r5=/(a)(d)/gi,uf=52,CC=function(e){return String.fromCharCode(e+(e>25?39:97))};function u0(e){var n,t="";for(n=Math.abs(e);n>uf;n=n/uf|0)t=CC(n%uf)+t;return(CC(n%uf)+t).replace(r5,"$1-$2")}var Ng,PN=5381,ou=function(e,n){for(var t=n.length;t;)e=33*e^n.charCodeAt(--t);return e},FN=function(e){return ou(PN,e)};function Vy(e){return u0(FN(e)>>>0)}function i5(e){return e.displayName||e.name||"Component"}function Ig(e){return typeof e=="string"&&!0}var $N=typeof Symbol=="function"&&Symbol.for,zN=$N?Symbol.for("react.memo"):60115,a5=$N?Symbol.for("react.forward_ref"):60112,s5={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o5={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},HN={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l5=((Ng={})[a5]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ng[zN]=HN,Ng);function SC(e){return("type"in(n=e)&&n.type.$$typeof)===zN?HN:"$$typeof"in e?l5[e.$$typeof]:s5;var n}var u5=Object.defineProperty,c5=Object.getOwnPropertyNames,TC=Object.getOwnPropertySymbols,d5=Object.getOwnPropertyDescriptor,h5=Object.getPrototypeOf,wC=Object.prototype;function qN(e,n,t){if(typeof n!="string"){if(wC){var r=h5(n);r&&r!==wC&&qN(e,r,t)}var i=c5(n);TC&&(i=i.concat(TC(n)));for(var a=SC(e),s=SC(n),o=0;o<i.length;++o){var l=i[o];if(!(l in o5||t&&t[l]||s&&l in s||a&&l in a)){var u=d5(n,l);try{u5(e,l,u)}catch{}}}}return e}function dl(e){return typeof e=="function"}function jy(e){return typeof e=="object"&&"styledComponentId"in e}function qo(e,n){return e&&n?"".concat(e," ").concat(n):e||n||""}function jp(e,n){if(e.length===0)return"";for(var t=e[0],r=1;r<e.length;r++)t+=e[r];return t}function jd(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function c0(e,n,t){if(t===void 0&&(t=!1),!t&&!jd(e)&&!Array.isArray(e))return n;if(Array.isArray(n))for(var r=0;r<n.length;r++)e[r]=c0(e[r],n[r]);else if(jd(n))for(var r in n)e[r]=c0(e[r],n[r]);return e}function Qy(e,n){Object.defineProperty(e,"toString",{value:n})}function Xs(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var f5=function(){function e(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return e.prototype.indexOfGroup=function(n){for(var t=0,r=0;r<n;r++)t+=this.groupSizes[r];return t},e.prototype.insertRules=function(n,t){if(n>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,a=i;n>=a;)if((a<<=1)<0)throw Xs(16,"".concat(n));this.groupSizes=new Uint32Array(a),this.groupSizes.set(r),this.length=a;for(var s=i;s<a;s++)this.groupSizes[s]=0}for(var o=this.indexOfGroup(n+1),l=(s=0,t.length);s<l;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[n]++,o++)},e.prototype.clearGroup=function(n){if(n<this.length){var t=this.groupSizes[n],r=this.indexOfGroup(n),i=r+t;this.groupSizes[n]=0;for(var a=r;a<i;a++)this.tag.deleteRule(r)}},e.prototype.getGroup=function(n){var t="";if(n>=this.length||this.groupSizes[n]===0)return t;for(var r=this.groupSizes[n],i=this.indexOfGroup(n),a=i+r,s=i;s<a;s++)t+="".concat(this.tag.getRule(s)).concat(Gy);return t},e}(),Gf=new Map,Qp=new Map,Vf=1,cf=function(e){if(Gf.has(e))return Gf.get(e);for(;Qp.has(Vf);)Vf++;var n=Vf++;return Gf.set(e,n),Qp.set(n,e),n},p5=function(e,n){Vf=n+1,Gf.set(e,n),Qp.set(n,e)},m5="style[".concat(Lu,"][").concat(RN,'="').concat($m,'"]'),_5=new RegExp("^".concat(Lu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),g5=function(e,n,t){for(var r,i=t.split(","),a=0,s=i.length;a<s;a++)(r=i[a])&&e.registerName(n,r)},v5=function(e,n){for(var t,r=((t=n.textContent)!==null&&t!==void 0?t:"").split(Gy),i=[],a=0,s=r.length;a<s;a++){var o=r[a].trim();if(o){var l=o.match(_5);if(l){var u=0|parseInt(l[1],10),c=l[2];u!==0&&(p5(c,u),g5(e,c,l[3]),e.getTag().insertRules(u,i)),i.length=0}else i.push(o)}}},AC=function(e){for(var n=document.querySelectorAll(m5),t=0,r=n.length;t<r;t++){var i=n[t];i&&i.getAttribute(Lu)!==kN&&(v5(e,i),i.parentNode&&i.parentNode.removeChild(i))}};function y5(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var BN=function(e){var n=document.head,t=e||n,r=document.createElement("style"),i=function(o){var l=Array.from(o.querySelectorAll("style[".concat(Lu,"]")));return l[l.length-1]}(t),a=i!==void 0?i.nextSibling:null;r.setAttribute(Lu,kN),r.setAttribute(RN,$m);var s=y5();return s&&r.setAttribute("nonce",s),t.insertBefore(r,a),r},b5=function(){function e(n){this.element=BN(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var r=document.styleSheets,i=0,a=r.length;i<a;i++){var s=r[i];if(s.ownerNode===t)return s}throw Xs(17)}(this.element),this.length=0}return e.prototype.insertRule=function(n,t){try{return this.sheet.insertRule(t,n),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.prototype.getRule=function(n){var t=this.sheet.cssRules[n];return t&&t.cssText?t.cssText:""},e}(),E5=function(){function e(n){this.element=BN(n),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(n,t){if(n<=this.length&&n>=0){var r=document.createTextNode(t);return this.element.insertBefore(r,this.nodes[n]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},e}(),C5=function(){function e(n){this.rules=[],this.length=0}return e.prototype.insertRule=function(n,t){return n<=this.length&&(this.rules.splice(n,0,t),this.length++,!0)},e.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},e}(),NC=Vp,S5={isServer:!Vp,useCSSOMInjection:!JL},Kp=function(){function e(n,t,r){n===void 0&&(n=Pu),t===void 0&&(t={});var i=this;this.options=Ln(Ln({},S5),n),this.gs=t,this.names=new Map(r),this.server=!!n.isServer,!this.server&&Vp&&NC&&(NC=!1,AC(this)),Qy(this,function(){return function(a){for(var s=a.getTag(),o=s.length,l="",u=function(d){var h=function(b){return Qp.get(b)}(d);if(h===void 0)return"continue";var f=a.names.get(h),m=s.getGroup(d);if(f===void 0||!f.size||m.length===0)return"continue";var y="".concat(Lu,".g").concat(d,'[id="').concat(h,'"]'),C="";f!==void 0&&f.forEach(function(b){b.length>0&&(C+="".concat(b,","))}),l+="".concat(m).concat(y,'{content:"').concat(C,'"}').concat(Gy)},c=0;c<o;c++)u(c);return l}(i)})}return e.registerId=function(n){return cf(n)},e.prototype.rehydrate=function(){!this.server&&Vp&&AC(this)},e.prototype.reconstructWithOptions=function(n,t){return t===void 0&&(t=!0),new e(Ln(Ln({},this.options),n),this.gs,t&&this.names||void 0)},e.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(n=function(t){var r=t.useCSSOMInjection,i=t.target;return t.isServer?new C5(i):r?new b5(i):new E5(i)}(this.options),new f5(n)));var n},e.prototype.hasNameForId=function(n,t){return this.names.has(n)&&this.names.get(n).has(t)},e.prototype.registerName=function(n,t){if(cf(n),this.names.has(n))this.names.get(n).add(t);else{var r=new Set;r.add(t),this.names.set(n,r)}},e.prototype.insertRules=function(n,t,r){this.registerName(n,t),this.getTag().insertRules(cf(n),r)},e.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.prototype.clearRules=function(n){this.getTag().clearGroup(cf(n)),this.clearNames(n)},e.prototype.clearTag=function(){this.tag=void 0},e}(),T5=/&/g,w5=/^\s*\/\/.*$/gm;function GN(e,n){return e.map(function(t){return t.type==="rule"&&(t.value="".concat(n," ").concat(t.value),t.value=t.value.replaceAll(",",",".concat(n," ")),t.props=t.props.map(function(r){return"".concat(n," ").concat(r)})),Array.isArray(t.children)&&t.type!=="@keyframes"&&(t.children=GN(t.children,n)),t})}function VN(e){var n,t,r,i=e===void 0?Pu:e,a=i.options,s=a===void 0?Pu:a,o=i.plugins,l=o===void 0?zm:o,u=function(h,f,m){return m.startsWith(t)&&m.endsWith(t)&&m.replaceAll(t,"").length>0?".".concat(n):h},c=l.slice();c.push(function(h){h.type===Um&&h.value.includes("&")&&(h.props[0]=h.props[0].replace(T5,t).replace(r,u))}),s.prefix&&c.push(ZL),c.push(KL);var d=function(h,f,m,y){f===void 0&&(f=""),m===void 0&&(m=""),y===void 0&&(y="&"),n=y,t=f,r=new RegExp("\\".concat(t,"\\b"),"g");var C=h.replace(w5,""),b=jL(m||f?"".concat(m," ").concat(f," { ").concat(C," }"):C);s.namespace&&(b=GN(b,s.namespace));var v=[];return Gp(b,WL(c.concat(YL(function(E){return v.push(E)})))),v};return d.hash=l.length?l.reduce(function(h,f){return f.name||Xs(15),ou(h,f.name)},PN).toString():"",d}var A5=new Kp,d0=VN(),Ky=ye.createContext({shouldForwardProp:void 0,styleSheet:A5,stylis:d0});Ky.Consumer;var N5=ye.createContext(void 0);function Wp(){return p.useContext(Ky)}function I5(e){var n=p.useState(e.stylisPlugins),t=n[0],r=n[1],i=Wp().styleSheet,a=p.useMemo(function(){var l=i;return e.sheet?l=e.sheet:e.target&&(l=l.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(l=l.reconstructWithOptions({useCSSOMInjection:!1})),l},[e.disableCSSOMInjection,e.sheet,e.target,i]),s=p.useMemo(function(){return VN({options:{namespace:e.namespace,prefix:e.enableVendorPrefixes},plugins:t})},[e.enableVendorPrefixes,e.namespace,t]);p.useEffect(function(){kL(t,e.stylisPlugins)||r(e.stylisPlugins)},[e.stylisPlugins]);var o=p.useMemo(function(){return{shouldForwardProp:e.shouldForwardProp,styleSheet:a,stylis:s}},[e.shouldForwardProp,a,s]);return ye.createElement(Ky.Provider,{value:o},ye.createElement(N5.Provider,{value:s},e.children))}var jN=function(){function e(n,t){var r=this;this.inject=function(i,a){a===void 0&&(a=d0);var s=r.name+a.hash;i.hasNameForId(r.id,s)||i.insertRules(r.id,s,a(r.rules,s,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=t,Qy(this,function(){throw Xs(12,String(r.name))})}return e.prototype.getName=function(n){return n===void 0&&(n=d0),this.name+n.hash},e}(),M5=function(e){return e>="A"&&e<="Z"};function IC(e){for(var n="",t=0;t<e.length;t++){var r=e[t];if(t===1&&r==="-"&&e[0]==="-")return e;M5(r)?n+="-"+r.toLowerCase():n+=r}return n.startsWith("ms-")?"-"+n:n}var QN=function(e){return e==null||e===!1||e===""},KN=function(e){var n,t,r=[];for(var i in e){var a=e[i];e.hasOwnProperty(i)&&!QN(a)&&(Array.isArray(a)&&a.isCss||dl(a)?r.push("".concat(IC(i),":"),a,";"):jd(a)?r.push.apply(r,ku(ku(["".concat(i," {")],KN(a),!1),["}"],!1)):r.push("".concat(IC(i),": ").concat((n=i,(t=a)==null||typeof t=="boolean"||t===""?"":typeof t!="number"||t===0||n in XL||n.startsWith("--")?String(t).trim():"".concat(t,"px")),";")))}return r};function js(e,n,t,r){if(QN(e))return[];if(jy(e))return[".".concat(e.styledComponentId)];if(dl(e)){if(!dl(a=e)||a.prototype&&a.prototype.isReactComponent||!n)return[e];var i=e(n);return js(i,n,t,r)}var a;return e instanceof jN?t?(e.inject(t,r),[e.getName(r)]):[e]:jd(e)?KN(e):Array.isArray(e)?Array.prototype.concat.apply(zm,e.map(function(s){return js(s,n,t,r)})):[e.toString()]}function WN(e){for(var n=0;n<e.length;n+=1){var t=e[n];if(dl(t)&&!jy(t))return!1}return!0}var x5=FN($m),O5=function(){function e(n,t,r){this.rules=n,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&WN(n),this.componentId=t,this.baseHash=ou(x5,t),this.baseStyle=r,Kp.registerId(t)}return e.prototype.generateAndInjectStyles=function(n,t,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,t,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))i=qo(i,this.staticRulesId);else{var a=jp(js(this.rules,n,t,r)),s=u0(ou(this.baseHash,a)>>>0);if(!t.hasNameForId(this.componentId,s)){var o=r(a,".".concat(s),void 0,this.componentId);t.insertRules(this.componentId,s,o)}i=qo(i,s),this.staticRulesId=s}else{for(var l=ou(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var d=this.rules[c];if(typeof d=="string")u+=d;else if(d){var h=jp(js(d,n,t,r));l=ou(l,h+c),u+=h}}if(u){var f=u0(l>>>0);t.hasNameForId(this.componentId,f)||t.insertRules(this.componentId,f,r(u,".".concat(f),void 0,this.componentId)),i=qo(i,f)}}return i},e}(),Fu=ye.createContext(void 0);Fu.Consumer;function Wy(){var e=p.useContext(Fu);if(!e)throw Xs(18);return e}function D5(e){var n=ye.useContext(Fu),t=p.useMemo(function(){return function(r,i){if(!r)throw Xs(14);if(dl(r)){var a=r(i);return a}if(Array.isArray(r)||typeof r!="object")throw Xs(8);return i?Ln(Ln({},i),r):r}(e.theme,n)},[e.theme,n]);return e.children?ye.createElement(Fu.Provider,{value:t},e.children):null}var Mg={};function k5(e,n,t){var r=jy(e),i=e,a=!Ig(e),s=n.attrs,o=s===void 0?zm:s,l=n.componentId,u=l===void 0?function(S,w){var A=typeof S!="string"?"sc":EC(S);Mg[A]=(Mg[A]||0)+1;var D="".concat(A,"-").concat(Vy($m+A+Mg[A]));return w?"".concat(w,"-").concat(D):D}(n.displayName,n.parentComponentId):l,c=n.displayName,d=c===void 0?function(S){return Ig(S)?"styled.".concat(S):"Styled(".concat(i5(S),")")}(e):c,h=n.displayName&&n.componentId?"".concat(EC(n.displayName),"-").concat(n.componentId):n.componentId||u,f=r&&i.attrs?i.attrs.concat(o).filter(Boolean):o,m=n.shouldForwardProp;if(r&&i.shouldForwardProp){var y=i.shouldForwardProp;if(n.shouldForwardProp){var C=n.shouldForwardProp;m=function(S,w){return y(S,w)&&C(S,w)}}else m=y}var b=new O5(t,h,r?i.componentStyle:void 0);function v(S,w){return function(A,D,O){var M=A.attrs,F=A.componentStyle,U=A.defaultProps,$=A.foldedComponentIds,J=A.styledComponentId,ee=A.target,ve=ye.useContext(Fu),Q=Wp(),Z=A.shouldForwardProp||Q.shouldForwardProp,X=UN(D,ve,U)||Pu,se=function(pe,lt,an){for(var oe,le=Ln(Ln({},lt),{className:void 0,theme:an}),me=0;me<pe.length;me+=1){var ke=dl(oe=pe[me])?oe(le):oe;for(var fe in ke)le[fe]=fe==="className"?qo(le[fe],ke[fe]):fe==="style"?Ln(Ln({},le[fe]),ke[fe]):ke[fe]}return lt.className&&(le.className=qo(le.className,lt.className)),le}(M,D,X),Ce=se.as||ee,Me={};for(var Ue in se)se[Ue]===void 0||Ue[0]==="$"||Ue==="as"||Ue==="theme"&&se.theme===X||(Ue==="forwardedAs"?Me.as=se.forwardedAs:Z&&!Z(Ue,Ce)||(Me[Ue]=se[Ue]));var Le=function(pe,lt){var an=Wp(),oe=pe.generateAndInjectStyles(lt,an.styleSheet,an.stylis);return oe}(F,se),ot=qo($,J);return Le&&(ot+=" "+Le),se.className&&(ot+=" "+se.className),Me[Ig(Ce)&&!LN.has(Ce)?"class":"className"]=ot,O&&(Me.ref=O),p.createElement(Ce,Me)}(E,S,w)}v.displayName=d;var E=ye.forwardRef(v);return E.attrs=f,E.componentStyle=b,E.displayName=d,E.shouldForwardProp=m,E.foldedComponentIds=r?qo(i.foldedComponentIds,i.styledComponentId):"",E.styledComponentId=h,E.target=r?i.target:e,Object.defineProperty(E,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(S){this._foldedDefaultProps=r?function(w){for(var A=[],D=1;D<arguments.length;D++)A[D-1]=arguments[D];for(var O=0,M=A;O<M.length;O++)c0(w,M[O],!0);return w}({},i.defaultProps,S):S}}),Qy(E,function(){return".".concat(E.styledComponentId)}),a&&qN(E,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),E}function MC(e,n){for(var t=[e[0]],r=0,i=n.length;r<i;r+=1)t.push(n[r],e[r+1]);return t}var xC=function(e){return Object.assign(e,{isCss:!0})};function at(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(dl(e)||jd(e))return xC(js(MC(zm,ku([e],n,!0))));var r=e;return n.length===0&&r.length===1&&typeof r[0]=="string"?js(r):xC(js(MC(r,n)))}function h0(e,n,t){if(t===void 0&&(t=Pu),!n)throw Xs(1,n);var r=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return e(n,t,at.apply(void 0,ku([i],a,!1)))};return r.attrs=function(i){return h0(e,n,Ln(Ln({},t),{attrs:Array.prototype.concat(t.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return h0(e,n,Ln(Ln({},t),i))},r}var YN=function(e){return h0(k5,e)},q=YN;LN.forEach(function(e){q[e]=YN(e)});var R5=function(){function e(n,t){this.rules=n,this.componentId=t,this.isStatic=WN(n),Kp.registerId(this.componentId+1)}return e.prototype.createStyles=function(n,t,r,i){var a=i(jp(js(this.rules,t,r,i)),""),s=this.componentId+n;r.insertRules(s,s,a)},e.prototype.removeStyles=function(n,t){t.clearRules(this.componentId+n)},e.prototype.renderStyles=function(n,t,r,i){n>2&&Kp.registerId(this.componentId+n),this.removeStyles(n,r),this.createStyles(n,t,r,i)},e}();function U5(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=at.apply(void 0,ku([e],n,!1)),i="sc-global-".concat(Vy(JSON.stringify(r))),a=new R5(r,i),s=function(l){var u=Wp(),c=ye.useContext(Fu),d=ye.useRef(u.styleSheet.allocateGSInstance(i)).current;return u.styleSheet.server&&o(d,l,u.styleSheet,c,u.stylis),ye.useLayoutEffect(function(){if(!u.styleSheet.server)return o(d,l,u.styleSheet,c,u.stylis),function(){return a.removeStyles(d,u.styleSheet)}},[d,l,u.styleSheet,c,u.stylis]),null};function o(l,u,c,d,h){if(a.isStatic)a.renderStyles(l,e5,c,h);else{var f=Ln(Ln({},u),{theme:UN(u,d,s.defaultProps)});a.renderStyles(l,f,c,h)}}return ye.memo(s)}function ZN(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r=jp(at.apply(void 0,ku([e],n,!1))),i=Vy(r);return new jN(i,r)}const XN=6048e5,L5=864e5,OC=Symbol.for("constructDateFrom");function Js(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&OC in e?e[OC](n):e instanceof Date?new e.constructor(n):new Date(n)}function Ti(e,n){return Js(n||e,e)}let P5={};function Hm(){return P5}function Qd(e,n){const t=Hm(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=Ti(e,n?.in),a=i.getDay(),s=(a<r?7:0)+a-r;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function Yp(e,n){return Qd(e,{...n,weekStartsOn:1})}function JN(e,n){const t=Ti(e,n?.in),r=t.getFullYear(),i=Js(t,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const a=Yp(i),s=Js(t,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const o=Yp(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function DC(e){const n=Ti(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function eI(e,...n){const t=Js.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function Zp(e,n){const t=Ti(e,n?.in);return t.setHours(0,0,0,0),t}function F5(e,n,t){const[r,i]=eI(t?.in,e,n),a=Zp(r),s=Zp(i),o=+a-DC(a),l=+s-DC(s);return Math.round((o-l)/L5)}function $5(e,n){const t=JN(e,n),r=Js(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Yp(r)}function tI(e,n,t){const[r,i]=eI(t?.in,e,n);return+Zp(r)==+Zp(i)}function z5(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function H5(e){return!(!z5(e)&&typeof e!="number"||isNaN(+Ti(e)))}function q5(e,n){const t=Ti(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const B5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},G5=(e,n,t)=>{let r;const i=B5[e];return typeof i=="string"?r=i:n===1?r=i.one:r=i.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function xg(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const V5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},j5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Q5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},K5={date:xg({formats:V5,defaultWidth:"full"}),time:xg({formats:j5,defaultWidth:"full"}),dateTime:xg({formats:Q5,defaultWidth:"full"})},W5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Y5=(e,n,t,r)=>W5[e];function vc(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=t?.width?String(t.width):s;i=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=t?.width?String(t.width):e.defaultWidth;i=e.values[o]||e.values[s]}const a=e.argumentCallback?e.argumentCallback(n):n;return i[a]}}const Z5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},X5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},J5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},e6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},t6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},n6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},r6=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},i6={ordinalNumber:r6,era:vc({values:Z5,defaultWidth:"wide"}),quarter:vc({values:X5,defaultWidth:"wide",argumentCallback:e=>e-1}),month:vc({values:J5,defaultWidth:"wide"}),day:vc({values:e6,defaultWidth:"wide"}),dayPeriod:vc({values:t6,defaultWidth:"wide",formattingValues:n6,defaultFormattingWidth:"wide"})};function yc(e){return(n,t={})=>{const r=t.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=n.match(i);if(!a)return null;const s=a[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?s6(o,d=>d.test(s)):a6(o,d=>d.test(s));let u;u=e.valueCallback?e.valueCallback(l):l,u=t.valueCallback?t.valueCallback(u):u;const c=n.slice(s.length);return{value:u,rest:c}}}function a6(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function s6(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function o6(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const i=r[0],a=n.match(e.parsePattern);if(!a)return null;let s=e.valueCallback?e.valueCallback(a[0]):a[0];s=t.valueCallback?t.valueCallback(s):s;const o=n.slice(i.length);return{value:s,rest:o}}}const l6=/^(\d+)(th|st|nd|rd)?/i,u6=/\d+/i,c6={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},d6={any:[/^b/i,/^(a|c)/i]},h6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},f6={any:[/1/i,/2/i,/3/i,/4/i]},p6={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},m6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},g6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},v6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},y6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},b6={ordinalNumber:o6({matchPattern:l6,parsePattern:u6,valueCallback:e=>parseInt(e,10)}),era:yc({matchPatterns:c6,defaultMatchWidth:"wide",parsePatterns:d6,defaultParseWidth:"any"}),quarter:yc({matchPatterns:h6,defaultMatchWidth:"wide",parsePatterns:f6,defaultParseWidth:"any",valueCallback:e=>e+1}),month:yc({matchPatterns:p6,defaultMatchWidth:"wide",parsePatterns:m6,defaultParseWidth:"any"}),day:yc({matchPatterns:_6,defaultMatchWidth:"wide",parsePatterns:g6,defaultParseWidth:"any"}),dayPeriod:yc({matchPatterns:v6,defaultMatchWidth:"any",parsePatterns:y6,defaultParseWidth:"any"})},nI={code:"en-US",formatDistance:G5,formatLong:K5,formatRelative:Y5,localize:i6,match:b6,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E6(e,n){const t=Ti(e,n?.in);return F5(t,q5(t))+1}function C6(e,n){const t=Ti(e,n?.in),r=+Yp(t)-+$5(t);return Math.round(r/XN)+1}function rI(e,n){const t=Ti(e,n?.in),r=t.getFullYear(),i=Hm(),a=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=Js(n?.in||e,0);s.setFullYear(r+1,0,a),s.setHours(0,0,0,0);const o=Qd(s,n),l=Js(n?.in||e,0);l.setFullYear(r,0,a),l.setHours(0,0,0,0);const u=Qd(l,n);return+t>=+o?r+1:+t>=+u?r:r-1}function S6(e,n){const t=Hm(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=rI(e,n),a=Js(n?.in||e,0);return a.setFullYear(i,0,r),a.setHours(0,0,0,0),Qd(a,n)}function T6(e,n){const t=Ti(e,n?.in),r=+Qd(t,n)-+S6(t,n);return Math.round(r/XN)+1}function St(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const hs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return St(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):St(t+1,2)},d(e,n){return St(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return St(e.getHours()%12||12,n.length)},H(e,n){return St(e.getHours(),n.length)},m(e,n){return St(e.getMinutes(),n.length)},s(e,n){return St(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),i=Math.trunc(r*Math.pow(10,t-3));return St(i,n.length)}},Pl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kC={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),i=r>0?r:1-r;return t.ordinalNumber(i,{unit:"year"})}return hs.y(e,n)},Y:function(e,n,t,r){const i=rI(e,r),a=i>0?i:1-i;if(n==="YY"){const s=a%100;return St(s,2)}return n==="Yo"?t.ordinalNumber(a,{unit:"year"}):St(a,n.length)},R:function(e,n){const t=JN(e);return St(t,n.length)},u:function(e,n){const t=e.getFullYear();return St(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return St(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return St(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return hs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return St(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const i=T6(e,r);return n==="wo"?t.ordinalNumber(i,{unit:"week"}):St(i,n.length)},I:function(e,n,t){const r=C6(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):St(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):hs.d(e,n)},D:function(e,n,t){const r=E6(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):St(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const i=e.getDay(),a=(i-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(a);case"ee":return St(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const i=e.getDay(),a=(i-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(a);case"cc":return St(a,n.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),i=r===0?7:r;switch(n){case"i":return String(i);case"ii":return St(i,n.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const i=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let i;switch(r===12?i=Pl.noon:r===0?i=Pl.midnight:i=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let i;switch(r>=17?i=Pl.evening:r>=12?i=Pl.afternoon:r>=4?i=Pl.morning:i=Pl.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return hs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):hs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):St(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):St(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):hs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):hs.s(e,n)},S:function(e,n){return hs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return UC(r);case"XXXX":case"XX":return wo(r);case"XXXXX":case"XXX":default:return wo(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return UC(r);case"xxxx":case"xx":return wo(r);case"xxxxx":case"xxx":default:return wo(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+RC(r,":");case"OOOO":default:return"GMT"+wo(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+RC(r,":");case"zzzz":default:return"GMT"+wo(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return St(r,n.length)},T:function(e,n,t){return St(+e,n.length)}};function RC(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),a=r%60;return a===0?t+String(i):t+String(i)+n+St(a,2)}function UC(e,n){return e%60===0?(e>0?"-":"+")+St(Math.abs(e)/60,2):wo(e,n)}function wo(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),i=St(Math.trunc(r/60),2),a=St(r%60,2);return t+i+n+a}const LC=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},iI=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},w6=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],i=t[2];if(!i)return LC(e,n);let a;switch(r){case"P":a=n.dateTime({width:"short"});break;case"PP":a=n.dateTime({width:"medium"});break;case"PPP":a=n.dateTime({width:"long"});break;case"PPPP":default:a=n.dateTime({width:"full"});break}return a.replace("{{date}}",LC(r,n)).replace("{{time}}",iI(i,n))},A6={p:iI,P:w6},N6=/^D+$/,I6=/^Y+$/,M6=["D","DD","YY","YYYY"];function x6(e){return N6.test(e)}function O6(e){return I6.test(e)}function D6(e,n,t){const r=k6(e,n,t);if(console.warn(r),M6.includes(e))throw new RangeError(r)}function k6(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const R6=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,U6=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,L6=/^'([^]*?)'?$/,P6=/''/g,F6=/[a-zA-Z]/;function Xp(e,n,t){const r=Hm(),i=t?.locale??r.locale??nI,a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=Ti(e,t?.in);if(!H5(o))throw new RangeError("Invalid time value");let l=n.match(U6).map(c=>{const d=c[0];if(d==="p"||d==="P"){const h=A6[d];return h(c,i.formatLong)}return c}).join("").match(R6).map(c=>{if(c==="''")return{isToken:!1,value:"'"};const d=c[0];if(d==="'")return{isToken:!1,value:$6(c)};if(kC[d])return{isToken:!0,value:c};if(d.match(F6))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:c}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const u={firstWeekContainsDate:a,weekStartsOn:s,locale:i};return l.map(c=>{if(!c.isToken)return c.value;const d=c.value;(!t?.useAdditionalWeekYearTokens&&O6(d)||!t?.useAdditionalDayOfYearTokens&&x6(d))&&D6(d,n,String(e));const h=kC[d[0]];return h(o,d,i.localize,u)}).join("")}function $6(e){const n=e.match(L6);return n?n[1].replace(P6,"'"):e}function PC(e,n){const t=Ti(e,n?.in);return t.setSeconds(0,0),t}function FC(e,n){return+PC(e)==+PC(n)}var f0,Ar,$C=function(){function e(n){this.url=n.channel_url,this.lastMessageTs=n.last_message_ts}return e.payloadify=function(n){return{channel_url:n.url,last_message_ts:n.lastMessageTs}},e}(),zC=function(){function e(n){var t,r;this.type=n.type,this.ticketId=(t=n.ticket_id)!==null&&t!==void 0?t:void 0,this.timestamp=(r=n.timestamp)!==null&&r!==void 0?r:void 0}return e.payloadify=function(n){return W({type:n.type,ticket_id:n.ticketId,timestamp:n.timestamp})},e}(),HC=function(){function e(n){this.isResolved=n.is_resolved,this.determinedBy=n.determined_by}return e.payloadify=function(n){return{is_resolved:n.isResolved,determined_by:n.determinedBy}},e}();(function(e){e.DEFAULT="default",e.PROACTIVE="proactive"})(f0||(f0={})),function(e){e.OPEN="open",e.CLOSED="closed"}(Ar||(Ar={}));var $u=function(){function e(n){var t,r,i,a;this.id=n.id,this.type=n.conversation_type,this.status=n.status,this.channelInfo=new $C(n.channel),this.csat=(t=n.csat)!==null&&t!==void 0?t:void 0,this.csatReason=(r=n.csat_reason)!==null&&r!==void 0?r:void 0,this.csatExpireAt=(i=n.csat_expire_at)!==null&&i!==void 0?i:void 0,this.resolution=n.resolution?new HC(n.resolution):void 0,this.topics=(a=n.topics)!==null&&a!==void 0?a:[],this.handoff=n.handoff?new zC(n.handoff):void 0}return e.payloadify=function(n){return W(ae({id:n.id,conversation_type:n.type,status:n.status,channel:$C.payloadify(n.channelInfo),csat:n.csat,csat_reason:n.csatReason,csat_expire_at:n.csatExpireAt,resolution:n.resolution&&HC.payloadify(n.resolution),topics:n.topics,handoff:n.handoff&&zC.payloadify(n.handoff)}))},e}(),Kd,z6=function(e){function n(t){var r=t.aiAgentId,i=t.userId,a=t.language,s=t.country,o=t.context,l=t.forceCreateChannel,u=e.call(this)||this;return u.method=z.POST,u.path="".concat(Tm,"/ai_agents/").concat(encodeURIComponent(r),"/messenger_settings"),u.requireAuth=!1,u.params=W({user_id:i,country:s,language:a,context:o,force_create:l}),u}return T(n,e),n}(H),H6=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.settings=r,i}return T(n,e),n}(j),q6=function(e){function n(t){var r=this,i=t.token,a=t.limit,s=t.aiAgentId,o=t.status,l=t.reverse,u=t.order;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Tm,"/my_conversations"),r.params=W({token:i,limit:a,reverse:l,order:u,status:o,bot_userid:s}),r}return T(n,e),n}(H),B6=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.conversations=[];var a=r.next_token,s=r.conversations;return i.token=a,s&&s.length>0&&(i.conversations=s.map(function(o){return new $u(o)})),i}return T(n,e),n}(j),aI={limit:10},G6=function(e){function n(t){var r=this,i=t.limit,a=i===void 0?aI.limit:i,s=t.keys,o=t.token;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Tm,"/sdk_message_templates"),r.params=W({limit:a,keys:s,token:o}),r}return T(n,e),n}(H),V6=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.templates,s=r.template_list_token;return i.token=s,i.templates=a.map(function(o){return{template:JSON.stringify(o)}}),i}return T(n,e),n}(j),j6=function(e){function n(t){var r=this,i=t.key;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Tm,"/sdk_message_templates/").concat(i),r}return T(n,e),n}(H),Q6=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.template=JSON.stringify(r),i}return T(n,e),n}(j),qC={},sI=function(){function e(n,t){var r=t.sdkState,i=t.requestQueue,a=t.logger;this._iid=n,this._sdkState=r,this._requestQueue=i,this._logger=a,qC[n]=this}return e.of=function(n){return qC[n]},e.prototype.requestMessengerSettings=function(n){return g(this,void 0,void 0,function(){var t,r,i;return _(this,function(a){switch(a.label){case 0:return t=I.of(this._iid).requestQueue,r=new z6(n),[4,t.commandRouter.send(r)];case 1:return i=a.sent(),[2,i.as(H6).settings]}})})},e.prototype.getConversations=function(n,t,r){return g(this,void 0,void 0,function(){var i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return i=I.of(this._iid).requestQueue,a=new q6(N(N({},t),{token:n,limit:r})),[4,i.send(a)];case 1:return s=c.sent(),o=s.as(B6),l=o.conversations,u=o.token,[2,{conversations:l,token:u}]}})})},e.prototype.getMessageTemplates=function(n){return n===void 0&&(n={}),g(this,void 0,void 0,function(){var t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return t=n.keys,r=n.limit,i=new G6({keys:t,limit:r}),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(V6),o=s.templates,l=s.token,[2,{templates:o,token:l}]}})})},e.prototype.getMessageTemplate=function(n){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=new j6({key:n}),[4,this._requestQueue.send(t)];case 1:return r=i.sent(),[2,{template:r.as(Q6).template}]}})})},e}();(function(e){e.CREATED_AT="created_at",e.UPDATED_AT="updated_at"})(Kd||(Kd={}));var BC={reverse:!1,order:Kd.UPDATED_AT},K6=function(e){function n(t,r){var i,a,s,o,l=this;return(l=e.call(this,t,r)||this).status=(i=r.status)!==null&&i!==void 0?i:void 0,l.aiAgentId=(a=r.aiAgentId)!==null&&a!==void 0?a:void 0,l.reverse=(s=r.reverse)!==null&&s!==void 0?s:BC.reverse,l.order=(o=r.order)!==null&&o!==void 0?o:BC.order,l}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&be(Ar,this.status,!0)&&x("string",this.aiAgentId,!0)&&x("boolean",this.reverse)&&be(Kd,this.order)},n.prototype.serialize=function(){return Wu(this)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=sI.of(this._iid),this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,t.getConversations(this._token,ae(N({},this)),this.limit)]):[3,2]:[3,5];case 1:return r=s.sent(),i=r.conversations,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),W6=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.name="aiAgent",t}return T(n,e),n.prototype.init=function(t,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,o=r.requestQueue,l=r.logger,u=r.onlineDetector,c=r.cacheContext;e.prototype.init.call(this,t,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:o,logger:l,onlineDetector:u,cacheContext:c}),this._manager=new sI(t,{sdkState:i,requestQueue:o,logger:l})},n.prototype.requestMessengerSettings=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){return r=t.aiAgentId,i=t.userId,a=t.language,s=t.country,o=t.context,l=t.forceCreateChannel,B(x("string",r)&&x("string",i,!0)&&x("string",a,!0)&&x("string",s,!0)&&x("object",o,!0)&&x("boolean",l,!0)).throw(k.invalidParameters),[2,this._manager.requestMessengerSettings(t)]})})},n.prototype.createConversationListQuery=function(t){return t===void 0&&(t={}),new K6(this._iid,t)},n.prototype.getMessageTemplates=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},aI),t),B(function(a){return x("number",a.limit,!0)&&Te("string",a.keys,!0)}(r)).throw(k.invalidParameters),[2,this._manager.getMessageTemplates(t)]})})},n.prototype.getMessageTemplate=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(x("string",t)).throw(k.invalidParameters),[2,this._manager.getMessageTemplate(t)]})})},n}(xm),ie;(function(e){e.Box="box",e.Text="text",e.Image="image",e.TextButton="textButton",e.ImageButton="imageButton",e.Carousel="carouselView"})(ie||(ie={}));const Jp=(e,n)=>typeof n[e]!="string"?{}:{[e]:Y6(n[e])};function Y6(e){return e.startsWith("#")?e.length===9?`#${e.slice(3)}${e[1]}${e[2]}`:e.length===5?`#${e.slice(2)}${e[1]}`:e:e}const Og=e=>e?{viewStyle:Object.assign(Object.assign(Object.assign({},e),Jp("backgroundColor",e)),Jp("borderColor",e))}:{},Z6=e=>e?{textStyle:Object.assign(Object.assign({},e),Jp("color",e))}:{},X6=e=>e?{imageStyle:Object.assign(Object.assign({},e),Jp("tintColor",e))}:{},J6={run(e){return e.type===ie.Text||e.type===ie.TextButton?Object.assign(Object.assign(Object.assign({},e),Og(e.viewStyle)),Z6(e.textStyle)):e.type===ie.ImageButton||e.type===ie.Image?Object.assign(Object.assign(Object.assign({},e),Og(e.viewStyle)),X6(e.imageStyle)):Object.assign(Object.assign({},e),Og(e.viewStyle))}},Os=e=>typeof e=="string"?!Number.isNaN(Number(e)):typeof e=="number"&&!Number.isNaN(e),hl=(e,n)=>n[e]===void 0||n[e]===null?{}:Os(n[e])?{[e]:Number(n[e])}:{},GC=(e,n)=>n?{[e]:{left:Os(n.left)?Number(n.left):n.left,right:Os(n.right)?Number(n.right):n.right,top:Os(n.top)?Number(n.top):n.top,bottom:Os(n.bottom)?Number(n.bottom):n.bottom}}:{},VC=(e,n)=>n?{[e]:{type:n.type,value:Os(n.value)?Number(n.value):n.value}}:{},eP=e=>e?{metaData:{pixelWidth:Os(e.pixelWidth)?Number(e.pixelWidth):e.pixelWidth,pixelHeight:Os(e.pixelHeight)?Number(e.pixelHeight):e.pixelHeight}}:{},tP=e=>e?{viewStyle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),hl("borderWidth",e)),hl("radius",e)),GC("margin",e.margin)),GC("padding",e.padding))}:{},nP=e=>e?{textStyle:Object.assign(Object.assign(Object.assign({},e),hl("size",e)),hl("weight",e))}:{},rP=e=>e?{carouselStyle:Object.assign(Object.assign(Object.assign({},e),hl("spacing",e)),hl("maxChildWidth",e))}:{},qm=e=>Object.assign(Object.assign(Object.assign({},VC("width",e.width)),VC("height",e.height)),tP(e.viewStyle)),iP=e=>Object.assign(Object.assign(Object.assign({},qm(e)),nP(e.textStyle)),hl("maxTextLines",e)),aP=e=>Object.assign(Object.assign({},qm(e)),eP(e.metaData)),sP=e=>Object.assign(Object.assign(Object.assign({},qm(e)),rP(e.carouselStyle)),{items:e.items.map(n=>Object.assign(Object.assign({},n),{body:Object.assign(Object.assign({},n.body),{items:n.body.items.map(t=>oI.run(t))})}))}),oI={run(e){return e.type===ie.Text||e.type===ie.TextButton?Object.assign(Object.assign({},e),iP(e)):e.type===ie.ImageButton||e.type===ie.Image?Object.assign(Object.assign({},e),aP(e)):e.type===ie.Carousel?Object.assign(Object.assign({},e),sP(e)):Object.assign(Object.assign({},e),qm(e))}},oP=()=>{},lI=e=>{var n;const t=e?.defaultMapper||oP,r={defaultMapper:t,mapBoxProps:e?.mapBoxProps||t,mapTextProps:e?.mapTextProps||t,mapImageProps:e?.mapImageProps||t,mapTextButtonProps:e?.mapTextButtonProps||t,mapImageButtonProps:e?.mapImageButtonProps||t,mapCarouselProps:e?.mapCarouselProps||t},i=[J6,oI,...(n=e?.transforms)!==null&&n!==void 0?n:[]];return{setTransforms(a){i.length=0,i.push(...a)},addTransforms(a){i.push(...a)},parse(a,s){const o=i.reduce((l,u)=>u.run(l),a);switch(o.type){case ie.Box:return{transformed:o,properties:r.mapBoxProps(o,s)};case ie.Text:return{transformed:o,properties:r.mapTextProps(o,s)};case ie.Image:return{transformed:o,properties:r.mapImageProps(o,s)};case ie.TextButton:return{transformed:o,properties:r.mapTextButtonProps(o,s)};case ie.ImageButton:return{transformed:o,properties:r.mapImageButtonProps(o,s)};case ie.Carousel:return{transformed:o,properties:r.mapCarouselProps(o,s)};default:return{transformed:o,properties:void 0}}}}},Fl=({children:e})=>ye.createElement(ye.Fragment,null,e);function uI(e){var n,t,r,i,a,s;return{box:((n=e?.views)===null||n===void 0?void 0:n.box)||Fl,text:((t=e?.views)===null||t===void 0?void 0:t.text)||Fl,image:((r=e?.views)===null||r===void 0?void 0:r.image)||Fl,imageButton:((i=e?.views)===null||i===void 0?void 0:i.imageButton)||Fl,textButton:((a=e?.views)===null||a===void 0?void 0:a.textButton)||Fl,carouselView:((s=e?.views)===null||s===void 0?void 0:s.carouselView)||Fl}}var lP=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const cI=p.createContext({sizes:{},updateSize:()=>{}}),uP=({children:e})=>{const[n,t]=p.useState({}),r=p.useCallback(i=>{var{id:a}=i,s=lP(i,["id"]);a&&t(o=>Object.assign(Object.assign({},o),{[a]:s}))},[]);return ye.createElement(cI.Provider,{value:{sizes:n,updateSize:r}},e)},cP=()=>p.useContext(cI);var qe;(function(e){e.Row="row",e.Column="column"})(qe||(qe={}));var nt;(function(e){e.Center="center",e.Left="left",e.Right="right",e.Top="top",e.Bottom="bottom"})(nt||(nt={}));var ze;(function(e){e[e.FillParent=0]="FillParent",e[e.WrapContent=1]="WrapContent"})(ze||(ze={}));var vn;(function(e){e.Normal="normal",e.Bold="bold"})(vn||(vn={}));var Yn;(function(e){e.AspectFit="aspectFit",e.AspectFill="aspectFill",e.ScalesToFill="scalesToFill"})(Yn||(Yn={}));const dI=[1,2],df=e=>{switch(e){case nt.Right:case nt.Bottom:return"flex-end";case nt.Center:return"center";case nt.Left:case nt.Top:default:return"flex-start"}},dP=e=>e?dI.includes(Number(e)):!0,hP=e=>{const n=new Map,t=function(r){return(n.has(r)||n.set(r,e.call(this,r)))&&n.get(r)};return t.cache=n,t},fP=hP(e=>{const n=(t,r)=>{"items"in t&&t?.items!=null&&t.items.forEach((i,a)=>{const s=`${r}-${a}`;i.id=s,n(i,s)})};return e.forEach((t,r)=>{const i=`${r}`;t.id=i,n(t,i)}),e}),Qr={rootLayout:qe.Column,view:{size:{width:{type:"flex",value:ze.FillParent},height:{type:"flex",value:ze.WrapContent}}},box:{layout:qe.Row,align:{vertical:nt.Top,horizontal:nt.Left}},textButton:{maxTextLines:1},carousel:{style:{spacing:10,maxChildWidth:240}}},hI=e=>{const n=e.Container||ye.Fragment,t=e.UnknownMessage||(()=>null),r=e.parser||lI(),i=e.renderer||uI(),a=({templateItems:s,templateVersion:o,parentLayout:l=Qr.box.layout,depth:u=0})=>{if(!dP(o))throw new Error(`Cannot parse template item due to unsupported template version: ${o}, ${dI}`);return ye.createElement(ye.Fragment,null,s.map((c,d,h)=>{const f=r.parse(c,{parentLayout:l,depth:u,elemIdx:d,siblings:h}),m=f.transformed,y={key:d,siblings:h,parentLayout:l,parsedProperties:f.properties,rawProperties:c};switch(m.type){case ie.Carousel:{if(!Array.isArray(m.items)||m.items.length===0)throw new Error("Cannot parse template item as Carousel if carousel has no items.");return ye.createElement(i.carouselView,Object.assign({},m,y),m.items.map((C,b)=>ye.createElement(a,{key:b,templateItems:C.body.items||[],depth:u+1,templateVersion:C.version})))}case ie.Box:return ye.createElement(i.box,Object.assign({},m,y),ye.createElement(a,{templateItems:m.items||[],parentLayout:m.layout,depth:u+1,templateVersion:o}));case ie.Text:return ye.createElement(i.text,Object.assign({},m,y));case ie.Image:return ye.createElement(i.image,Object.assign({},m,y));case ie.TextButton:return ye.createElement(i.textButton,Object.assign({},m,y));case ie.ImageButton:return ye.createElement(i.imageButton,Object.assign({},m,y));default:return ye.createElement(t,{item:m})}}))};return{MessageTemplate:({templateVersion:s,templateItems:o,parentLayout:l=Qr.rootLayout})=>{const u=fP(o);return ye.createElement(uP,null,ye.createElement(n,{className:"sb-message-template__parent"},ye.createElement(a,{isRoot:!0,parentLayout:l,templateItems:u,templateVersion:s})))},MessageTemplateBase:a}};var Br;(function(e){e.Web="web",e.Custom="custom",e.UIKit="uikit"})(Br||(Br={}));ie.Image,Br.Web,Yn.AspectFill,ie.Box,qe.Column,ze.FillParent,ie.Box,ze.FillParent,ze.FillParent,ie.Box,qe.Column,ze.FillParent,ze.WrapContent,ie.Text,nt.Center,nt.Center,ze.FillParent,ie.Image,Br.Web,ze.FillParent,Yn.AspectFill,ie.Box,ze.FillParent,ie.Box,ze.FillParent,ze.FillParent,ie.Box,qe.Column,ie.Box,nt.Left,nt.Center,qe.Row,ze.FillParent,ie.Text,ze.FillParent,nt.Center,nt.Left,vn.Bold,ie.ImageButton,Br.UIKit,Yn.AspectFit,ie.Text,ie.TextButton,Br.Web,vn.Bold;ie.Image,Br.Web,Yn.AspectFill,ie.Box,qe.Column,ze.FillParent,ie.Box,ze.FillParent,qe.Row,ie.TextButton,Br.Web,vn.Bold,ie.TextButton,Br.Web,ze.FillParent,vn.Bold,ie.Box,ze.FillParent,qe.Row,ie.Text,ze.FillParent,vn.Bold,ie.ImageButton,Br.UIKit,Yn.AspectFit,ie.Text;ie.Box,qe.Column,ie.Image,Yn.AspectFill,ie.Box,qe.Column,ie.Text,vn.Bold,ie.Text,ie.Box,nt.Left,nt.Center,qe.Row,ie.Image,Yn.AspectFill,ie.Box,nt.Left,nt.Center,qe.Column,ie.Text,vn.Bold,ie.Text,vn.Bold,ie.Box,nt.Left,nt.Center,qe.Row,ie.Image,Yn.AspectFill,ie.Box,nt.Left,nt.Center,qe.Column,ie.Text,vn.Bold,ie.Text,vn.Bold,ie.Box,nt.Left,nt.Center,qe.Row,ie.Image,Yn.AspectFill,ie.Box,nt.Left,nt.Center,qe.Column,ie.Text,vn.Bold,ie.Text,vn.Bold,ie.Box,nt.Left,nt.Center,qe.Row,ie.TextButton,Br.Web,vn.Bold,ie.TextButton,Br.Web,vn.Bold;ie.Box,qe.Column,ie.Image,ie.Box,qe.Column,ie.Box,qe.Row,ie.Box,qe.Column,ie.Text,vn.Bold,ie.Text,ie.ImageButton,Br.UIKit,ie.Box,qe.Column,ie.Box,nt.Left,nt.Center,qe.Row,ie.Image,Yn.AspectFill,ie.Box,qe.Column,ie.Text,vn.Bold,ie.Text,ie.Box,nt.Left,nt.Center,qe.Row,ie.Image,Yn.AspectFill,ie.Box,qe.Column,ie.Text,vn.Bold,ie.Text;ze.FillParent,ze.FillParent,ze.FillParent,ze.FillParent,ze.FillParent,ze.FillParent;ze.FillParent,ze.WrapContent,ze.FillParent,ze.FillParent;function pP(e){var n;return e.type===ie.Text&&((n=e.width)===null||n===void 0?void 0:n.value)==ze.WrapContent}const jC=({size:e,option:n})=>n==="wrap"?e.type==="flex"&&e.value==ze.WrapContent:n==="fill"?e.type==="flex"&&e.value==ze.FillParent:e.type==="fixed",mP=e=>{var n;return typeof e!="string"?!1:((n=e.split(".").pop())===null||n===void 0?void 0:n.toLowerCase())==="gif"},bs=(...e)=>e.filter(n=>!!n).join(" "),_P=(e="")=>["http://","https://","ftp://"].some(n=>e.startsWith(n)),QC=(e="")=>_P(e)?e:`https://${e}`;function $l(e){return Object.assign({display:"flex",overflow:"hidden",boxSizing:"border-box"},e)}function zl(e,n,t){bP(e,n,t),vP(e,n)}function gP(e,n,t,r){n&&(e["--border-width"]=`${n}px`,e["--border-color"]=t||"transparent"),r&&(e.borderRadius=r,e["--border-radius"]=`${r}px`)}function vP(e,n){var t,r,i,a,s,o,l,u;const{viewStyle:c}=n;e.marginBlockStart=(t=c?.margin)===null||t===void 0?void 0:t.top,e.marginBlockEnd=(r=c?.margin)===null||r===void 0?void 0:r.bottom,e.marginInlineStart=(i=c?.margin)===null||i===void 0?void 0:i.left,e.marginInlineEnd=(a=c?.margin)===null||a===void 0?void 0:a.right;const d=((o=(s=c?.margin)===null||s===void 0?void 0:s.left)!==null&&o!==void 0?o:0)+((u=(l=c?.margin)===null||l===void 0?void 0:l.right)!==null&&u!==void 0?u:0);d>0&&e.width==="100%"&&(e.width=`calc(100% - ${d}px)`),c?.backgroundColor&&(e.backgroundColor=c.backgroundColor),c?.backgroundImageUrl&&(e.backgroundImage=`url(${JSON.stringify(c.backgroundImageUrl)})`,e.backgroundSize="100% 100%",e.backgroundPosition="center"),gP(e,c?.borderWidth,c?.borderColor,c?.radius)}function yP(e,n,t){const r={};return e.type==="flex"&&e.value==ze.FillParent?(r.width="100%",t===qe.Row&&(r.flex=1)):e.type==="flex"&&e.value==ze.WrapContent?(r.width="fit-content",t===qe.Row&&(r.flexShrink=0)):e.type==="fixed"&&e.value>=0&&(r.width=e.value,t===qe.Row&&(r.flexShrink=0)),n.type==="flex"&&n.value==ze.FillParent?(r.height="100%",t===qe.Column&&(r.flex=1)):n.type==="flex"&&n.value==ze.WrapContent?(r.height="fit-content",t===qe.Column&&(r.flexShrink=0)):n.type==="fixed"&&n.value>=0&&(r.height=n.value,t===qe.Column&&(r.flexShrink=0)),r}function bP(e,n,t){var r,i;const{width:a,height:s}=Qr.view.size,{parentLayout:o}=t,l=yP((r=n.width)!==null&&r!==void 0?r:a,(i=n.height)!==null&&i!==void 0?i:s,o);Object.assign(e,l)}function KC(e,n=Qr.box.layout,t=Qr.box.align){n===qe.Row&&(e.flexDirection="row",e.alignItems=df(t.vertical),e.justifyContent=df(t.horizontal)),n===qe.Column&&(e.flexDirection="column",e.alignItems=df(t.horizontal),e.justifyContent=df(t.vertical))}function EP(e,n=Qr.box.align.horizontal){switch(n){case nt.Left:e.textAlign="start";break;case nt.Right:e.textAlign="end";break;case nt.Center:e.textAlign="center";break;default:e.textAlign="start";break}}function WC(e,n){const{contentMode:t=Yn.AspectFit}=n||{};if(t)switch(t){case Yn.AspectFill:e.objectFit="cover";break;case Yn.AspectFit:e.objectFit="contain";break;case Yn.ScalesToFill:e.objectFit="fill";break}}function YC(e,n){var t,r,i,a;const s=n?.metaData;!s?.pixelHeight||!s?.pixelWidth||((t=n?.width)===null||t===void 0?void 0:t.type)==="fixed"||((r=n?.height)===null||r===void 0?void 0:r.type)==="fixed"||(e.aspectRatio=`${(i=n?.metaData)===null||i===void 0?void 0:i.pixelWidth} / ${(a=n?.metaData)===null||a===void 0?void 0:a.pixelHeight}`)}function ZC(e){return{WebkitLineClamp:e,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden",overflowWrap:"anywhere",flex:1}}function XC(e,n,t){const{textStyle:r,width:i}=n,{size:a,color:s,weight:o}=r||{};if(a&&(e.fontSize=a),s&&(e.color=s),o&&(e.fontWeight=o),i?.type==="flex"&&i?.value==ze.WrapContent&&(e.width="fit-content",e.maxWidth="100%"),n.type===ie.Text){const{siblings:l,elemIdx:u}=t;l!=null&&l.length>=2&&l.every(pP)&&(e.flexShrink=l.length-1===u?1:0)}}const fI=lI({mapBoxProps(e,n){const t=$l();return zl(t,e,n),KC(t,e.layout,e.align),t},mapTextProps(e,n){var t;const r=$l({whiteSpace:"pre-line",wordBreak:"break-word"});return zl(r,e,n),XC(r,e,n),KC(r,qe.Row,e.align),EP(r,(t=e.align)===null||t===void 0?void 0:t.horizontal),r},mapImageProps(e,n){const t=$l();return zl(t,e,n),WC(t,e.imageStyle),YC(t,e),t},mapTextButtonProps(e,n){const t=$l({whiteSpace:"pre-line",alignItems:"center",justifyContent:"center"});return zl(t,e,n),XC(t,e,n),t},mapImageButtonProps(e,n){const t=$l();return zl(t,e,n),WC(t,e.imageStyle),YC(t,e),t},mapCarouselProps(e,n){var t,r,i,a,s,o,l,u;const c=$l();return zl(c,e,n),c.paddingBlockStart=(r=(t=e.viewStyle)===null||t===void 0?void 0:t.padding)===null||r===void 0?void 0:r.top,c.paddingBlockEnd=(a=(i=e.viewStyle)===null||i===void 0?void 0:i.padding)===null||a===void 0?void 0:a.bottom,c.paddingInlineStart=(o=(s=e.viewStyle)===null||s===void 0?void 0:s.padding)===null||o===void 0?void 0:o.left,c.paddingInlineEnd=(u=(l=e.viewStyle)===null||l===void 0?void 0:l.padding)===null||u===void 0?void 0:u.right,c}}),CP=24,JC=5;function SP({spacing:e,childrenLength:n,paddingInlineStart:t,paddingInlineEnd:r}){const i=p.useRef(null),a=p.useRef(Array.from({length:n},()=>ye.createRef())),s=p.useRef(!1),o=p.useRef(!1),l=p.useRef(null),u=p.useRef({sx:null,sy:null,offset:0,translateX:0,currentIndex:0,didMove:!1}),[c,d]=p.useState(()=>a.current.map(()=>0)),[h,f]=p.useState(!1),m=h?-1:1,y=p.useMemo(()=>{let Z=t;return c.map((X,se)=>{const Ce=se>0?e:0,Me=Z-Ce,Ue=Me-X;return Z=Ue,{start:Me,end:Ue}})},[c,e,t]),C=p.useMemo(()=>{const Z=c.reduce((se,Ce)=>se+Ce,0),X=e*(n-1);return Z+X},[c,e,n]);p.useLayoutEffect(()=>{if(i.current){const Z=getComputedStyle(i.current).direction;f(Z==="rtl")}},[]),p.useLayoutEffect(()=>{d(a.current.map(Z=>{var X,se;return(se=(X=Z.current)===null||X===void 0?void 0:X.clientWidth)!==null&&se!==void 0?se:0}))},[n]),p.useLayoutEffect(()=>{y.length>0&&(u.current.translateX=y[0].start,A())},[y]);const b=()=>{i.current&&(s.current=!0,i.current.style.cursor="grabbing",i.current.style.transition="none",l.current=requestAnimationFrame(A))},v=()=>{i.current&&(s.current=!1,i.current.style.cursor="grab",i.current.style.transition="transform 0.5s ease",l.current&&(cancelAnimationFrame(l.current),l.current=null))},E=()=>{const{offset:Z,currentIndex:X}=u.current,se=Math.abs(Z)>=CP,Ce=Z<0&&X<n-1,Me=Z>0&&X>0;let Ue=X;se&&Ce?Ue=X+1:se&&Me&&(Ue=X-1);function Le(ot){var pe,lt;const an=(lt=(pe=i.current)===null||pe===void 0?void 0:pe.clientWidth)!==null&&lt!==void 0?lt:0,oe=t,le=Math.min(0,an-C)-r;return Math.min(oe,Math.max(ot,le))}u.current.currentIndex=Ue,u.current.translateX=Le(y[Ue].start),u.current.offset=0},S=()=>{o.current=!0},w=()=>{o.current=!1},A=()=>{if(i.current){const Z=(u.current.translateX+u.current.offset)*m;i.current.style.transform=`translateX(${Z}px)`}l.current&&(l.current=requestAnimationFrame(A))},D=()=>{i.current&&(i.current.style.touchAction="pan-x")},O=()=>{i.current&&(i.current.style.touchAction="pan-y")};return{carouselRef:i,childrenRefs:a,handlers:{onMouseDown:Z=>{b(),w(),u.current.sx=Z.clientX,u.current.sy=Z.clientY,u.current.offset=0,u.current.didMove=!1,l.current=requestAnimationFrame(A)},onMouseMove:Z=>{!s.current||u.current.sx===null||(u.current.offset=(Z.clientX-u.current.sx)*m,Math.abs(u.current.offset)>JC&&(u.current.didMove=!0))},onMouseUp:Z=>{s.current&&(w(),E(),v(),u.current.didMove&&(Z.preventDefault(),Z.stopPropagation()))},onMouseLeave:Z=>{s.current&&(w(),E(),v(),u.current.didMove&&(Z.preventDefault(),Z.stopPropagation()))},onTouchStart:Z=>{w(),v();const X=Z.touches[0];u.current.sx=X.clientX,u.current.sy=X.clientY,u.current.offset=0,u.current.didMove=!1,l.current=requestAnimationFrame(A)},onTouchMove:Z=>{if(u.current.sx===null||u.current.sy===null||o.current)return;const{clientX:X,clientY:se}=Z.touches[0],{sx:Ce,sy:Me}=u.current;if(s.current){u.current.offset=(X-Ce)*m,Math.abs(u.current.offset)>JC&&(u.current.didMove=!0);return}Math.abs(se-Me)>Math.abs(X-Ce)?S():(u.current.offset=(X-Ce)*m,D(),b())},onTouchEnd:Z=>{O(),w(),E(),v(),u.current.didMove&&(Z.preventDefault(),Z.stopPropagation())},onClickCapture:Z=>{u.current.didMove&&(Z.preventDefault(),Z.stopPropagation())}}}}var eS=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const TP=e=>{var{children:n,style:t,spacing:r=Qr.carousel.style.spacing,maxChildWidth:i=Qr.carousel.style.maxChildWidth,inlineStyle:a}=e,s=eS(e,["children","style","spacing","maxChildWidth","inlineStyle"]);const o=t??{},{paddingInlineStart:l=0,paddingInlineEnd:u=0}=o,c=eS(o,["paddingInlineStart","paddingInlineEnd"]),{carouselRef:d,childrenRefs:h,handlers:f}=SP({spacing:r,childrenLength:n.length,paddingInlineStart:Number(l),paddingInlineEnd:Number(u)});return ye.createElement("div",Object.assign({},f,{ref:d,style:Object.assign(Object.assign(Object.assign({},c),{gap:r,width:"100%",overflow:"visible"}),a)},s),n.map((m,y)=>ye.createElement(wP,{ref:h.current[y],key:y,maxChildWidth:i},m)))},wP=ye.forwardRef(function({maxChildWidth:n,children:t},r){const i=AP(t.props,n)?n:"fit-content";return ye.createElement("div",{ref:r,style:{maxWidth:i,width:"100%",flexShrink:0,overflow:"hidden",userSelect:"none"}},t)});function AP(e,n){return!!e.templateItems.find(t=>{var r;const i=(r=t.width)!==null&&r!==void 0?r:Qr.view.size.width,a=i.type==="flex"&&i.value===ze.FillParent,s=i.type==="fixed"&&i.value>=n;return a||s})}var NP=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const IP=e=>{const{imageSize:n,canvasRef:t,canvasProps:r}=MP(e);return ye.createElement("canvas",Object.assign({},r,{ref:t,width:n?.width,height:n?.height,onError:e.onError}))},MP=e=>{var{metaData:n,tintColor:t}=e,r=NP(e,["metaData","tintColor"]);const i=p.useRef(null),[a,s]=p.useState(),o=p.useMemo(()=>n?.pixelHeight&&n?.pixelWidth?{width:n.pixelWidth,height:n.pixelHeight}:a,[a,n?.pixelHeight,n?.pixelWidth]);return p.useEffect(()=>{if(o==null&&i.current){i.current.style.width="100%",i.current.style.height="100%";const l=i.current.getBoundingClientRect();s(l)}},[o]),p.useEffect(()=>{if(r.src){const l=new Image,u=()=>{if(i.current&&t&&o){const d=i.current.getContext("2d");if(d){const{width:h,height:f}=o;d.clearRect(0,0,h,f),d.beginPath(),d.globalCompositeOperation="source-over",d.fillStyle="#000",d.drawImage(l,0,0,h,f),d.globalCompositeOperation="source-atop",d.fillStyle=t,d.fillRect(0,0,h,f)}}},c=d=>{var h;(h=r.onError)===null||h===void 0||h.call(r,d)};return l.addEventListener("load",u),l.addEventListener("error",c),l.src=r.src,()=>{l.removeEventListener("load",u),l.removeEventListener("error",c)}}},[r.src,o,t]),{canvasRef:i,canvasProps:r,imageSize:o}},xP=e=>ye.createElement("img",Object.assign({},e,{onError:e.onError,draggable:!1,referrerPolicy:"no-referrer"})),OP=e=>ye.createElement("div",{style:Object.assign(Object.assign({},e.style),{backgroundColor:"transparent"})});var DP=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const tS=e=>{var{tintColor:n,metaData:t}=e,r=DP(e,["tintColor","metaData"]);const{hasError:i,onError:a}=kP(r.src);return r.onError&&console.warn("`onError` is intercepted and not executed in the ReactMessageTemplateImage."),i?ye.createElement(OP,Object.assign({},r)):n&&!mP(r.src)?ye.createElement(IP,Object.assign({},r,{onError:a,tintColor:n,metaData:t})):ye.createElement(xP,Object.assign({},r,{onError:a}))},kP=e=>{const[n,t]=p.useState(!1);return p.useEffect(()=>t(!1),[e]),{hasError:n,onError:p.useCallback(()=>t(!0),[])}},pI=ye.createContext(null),RP=({message:e,handleWebAction:n,handleCustomAction:t,handlePredefinedAction:r,highlight:i,children:a})=>{const s=ye.useMemo(()=>({message:e,handleWebAction:n,handleCustomAction:t,handlePredefinedAction:r,highlight:i}),[e?.updatedAt,i?.getContainerClassName,i?.getContainerInlineStyle,i?.renderText]);return ye.createElement(pI.Provider,{value:s},a)},mI=()=>{const e=ye.useContext(pI);if(!e)throw new Error("useMessageContext must be used within a MessageProvider");return e};function Hl(e){const{highlight:n}=mI();return{className:n?.getContainerClassName?n.getContainerClassName(e):void 0,style:n?.getContainerInlineStyle?n.getContainerInlineStyle(e):void 0,renderText:n?.renderText?n.renderText:t=>t}}function _I(e){const n=p.useRef(e);return p.useEffect(()=>{n.current=e},[e]),p.useCallback((...t)=>n.current(...t),[n])}function UP(e,n){const t=_I(e),r=p.useRef(nS);return p.useCallback(a=>{if(r.current(),r.current=nS,a!=null){const s=e(a);typeof s=="function"&&(r.current=s)}},[t,...n])}function nS(){}function LP(e){const n=_I(e);return UP(r=>{const i=new ResizeObserver(a=>{a[0]!=null&&n(a[0])});return i.observe(r),()=>{i.unobserve(r)}},[n])}function PP(){const[e,n]=p.useState(-1),[t,r]=p.useState(-1),[i,a]=p.useState(-1),[s,o]=p.useState(-1),[l,u]=p.useState(-1),[c,d]=p.useState(-1);return{ref:LP(f=>{const{width:m,height:y}=f.contentRect,C=f.target,{width:b,height:v}=C.getBoundingClientRect();n(b),r(v),a(m),o(y),u(b-m),d(v-y)}),width:e,height:t,contentWidth:i,contentHeight:s,paddingWidth:l,paddingHeight:c}}var FP=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};function hf({width:e=Qr.view.size.width,height:n=Qr.view.size.height,parentLayout:t=Qr.box.layout,option:r}){return t===qe.Row?jC({size:e,option:r}):jC({size:n,option:r})}function $P(e){const{style:n,props:t}=e,r=PP(),{ref:i}=r,a=FP(r,["ref"]),{updateSize:s,sizes:o}=cP(),{id:l,siblings:u,parentLayout:c}=t,{width:d,height:h,paddingWidth:f,paddingHeight:m,contentWidth:y,contentHeight:C}=a;return p.useEffect(()=>{s({id:t.id,width:d,height:h,paddingWidth:f,paddingHeight:m,contentWidth:y,contentHeight:C})},[t.id,d,h,f,m,y,C,s]),{recalculatedStyle:p.useMemo(()=>{const v=(S=0,w)=>{var A,D,O,M;return c===qe.Row?S+((D=(A=o[w.id])===null||A===void 0?void 0:A.contentWidth)!==null&&D!==void 0?D:0):S+((M=(O=o[w.id])===null||O===void 0?void 0:O.contentHeight)!==null&&M!==void 0?M:0)};if(hf({width:t.width,height:t.height,parentLayout:c,option:"fill"})){const S=u.filter(({width:D,height:O})=>!hf({width:D,height:O,parentLayout:c,option:"fill"})).reduce(v,0),w=u.filter(({width:D,height:O})=>hf({width:D,height:O,parentLayout:c,option:"fill"})).length,A=c===qe.Row?{maxWidth:`calc((100% - ${S}px) / ${w})`}:{maxHeight:`calc((100% - ${S}px) / ${w})`};return Object.assign(Object.assign(Object.assign({},n),A),d==0&&{height:0})}else{const S=u.findIndex(A=>A.id===l),w=u.slice(0,S).filter(({width:A,height:D})=>hf({width:A,height:D,parentLayout:c,option:"wrap"})).reduce(v,0);return Object.assign(Object.assign(Object.assign({},n),d===0&&{height:0}),c===qe.Row?{maxWidth:`calc(100% - ${w}px)`}:{maxHeight:`calc(100% - ${w}px)`})}},[t.width,t.height,c,o,u,n,d,l]),elemRef:i}}var zP=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const bc=({children:e,props:n,className:t,style:r,inlineStyle:i})=>{var a,s,o,l,u,c,d,h,f;const{recalculatedStyle:m,elemRef:y}=$P({style:r,props:n}),{message:C,handleWebAction:b,handleCustomAction:v,handlePredefinedAction:E}=mI(),S=!((a=n.viewStyle)===null||a===void 0)&&a.borderWidth?"sb-message-template__border":"",w=n.action?"sb-message-template__action":"",A={paddingBlockStart:(o=(s=n.viewStyle)===null||s===void 0?void 0:s.padding)===null||o===void 0?void 0:o.top,paddingBlockEnd:(u=(l=n.viewStyle)===null||l===void 0?void 0:l.padding)===null||u===void 0?void 0:u.bottom,paddingInlineStart:(d=(c=n.viewStyle)===null||c===void 0?void 0:c.padding)===null||d===void 0?void 0:d.left,paddingInlineEnd:(f=(h=n.viewStyle)===null||h===void 0?void 0:h.padding)===null||f===void 0?void 0:f.right},D=ee=>{var ve,Q,Z,X,se,Ce,Me;((ve=n.action)===null||ve===void 0?void 0:ve.type)==="web"?b?b(ee,n.action,C):(Z=window?.open(QC((Q=n?.action)===null||Q===void 0?void 0:Q.data),"_blank","noopener noreferrer"))===null||Z===void 0||Z.focus():((X=n.action)===null||X===void 0?void 0:X.type)==="custom"?v?v(ee,n.action,C):(Ce=window?.open(QC((se=n?.action)===null||se===void 0?void 0:se.data),"_blank","noopener noreferrer"))===null||Ce===void 0||Ce.focus():((Me=n.action)===null||Me===void 0?void 0:Me.type)==="uikit"&&E?.(ee,n.action,C)};if(n.type===ie.TextButton)return ye.createElement("button",{className:bs(t,S,w),"data-sb-template-id":n.elementId,style:Object.assign(Object.assign(Object.assign({},r),A),i),onClick:D},e);const{display:O,flexDirection:M,justifyContent:F,alignItems:U,objectFit:$}=m,J=zP(m,["display","flexDirection","justifyContent","alignItems","objectFit"]);return ye.createElement("div",{ref:y,className:bs(t,S,w),"data-sb-template-id":n.elementId,style:Object.assign(Object.assign({},J),i),onClick:D},ye.createElement("div",{style:Object.assign({display:O,flexDirection:M,justifyContent:F,alignItems:U,objectFit:$,width:"100%",height:"100%"},A)},e))},gI=uI({views:{box(e){const n=Hl(e.rawProperties);return ye.createElement(bc,{className:bs("sb-message-template__box",n.className),inlineStyle:n.style,elementId:e.elementId,style:e.parsedProperties,props:e},e.children)},text(e){const n=Hl(e.rawProperties);return ye.createElement(bc,{className:bs("sb-message-template__text",n.className),inlineStyle:n.style,elementId:e.elementId,style:e.parsedProperties,props:e},rS(e,n.renderText))},image(e){var n;const t=Hl(e.rawProperties);return ye.createElement(bc,{className:bs("sb-message-template__image-container",t.className),inlineStyle:t.style,elementId:e.elementId,style:e.parsedProperties,props:e},ye.createElement(tS,{className:"sb-message-template__image",alt:"image",src:e.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(n=e.imageStyle)===null||n===void 0?void 0:n.tintColor,metaData:e.metaData}))},textButton(e){const n=Hl(e.rawProperties);return ye.createElement(bc,{className:bs("sb-message-template__text-button",n.className),inlineStyle:n.style,elementId:e.elementId,style:e.parsedProperties,props:e},rS(Object.assign({maxTextLines:Qr.textButton.maxTextLines},e),n.renderText))},imageButton(e){var n;const t=Hl(e.rawProperties);return ye.createElement(bc,{className:bs("sb-message-template__image-container","sb-message-template__image-button",t.className),inlineStyle:t.style,elementId:e.elementId,style:e.parsedProperties,props:e},ye.createElement(tS,{className:"sb-message-template__image",alt:"image-button",src:e.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(n=e.imageStyle)===null||n===void 0?void 0:n.tintColor,metaData:e.metaData}))},carouselView(e){var n,t;const r=Hl(e.rawProperties);return ye.createElement(TP,{className:bs("sb-message-template__carousel",r.className),inlineStyle:r.style,maxChildWidth:(n=e.carouselStyle)===null||n===void 0?void 0:n.maxChildWidth,spacing:(t=e.carouselStyle)===null||t===void 0?void 0:t.spacing,style:e.parsedProperties},e.children)}}});function HP(e,n){return e.split(`
`).map((t,r)=>ye.createElement(ye.Fragment,{key:r},n(t),ye.createElement("br",null)))}function rS(e,n){const{text:t,maxTextLines:r}=e,i=qP(e),a=typeof r=="number"&&r>0,s=HP(t,n);if(a||i){const o=Object.assign(Object.assign({},(a||i)&&{maxWidth:"100%"}),i&&{maxHeight:"100%",overflow:"hidden"});return ye.createElement("div",{style:o},a?ye.createElement("div",{style:ZC(r)},s):s)}return a?ye.createElement("div",{style:ZC(r)},s):s}function qP(e){var n,t,r,i;const a=(n=e?.height)===null||n===void 0?void 0:n.type,s=(t=e?.width)===null||t===void 0?void 0:t.type,o=a==="fixed"||s==="fixed",l=a==="flex"&&((r=e?.height)===null||r===void 0?void 0:r.value)===ze.FillParent||s==="flex"&&((i=e?.width)===null||i===void 0?void 0:i.value)===ze.FillParent;return o||l}hI({renderer:gI,parser:fI,Container:({children:e,className:n})=>ye.createElement("div",{className:`sb-message-template__parent ${n}`,style:{display:"flex",flexDirection:"column",maxWidth:400,marginBlockEnd:24}},e)});var Ht;(function(e){e[e.NONE=0]="NONE",e[e.CHANNEL_ENTER=10102]="CHANNEL_ENTER",e[e.CHANNEL_EXIT=10103]="CHANNEL_EXIT",e[e.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",e[e.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",e[e.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",e[e.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",e[e.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",e[e.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",e[e.TYPING_START=10900]="TYPING_START",e[e.TYPING_END=10901]="TYPING_END",e[e.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",e[e.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",e[e.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",e[e.CHANNEL_INVITE=10020]="CHANNEL_INVITE",e[e.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",e[e.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",e[e.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",e[e.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",e[e.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",e[e.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",e[e.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",e[e.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",e[e.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED"})(Ht||(Ht={}));var BP=function(){function e(n){var t;this.channelUrl=n.channel_url,this.channelType=n.channel_type,this.category=n.cat,this.data=(t=n.data)!==null&&t!==void 0?t:{},this.ts=n.ts}return Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===Pe.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===Pe.OPEN},enumerable:!1,configurable:!0}),e}(),Zu=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.event=new BP(i),a}return T(n,e),n}(pt),GP=function(e){function n(t,r,i){var a=e.call(this,t,r,i)||this,s=i.data.operators,o=s===void 0?[]:s;return a.operators=o.map(function(l){return new xe(a._iid,l)}),a}return T(n,e),n}(Zu),VP=function(e){function n(t,r,i){var a,s=this;return(s=e.call(this,t,"SYEV",i)||this).pinnedMessageIds=[],s.latestPinnedMessage=null,s.ts=0,i.data&&(s.pinnedMessageIds=(a=i.data.pinned_message_ids)!==null&&a!==void 0?a:[],s.latestPinnedMessage=i.data.latest_pinned_message?Zn(t,N({},i.data.latest_pinned_message)):null),s.ts=i.ts,s}return T(n,e),n}(pt),jP=function(e){function n(t,r){var i=e.call(this,t)||this;return i._logger=r.logger,i._sdkState=r.sdkState,i._sessionManager=r.sessionManager,i._requestQueue=r.requestQueue,i._dispatcher=r.dispatcher,i._cacheContext=r.cacheContext,i._channelType=r.channelType,i}return T(n,e),Object.defineProperty(n.prototype,"_messageBroadcast",{get:function(){return _N.of(this._iid)},enumerable:!1,configurable:!0}),n.prototype.subscribeMessageEvent=function(t,r){this._messageBroadcast.subscribe(t,r)},n.prototype.unsubscribeMessageEvent=function(t){this._messageBroadcast.unsubscribe(t)},n.prototype.getMessageFromCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2,null]})})},n.prototype.getExactlyMatchingMessagesForTokenFromCache=function(t,r,i){return g(this,void 0,void 0,function(){return _(this,function(a){return[2,[]]})})},n.prototype.getMessagesFromCache=function(t,r,i,a,s,o){return g(this,void 0,void 0,function(){return _(this,function(l){return[2,[]]})})},n.prototype.getPollMessagesFromCache=function(t,r,i,a){return g(this,void 0,void 0,function(){return _(this,function(s){return[2,[]]})})},n.prototype.getCachedMessageCountBetween=function(t,r,i,a){return g(this,void 0,void 0,function(){return _(this,function(s){return[2,0]})})},n.prototype.getUnsentMessagesFromCache=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){return[2,[]]})})},n.prototype.removeFailedMessageFromCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return[2]})})},n}(Wt),QP=function(e){function n(t,r,i){var a,s,o,l,u=this;(u=e.call(this,t,"ADMM",i)||this).message=new ol(t,i);var c=I.of(t).sdkState;return u.isMentioned=Iu(u.message.mentionType,(o=(a=u.message.mentionedUserIds)!==null&&a!==void 0?a:(s=u.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(d){return d.userId}))!==null&&o!==void 0?o:[],c.userId),u.forceUpdateLastMessage=(l=i.force_update_last_message)!==null&&l!==void 0&&l,u}return T(n,e),n}(pt),KP=function(e){function n(t,r,i){var a,s,o,l,u,c=this;(c=e.call(this,t,"AEDI",i)||this).message=new ol(t,i);var d=I.of(t).sdkState;return c.mentionCountChange=Cy({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(o=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&o!==void 0?o:[]},ae({mentionType:c.message.mentionType,mentionedUserIds:(l=c.message.mentionedUserIds)!==null&&l!==void 0?l:(u=c.message.mentionedUsers)===null||u===void 0?void 0:u.map(function(h){return h.userId})}),d.userId),c}return T(n,e),n}(pt),WP=function(e){function n(t,r,i){var a=e.call(this,t,"MRCT",i)||this;return a.channelUrl=i.channel_url,a.channelType=i.channel_type,a.event=new ky(i),a}return T(n,e),n}(pt),YP=function(e){function n(t,r,i){var a=e.call(this,t,"MTHD",i)||this;return a.event=new gN(t,i),a}return T(n,e),n}(pt),ZP=function(e){function n(t,r,i){var a=e.call(this,t,"MCNT",i)||this;return a.groupChannelMemberCounts=i.group_channels.map(function(s){return{channelUrl:s.channel_url,memberCount:s.member_count,joinedMemberCount:s.joined_member_count,updatedAt:s.ts}}),a.openChannelMemberCounts=i.open_channels.map(function(s){return{channelUrl:s.channel_url,participantCount:s.participant_count,updatedAt:s.ts}}),a}return T(n,e),n}(pt),XP=function(e){function n(t,r,i){var a=e.call(this,t,"PEDI",i)||this;return a.event=new C4(t,i),a.status=Qv(i.poll.status)||i.poll.status,a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return T(n,e),n}(pt),Mt;(function(e){e.NONE="none",e.JOINED="joined",e.INVITED="invited",e.LEFT="left"})(Mt||(Mt={}));var la,dr,gr,Qs,fi,em,Ga,Wd,Hr=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.state=null,i.role=null,i.isMuted=!1,i.isBlockedByMe=!1,i.isBlockingMe=!1,i.state=be(Mt,r.state)?r.state:null,i.role=be(gi,r.role)?r.role:null,typeof r.is_muted=="boolean"&&(i.isMuted=r.is_muted),typeof r.is_blocked_by_me=="boolean"&&(i.isBlockedByMe=r.is_blocked_by_me),typeof r.is_blocking_me=="boolean"&&(i.isBlockingMe=r.is_blocking_me),i}return T(n,e),n.payloadify=function(t){return W(ae(N(N({},e.payloadify.call(this,t)),{state:t.state,role:t.role,is_muted:t.isMuted,is_blocked_by_me:t.isBlockedByMe,is_blocking_me:t.isBlockingMe})))},n}(wl),JP=function(e){function n(t,r){var i,a,s=this;return(s=e.call(this,t)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",s.channelType=(a=r.channel_type)!==null&&a!==void 0?a:Pe.GROUP,s.member=new xe(s._iid,r.user),s.deliveryAt=r.ts,s}return T(n,e),n}(Wt);(function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"})(la||(la={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(dr||(dr={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only"}(gr||(gr={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(Qs||(Qs={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(fi||(fi={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator"}(em||(em={})),function(e){e.AND="AND",e.OR="OR"}(Ga||(Ga={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(Wd||(Wd={}));var Et,vI=function(){function e(n){var t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w;this._searchFilter=null,this._userIdsFilter=null,this.metadataKey=null,this.metadataValues=null,this.metadataValueStartsWith=null,this.includeEmpty=(t=n?.includeEmpty)!==null&&t!==void 0&&t,this.nicknameContainsFilter=(r=n?.nicknameContainsFilter)!==null&&r!==void 0?r:null,this.nicknameStartsWithFilter=(i=n?.nicknameStartsWithFilter)!==null&&i!==void 0?i:null,this.nicknameExactMatchFilter=(a=n?.nicknameExactMatchFilter)!==null&&a!==void 0?a:null,this.channelNameContainsFilter=(s=n?.channelNameContainsFilter)!==null&&s!==void 0?s:"",this.myMemberStateFilter=(o=n?.myMemberStateFilter)!==null&&o!==void 0?o:dr.ALL,this.customTypesFilter=(l=n?.customTypesFilter)!==null&&l!==void 0?l:null,this.channelUrlsFilter=(u=n?.channelUrlsFilter)!==null&&u!==void 0?u:null,this.superChannelFilter=(c=n?.superChannelFilter)!==null&&c!==void 0?c:gr.ALL,this.publicChannelFilter=(d=n?.publicChannelFilter)!==null&&d!==void 0?d:la.ALL,this.customTypeStartsWithFilter=(h=n?.customTypeStartsWithFilter)!==null&&h!==void 0?h:null,this.unreadChannelFilter=(f=n?.unreadChannelFilter)!==null&&f!==void 0?f:Qs.ALL,this.hiddenChannelFilter=(m=n?.hiddenChannelFilter)!==null&&m!==void 0?m:fi.UNHIDDEN,this.includeFrozen=(y=n?.includeFrozen)===null||y===void 0||y,this.metadataKey=(C=n?.metadataKey)!==null&&C!==void 0?C:null,this.metadataValues=(b=n?.metadataValues)!==null&&b!==void 0?b:null,this.metadataValueStartsWith=(v=n?.metadataValueStartsWith)!==null&&v!==void 0?v:null,this._userIdsFilter=(E=n?.userIdsFilter)!==null&&E!==void 0?E:null,this._searchFilter=(S=n?.searchFilter)!==null&&S!==void 0?S:null,n?.createdAfter&&(this.createdAfter=n.createdAfter),n?.createdBefore&&(this.createdBefore=n.createdBefore),this.includeMetaData=(w=n?.includeMetaData)===null||w===void 0||w}return e.prototype._isFriend=function(n){return!(!n||!n.friendDiscoveryKey&&!n.friendName)},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(n,t){Array.isArray(n)&&n.length!==0&&typeof t=="string"&&t&&(this._searchFilter={query:t,fields:n})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(n,t,r){r===void 0&&(r=Ga.AND),this._userIdsFilter={userIds:n,includeMode:t,queryType:r}},e.prototype.clone=function(){var n,t=new e;this.searchFilter&&t.setSearchFilter(this.searchFilter.fields,(n=this.searchFilter.query)!==null&&n!==void 0?n:void 0),this.userIdsFilter&&t.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach(function(i){t[i]=r[i]}),t},e.prototype.match=function(n,t){var r;if(this._searchFilter){var i=this._searchFilter,a=i.query,s=i.fields;if(a&&s&&s.length>0&&!s.some(function(y){switch(y){case Wd.CHANNEL_NAME:return n.name.toLowerCase().includes(a.toLowerCase());case Wd.MEMBER_NICKNAME:return n.members.some(function(C){return C.nickname.toLowerCase().includes(a.toLowerCase())});default:return!0}}))return!1}if(this._userIdsFilter){var o=this._userIdsFilter,l=o.userIds,u=o.includeMode,c=o.queryType,d=n.members.map(function(y){return y.userId});if(u){if(l.length>0)switch(c){case Ga.AND:if(l.some(function(y){return!d.includes(y)}))return!1;break;case Ga.OR:if(l.every(function(y){return!d.includes(y)}))return!1}}else if(l.includes(t)||l.push(t),n.members.length>l.length||!CO(l,d))return!1}if(!this.includeEmpty&&!n.lastMessage||!this.includeFrozen&&n.isFrozen||this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(n.customType)||this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(n.customType)||this.channelNameContainsFilter&&!n.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var h=this.nicknameContainsFilter.toLowerCase();if(!n.members.some(function(y){return y.userId!==t&&y.nickname.toLowerCase().includes(h)}))return!1}if(this.nicknameStartsWithFilter){var f=this.nicknameStartsWithFilter.toLowerCase();if(!n.members.some(function(y){return y.userId!==t&&y.nickname.toLowerCase().startsWith(f)}))return!1}if(this.nicknameExactMatchFilter){var m=this.nicknameExactMatchFilter.toLowerCase();if(!n.members.some(function(y){return y.userId!==t&&y.nickname.toLowerCase()!=m}))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(n.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case dr.ALL:if(n.myMemberState==="none")return!1;break;case dr.JOINED:if(n.myMemberState!=="joined")return!1;break;case dr.INVITED:if(n.myMemberState!=="invited")return!1;break;case dr.INVITED_BY_FRIEND:if(n.myMemberState!=="invited"||!this._isFriend(n.inviter))return!1;break;case dr.INVITED_BY_NON_FRIEND:if(n.myMemberState!=="invited"||this._isFriend(n.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case fi.UNHIDDEN:if(n.isHidden||n.hiddenState!=="unhidden")return!1;break;case fi.HIDDEN:if(!n.isHidden)return!1;break;case fi.HIDDEN_ALLOW_AUTO_UNHIDE:if(!n.isHidden||n.hiddenState!=="hidden_allow_auto_unhide")return!1;break;case fi.HIDDEN_PREVENT_AUTO_UNHIDE:if(!n.isHidden||n.hiddenState!=="hidden_prevent_auto_unhide")return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Qs.UNREAD_MESSAGE&&n.unreadMessageCount===0)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case la.PUBLIC:if(!n.isPublic)return!1;break;case la.PRIVATE:if(n.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case gr.SUPER:if(!n.isSuper)return!1;break;case gr.NON_SUPER:if(n.isSuper)return!1}return this.includeMetaData&&this.metadataKey&&(((r=n.cachedMetaData)===null||r===void 0?void 0:r[this.metadataKey])===void 0||this.metadataValues&&!this.metadataValues.includes(n.cachedMetaData[this.metadataKey])||this.metadataValueStartsWith&&!n.cachedMetaData[this.metadataKey].startsWith(this.metadataValueStartsWith))?!1:!(this.createdAfter&&n.createdAt<this.createdAfter)&&!(this.createdBefore&&n.createdAt>this.createdBefore)},e}(),e8=function(e){function n(t,r){var i=r.sdkState,a=r.cacheContext,s=e.call(this,t)||this;return s._channels=new Map,s._sdkState=i,s._cacheContext=a,s}return T(n,e),Object.defineProperty(n.prototype,"collection",{get:function(){var t=this._cacheContext.nestdb;return B(!!t).throw(k.databaseError),t.collection(cN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n.prototype._serialize=function(t,r){return r===void 0&&(r=0),N(N({},t.serialize()),{lastMessageUpdatedAt:t.lastMessage?t.lastMessage.createdAt:0,syncIndex:r})},n.prototype._deserialize=function(t){return en.of(this._iid).buildGroupChannelFromSerializedData(t)},Object.defineProperty(n.prototype,"channels",{get:function(){return ce([],ne(this._channels.values()),!1)},enumerable:!1,configurable:!0}),n.prototype.isCachedInMemory=function(t){return this._channels.has(t)},n.prototype.filterOffsetChanged=function(t){var r=this;return t.filter(function(i){if(r._channels.has(i.url))return r._channels.get(i.url).messageOffsetTimestamp<i.messageOffsetTimestamp})},n.prototype.get=function(t){return g(this,void 0,void 0,function(){var r,i;return _(this,function(a){switch(a.label){case 0:return this._channels.has(t)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(t)]:[3,2];case 1:if(r=a.sent())return i=this._deserialize(r),this._channels.set(t,i),[2,i];a.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(t)]}})})},n.prototype.fetch=function(t){var r=t.token,i=t.limit,a=i===void 0?uN:i,s=t.backward,o=s!==void 0&&s,l=t.filter,u=l===void 0?new vI:l,c=t.order,d=c===void 0?Dt.LATEST_LAST_MESSAGE:c,h=t.borderlineChannelUrl;return g(this,void 0,void 0,function(){var f,m,y,C,b,v=this;return _(this,function(E){switch(E.label){case 0:return this.localCacheEnabled?(f=!!h,m=zf(d),y={where:function(S){if(r)switch(d){case Dt.CHANNEL_NAME_ALPHABETICAL:if(!o&&S.name.localeCompare(r)<0||o&&S.name.localeCompare(r)>0)return!1;break;case Dt.CHRONOLOGICAL:if(!o&&S.createdAt>r||o&&S.createdAt<r)return!1;break;case Dt.LATEST_LAST_MESSAGE:if(!o&&S.lastMessageUpdatedAt>r||o&&S.lastMessageUpdatedAt<r)return!1}return f&&h&&h===S.url?(f=!1,!1):!f&&u.match(v._deserialize(S),v._sdkState.userId)},index:m,backward:o},[4,this.collection.query(y)]):[3,3];case 1:return[4,E.sent().fetch({limit:a})];case 2:return C=E.sent(),(b=C.map(function(S){return v._deserialize(S)})).forEach(function(S){!u.includeMetaData&&S.cachedMetaData&&S._clearCachedMetaData(),v._channels.has(S.url)||v._channels.set(S.url,S)}),[2,b];case 3:return[2,[]]}})})},n.prototype.upsert=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o=this;return _(this,function(l){switch(l.label){case 0:if(i=[],t.forEach(function(u){if(o._channels.has(u.url)){var c=o._channels.get(u.url);c._pinnedMessagesUpdatedAt<u._pinnedMessagesUpdatedAt&&(c._pinnedMessagesUpdatedAt=u._pinnedMessagesUpdatedAt),c._messageCollectionLastAccessedAt>u._messageCollectionLastAccessedAt&&(u._messageCollectionLastAccessedAt=c._messageCollectionLastAccessedAt),u.cachedMetaData instanceof Map&&u.cachedMetaData.size>0&&r&&(c._updateCachedMetaData(u.cachedMetaData,r).isUpdated||Object.assign(u,{_cachedMetaData:c.cachedMetaData})),c._update(u),i.push(c)}else o._channels.set(u.url,u),i.push(u)}),!this.localCacheEnabled)return[3,2];for(a=[],s=0;s<i.length;s++)a.push(this._serialize(i[s],s));return[4,this.collection.upsertMany(a)];case 1:l.sent(),l.label=2;case 2:return[2,i]}})})},n.prototype.remove=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),r=K(t),i=r.next(),u.label=1;case 1:return i.done?[3,4]:(a=i.value,this._channels.delete(a),this.localCacheEnabled?[4,this.collection.remove(a)]:[3,3]);case 2:u.sent(),u.label=3;case 3:return i=r.next(),[3,1];case 4:return[3,7];case 5:return s=u.sent(),o={error:s},[3,7];case 6:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 7:return[2]}})})},n.prototype.clear=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.clearMemoryCache=function(){this._channels.clear()},n.prototype._setBlockStateOfAllChannels=function(t,r,i){return g(this,void 0,void 0,function(){var a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D;return _(this,function(O){switch(O.label){case 0:if(a=[],t===this._sdkState.userId)try{for(s=K(this._channels.values()),o=s.next();!o.done;o=s.next()){h=o.value;try{for(v=void 0,l=K(h.members),u=l.next();!u.done;u=l.next())if((y=u.value).userId===r){y.isBlockedByMe=i,a.push(h);break}}catch(M){v={error:M}}finally{try{u&&!u.done&&(E=l.return)&&E.call(l)}finally{if(v)throw v.error}}}}catch(M){C={error:M}}finally{try{o&&!o.done&&(b=s.return)&&b.call(s)}finally{if(C)throw C.error}}else if(r===this._sdkState.userId)try{for(c=K(this._channels.values()),d=c.next();!d.done;d=c.next()){h=d.value;try{for(A=void 0,f=K(h.members),m=f.next();!m.done;m=f.next())if((y=m.value).userId===t){y.isBlockingMe=i,a.push(h);break}}catch(M){A={error:M}}finally{try{m&&!m.done&&(D=f.return)&&D.call(f)}finally{if(A)throw A.error}}}}catch(M){S={error:M}}finally{try{d&&!d.done&&(w=c.return)&&w.call(c)}finally{if(S)throw S.error}}return a.length>0?[4,this.upsert(a)]:[3,2];case 1:O.sent(),O.label=2;case 2:return[2]}})})},n.prototype.block=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(t,r,!0)];case 1:return i.sent(),[2]}})})},n.prototype.unblock=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(t,r,!1)];case 1:return i.sent(),[2]}})})},n.prototype.markAsRead=function(t,r){return r===void 0&&(r=ce([],ne(this._channels.keys()),!1)),g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:i=[],h.label=1;case 1:h.trys.push([1,6,7,8]),a=K(r),s=a.next(),h.label=2;case 2:return s.done?[3,5]:(o=s.value,[4,this.get(o)]);case 3:(l=h.sent())!=null&&l._updateUnreadMemberState(this._sdkState.userId,t)&&(l._updateUnreadCount(0,0),i.push(l)),h.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return u=h.sent(),c={error:u},[3,8];case 7:try{s&&!s.done&&(d=a.return)&&d.call(a)}finally{if(c)throw c.error}return[7];case 8:return i.length>0?[4,this.upsert(i)]:[3,10];case 9:h.sent(),h.label=10;case 10:return[2]}})})},n}(Wt),jf={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},p0=function(e){return Te("string",e.invitedUserIds,!0)&&x("string",e.channelUrl,!0)&&x("string",e.coverUrl,!0)&&(Kn(e.coverImage)||x("string",e.coverImage,!0))&&x("boolean",e.isDistinct,!0)&&x("boolean",e.isSuper,!0)&&x("boolean",e.isBroadcast,!0)&&x("boolean",e.isExclusive,!0)&&x("boolean",e.isPublic,!0)&&x("boolean",e.isStrict,!0)&&x("boolean",e.isDiscoverable,!0)&&x("boolean",e.isEphemeral,!0)&&x("string",e.accessCode,!0)&&x("string",e.name,!0)&&x("string",e.data,!0)&&x("string",e.customType,!0)&&Te("string",e.operatorUserIds,!0)&&x("number",e.messageSurvivalSeconds,!0)},tm={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1},m0=function(e){return Te("string",e.customTypes,!0)&&x("boolean",e.includeEmpty,!0)&&x("boolean",e.includeFrozen,!0)&&x("boolean",e.includeMetaData,!0)&&x("boolean",e.includeChatNotification,!0)},yI={myMemberStateFilter:dr.ALL},bI=function(e){return be(dr,e.myMemberStateFilter)};(function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"})(Et||(Et={}));var t8={keys:[Et.GROUP_CHANNEL_UNREAD_MENTION_COUNT,Et.NONSUPER_UNREAD_MENTION_COUNT,Et.SUPER_UNREAD_MENTION_COUNT,Et.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT,Et.NONSUPER_UNREAD_MESSAGE_COUNT,Et.SUPER_UNREAD_MESSAGE_COUNT,Et.GROUP_CHANNEL_INVITATION_COUNT,Et.NONSUPER_INVITATION_COUNT,Et.SUPER_INVITATION_COUNT],customTypeFilters:void 0,customTypesFilter:void 0},n8={channelCustomTypesFilter:void 0,superChannelFilter:gr.ALL},r8=function(e){return Te("string",e.channelCustomTypesFilter,!0)&&be(gr,e.superChannelFilter)},i8={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:Un.ALL};N({},P);var Qf=function(e){return e.startsWith("EVENT_")||e===P.SYNC_CHANNEL_CHANGELOGS||e===P.REFRESH_CHANNEL},Se=function(e){function n(t){var r=t.channels,i=t.context,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=t.ts,l=e.call(this)||this;return l.channels=r,l.context=i,l.isWebSocketEventComing=s,l.ts=o,l}return T(n,e),n}(st),Ta=function(e){function n(t){var r=t.channelUrls,i=t.context,a=t.isWebSocketEventComing,s=a!==void 0&&a,o=e.call(this)||this;return o.channelUrls=r,o.context=i,o.isWebSocketEventComing=s,o}return T(n,e),n}(st),a8=function(e){function n(t){var r=t.channel,i=e.call(this)||this;return i.channel=r,i}return T(n,e),n}(st),s8=function(){function e(n){var t=n.groupChannelCache,r=n.userInfoCache,i=n.messageCache,a=n.unsentMessageCache,s=n.dispatcher,o=this;this._observers=new Map,s.on(function(l){return g(o,void 0,void 0,function(){var u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M,F,U=this;return _(this,function($){switch($.label){case 0:if(!(l instanceof Se))return[3,19];if(u=l.channels,w=l.context,A=l.isWebSocketEventComing,c=u.filter(function(J){return J instanceof Yr}),w.source!==P.EVENT_CHANNEL_RESET_HISTORY&&w.source!==P.EVENT_CHANNEL_HIDDEN)return[3,9];$.label=1;case 1:$.trys.push([1,6,7,8]),d=K(c),h=d.next(),$.label=2;case 2:return h.done?[3,5]:(b=h.value,[4,i.removeUnderOffset(b.url,b.messageOffsetTimestamp)]);case 3:$.sent(),$.label=4;case 4:return h=d.next(),[3,2];case 5:return[3,8];case 6:return f=$.sent(),D={error:f},[3,8];case 7:try{h&&!h.done&&(O=d.return)&&O.call(d)}finally{if(D)throw D.error}return[7];case 8:return[3,17];case 9:m=t.filterOffsetChanged(c),$.label=10;case 10:$.trys.push([10,15,16,17]),y=K(m),C=y.next(),$.label=11;case 11:return C.done?[3,14]:(b=C.value,[4,i.removeUnderOffset(b.url,b.messageOffsetTimestamp)]);case 12:$.sent(),$.label=13;case 13:return C=y.next(),[3,11];case 14:return[3,17];case 15:return v=$.sent(),M={error:v},[3,17];case 16:try{C&&!C.done&&(F=y.return)&&F.call(y)}finally{if(M)throw M.error}return[7];case 17:return[4,t.upsert(c,l.ts)];case 18:return E=$.sent(),A||this._broadcastUpdateEvent(E,w),[3,25];case 19:return l instanceof Ta?(S=l.channelUrls,w=l.context,A=l.isWebSocketEventComing,[4,t.remove(S)]):[3,22];case 20:return $.sent(),[4,Ct(function(){return g(U,void 0,void 0,function(){var J,ee,ve,Q,Z,X;return _(this,function(se){switch(se.label){case 0:se.trys.push([0,6,7,8]),J=K(S),ee=J.next(),se.label=1;case 1:return ee.done?[3,5]:(ve=ee.value,[4,i.removeMessagesOfChannel(ve)]);case 2:return se.sent(),[4,a.removeMessagesOfChannel(ve)];case 3:se.sent(),se.label=4;case 4:return ee=J.next(),[3,1];case 5:return[3,8];case 6:return Q=se.sent(),Z={error:Q},[3,8];case 7:try{ee&&!ee.done&&(X=J.return)&&X.call(J)}finally{if(Z)throw Z.error}return[7];case 8:return[2]}})})})];case 21:return $.sent(),A||this._broadcastRemoveEvent(S,w),[3,25];case 22:return l instanceof yN?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,25];case 23:return $.sent(),[4,r.fetch({limit:Number.MAX_SAFE_INTEGER})];case 24:$.sent(),$.label=25;case 25:return[2]}})})})}return e.prototype._broadcastUpdateEvent=function(n,t){var r,i;try{for(var a=K(this._observers.values()),s=a.next();!s.done;s=a.next()){var o=s.value;o.onUpdate&&o.onUpdate(n,t)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},e.prototype._broadcastRemoveEvent=function(n,t){var r,i;try{for(var a=K(this._observers.values()),s=a.next();!s.done;s=a.next()){var o=s.value;o.onRemove&&o.onRemove(n,t)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},e.prototype.subscribe=function(n,t){this._observers.set(n,t)},e.prototype.unsubscribe=function(n){this._observers.delete(n)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),o8=function(e){function n(t){var r=t.userId,i=t.ts,a=t.token,s=t.filter,o=t.includeChatNotification,l=o!==void 0&&o,u=e.call(this)||this,c=N(N({},tm),s),d=c.customTypes,h=c.includeEmpty,f=c.includeFrozen;return u.method=z.GET,u.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/my_group_channels/changelogs"),u.params=W(ae({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:i||null,token:a,custom_types:d,show_empty:h,show_frozen:f,include_chat_notification:l})),u}return T(n,e),n}(H),l8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.updatedChannels=r.updated.map(function(a){return new Yr(t,Object.assign(a,{ts:r.ts}))}),i.deletedChannelUrls=r.deleted,i.hasMore=r.has_more,i.token=r.next,i.ts=r.ts,i}return T(n,e),n}(j),_0=function(e){function n(t){var r=t.channelUrl,i=t.isInternalCall,a=t.showLatestMessage,s=e.call(this)||this;return s.method=z.GET,s.path="".concat(i?MO:Jn,"/").concat(encodeURIComponent(r)),s.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_latest_message:a!=null&&a,show_conversation:!0},s}return T(n,e),n}(H),g0=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i}return T(n,e),n}(j),ql={includeEmpty:!1,myMemberStateFilter:dr.ALL,unreadChannelFilter:Qs.ALL,superChannelFilter:gr.ALL,publicChannelFilter:la.ALL,hiddenChannelFilter:fi.ALL,userIdsFilter:{queryType:Ga.AND},order:Dt.LATEST_LAST_MESSAGE},u8=function(e){function n(t){var r=this,i=t.userId,a=t.token,s=t.limit,o=t.order,l=t.includeEmpty,u=t.myMemberStateFilter,c=t.superChannelFilter,d=t.publicChannelFilter,h=t.unreadChannelFilter,f=t.nicknameContainsFilter,m=t.nicknameStartsWithFilter,y=t.nicknameExactMatchFilter,C=t.channelNameContainsFilter,b=t.channelUrlsFilter,v=t.customTypesFilter,E=t.customTypeStartsWithFilter,S=t.hiddenChannelFilter,w=t.metadataOrderKeyFilter,A=t.metadataKey,D=t.metadataValues,O=t.metadataValueStartsWith,M=t.includeFrozen,F=t.includeMetaData,U=t.searchFilter,$=t.userIdsFilter,J=t.includeChatNotification,ee=J!==void 0&&J,ve=t.includeLeftChannel,Q=ve!==void 0&&ve,Z=t.createdAfter,X=t.createdBefore;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Fe,"/").concat(encodeURIComponent(i),"/my_group_channels"),r.params=W({token:a,limit:s,order:o??ql.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:l??ql.includeEmpty,member_state_filter:u??ql.myMemberStateFilter,super_mode:c??ql.superChannelFilter,public_mode:d??ql.publicChannelFilter,unread_filter:h??ql.unreadChannelFilter,members_nickname_contains:f,members_nickname_startswith:m,members_nickname:y,name_contains:C,channel_urls:b,custom_types:v,custom_type_startswith:E,hidden_mode:S,metadata_order_key:w,metadata_key:A,metadata_values:D,metadata_value_startswith:O,show_frozen:M,show_metadata:F,include_chat_notification:ee,include_left_channel:Q,created_after:Z,created_before:X}),U&&U.query&&U.fields&&(r.params.search_query=U.query,r.params.search_fields=U.fields),$&&$.userIds&&$.userIds.length>0&&($.includeMode?(r.params.members_include_in=$.userIds,r.params.query_type=$.queryType.toUpperCase()):r.params.members_exactly_in=$.userIds),r}return T(n,e),n}(H),c8=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.channels=[];var a=r.next,s=r.channels,o=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(l){return l.ts=o,new Yr(t,l)})),i.ts=o??0,i}return T(n,e),n}(j),d8=function(e){function n(t){var r=t.userId,i=t.filter,a=e.call(this)||this,s=i.myMemberStateFilter;return a.method=z.GET,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/group_channel_count"),a.params={state:s??dr.ALL},a}return T(n,e),n}(H),h8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.groupChannelCount=r.group_channel_count,i}return T(n,e),n}(j),f8=function(e){function n(t){var r=t.userId,i=t.filter,a=e.call(this)||this,s=i.keys,o=i.customTypeFilters,l=i.customTypesFilter;return a.method=z.GET,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/unread_item_count"),a.params=W({item_keys:s,custom_types:l??o}),a}return T(n,e),n}(H),p8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return typeof r[Et.GROUP_CHANNEL_UNREAD_MENTION_COUNT]=="number"&&(i.groupChannelUnreadMentionCount=r[Et.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),typeof r[Et.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]=="number"&&(i.groupChannelUnreadMessageCount=r[Et.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),typeof r[Et.GROUP_CHANNEL_INVITATION_COUNT]=="number"&&(i.groupChannelInvitationCount=r[Et.GROUP_CHANNEL_INVITATION_COUNT]),typeof r[Et.SUPER_UNREAD_MENTION_COUNT]=="number"&&(i.superGroupChannelUnreadMentionCount=r[Et.SUPER_UNREAD_MENTION_COUNT]),typeof r[Et.SUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.superGroupChannelUnreadMessageCount=r[Et.SUPER_UNREAD_MESSAGE_COUNT]),typeof r[Et.SUPER_INVITATION_COUNT]=="number"&&(i.superGroupChannelInvitationCount=r[Et.SUPER_INVITATION_COUNT]),typeof r[Et.NONSUPER_UNREAD_MENTION_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMentionCount=r[Et.NONSUPER_UNREAD_MENTION_COUNT]),typeof r[Et.NONSUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMessageCount=r[Et.NONSUPER_UNREAD_MESSAGE_COUNT]),typeof r[Et.NONSUPER_INVITATION_COUNT]=="number"&&(i.nonSuperGroupChannelInvitationCount=r[Et.NONSUPER_INVITATION_COUNT]),i}return T(n,e),n}(j),m8=function(e){function n(t){var r=t.userId,i=e.call(this)||this;return i.method=z.GET,i.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/unread_channel_count"),i}return T(n,e),n}(H),_8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.unreadCount=r.unread_count,i}return T(n,e),n}(j),g8=function(e){function n(t){var r=t.userId,i=t.filter,a=t.includeFeedChannel,s=a!==void 0&&a,o=e.call(this)||this,l=i.channelCustomTypesFilter,u=i.superChannelFilter;return o.method=z.GET,o.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/unread_message_count"),o.params={super_mode:u??gr.ALL,custom_types:l,include_feed_channel:s},o}return T(n,e),n}(H),v8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.unreadCount=r.unread_count,i.unreadFeedCount=r.unread_feed_count,i}return T(n,e),n}(j),y8=function(e){function n(t){var r=t.channelUrl,i=t.scheduledStatus,a=t.messageTypeFilter,s=e.call(this)||this;return s.method=z.GET,s.path="".concat(X2,"/count"),s.params={channel_url:r,status:E8(i)},a&&(s.params.message_type=a),s}return T(n,e),n}(H),b8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.count=r.count,i}return T(n,e),n}(j),E8=function(e){if(!e)return[];var n=[];return e.forEach(function(t){switch(t){case xs.PENDING:n.push($r.PENDING);break;case xs.SENT:n.push($r.IN_QUEUE),n.push($r.SENT);break;case xs.CANCELED:n.push($r.CANCELED);break;case xs.FAILED:n.push($r.FAILED)}}),n},C8=function(e){function n(t){var r=this,i=t.userId,a=t.channelUrl,s=t.coverUrl,o=t.coverImage,l=t.isDistinct,u=t.isSuper,c=t.isBroadcast,d=t.isPublic,h=t.isExclusive,f=t.isDiscoverable,m=t.isStrict,y=t.isEphemeral,C=t.accessCode,b=t.name,v=t.data,E=t.customType,S=t.messageSurvivalSeconds,w=t.invitedUserIds,A=t.operatorUserIds;return(r=e.call(this)||this).method=z.POST,r.path=Jn,r.params=W({user_ids:ce([i],ne(w??[]),!1).filter(function(D,O,M){return O===M.indexOf(D)}),channel_url:a,cover_url:s,cover_file:o,is_distinct:l,is_super:u,is_broadcast:c,is_exclusive:h,is_public:d,is_discoverable:f,strict:m,is_ephemeral:y,access_code:C,name:b,data:v,custom_type:E,operator_ids:A,message_survival_seconds:S}),r}return T(n,e),n}(H),S8=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,r)||this).channel=new Yr(t,r),a.isCreated=(i=r.is_created)===null||i===void 0||i,a}return T(n,e),n}(j),iS=function(e){function n(t){var r=t.userId,i=t.channelUrls,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/mark_as_read_all"),a.params={channel_urls:i},a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var T8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userId,s=t.accessCode;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/join"),r.params={user_id:a,access_code:s},r}return T(n,e),n}(H),w8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i}return T(n,e),n}(j),A8=function(e){function n(t,r,i){var a=e.call(this,t,r,i)||this,s=i.data,o=s.member_count,l=o===void 0?0:o,u=s.joined_member_count,c=u===void 0?0:u,d=s.users,h=d===void 0?null:d;return a.memberCount=l,a.joinedMemberCount=c,a.members=Array.isArray(h)?h.map(function(f){return new Hr(t,f)}):[new Hr(t,i.data)],a}return T(n,e),n}(Zu),N8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userId,s=t.shouldRemoveOperatorStatus;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/leave"),r.params={user_id:a,should_remove_operator_status:s},r}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var I8=function(e){function n(t,r,i){var a=e.call(this,t,r,i)||this,s=i.data,o=s.member_count,l=o===void 0?0:o,u=s.joined_member_count,c=u===void 0?0:u;return a.memberCount=l,a.joinedMemberCount=c,a.member=new Hr(a._iid,i.data),a}return T(n,e),n}(Zu),M8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userIds;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/invite"),r.params={user_ids:a},r}return T(n,e),n}(H),x8=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i}return T(n,e),n}(j),O8=function(e){function n(t,r,i){var a=e.call(this,t,r,i)||this;a.inviter=null;var s=i.data,o=s.member_count,l=o===void 0?0:o,u=s.joined_member_count,c=u===void 0?0:u,d=s.inviter,h=s.invitees,f=h===void 0?[]:h;return a.memberCount=l,a.joinedMemberCount=c,d&&Object.keys(d).length>0&&(a.inviter=new xe(t,d)),a.invitees=f.map(function(m){return new Hr(t,m)}),a}return T(n,e),n}(Zu),D8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userId;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/decline"),r.params={user_id:a},r}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i.channel.myMemberState=Mt.NONE,i}T(n,e)})(j);var k8=function(e){function n(t,r,i){var a=e.call(this,t,r,i)||this,s=i.data,o=s.member_count,l=s.joined_member_count,u=s.inviter,c=s.invitee;return a.memberCount=o??0,a.joinedMemberCount=l??0,a.inviter=new xe(t,u),a.invitee=new Hr(t,c),a}return T(n,e),n}(Zu),v0={hidePreviousMessages:!1,allowAutoUnhide:!0},R8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userId,s=t.hidePreviousMessages,o=t.allowAutoUnhide;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/hide"),r.params={user_id:a,hide_previous_messages:s??v0.hidePreviousMessages,allow_auto_unhide:o??v0.allowAutoUnhide},r}return T(n,e),n}(H),U8=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return T(n,e),n}(j),L8=function(e){function n(t,r,i){var a,s,o,l=this;return(l=e.call(this,t,"SYEV",i)||this).allowAutoUnhide=null,l.hidePreviousMessages=null,l.messageOffsetTimestamp=null,i.data&&(l.allowAutoUnhide=(a=i.data.allow_auto_unhide)!==null&&a!==void 0?a:null,l.hidePreviousMessages=(s=i.data.hide_previous_messages)!==null&&s!==void 0?s:null),l.messageOffsetTimestamp=(o=i.ts_message_offset)!==null&&o!==void 0?o:null,l}return T(n,e),n}(pt),P8=function(e){function n(t){var r=t.channelUrl,i=t.time;return e.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return T(n,e),n}(sr),F8=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new xe(t,i.data),a}return T(n,e),n}(pt),$8=function(e){function n(t){var r=t.channelUrl,i=t.time;return e.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return T(n,e),n}(sr),z8=function(e){function n(t,r,i){var a=e.call(this,t,"SYEV",i)||this;return a.user=new xe(t,i.data),a}return T(n,e),n}(pt),H8=function(e){function n(t){var r=t.channelUrl,i=t.messageId;return e.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:r,msg_id:i}})||this}return T(n,e),n}(sr),EI=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M,F,U=this;return(U=e.call(this,t,r)||this).includeEmpty=!1,U.includeFrozen=!0,U.includeMetaData=!0,U.includeChatNotification=!1,U.channelUrlsFilter=null,U.customTypesFilter=null,U.customTypeStartsWithFilter=null,U.nicknameContainsFilter=null,U.nicknameStartsWithFilter=null,U.nicknameExactMatchFilter=null,U.channelNameContainsFilter="",U.myMemberStateFilter=dr.ALL,U.unreadChannelFilter=Qs.ALL,U.superChannelFilter=gr.ALL,U.publicChannelFilter=la.ALL,U.hiddenChannelFilter=fi.UNHIDDEN,U.searchFilter={fields:[],query:null},U.userIdsFilter={userIds:[],includeMode:!0,queryType:Ga.AND},U.metadataKey=null,U.metadataValues=null,U.metadataOrderKeyFilter=null,U.metadataValueStartsWith=null,U.order=Dt.LATEST_LAST_MESSAGE,U.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,U.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,U.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,U.includeChatNotification=(o=r.includeChatNotification)!==null&&o!==void 0&&o,U.channelUrlsFilter=(l=r.channelUrlsFilter)!==null&&l!==void 0?l:null,U.customTypesFilter=(u=r.customTypesFilter)!==null&&u!==void 0?u:null,U.customTypeStartsWithFilter=(c=r.customTypeStartsWithFilter)!==null&&c!==void 0?c:"",U.nicknameContainsFilter=(d=r.nicknameContainsFilter)!==null&&d!==void 0?d:null,U.nicknameStartsWithFilter=(h=r.nicknameStartsWithFilter)!==null&&h!==void 0?h:null,U.nicknameExactMatchFilter=(f=r.nicknameExactMatchFilter)!==null&&f!==void 0?f:null,U.channelNameContainsFilter=(m=r.channelNameContainsFilter)!==null&&m!==void 0?m:"",U.myMemberStateFilter=(y=r.myMemberStateFilter)!==null&&y!==void 0?y:dr.ALL,U.unreadChannelFilter=(C=r.unreadChannelFilter)!==null&&C!==void 0?C:Qs.ALL,U.superChannelFilter=(b=r.superChannelFilter)!==null&&b!==void 0?b:gr.ALL,U.publicChannelFilter=(v=r.publicChannelFilter)!==null&&v!==void 0?v:la.ALL,U.hiddenChannelFilter=(E=r.hiddenChannelFilter)!==null&&E!==void 0?E:fi.UNHIDDEN,U.searchFilter=(S=r.searchFilter)!==null&&S!==void 0?S:{fields:[],query:null},U.userIdsFilter=(w=r.userIdsFilter)!==null&&w!==void 0?w:{userIds:[],includeMode:!0,queryType:Ga.AND},U.metadataKey=(A=r.metadataKey)!==null&&A!==void 0?A:null,U.metadataValues=(D=r.metadataValues)!==null&&D!==void 0?D:null,U.metadataOrderKeyFilter=(O=r.metadataOrderKeyFilter)!==null&&O!==void 0?O:null,U.metadataValueStartsWith=(M=r.metadataValueStartsWith)!==null&&M!==void 0?M:null,U.order=(F=r.order)!==null&&F!==void 0?F:Dt.LATEST_LAST_MESSAGE,r.createdAfter&&(U.createdAfter=r.createdAfter),r.createdBefore&&(U.createdBefore=r.createdBefore),U}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("boolean",this.includeEmpty)&&x("boolean",this.includeFrozen)&&x("boolean",this.includeMetaData)&&x("string",this.channelNameContainsFilter)&&Te("string",this.channelUrlsFilter,!0)&&Te("string",this.customTypesFilter,!0)&&x("string",this.customTypeStartsWithFilter)&&x("string",this.nicknameContainsFilter,!0)&&x("string",this.nicknameStartsWithFilter,!0)&&x("string",this.nicknameExactMatchFilter,!0)&&be(dr,this.myMemberStateFilter)&&be(gr,this.superChannelFilter)&&be(la,this.publicChannelFilter)&&be(Qs,this.unreadChannelFilter)&&be(fi,this.hiddenChannelFilter)&&Te(Wd,this.searchFilter.fields)&&x("string",this.searchFilter.query,!0)&&Te("string",this.userIdsFilter.userIds)&&x("boolean",this.userIdsFilter.includeMode)&&be(Ga,this.userIdsFilter.queryType)&&be(Dt,this.order)&&x("string",this.metadataOrderKeyFilter,!0)&&x("string",this.metadataKey,!0)&&Te("string",this.metadataValues,!0)&&x("string",this.metadataValueStartsWith,!0)&&WE(this.createdAfter)&&WE(this.createdBefore)},n.prototype.serialize=function(){return Wu(this)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i;return _(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,en.of(this._iid).getMyGroupChannels(this._token,ae(N({},this)),this.limit,P.REQUEST_CHANNEL,!0)]):[3,2]:[3,5];case 1:return t=a.sent(),r=t.channels,i=t.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),q8=function(e){function n(t){var r=t.channelUrl,i=t.userId,a=e.call(this)||this;return a.method=z.PUT,a.path="".concat(Jn,"/").concat(encodeURIComponent(r),"/messages/mark_as_delivered"),a.params=W({user_id:i}),a}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var nm,B8=function(e){function n(t,r,i){var a=e.call(this,t,"DLVR",i)||this;return a.channelUrl=i.channel_url,a.deliveredStateUpdate=i.updated,a}return T(n,e),n}(pt),na=function(){function e(n){var t=n.top,r=t===void 0?Number.MAX_SAFE_INTEGER:t,i=n.bottom,a=i===void 0?0:i;this.top=r,this.bottom=a}return e.prototype.includes=function(){for(var n=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.every(function(i){return n.top<=i&&i<=n.bottom})},e.prototype.overlap=function(n){return this.includes(n.top)||this.includes(n.bottom)},e.prototype.intersect=function(){for(var n=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.some(function(i){return n.top<=i&&i<=n.bottom})},e.prototype.extends=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.top=Math.min.apply(Math,ce([this.top],ne(n),!1)),this.bottom=Math.max.apply(Math,ce([this.bottom],ne(n),!1))},e}(),yo={},en=function(e){function n(t,r){var i,a=this;return(a=e.call(this,t,N(N({},r),{channelType:Pe.GROUP}))||this)._leftChannels=new Map,a._markAsReadAllLastSentAt=0,a._forceDisableMack=(i=r.forceDisableMack)!==null&&i!==void 0&&i,a._groupChannelHandlers=new Map,a._groupChannelCache=new e8(a._iid,{sdkState:r.sdkState,cacheContext:r.cacheContext}),a._userInfoCache=new i0(a._iid,{sdkState:r.sdkState,cacheContext:r.cacheContext}),a._groupChannelBroadcast=new s8({dispatcher:r.dispatcher,groupChannelCache:a._groupChannelCache,userInfoCache:a._userInfoCache,messageCache:Ho.of(a._iid),unsentMessageCache:cl.of(a._iid)}),setInterval(function(){var s,o,l=function(d){d.invalidateTypingStatus()&&(a._dispatcher.dispatch(new Se({channels:[d],context:{source:P.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),a._groupChannelHandlers.forEach(function(h){h.onTypingStatusUpdated&&h.onTypingStatusUpdated(d)}))};try{for(var u=K(a._groupChannelCache.channels),c=u.next();!c.done;c=u.next())l(c.value)}catch(d){s={error:d}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(s)throw s.error}}},1e3),a._dispatcher.on(function(s){if(s instanceof pt)a._handleEvent(s).catch(function(c){if(fr(c)&&a._sdkState.appState==="foreground")throw c});else if(s instanceof vN)g(a,void 0,void 0,function(){var c,d;return _(this,function(h){switch(h.label){case 0:return c=s.message,[4,this.getChannelFromCache(c.channelUrl)];case 1:return(d=h.sent())&&!d.isFrozen?[3,3]:[4,this.getChannelWithoutCache(c.channelUrl,!0)];case 2:d=h.sent(),h.label=3;case 3:return d.isFrozen||(c instanceof kn?d._autoResendUserMessage(c):c instanceof qt&&d._autoResendFileMessage(c)),[2]}})});else if(s instanceof bN)a.reduceDBSize();else if(s instanceof SN){var o=s.appConfigsInfo,l=s.configTs,u=o.message_purge_offset;u&&a._messageDataRetention(u),a._dispatcher.dispatch(new EN({configTs:l}))}else s instanceof ZA&&g(a,void 0,void 0,function(){var c,d,h,f,m,y=this;return _(this,function(C){switch(C.label){case 0:return c=s.channelUrl,d=s.channelType,h=s.parentMessage,f=new gN(this._iid,{channel_type:Pe.GROUP,channel_url:c,parent_message_id:h.messageId,thread_info:zp.payloadify(h.threadInfo)}),d!==Pe.GROUP?[3,2]:[4,this.getChannel(c,!0)];case 1:m=C.sent(),he(function(){return g(y,void 0,void 0,function(){var b,v,E,S,w;return _(this,function(A){try{for(b=K(this._groupChannelHandlers.values()),v=b.next();!v.done;v=b.next())(E=v.value).onThreadInfoUpdated&&E.onThreadInfoUpdated(m,f)}catch(D){S={error:D}}finally{try{v&&!v.done&&(w=b.return)&&w.call(b)}finally{if(S)throw S.error}}return[2]})})}),C.label=2;case 2:return[2]}})})}),yo[t]||(yo[t]=a),a}return T(n,e),Object.defineProperty(n.prototype,"_messageCache",{get:function(){return Ho.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_unsentMessageCache",{get:function(){return cl.of(this._iid)},enumerable:!1,configurable:!0}),n.of=function(t){return yo[t]||(yo[t]=new n(t,I.of(t))),yo[t]},n.clear=function(t){yo[t]&&delete yo[t]},Object.defineProperty(n.prototype,"handlers",{get:function(){return ce([],ne(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),n.prototype.buildGroupChannelFromSerializedData=function(t){var r=Gs(t);return new Yr(this._iid,Yr.payloadify(r))},n.prototype.buildGroupChannelListQueryFromSerializedData=function(t){var r=Gs(t);return new EI(this._iid,r)},n.prototype.buildMemberFromSerializedData=function(t){var r=Gs(t);return new Hr(this._iid,Hr.payloadify(r))},n.prototype.getChannelFromCache=function(t){var r;return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this._groupChannelCache.get(t)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},n.prototype.getChannelsFromCache=function(t,r,i,a,s){return g(this,void 0,void 0,function(){return _(this,function(o){switch(o.label){case 0:return[4,this._groupChannelCache.fetch({token:t,filter:r,order:i,limit:a,borderlineChannelUrl:s})];case 1:return[2,o.sent()]}})})},n.prototype.upsertChannelsToCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.upsert(t)];case 1:return[2,r.sent()]}})})},n.prototype.removeChannelsFromCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.remove(t)];case 1:return r.sent(),[2]}})})},n.prototype.clearChannelsFromCache=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return t.sent(),[2]}})})},n.prototype.reduceDBSize=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h,f,m,y,C;return _(this,function(b){switch(b.label){case 0:return t=Ho.of(this._iid),r=I.of(this._iid).cacheContext,i=r.localCacheConfig,a=r.nestdb,r.localCacheEnabled&&a&&a.state==Zi.OPENED?(s=1024*i.maxSize*1024,[4,a.estimateUsage()]):[2];case 1:if((o=b.sent())<s)return[2];l=[],u=this._groupChannelCache.channels,c={},m=0,b.label=2;case 2:return m<u.length?[4,this.getMessagesFromCache(u[m].url,0,"prev",new Wa)]:[3,5];case 3:d=b.sent(),c[u[m].url]=JSON.stringify(d).length,h=new TO({channel:u[m],cachedMessageCount:d.length}),l.push(h),b.label=4;case 4:return m++,[3,2];case 5:f=l.sort(i.clearOrderComparator),m=0,b.label=6;case 6:return m<f.length?[4,t.removeMessagesOfChannel(f[m].channel.url)]:[3,10];case 7:return b.sent(),[4,t._getGroupChannelPreferenceSize(f[m].channel.url)];case 8:if(y=b.sent(),C=c[f[m].channel.url]+y,(o-=C)<s)return[3,10];b.label=9;case 9:return m++,[3,6];case 10:return[4,i0.of(this._iid).clear()];case 11:return b.sent(),[2]}})})},n.prototype._messageDataRetention=function(t){var r;return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h,f,m=this;return _(this,function(y){switch(y.label){case 0:i=[],a=Ho.of(this._iid),s=function(C){var b,v;return _(this,function(E){switch(E.label){case 0:return b=C.customType,v=(r=t[b])!==null&&r!==void 0?r:t.global,[4,a.removeUnderOffset(C.url,v,!0)];case 1:return E.sent(),C.lastMessage&&C.lastMessage.createdAt<=v&&(C.lastMessage=null,i.push(C),he(function(){return g(m,void 0,void 0,function(){var S,w,A,D,O;return _(this,function(M){try{for(S=K(this._groupChannelHandlers.values()),w=S.next();!w.done;w=S.next())(A=w.value).onChannelChanged&&A.onChannelChanged(C)}catch(F){D={error:F}}finally{try{w&&!w.done&&(O=S.return)&&O.call(S)}finally{if(D)throw D.error}}return[2]})})})),o._dispatcher.dispatch(new UA({channelUrl:C.url,messageDeletionTimestamp:v,source:P.EVENT_MESSAGE_OFFSET_UPDATED})),[2]}})},o=this,y.label=1;case 1:y.trys.push([1,6,7,8]),l=K(this._groupChannelCache.channels),u=l.next(),y.label=2;case 2:return u.done?[3,5]:(c=u.value,[5,s(c)]);case 3:y.sent(),y.label=4;case 4:return u=l.next(),[3,2];case 5:return[3,8];case 6:return d=y.sent(),h={error:d},[3,8];case 7:try{u&&!u.done&&(f=l.return)&&f.call(l)}finally{if(h)throw h.error}return[7];case 8:return i.length>0&&this._dispatcher.dispatch(new Se({channels:i,context:{source:P.EVENT_CHANNEL_UPDATED}})),[2]}})})},n.prototype._isSuperGroupMackDisabled=function(t){var r=I.of(this._iid).appInfo;return!(!t.isSuper||t.isBroadcast||!r?.disableSuperGroupMack)},n.prototype._getCachedUserInfo=function(t){return this._userInfoCache.getUserInfoFromCache(t)},n.prototype._upsertCachedUserInfo=function(t,r){I.of(this._iid).useMemberInfoInMessage&&this._userInfoCache.upsert(t,r)},n.prototype._handleEvent=function(t){var r,i;return g(this,void 0,void 0,function(){var a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M,F,U,$,J,ee,ve,Q,Z,X,se,Ce,Me,Ue,Le,ot,pe,lt,an,oe,le,me,ke,fe,de,ue,$e,Yt,Qe,Tt,et,Ye,kt,zn,Cr,fa,pa,Xr,so,Xu,Nl,ns,Il,cn,Mr,Jr,De,Tn,rs,gh,oo,ji,Ml,wi,is,Lt,Zt,Ai,Ni,xl,lo,Ol,Ju,as,or,Qi,ss,ma,wn,os,xr,uo,ls,_a,co,Hn,Ee,R,te,_e,dt,Xt,Vt,mn,_n,ei,Ii,Jt,ga,gn,vh,ec,Zm,tc,yh,nc,bh,Dl,Eh,ho,Ch,Xm,Jm,e_,Sh,t_,Mi,Th,fo,po,mo,_o,wh,rc,ic,ac,va,Ah,n_,mb,_b,An,r_,i_,a_,Nh,Ih,s_,o_,gb,l_,vb,u_,yb,c_,bb,d_,Eb,h_,Cb,f_,Sb,p_,Tb,m_,wb,tt=this;return _(this,function(Oe){switch(Oe.label){case 0:switch(Oe.trys.push([0,88,,89]),t.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,27];case"MCNT":return[3,31];case"PEDI":return[3,40];case"VOTE":return[3,43];case"SYEV":return[3,46];case"USEV":return[3,86]}return[3,87];case 1:return f=null,t.code==="MESG"?f=t.as(sN):t.code==="FILE"?f=t.as(XA):t.code!=="ADMM"&&t.code!="BRDM"||(f=t.as(QP)),f?(a=f.message,s=f.isMentioned,o=f.forceUpdateLastMessage,a.channelType!==Pe.GROUP?[3,3]:(Ue=this._groupChannelCache.isCachedInMemory(a.channelUrl),ee=a instanceof xt&&a.sender.userId===this._sdkState.userId,[4,this.getChannel(a.channelUrl,!0)])):[3,3];case 2:if(l=Oe.sent(),u=I.of(this._iid),b=u.useMemberInfoInMessage,An=u.requestDeduplicator,this._forceDisableMack||this._isSuperGroupMackDisabled(l)||a instanceof ol||ee||Ct(function(){return g(tt,void 0,void 0,function(){var G;return _(this,function(L){switch(L.label){case 0:return G=new H8(a),[4,this._requestQueue.send(G)];case 1:return L.sent(),[2]}})})}),a instanceof xt){c=a.sender,l.isSuper&&this._upsertCachedUserInfo(c,a.createdAt);try{for(d=K(l.members),h=d.next();!h.done;h=d.next())if((gn=h.value).userId===a.sender.userId){b&&(gn.nickname=a.sender.nickname,gn.plainProfileUrl=a.sender.plainProfileUrl,gn.metaData=a.sender.metaData,gn.isBlockedByMe=a.sender.isBlockedByMe);break}}catch(G){o_={error:G}}finally{try{h&&!h.done&&(gb=d.return)&&gb.call(d)}finally{if(o_)throw o_.error}}b&&s&&((r=a.mentionedUsers)===null||r===void 0||r.forEach(function(G){var L,we;try{for(var ge=K(l.members),Ae=ge.next();!Ae.done;Ae=ge.next()){var It=Ae.value;if(G.userId===It.userId){It.nickname=G.nickname,It.plainProfileUrl=G.plainProfileUrl,It.metaData=G.metaData;break}}}catch(ht){L={error:ht}}finally{try{Ae&&!Ae.done&&(we=ge.return)&&we.call(ge)}finally{if(L)throw L.error}}})),ee&&(A=this._sessionManager.currentUser)&&(A.nickname=a.sender.nickname,A.plainProfileUrl=a.sender.plainProfileUrl,A.metaData=a.sender.metaData)}a.silent&&!ee||(l.isEphemeral||Ue)&&(l._updateLastMessage(a),ee||l._shouldUpdateUnreadCountWith(a)&&l._updateUnreadCount(l.unreadMessageCount+1,l.unreadMentionCount+(s?1:0))),o&&l._updateLastMessage(a),An.updatePendingResponse(l,Date.now()),this._dispatcher.dispatch(new Se({channels:[l],context:{source:P.EVENT_MESSAGE_RECEIVED}})),a.silent&&!ee||he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onChannelChanged&&we.onChannelChanged(l)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),this._dispatcher.dispatch(new _t({messages:[a],source:P.EVENT_MESSAGE_RECEIVED})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onMessageReceived&&we.onMessageReceived(l,a),s&&we.onMentionReceived&&we.onMentionReceived(l,a)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=3;case 3:return[3,87];case 4:return f=null,t.code==="MEDI"?f=t.as(Jv):t.code==="FEDI"?f=t.as(e0):t.code==="AEDI"&&(f=t.as(KP)),f?(m=f.message,y=f.mentionCountChange,C=I.of(this._iid),b=C.useMemberInfoInMessage,An=C.requestDeduplicator,m.threadInfo&&(m.threadInfo.unreadReplyCount=void 0),m.channelType!==Pe.GROUP?[3,6]:(Ue=this._groupChannelCache.isCachedInMemory(m.channelUrl),[4,this.getChannel(m.channelUrl,!0)])):[3,6];case 5:if(v=Oe.sent(),ee=!1,m instanceof xt){ee=m.sender.userId===this._sdkState.userId,v.isSuper&&this._upsertCachedUserInfo(m.sender,m.updatedAt);try{for(E=K(v.members),S=E.next();!S.done;S=E.next())if((gn=S.value).userId===m.sender.userId){b&&(gn.nickname=m.sender.nickname,gn.plainProfileUrl=m.sender.plainProfileUrl,gn.metaData=m.sender.metaData,gn.isBlockedByMe=m.sender.isBlockedByMe);break}}catch(G){l_={error:G}}finally{try{S&&!S.done&&(vb=E.return)&&vb.call(E)}finally{if(l_)throw l_.error}}}X=!1,ee?(w=m.sender,(A=this._sessionManager.currentUser)&&(A.nickname=w.nickname,A.plainProfileUrl=w.plainProfileUrl,A.metaData=w.metaData)):v.isReadMessage(m)||y!==0&&!m.silent&&Ue&&(v._updateUnreadCount(v.unreadMessageCount,v.unreadMentionCount+y),X=!0),v._updateLastMessage(m)?X=!0:!((i=v.lastMessage)===null||i===void 0)&&i.isIdentical(m)&&(Ue?v._updateLastMessage(m)&&(X=!0):X=!0),D=!1,v.lastPinnedMessage&&v.lastPinnedMessage.messageId===m.messageId&&(v.lastPinnedMessage=m,X=!0,D=!0),X&&(An.updatePendingResponse(v,Date.now()),this._dispatcher.dispatch(new Se({channels:[v],context:{source:D?P.EVENT_PINNED_MESSAGE_UPDATED:P.EVENT_MESSAGE_UPDATED}})),m.silent&&!ee||he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onChannelChanged&&we.onChannelChanged(v)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),D&&he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onPinnedMessageUpdated&&we.onPinnedMessageUpdated(v)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})})),this._dispatcher.dispatch(new _t({messages:[m],source:P.EVENT_MESSAGE_UPDATED})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onMessageUpdated&&we.onMessageUpdated(v,m),y>0&&we.onMentionReceived&&we.onMentionReceived(v,m)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=6;case 6:return[3,87];case 7:return O=t.as(VO),cn=O.channelUrl,Mr=O.channelType,M=O.messageId,F=O.silent,U=O.messageCreatedAt,$=O.senderId,Mr!==Pe.GROUP?[3,9]:[4,this.getChannel(cn,!0)];case 8:J=Oe.sent(),ee=$===this._sdkState.userId,F||ee||U>0&&J.myLastRead<U&&J.unreadMessageCount>0&&(J._updateUnreadCount(J.unreadMessageCount-1,0),(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(J,Date.now())),this._dispatcher.dispatch(new Oy({messageIds:[M],source:P.EVENT_MESSAGE_DELETED})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onMessageDeleted&&we.onMessageDeleted(J,M)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=9;case 9:return[3,87];case 10:return(ve=t.as(YA).readStatus).channelType!==Pe.GROUP?[3,12]:(Ue=this._groupChannelCache.isCachedInMemory(ve.channelUrl),[4,this.getChannel(ve.channelUrl,!0)]);case 11:if(Q=Oe.sent(),(Z=ve.reader.userId===this._sdkState.userId)&&ve.isExcluded)return[2];X=!0,Ue&&Q._updateUnreadMemberState(ve.reader.userId,ve.readAt,ve.isExcluded),Z&&(Ue?Q.unreadMentionCount>0||Q.unreadMessageCount>0?Q._updateUnreadCount(0,0):X=!1:Q.unreadMessageCount!==0&&Q.unreadMentionCount!==0&&(X=!1)),X&&(this._dispatcher.dispatch(new Se({channels:[Q],context:{source:P.EVENT_CHANNEL_READ}})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae,It;return _(this,function(ht){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())we=L.value,(ge=Z?we.onChannelChanged:we.onUnreadMemberStatusUpdated)&&ge(Q)}catch(__){Ae={error:__}}finally{try{L&&!L.done&&(It=G.return)&&It.call(G)}finally{if(Ae)throw Ae.error}}return[2]})})})),Oe.label=12;case 12:return[3,87];case 13:return se=t.as(B8),cn=se.channelUrl,Ce=se.deliveredStateUpdate,Me=Ce===void 0?{}:Ce,Ue=this._groupChannelCache.isCachedInMemory(cn),[4,this.getChannel(cn,!0)];case 14:return Le=Oe.sent(),Ue&&Object.keys(Me).forEach(function(G){Le._updateUndeliveredMemberState(G,Me[G])}),Object.keys(Me).some(function(G){return G!==tt._sdkState.userId})&&(this._dispatcher.dispatch(new Se({channels:[Le],context:{source:P.EVENT_CHANNEL_DELIVERED}})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onUndeliveredMemberStatusUpdated&&we.onUndeliveredMemberStatusUpdated(Le)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})})),[3,87];case 15:return ot=t.as(WP),cn=ot.channelUrl,Mr=ot.channelType,pe=ot.event,Mr!==Pe.GROUP?[3,26]:[4,this.getChannel(cn,!0)];case 16:return lt=Oe.sent(),[4,this.getMessageFromCache(pe.messageId)];case 17:if($e=Oe.sent(),!lt.isSuper)return[3,25];Oe.label=18;case 18:Oe.trys.push([18,23,24,25]),an=K(Object.keys(pe._sampledUserInfoList)),oe=an.next(),Oe.label=19;case 19:return oe.done?[3,22]:(le=oe.value,[4,this._userInfoCache.get(le)]);case 20:(me=Oe.sent())?(me.plainProfileUrl=pe._sampledUserInfoList[le].profile_url,me.nickname=pe._sampledUserInfoList[le].nickname,this._upsertCachedUserInfo(me,pe.updatedAt)):(ke=new xe(this._iid,{user_id:le,nickname:pe._sampledUserInfoList[le].nickname,profile_url:pe._sampledUserInfoList[le].profile_url,require_auth_for_profile_image:pe._sampledUserInfoList[le].require_auth_for_profile_image}),this._upsertCachedUserInfo(ke,pe.updatedAt)),Oe.label=21;case 21:return oe=an.next(),[3,19];case 22:return[3,25];case 23:return fe=Oe.sent(),u_={error:fe},[3,25];case 24:try{oe&&!oe.done&&(yb=an.return)&&yb.call(an)}finally{if(u_)throw u_.error}return[7];case 25:$e?$e instanceof Vn&&($e.applyReactionEvent(pe),this._dispatcher.dispatch(new _t({messages:[$e],source:P.EVENT_MESSAGE_REACTION_UPDATED}))):this._dispatcher.dispatch(new LA({event:pe,source:P.EVENT_MESSAGE_REACTION_UPDATED})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onReactionUpdated&&we.onReactionUpdated(lt,pe)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=26;case 26:return[3,87];case 27:return(de=t.as(YP).event).channelType!==Pe.GROUP?[3,30]:[4,this.getChannel(de.channelUrl,!0)];case 28:return ue=Oe.sent(),[4,this.getMessageFromCache(de.targetMessageId)];case 29:if(($e=Oe.sent())?$e instanceof Vn&&($e.applyThreadInfoUpdateEvent(de),this._dispatcher.dispatch(new _t({messages:[$e],source:P.EVENT_MESSAGE_THREADINFO_UPDATED}))):this._dispatcher.dispatch(new PA({event:de,source:P.EVENT_MESSAGE_THREADINFO_UPDATED})),ue.isSuper)try{for(Yt=K(de.threadInfo.mostRepliedUsers),Qe=Yt.next();!Qe.done;Qe=Yt.next())mn=Qe.value,this._upsertCachedUserInfo(mn,de.threadInfo.updatedAt)}catch(G){c_={error:G}}finally{try{Qe&&!Qe.done&&(bb=Yt.return)&&bb.call(Yt)}finally{if(c_)throw c_.error}}he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onThreadInfoUpdated&&we.onThreadInfoUpdated(ue,de)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=30;case 30:return[3,87];case 31:Tt=t.as(ZP).groupChannelMemberCounts,et=[],Oe.label=32;case 32:Oe.trys.push([32,37,38,39]),Ye=K(Tt),kt=Ye.next(),Oe.label=33;case 33:return kt.done?[3,36]:(zn=kt.value,cn=zn.channelUrl,R=zn.memberCount,te=zn.joinedMemberCount,Cr=zn.updatedAt,[4,this.getChannelFromCache(cn)]);case 34:(fa=Oe.sent())&&fa._setLatestMemberCount(R,te,Cr)&&et.push(fa),Oe.label=35;case 35:return kt=Ye.next(),[3,33];case 36:return[3,39];case 37:return pa=Oe.sent(),d_={error:pa},[3,39];case 38:try{kt&&!kt.done&&(Eb=Ye.return)&&Eb.call(Ye)}finally{if(d_)throw d_.error}return[7];case 39:return et.length>0&&(this._dispatcher.dispatch(new Se({channels:et,context:{source:P.EVENT_CHANNEL_MEMBER_COUNT_UPDATED}})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onChannelMemberCountChanged&&we.onChannelMemberCountChanged(et)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})})),[3,87];case 40:return Xr=t.as(XP),so=Xr.event,Xu=Xr.status,cn=Xr.channelUrl,Mr=Xr.channelType,cn&&Mr===Pe.GROUP?[4,this.getChannel(cn,!0)]:[3,42];case 41:Nl=Oe.sent(),this._dispatcher.dispatch(new zA({event:so,source:P.EVENT_POLL_UPDATED})),he(Xu===Tk?function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onPollDeleted&&we.onPollDeleted(Nl,so.pollId)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}:function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onPollUpdated&&we.onPollUpdated(Nl,so)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=42;case 42:return[3,87];case 43:return ns=t.as(lN),Il=ns.event,cn=ns.channelUrl,Mr=ns.channelType,cn&&Mr===Pe.GROUP?[4,this.getChannel(cn,!0)]:[3,45];case 44:Jr=Oe.sent(),this._dispatcher.dispatch(new Dy({event:Il,source:P.EVENT_POLL_VOTED})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onPollVoted&&we.onPollVoted(Jr,Il)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),Oe.label=45;case 45:return[3,87];case 46:if(!(De=t.as(Zu).event).isGroupChannelEvent)return[3,85];switch(De.category){case Ht.CHANNEL_JOIN:return[3,47];case Ht.CHANNEL_LEAVE:return[3,49];case Ht.CHANNEL_OPERATOR_UPDATE:return[3,53];case Ht.CHANNEL_INVITE:return[3,55];case Ht.CHANNEL_DECLINE_INVITE:return[3,57];case Ht.TYPING_START:case Ht.TYPING_END:return[3,59];case Ht.USER_CHANNEL_MUTE:case Ht.USER_CHANNEL_UNMUTE:return[3,61];case Ht.USER_CHANNEL_BAN:return[3,63];case Ht.USER_CHANNEL_UNBAN:return[3,67];case Ht.CHANNEL_FREEZE:case Ht.CHANNEL_UNFREEZE:return[3,69];case Ht.CHANNEL_HIDE:return[3,71];case Ht.CHANNEL_UNHIDE:return[3,73];case Ht.CHANNEL_DELETED:return[3,75];case Ht.CHANNEL_PROP_CHANGED:return[3,76];case Ht.CHANNEL_META_DATA_CHANGED:return[3,79];case Ht.CHANNEL_META_COUNTERS_CHANGED:return[3,81];case Ht.PINNED_MESSAGE_CHANGED:return[3,83]}return[3,85];case 47:return[4,this.getChannel(De.channelUrl,!0)];case 48:if(Tn=Oe.sent(),rs=t.as(A8),gh=rs.memberCount,oo=rs.joinedMemberCount,ji=rs.members,Ml=!1,ji.forEach(function(G){Tn.isExclusive||Tn.isSuper||Tn.isBroadcast?Ml=Ml||Tn._setLatestMemberCount(gh,oo,De.ts):(G.state=Mt.JOINED,Tn.addMember(G,De.ts),tt._updateJoinedMemberCount(Tn)),G.userId===tt._sdkState.userId&&(Tn.myMemberState=Mt.JOINED)}),Tn.isSuper)try{for(wi=K(ji),is=wi.next();!is.done;is=wi.next())gn=is.value,this._upsertCachedUserInfo(gn,De.ts)}catch(G){h_={error:G}}finally{try{is&&!is.done&&(Cb=wi.return)&&Cb.call(wi)}finally{if(h_)throw h_.error}}return(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Tn,Date.now()),this._dispatcher.dispatch(new Se({channels:[Tn],context:{source:P.EVENT_CHANNEL_JOINED,users:ji}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){var we,ge;try{for(var Ae=K(ji),It=Ae.next();!It.done;It=Ae.next()){var ht=It.value;L.onUserJoined&&L.onUserJoined(Tn,ht)}}catch(__){we={error:__}}finally{try{It&&!It.done&&(ge=Ae.return)&&ge.call(Ae)}finally{if(we)throw we.error}}Tn.isBroadcast&&Ml&&L.onChannelMemberCountChanged&&L.onChannelMemberCountChanged([Tn])}),[2]})})}),[3,85];case 49:return(vh=this._leftChannels.get(De.channelUrl))?(Zt=vh.channel,[3,52]):[3,50];case 50:return[4,this.getChannel(De.channelUrl,!0)];case 51:Zt=Oe.sent(),Oe.label=52;case 52:return Lt=Zt,Ai=t.as(I8),R=Ai.memberCount,te=Ai.joinedMemberCount,Ni=Ai.member,xl=!1,lo=I.of(this._iid),Ol=lo.appInfo,An=lo.requestDeduplicator,Lt.isExclusive||Lt.isSuper||Lt.isBroadcast?xl=Lt._setLatestMemberCount(R,te,De.ts):(Ol?.enabledChannelMemberShipHistory?((Ju=Lt.members.find(function(G){return G.userId===Ni.userId}))&&(Ju.state=Mt.LEFT),Lt.memberCount=R):Lt.removeMember(Ni),this._updateJoinedMemberCount(Lt)),Ni.userId===this._sdkState.userId?(Lt.myMemberState=Mt.NONE,Lt.invitedAt=0,Lt.joinedAt=0,Lt._updateUnreadCount(0,0),Lt.isPublic?this._dispatcher.dispatch(new Se({channels:[Lt],context:{source:P.EVENT_CHANNEL_LEFT,user:Ni}})):(this._markAsLeave(Lt),this._dispatcher.dispatch(new Ta({channelUrls:[Lt.url],context:{source:P.EVENT_CHANNEL_LEFT,user:Ni}})))):this._dispatcher.dispatch(new Se({channels:[Lt],context:{source:P.EVENT_CHANNEL_LEFT,user:Ni}})),An.updatePendingResponse(Lt,Date.now()),Lt.isSuper&&this._upsertCachedUserInfo(Ni,De.ts),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onUserLeft&&L.onUserLeft(Lt,Ni),Lt.isBroadcast&&xl&&L.onChannelMemberCountChanged&&L.onChannelMemberCountChanged([Lt])}),[2]})})}),[3,85];case 53:return[4,this.getChannel(De.channelUrl,!0)];case 54:as=Oe.sent(),or=t.as(GP).operators,Qi=or.map(function(G){return G.userId});try{for(ss=K(as.members),ma=ss.next();!ma.done;ma=ss.next())(gn=ma.value).role=Qi.includes(gn.userId)?gi.OPERATOR:gi.NONE}catch(G){f_={error:G}}finally{try{ma&&!ma.done&&(Sb=ss.return)&&Sb.call(ss)}finally{if(f_)throw f_.error}}return as.myRole=Qi.includes(this._sdkState.userId)?gi.OPERATOR:gi.NONE,(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(as,Date.now()),this._dispatcher.dispatch(new Se({channels:[as],context:{source:P.EVENT_CHANNEL_OPERATOR_UPDATED,operators:or}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onOperatorUpdated&&L.onOperatorUpdated(as,or)}),[2]})})}),[3,85];case 55:return[4,this.getChannel(De.channelUrl,!0)];case 56:wn=Oe.sent(),os=t.as(O8),R=os.memberCount,te=os.joinedMemberCount,xr=os.inviter,(uo=os.invitees).forEach(function(G){return G.state=Mt.INVITED});try{for(ls=K(uo),_a=ls.next();!_a.done;_a=ls.next())co=_a.value,wn.isExclusive||wn.isSuper||wn.isBroadcast?(wn.isSuper&&this._userInfoCache.upsert(co,De.ts),wn._setLatestMemberCount(R,te,De.ts)):wn.addMember(co,De.ts),this._sdkState.userId===co.userId&&(wn.hiddenState=Pr.UNHIDDEN,wn.myMemberState!==Mt.JOINED&&(wn.myMemberState=Mt.INVITED),wn.invitedAt=De.ts)}catch(G){p_={error:G}}finally{try{_a&&!_a.done&&(Tb=ls.return)&&Tb.call(ls)}finally{if(p_)throw p_.error}}return(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(wn,Date.now()),this._dispatcher.dispatch(new Se({channels:[wn],context:{source:P.EVENT_CHANNEL_INVITED,inviter:xr,invitees:uo}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onUserReceivedInvitation&&L.onUserReceivedInvitation(wn,xr,uo)}),[2]})})}),[3,85];case 57:return[4,this.getChannel(De.channelUrl,!0)];case 58:return Hn=Oe.sent(),Ee=t.as(k8),R=Ee.memberCount,te=Ee.joinedMemberCount,_e=Ee.inviter,dt=Ee.invitee,Hn.isExclusive||Hn.isSuper||Hn.isBroadcast?(Hn.isSuper&&this._userInfoCache.upsert(dt,De.ts),Hn._setLatestMemberCount(R,te,De.ts)):Hn.removeMember(dt),this._sdkState.userId===dt.userId?(Hn.invitedAt=0,Hn.myMemberState=Mt.NONE,Hn.isPublic?this._dispatcher.dispatch(new Se({channels:[Hn],context:{source:P.EVENT_CHANNEL_DECLINED_INVITE,inviter:_e,invitee:dt}})):this._dispatcher.dispatch(new Ta({channelUrls:[Hn.url],context:{source:P.EVENT_CHANNEL_DECLINED_INVITE,inviter:_e,invitee:dt}}))):this._dispatcher.dispatch(new Se({channels:[Hn],context:{source:P.EVENT_CHANNEL_DECLINED_INVITE,inviter:_e,invitee:dt}})),(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Hn,Date.now()),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onUserDeclinedInvitation&&L.onUserDeclinedInvitation(Hn,_e,dt)}),[2]})})}),[3,85];case 59:return[4,this.getChannel(De.channelUrl,!0)];case 60:return Xt=Oe.sent(),Vt=De.category===Ht.TYPING_START,mn=t.as(Vt?F8:z8).user,Xt._updateTypingStatus(mn,Vt?De.ts:0),(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Xt,Date.now()),this._dispatcher.dispatch(new Se({channels:[Xt],context:{source:P.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onTypingStatusUpdated&&L.onTypingStatusUpdated(Xt)}),[2]})})}),[3,85];case 61:return[4,this.getChannel(De.channelUrl,!0)];case 62:_n=Oe.sent(),ei=De.category===Ht.USER_CHANNEL_MUTE,(Ii=t.as(ei?FR:zR).user).userId===this._sdkState.userId&&(_n.myMutedState=ei?Fi.MUTED:Fi.UNMUTED,_n._myMutedRemainingTime=Ii.restrictionInfo.remainingDuration);try{for(Jt=K(_n.members),ga=Jt.next();!ga.done;ga=Jt.next())if((gn=ga.value).userId===Ii.userId){gn.isMuted=ei;break}}catch(G){m_={error:G}}finally{try{ga&&!ga.done&&(wb=Jt.return)&&wb.call(Jt)}finally{if(m_)throw m_.error}}return _n.isSuper&&this._userInfoCache.upsert(Ii,De.ts),(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(_n,Date.now()),this._dispatcher.dispatch(new Se({channels:[_n],context:{source:ei?P.EVENT_CHANNEL_MUTED:P.EVENT_CHANNEL_UNMUTED,user:Ii}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){ei?L.onUserMuted&&L.onUserMuted(_n,Ii):L.onUserUnmuted&&L.onUserUnmuted(_n,Ii)}),[2]})})}),[3,85];case 63:return(vh=this._leftChannels.get(De.channelUrl))?(Zm=vh.channel,[3,66]):[3,64];case 64:return[4,this.getChannel(De.channelUrl,!0)];case 65:Zm=Oe.sent(),Oe.label=66;case 66:return ec=Zm,this._markAsLeave(ec),tc=t.as(qR).user,bh=tc.userId===this._sdkState.userId,ec.isSuper&&this._userInfoCache.upsert(tc,De.ts),bh&&this._dispatcher.dispatch(new Ta({channelUrls:[ec.url],context:{source:P.EVENT_CHANNEL_BANNED,user:tc}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onUserBanned&&L.onUserBanned(ec,tc)}),[2]})})}),[3,85];case 67:return[4,this.getChannel(De.channelUrl,!0)];case 68:return yh=Oe.sent(),nc=t.as(GR).user,bh=nc.userId===this._sdkState.userId,yh.isSuper&&this._userInfoCache.upsert(nc,De.ts),bh&&this._dispatcher.dispatch(new Ta({channelUrls:[yh.url],context:{source:P.EVENT_CHANNEL_UNBANNED,user:nc}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onUserUnbanned&&L.onUserUnbanned(yh,nc)}),[2]})})}),[3,85];case 69:return[4,this.getChannel(De.channelUrl,!0)];case 70:return Dl=Oe.sent(),Eh=t.as(VR).freeze,Dl.isFrozen=Eh,(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Dl,Date.now()),this._dispatcher.dispatch(new Se({channels:[Dl],context:{source:Eh?P.EVENT_CHANNEL_FROZEN:P.EVENT_CHANNEL_UNFROZEN}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){Eh?L.onChannelFrozen&&L.onChannelFrozen(Dl):L.onChannelUnfrozen&&L.onChannelUnfrozen(Dl)}),[2]})})}),[3,85];case 71:return[4,this.getChannel(De.channelUrl,!0)];case 72:return ho=Oe.sent(),Ch=t.as(L8),Xm=Ch.allowAutoUnhide,Jm=Ch.hidePreviousMessages,e_=Ch.messageOffsetTimestamp,Xm!==null&&(ho.hiddenState=Xm?Pr.HIDDEN_ALLOW_AUTO_UNHIDE:Pr.HIDDEN_PREVENT_AUTO_UNHIDE),Jm!==null&&Jm&&ho._updateUnreadCount(0,0),e_!==null&&(ho.messageOffsetTimestamp=e_),(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(ho,Date.now()),this._dispatcher.dispatch(new Se({channels:[ho],context:{source:P.EVENT_CHANNEL_HIDDEN}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onChannelHidden&&L.onChannelHidden(ho)}),[2]})})}),[3,85];case 73:return[4,this.getChannel(De.channelUrl,!0)];case 74:return(Sh=Oe.sent()).hiddenState=Pr.UNHIDDEN,(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Sh,Date.now()),this._dispatcher.dispatch(new Se({channels:[Sh],context:{source:P.EVENT_CHANNEL_UNHIDDEN}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onChannelChanged&&L.onChannelChanged(Sh)}),[2]})})}),[3,85];case 75:return this._dispatcher.dispatch(new Ta({channelUrls:[De.channelUrl],context:{source:P.EVENT_CHANNEL_DELETED}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onChannelDeleted&&L.onChannelDeleted(De.channelUrl,Pe.GROUP)}),[2]})})}),[3,85];case 76:return[4,tr(50)];case 77:return Oe.sent(),[4,this.getChannelWithoutCache(De.channelUrl,!0,!1)];case 78:return t_=Oe.sent(),this._dispatcher.dispatch(new Se({channels:[t_],context:{source:P.EVENT_CHANNEL_UPDATED}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onChannelChanged&&L.onChannelChanged(t_)}),[2]})})}),[3,85];case 79:return[4,this.getChannel(De.channelUrl,!0)];case 80:return Mi=Oe.sent(),Th=t.as(NR),fo=Th.created,po=Th.updated,mo=Th.deleted,fo&&(Mi._upsertCachedMetaData(fo,De.ts),this._dispatcher.dispatch(new Se({channels:[Mi],context:{source:P.EVENT_CHANNEL_METADATA_CREATED,metaData:fo},ts:De.ts}))),po&&(Mi._upsertCachedMetaData(po,De.ts),this._dispatcher.dispatch(new Se({channels:[Mi],context:{source:P.EVENT_CHANNEL_METADATA_UPDATED,metaData:po},ts:De.ts}))),mo&&(Mi._removeFromCachedMetaData(mo,De.ts),this._dispatcher.dispatch(new Se({channels:[Mi],context:{source:P.EVENT_CHANNEL_METADATA_DELETED,metaDataKeys:mo},ts:De.ts}))),(fo||po||mo)&&(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(Mi,Date.now()),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){fo&&L.onMetaDataCreated&&L.onMetaDataCreated(Mi,fo),po&&L.onMetaDataUpdated&&L.onMetaDataUpdated(Mi,po),mo&&L.onMetaDataDeleted&&L.onMetaDataDeleted(Mi,mo)}),[2]})})}),[3,85];case 81:return[4,this.getChannel(De.channelUrl,!0)];case 82:return _o=Oe.sent(),wh=t.as(RR),rc=wh.created,ic=wh.updated,ac=wh.deleted,rc&&this._dispatcher.dispatch(new Se({channels:[_o],context:{source:P.EVENT_CHANNEL_METACOUNTER_CREATED,metaCounters:rc}})),ic&&this._dispatcher.dispatch(new Se({channels:[_o],context:{source:P.EVENT_CHANNEL_METACOUNTER_UPDATED,metaCounters:ic}})),ac&&this._dispatcher.dispatch(new Se({channels:[_o],context:{source:P.EVENT_CHANNEL_METACOUNTER_DELETED,metaCounterKeys:ac}})),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){rc&&L.onMetaCounterCreated&&L.onMetaCounterCreated(_o,rc),ic&&L.onMetaCounterUpdated&&L.onMetaCounterUpdated(_o,ic),ac&&L.onMetaCounterDeleted&&L.onMetaCounterDeleted(_o,ac)}),[2]})})}),[3,85];case 83:return[4,this.getChannel(De.channelUrl,!0)];case 84:return va=Oe.sent(),Ah=t.as(VP),n_=Ah.pinnedMessageIds,mb=Ah.latestPinnedMessage,(_b=Ah.ts)>va._pinnedMessagesUpdatedAt&&(va.pinnedMessageIds=n_??[],va.lastPinnedMessage=mb,va._pinnedMessagesUpdatedAt=_b,(An=I.of(this._iid).requestDeduplicator).updatePendingResponse(va,Date.now()),this._dispatcher.dispatch(new Se({channels:[va],context:{source:P.EVENT_PINNED_MESSAGE_UPDATED}})),he(function(){return g(tt,void 0,void 0,function(){var G,L,we,ge,Ae;return _(this,function(It){try{for(G=K(this._groupChannelHandlers.values()),L=G.next();!L.done;L=G.next())(we=L.value).onChannelChanged&&we.onChannelChanged(va)}catch(ht){ge={error:ht}}finally{try{L&&!L.done&&(Ae=G.return)&&Ae.call(G)}finally{if(ge)throw ge.error}}return[2]})})}),he(function(){return g(tt,void 0,void 0,function(){return _(this,function(G){return this._groupChannelHandlers.forEach(function(L){L.onPinnedMessageUpdated&&L.onPinnedMessageUpdated(va)}),[2]})})})),[3,85];case 85:return[3,87];case 86:switch((r_=t.as(CN).event).category){case Vd.USER_BLOCK:i_=qp.getDataAsUserBlockEvent(this._iid,r_),Nh=i_.blocker,Ih=i_.blockee,this._groupChannelCache.block(Nh.userId,Ih.userId);break;case Vd.USER_UNBLOCK:a_=qp.getDataAsUserBlockEvent(this._iid,r_),Nh=a_.blocker,Ih=a_.blockee,this._groupChannelCache.unblock(Nh.userId,Ih.userId)}return[3,87];case 87:return[3,89];case 88:if(s_=Oe.sent(),fr(s_))throw s_;return[3,89];case 89:return[2]}})})},n.prototype._markAsLeave=function(t){var r,i=this,a=(r=this._leftChannels.get(t.url))!==null&&r!==void 0?r:{channel:t,ref:0};a.ref++,this._leftChannels.set(t.url,a),setTimeout(function(){a.ref--,a.ref===0&&i._leftChannels.delete(t.url)},1e4)},n.prototype.addHandler=function(t,r){this._groupChannelHandlers.set(t,r)},n.prototype.removeHandler=function(t){this._groupChannelHandlers.delete(t)},n.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},n.prototype.subscribeChannelEvent=function(t,r){this._groupChannelBroadcast.subscribe(t,r)},n.prototype.unsubscribeChannelEvent=function(t){this._groupChannelBroadcast.unsubscribe(t)},n.prototype._updateJoinedMemberCount=function(t){t.joinedMemberCount=t.members.filter(function(r){return r.state===Mt.JOINED}).length},n.prototype.getChannel=function(t,r){return r===void 0&&(r=!1),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:B(x("string",t)).throw(k.invalidParameters),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getChannelFromCache(t)];case 2:return(i=a.sent())?[2,i]:[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(t,r)];case 5:return[2,a.sent()]}})})},n.prototype.getChannelWithoutCache=function(t,r,i){return r===void 0&&(r=!1),i===void 0&&(i=!0),g(this,void 0,void 0,function(){var a,s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:return B(x("string",t)).throw(k.invalidParameters),a=I.of(this._iid).requestDeduplicator,s=new _0({channelUrl:t,isInternalCall:r}),[4,a.requestGetChannel(s.path,function(){return d._requestQueue.send(s)},s.params,i)];case 1:switch(o=h.sent(),l=o.as(g0).channel,u=l.unreadMessageCount,c=l.unreadMentionCount,l.myCountPreference){case Lr.UNREAD_MESSAGE_COUNT_ONLY:c=0;break;case Lr.UNREAD_MENTION_COUNT_ONLY:u=0;break;case Lr.OFF:u=0,c=0}return l._updateUnreadCount(u,c),[4,this.upsertChannelsToCache([l])];case 2:return[2,h.sent()[0]]}})})},n.prototype.refreshChannel=function(t,r,i,a){return r===void 0&&(r=!0),i===void 0&&(i=P.REFRESH_CHANNEL),a===void 0&&(a=!1),g(this,void 0,void 0,function(){var s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:return f.trys.push([0,5,,6]),s=I.of(this._iid).requestDeduplicator,o=new _0({channelUrl:t,isInternalCall:r,showLatestMessage:a}),[4,s.requestGetChannel(o.path,function(){return h._requestQueue.send(o)},o.params)];case 1:return l=f.sent(),(u=l.as(g0).channel).myMemberState!==Mt.NONE?[3,2]:(this._dispatcher.dispatch(new Ta({channelUrls:[u.url],context:{source:i}})),[3,4]);case 2:return[4,this.upsertChannelsToCache([u])];case 3:c=f.sent(),this._dispatcher.dispatch(new Se({channels:c,context:{source:i}})),f.label=4;case 4:return[3,6];case 5:return(d=f.sent()).code!==re.NON_AUTHORIZED&&d.code!==re.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new Ta({channelUrls:[t],context:{source:i}})),[3,6];case 6:return[2]}})})},n.prototype.getMyGroupChannels=function(t,r,i,a,s){return a===void 0&&(a=P.REQUEST_CHANNEL),s===void 0&&(s=!1),g(this,void 0,void 0,function(){var o,l,u,c,d,h,f,m,y;return _(this,function(C){switch(C.label){case 0:return r.createdAfter&&(r.createdAfter=Math.floor(r.createdAfter/1e3)),r.createdBefore&&(r.createdBefore=Math.floor(r.createdBefore/1e3)),o=!1,s&&(l=I.of(this._iid),u=l.appInfo,(c=l.cacheContext)&&!c.localCacheEnabled&&u?.enabledChannelMemberShipHistory&&u?.applicationAttributes.includes("left_user_view_support")&&(o=!0)),d=new u8(N(N({},r),{userId:this._sdkState.userId,token:t,limit:i,includeLeftChannel:s&&o})),[4,this._requestQueue.send(d)];case 1:return h=C.sent(),f=h.as(c8),m=f.channels,y=f.token,this._dispatcher.dispatch(new Se({channels:m,context:{source:a}})),[2,{channels:m,token:y}]}})})},n.prototype.getMyGroupChannelChangeLogs=function(t,r,i){return i===void 0&&(i=P.REQUEST_CHANNEL_CHANGELOGS),g(this,void 0,void 0,function(){var a,s,o,l,u,c,d,h;return _(this,function(f){switch(f.label){case 0:return a=N(N({},tm),r),B((x("string",t)||x("number",t))&&m0(a)).throw(k.invalidParameters),s=new o8(ae({userId:this._sdkState.userId,ts:typeof t=="number"?t:null,token:typeof t=="string"?t:null,filter:a})),[4,this._requestQueue.send(s)];case 1:return o=f.sent(),l=o.as(l8),u=l.updatedChannels,c=l.deletedChannelUrls,d=l.hasMore,h=l.ts,u.length>0&&this._dispatcher.dispatch(new Se({channels:u,context:{source:i},ts:h})),c.length>0&&this._dispatcher.dispatch(new Ta({channelUrls:c,context:{source:i}})),[2,{updatedChannels:u,deletedChannelUrls:c,hasMore:d,token:l.token}]}})})},n.prototype.getGroupChannelCount=function(t){return g(this,void 0,void 0,function(){var r,i,a;return _(this,function(s){switch(s.label){case 0:return r=N(N({},yI),t),B(bI(r)).throw(k.invalidParameters),i=new d8({userId:this._sdkState.userId,filter:r}),[4,this._requestQueue.send(i)];case 1:return a=s.sent(),[2,a.as(h8).groupChannelCount]}})})},n.prototype.getUnreadItemCount=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v;return _(this,function(E){switch(E.label){case 0:return r=N(N({},t8),t),B(function(S){return Te(Et,S.keys)&&Te("string",S.customTypeFilters,!0)&&Te("string",S.customTypesFilter,!0)}(r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.requestQueue,o=new f8({userId:a.userId,filter:r}),[4,s.send(o)];case 1:return l=E.sent(),u=l.as(p8),c=u.groupChannelUnreadMentionCount,d=u.groupChannelUnreadMessageCount,h=u.groupChannelInvitationCount,f=u.superGroupChannelUnreadMentionCount,m=u.superGroupChannelUnreadMessageCount,y=u.superGroupChannelInvitationCount,C=u.nonSuperGroupChannelUnreadMentionCount,b=u.nonSuperGroupChannelUnreadMessageCount,v=u.nonSuperGroupChannelInvitationCount,[2,W({groupChannelUnreadMentionCount:c,groupChannelUnreadMessageCount:d,groupChannelInvitationCount:h,superGroupChannelUnreadMentionCount:f,superGroupChannelUnreadMessageCount:m,superGroupChannelInvitationCount:y,nonSuperGroupChannelUnreadMentionCount:C,nonSuperGroupChannelUnreadMessageCount:b,nonSuperGroupChannelInvitationCount:v})]}})})},n.prototype.getTotalUnreadChannelCount=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new m8({userId:r.userId}),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(_8).unreadCount]}})})},n.prototype.getTotalUnreadMessageCount=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=N(N({},n8),t),B(r8(r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.sdkState,s=i.requestQueue,o=new g8({userId:a.userId,filter:r}),[4,s.send(o)];case 1:return l=u.sent(),[2,l.as(v8).unreadCount]}})})},n.prototype.getTotalScheduledMessageCount=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=N(N({},i8),t),B(function(l){return x("string",l.channelUrl,!0)&&Te(xs,l.scheduledStatus,!0)&&be(Un,l.messageTypeFilter)}(r)).throw(k.invalidParameters),i=I.of(this._iid).requestQueue,a=new y8(r),[4,i.send(a)];case 1:return s=o.sent(),[2,s.as(b8).count]}})})},n.prototype.getSubscribedTotalUnreadMessageCount=function(){var t=I.of(this._iid).subscribedUnreadMessageCount;return t.all>=0?t.all:0},n.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var t=0,r=I.of(this._iid).subscribedUnreadMessageCount;return Object.keys(r.customTypes).forEach(function(i){t+=r.customTypes[i]}),t},n.prototype.getSubscribedCustomTypeUnreadMessageCount=function(t){var r;return(r=I.of(this._iid).subscribedUnreadMessageCount.customTypes[t])!==null&&r!==void 0?r:0},n.prototype.createChannel=function(t){return g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=N(N({},jf),t),B(p0(r)).throw(k.invalidParameters),r.isPublic||(r.accessCode=void 0),i=new C8(N({userId:this._sdkState.userId},r)),[4,this._requestQueue.send(i)];case 1:return a=o.sent(),s=a.as(S8).channel,[4,this.upsertChannelsToCache([s])];case 2:return o.sent(),[2,s]}})})},n.prototype.markAsReadAll=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return t=Date.now(),B(t-this._markAsReadAllLastSentAt>=1e3).throw(k.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,r=new iS({userId:this._sdkState.userId}),[4,this._requestQueue.send(r)];case 1:c.sent(),i=this._groupChannelCache.channels;try{for(a=K(i),s=a.next();!s.done;s=a.next())(o=s.value)._updateUnreadMemberState(this._sdkState.userId,t),o._updateUnreadCount(0,0)}catch(d){l={error:d}}finally{try{s&&!s.done&&(u=a.return)&&u.call(a)}finally{if(l)throw l.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}})})},n.prototype.markAsReadWithChannelUrls=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d;return _(this,function(h){switch(h.label){case 0:return r=Date.now(),B(Te("string",t)&&r-this._markAsReadAllLastSentAt>=1e3).throw(k.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=r,i=new iS({userId:this._sdkState.userId,channelUrls:t}),[4,this._requestQueue.send(i)];case 1:h.sent(),a=this._groupChannelCache.channels,s=[];try{for(o=K(a),l=o.next();!l.done;l=o.next())u=l.value,t.includes(u.url)&&(u._updateUnreadMemberState(this._sdkState.userId,r),u._updateUnreadCount(0,0),s.push(u))}catch(f){c={error:f}}finally{try{l&&!l.done&&(d=o.return)&&d.call(o)}finally{if(c)throw c.error}}return s.length>0?[4,this.upsertChannelsToCache(s)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[2]}})})},n.prototype.markAsDelivered=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this.getChannel(t)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},n.prototype.getMessageFromCache=function(t){var r;return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this._messageCache.get(t)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},n.prototype.getExactlyMatchingMessagesForTokenFromCache=function(t,r,i){return g(this,void 0,void 0,function(){return _(this,function(a){switch(a.label){case 0:return[4,this._messageCache.fetch({channelUrl:t,token:r,filter:i,exactMatch:!0})];case 1:return[2,a.sent()]}})})},n.prototype.getMessagesFromCache=function(t,r,i,a,s,o){return s===void 0&&(s=dN),o===void 0&&(o=!0),g(this,void 0,void 0,function(){return _(this,function(l){switch(l.label){case 0:return[4,this._messageCache.fetch({channelUrl:t,token:r,limit:s,filter:a,backward:i==="next",inclusive:o})];case 1:return[2,l.sent()]}})})},n.prototype.getPollMessagesFromCache=function(t,r,i,a){return g(this,void 0,void 0,function(){return _(this,function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:t,token:r,limit:a,filter:i,backward:!1,isPollOnly:!0})];case 1:return[2,s.sent()]}})})},n.prototype.getCachedMessageCountBetween=function(t,r,i,a){return g(this,void 0,void 0,function(){return _(this,function(s){switch(s.label){case 0:return[4,this._messageCache.countBetween(t,r,new na({top:i,bottom:a}))];case 1:return[2,s.sent()]}})})},n.prototype.getUnsentMessagesFromCache=function(t,r){return g(this,void 0,void 0,function(){return _(this,function(i){switch(i.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:t,filter:r})];case 1:return[2,i.sent()]}})})},n.prototype.removeFailedMessageFromCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._unsentMessageCache.remove([t])];case 1:return r.sent(),[2]}})})},n}(jP),Or=function(e,n){return n instanceof xt?e.findIndex(function(t){return t instanceof xt&&n.isIdentical(t)}):e.findIndex(function(t){return t.isIdentical(n)})},Ec=function(e,n){return e.findIndex(function(t){return t instanceof Vn?t.messageId===n:t instanceof ll?t.notificationId===n:void 0})},Dg=function(e,n){if(e.length>0){for(var t=0,r=e.length-1,i=Math.floor((t+r)/2);t<r;){var a=e[i].createdAt-n.createdAt;if(a>0)r=i,i=Math.floor((t+r)/2);else{if(!(a<0))return i;t=i+1,i=Math.floor((t+r)/2)}}return e[i].createdAt>n.createdAt?i:i+1}return e.length},xi={},G8=function(){function e(n){var t=n._iid,r=n.channel,i=n.limit,a=i===void 0?100:i,s=this;this.ref=0,this._iid=t,this._channel=r,this._limit=a,this._prevSyncLoopCount=0;var o,l,u=I.of(this._iid),c=u.sdkState,d=u.cacheContext,h=u.dispatcher,f=u.logger,m=u.statManager,y=u.messageBackgroundSyncThrottleController;this._metadataKey=(o=c.userId,l=r.url,"sendbird:".concat(o,"@groupchannel/").concat(l,"/message/sync.meta"));var C=function(b,v){return"sendbird:".concat(b,"@groupchannel/").concat(v,"/message/sync")}(c.userId,r.url);this._prevSync=new Ya(C,function(b){return g(s,void 0,void 0,function(){var v=this;return _(this,function(E){switch(E.label){case 0:return[4,y.run("message-background-sync-".concat(r.url,"-prev"),function(){return g(v,void 0,void 0,function(){var S,w,A,D,O,M,F,U,$,J,ee,ve;return _(this,function(Q){switch(Q.label){case 0:return S={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata()];case 1:if(Q.sent(),f.debug("message background prev sync from",(M=this._metadata)===null||M===void 0?void 0:M.range.top),(F=this._metadata)===null||F===void 0?void 0:F.previousComplete)return[3,10];Q.label=2;case 2:return Q.trys.push([2,5,8,9]),[4,un.of(this._iid)._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,!(($=(U=this._metadata)===null||U===void 0?void 0:U.range)===null||$===void 0)&&$.top?this._metadata.range.top:b,{prevResultSize:this._limit,nextResultSize:0,replyType:Fn.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},P.SYNC_MESSAGE_BACKGROUND,!1,!1,ui.INTERNAL_BACKSYNC)];case 3:return(w=Q.sent().messages).length>0&&(A=w.map(function(Z){return Z.createdAt}),!((J=this._metadata)===null||J===void 0)&&(O=J.range).intersect.apply(O,ce([],ne(A),!1))?this.extendRange(w):this._metadata={range:new na({top:Math.min.apply(Math,ce([],ne(A),!1)),bottom:Math.max.apply(Math,ce([],ne(A),!1))}),previousComplete:!1}),S.hasNext=w.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(S.nextToken=this._metadata.range.top,this._metadata.previousComplete=w.length<this._limit),f.debug("message background prev sync progress",S),[4,this.saveMetadata()];case 4:return Q.sent(),[3,9];case 5:return D=Q.sent(),f.debug("message background prev sync error",D),D instanceof k&&D.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:Q.sent(),Q.label=7;case 7:throw D;case 8:return m.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(ve=(ee=d.localCacheConfig)===null||ee===void 0?void 0:ee.maxSize)!==null&&ve!==void 0?ve:0,use_local_cache:d.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:S.hasNext=!1,Q.label=11;case 11:return[2,S]}})})})];case 1:return[2,E.sent()]}})})}),this._nextSync=new Ya(C,function(b){return g(s,void 0,void 0,function(){var v=this;return _(this,function(E){switch(E.label){case 0:return[4,y.run("message-background-sync-".concat(r.url,"-next"),function(){return g(v,void 0,void 0,function(){var S,w,A,D,O,M,F,U,$,J,ee;return _(this,function(ve){switch(ve.label){case 0:return S={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:ve.sent(),f.debug("message background next sync from",(M=this._metadata)===null||M===void 0?void 0:M.range.bottom),ve.label=2;case 2:return ve.trys.push([2,5,6,7]),[4,un.of(this._iid)._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,!((U=(F=this._metadata)===null||F===void 0?void 0:F.range)===null||U===void 0)&&U.bottom?this._metadata.range.bottom:b,{prevResultSize:0,nextResultSize:this._limit,replyType:Fn.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},P.SYNC_MESSAGE_BACKGROUND,!1,!1,ui.INTERNAL_BACKSYNC)];case 3:return(w=ve.sent().messages).length>0&&(A=w.map(function(Q){return Q.createdAt}),!(($=this._metadata)===null||$===void 0)&&(O=$.range).intersect.apply(O,ce([],ne(A),!1))?this.extendRange(w):this._metadata={range:new na({top:Math.min.apply(Math,ce([],ne(A),!1)),bottom:Math.max.apply(Math,ce([],ne(A),!1))}),previousComplete:!1}),S.hasNext=w.length>=this._limit,this._metadata&&(S.nextToken=this._metadata.range.bottom),f.debug("message background next sync progress",S),[4,this.saveMetadata()];case 4:return ve.sent(),[3,7];case 5:throw D=ve.sent(),f.debug("message background next sync error",D),D;case 6:return m.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(ee=(J=d.localCacheConfig)===null||J===void 0?void 0:J.maxSize)!==null&&ee!==void 0?ee:0,use_local_cache:d.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,S]}})})})];case 1:return[2,E.sent()]}})})}),this._connectionEventContext=h.on(function(b){b instanceof Zr&&(b.stateType===He.CONNECTED?s.resume():s.pause())})}return e.of=function(n,t){return xi[n]||(xi[n]={}),xi[n][t.url]||(xi[n][t.url]=new e({_iid:n,channel:t})),xi[n][t.url].ref++,xi[n][t.url]},e.clear=function(n,t){xi[n]&&xi[n][t]&&(xi[n][t].close(),delete xi[n])},Object.defineProperty(e.prototype,"range",{get:function(){var n,t;return(t=(n=this._metadata)===null||n===void 0?void 0:n.range)!==null&&t!==void 0?t:new na({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var n;return!!(!((n=this._metadata)===null||n===void 0)&&n.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(n){var t;return(t=this.range)===null||t===void 0?void 0:t.includes.apply(t,ce([],ne(n.map(function(r){return r.createdAt})),!1))},e.prototype.extendRange=function(n){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,ce([],ne(n.map(function(r){return r.createdAt})),!1))},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,I.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:n=t.sent(),this._metadata=n?{range:new na(n.range),previousComplete:n.previousComplete}:{range:new na({}),previousComplete:!1},t.label=2;case 2:return[2,this._metadata]}})})},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this._metadata?[4,I.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}})})},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return n.sent(),this._metadata=void 0,[2]}})})},e.prototype.resume=function(n){var t,r,i,a;n===void 0&&(n=Date.now());var s=I.of(this._iid),o=s.logger,l=s.sessionManager;s.cacheContext.localCacheEnabled&&l.session.hasSession&&(o.debug("message background sync resume()"),this._prevSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start((r=(t=this._metadata)===null||t===void 0?void 0:t.range.top)!==null&&r!==void 0?r:n),this._nextSync.start((a=(i=this._metadata)===null||i===void 0?void 0:i.range.bottom)!==null&&a!==void 0?a:n))},e.prototype.pause=function(){I.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete xi[this._iid][this._channel.url])},e}(),Oi={},V8=function(){function e(n){var t=n._iid,r=n.channel,i=n.includeParams,a=this;this.ref=0,this._iid=t,this._channel=r,this._includeParams=i;var s,o,l=I.of(this._iid),u=l.logger,c=l.sdkState,d=l.dispatcher;this._metadataKey=(s=c.userId,o=r.url,"sendbird:".concat(s,"@groupchannel/").concat(o,"/message/changelogs.meta"));var h=function(f,m){return"sendbird:".concat(f,"@groupchannel/").concat(m,"/message/changelogs")}(c.userId,this._channel.url);this._sync=new Ya(h,function(){return g(a,void 0,void 0,function(){var f,m,y,C,b,v,E,S,w;return _(this,function(A){switch(A.label){case 0:return f={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:A.sent(),u.debug("message changelog sync from",(w=this._metadata)===null||w===void 0?void 0:w.token),A.label=2;case 2:return A.trys.push([2,5,,8]),[4,un.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,N({replyType:Fn.ALL},this._includeParams),P.SYNC_MESSAGE_CHANGELOGS)];case 3:return m=A.sent(),y=m.updatedMessages,C=m.deletedMessageIds,b=m.hasMore,v=m.token,E=m.forceUseNextToken,f.hasNext=b,f.nextToken=v,y.length>0||C.length>0?this._metadata&&(this._metadata.token=v):E&&this._metadata&&(this._metadata.token=v),u.debug("message changelog sync progress",f),[4,this.saveMetadata()];case 4:return A.sent(),[3,8];case 5:return S=A.sent(),u.debug("message changelog sync error",S),S instanceof k&&S.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:A.sent(),A.label=7;case 7:throw S;case 8:return[2,f]}})})}),this._connectionEventContext=d.on(function(f){f instanceof Zr&&(f.stateType===He.CONNECTED?a.resume():a.pause())})}return e.of=function(n,t,r){return Oi[n]||(Oi[n]={}),Oi[n][t.url]||(Oi[n][t.url]=new e({_iid:n,channel:t,includeParams:r})),Oi[n][t.url].ref++,Oi[n][t.url]},e.clear=function(n,t){Oi[n]&&Oi[n][t]&&(Oi[n][t].close(),delete Oi[n])},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(n=I.of(this._iid),t=n.cacheContext,r=n.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this._metadata?[4,I.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}})})},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return n.sent(),this._metadata=void 0,[2]}})})},e.prototype.resume=function(){var n=I.of(this._iid),t=n.logger;n.sessionManager.session.hasSession&&(t.debug("message changelog sync resume()"),this._sync.start(0))},e.prototype.pause=function(){I.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Oi[this._iid][this._channel.url])},e}(),bo={},j8=function(){function e(n){var t=n._iid,r=n.channel,i=n.hasPollMessage,a=this;this.ref=0,this._iid=t,this._channel=r;var s,o,l=I.of(this._iid),u=l.logger,c=l.sdkState,d=l.dispatcher;this._metadataKey=(s=c.userId,o=r.url,"sendbird:".concat(s,"@groupchannel/").concat(o,"/poll/changelogs.meta"));var h=function(f,m){return"sendbird:".concat(f,"@groupchannel/").concat(m,"/poll/changelogs")}(c.userId,this._channel.url);this._sync=new Ya(h,function(){return g(a,void 0,void 0,function(){var f,m,y,C,b,v,E,S;return _(this,function(w){switch(w.label){case 0:return f={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return w.sent(),u.debug("poll changelog sync from",(S=this._metadata)===null||S===void 0?void 0:S.token),(m=!this._metadata||!this._metadata.token)?[4,i()]:[3,3];case 2:m=!w.sent(),w.label=3;case 3:if(m)return[2,{hasNext:!1,nextToken:0}];this._metadata||(y=I.of(this._iid).firstConnectedAt,this._metadata={token:y}),w.label=4;case 4:return w.trys.push([4,7,,10]),[4,Pp.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return C=w.sent(),b=C.hasMore,v=C.token,f.hasNext=b,f.nextToken=v,this._metadata.token=v,u.debug("poll changelog sync progress",f),[4,this.saveMetadata()];case 6:return w.sent(),[3,10];case 7:return E=w.sent(),u.debug("poll changelog sync error",E),E instanceof k&&E.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:w.sent(),w.label=9;case 9:throw E;case 10:return[2,f]}})})}),this._connectionEventContext=d.on(function(f){f instanceof Zr&&(f.stateType===He.CONNECTED?a.resume():a.pause())})}return e.of=function(n,t,r){return bo[n]||(bo[n]={}),bo[n][t.url]||(bo[n][t.url]=new e({_iid:n,channel:t,hasPollMessage:r})),bo[n][t.url].ref++,bo[n][t.url]},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,I.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:n=t.sent(),this._metadata=n?{token:n.token}:void 0,t.label=2;case 2:return[2]}})})},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this._metadata?[4,I.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return n.sent(),this._metadata=void 0,[2]}})})},e.prototype.resume=function(){I.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},e.prototype.pause=function(){I.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete bo[this._iid][this._channel.url])},e}(),Q8=function(e){function n(t){var r,i,a,s,o,l,u,c,d,h,f=this;return(f=e.call(this)||this).method=z.GET,f.path="".concat(Re(t.channelType),"/").concat(t.channelUrl,"/messages_gap"),f.params=W({prev_start_ts:t.prevStart,prev_end_ts:t.prevEnd,prev_cache_count:t.prevCount,next_start_ts:t.nextStart,next_end_ts:t.nextEnd,next_cache_count:t.nextCount,huge_gap_threshold:(r=t.threshold)!==null&&r!==void 0?r:null,reverse:!0,custom_types:(i=t.customTypes)!==null&&i!==void 0?i:["*"],message_type:(a=t.messageType)!==null&&a!==void 0?a:null,include_reply_type:(s=t.replyType)!==null&&s!==void 0?s:Fn.NONE,include_reactions_summary:(o=t.includeReactions)===null||o===void 0||o,include_meta_array:(l=t.includeMetaArray)===null||l===void 0||l,include_thread_info:(u=t.includeThreadInfo)===null||u===void 0||u,include_parent_message_info:(c=t.includeParentMessageInfo)===null||c===void 0||c,with_sorted_meta_array:(d=t.includeMetaArray)===null||d===void 0||d,show_subchannel_messages_only:(h=t.showSubchannelMessagesOnly)!==null&&h!==void 0&&h,include_poll_details:!0,checking_continuous_messages:t.checkingContinuousMessages}),f}return T(n,e),n}(H),K8=function(e){function n(t,r){var i,a,s,o,l,u,c=this;return(c=e.call(this,t,r)||this).isHugeGap=r.is_huge_gap,c.prevMessages=((i=r.prev_messages)!==null&&i!==void 0?i:[]).map(function(d){return Zn(t,d)}),c.prevHasMore=(a=r.prev_hasmore)!==null&&a!==void 0&&a,c.isContinuousPrevMessages=(s=r.is_continuous_prev_messages)!==null&&s!==void 0&&s,c.nextMessages=((o=r.next_messages)!==null&&o!==void 0?o:[]).map(function(d){return Zn(t,d)}),c.nextHasmore=(l=r.next_hasmore)!==null&&l!==void 0&&l,c.isContinuousNextMessages=(u=r.is_continuous_next_messages)!==null&&u!==void 0&&u,c}return T(n,e),n}(j),aS={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};(function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"})(nm||(nm={}));var bd,Ed,Cd,W8=function(){function e(){this._onCacheResult=Ne,this._onApiResult=Ne}return e.prototype._invokeResponse=function(n,t,r){var i=this;he(function(){return g(i,void 0,void 0,function(){return _(this,function(a){switch(n){case"local":this._onCacheResult(t,r);break;case"remote":this._onApiResult(t,r)}return[2]})})})},e.prototype.onCacheResult=function(n){return this._onCacheResult=n,this},e.prototype.onApiResult=function(n){return this._onApiResult=n,this},e}(),Y8=function(){function e(n,t){var r=t.filter,i=t.startingPoint,a=t.limit,s=t.prevResultLimit,o=t.nextResultLimit,l=t.channel,u=t.channelManager,c=t.disableBackgroundSync,d=c!==void 0&&c,h=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=n,this._key="mc-".concat(Wr()),this._isDisposed=!1,this.filter=r??new Wa,this._channel=l,this._syncRange=new na({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint=typeof i=="number"&&Number.isFinite(i)?i:Number.MAX_SAFE_INTEGER,this._limit=a||dN,this._prevResultLimit=s??Math.floor(this._limit/2),this._nextResultLimit=o??Math.floor(this._limit/2),this._channelManager=u;var f=I.of(this._iid).statManager;this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(v,E){var S=E.source,w=v.findIndex(function(A){return A.isIdentical(h.channel)});w>=0&&(h._replaceChannelOfCollection(v[w]),h.channel._runIfHandleableWithGroupChannel(function(A){switch(S){case P.EVENT_CHANNEL_UPDATED:for(var D=!1,O=0;O<h._messages.length;O++)if(h._messages[O].createdAt>=A.messageOffsetTimestamp){D=!0;var M=O;if(M>0){var F=h._messages.splice(0,M);h._removeMessagesFromView(F.map(function(J){return h.keyOf(J)}),P.EVENT_MESSAGE_OFFSET_UPDATED)}break}!D&&h._messages.length>0&&h._removeMessagesFromView(h._messages.map(function(J){return h.keyOf(J)}),P.EVENT_MESSAGE_OFFSET_UPDATED);break;case P.EVENT_CHANNEL_UNMUTED:var U=I.of(h._iid).sdkState,$=E.user;U.userId===$.userId&&h._clearCheckMyMutedTimer();break;case P.EVENT_CHANNEL_MUTED:U=I.of(h._iid).sdkState,$=E.user,U.userId===$.userId&&A._myMutedRemainingTime!==-1&&h._startCheckMyMutedTimer(A._myMutedRemainingTime);break;case P.EVENT_CHANNEL_LEFT:A.isPublic&&h._clearCheckMyMutedTimer()}he(function(){return g(h,void 0,void 0,function(){var J;return _(this,function(ee){return Qf(S)&&(!((J=this._handler)===null||J===void 0)&&J.onChannelUpdated)&&this._handler.onChannelUpdated(E,this.channel),[2]})})})}),h._postprocessChannelUpdateEvent(v[w],S))},onRemove:function(v,E){var S=v.indexOf(h.channel.url);S>=0&&h._channel._runIfHandleableWithGroupChannel(function(w){w.myMemberState=Mt.NONE,h._clearCheckMyMutedTimer(),he(function(){return g(h,void 0,void 0,function(){var A;return _(this,function(D){return!((A=this._handler)===null||A===void 0)&&A.onChannelDeleted&&this._handler.onChannelDeleted(E,this.channel.url),[2]})})}),h._postprocessChannelRemoveEvent(v[S])})}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(v,E){var S,w,A=[],D=[];try{for(var O=K(v),M=O.next();!M.done;M=O.next()){var F=M.value;F.channelUrl===h._channel.url&&(h.filter.match(F)?A.push(F):D.push(h.keyOf(F)))}}catch(U){S={error:U}}finally{try{M&&!M.done&&(w=O.return)&&w.call(O)}finally{if(S)throw S.error}}if(Na(E)){if(A.length>0)switch(E){case P.LOCAL_MESSAGE_CANCELED:case P.LOCAL_MESSAGE_RESEND_STARTED:case P.EVENT_MESSAGE_SENT_FAILED:case P.EVENT_MESSAGE_SENT_SUCCESS:case P.EVENT_MESSAGE_UPDATED:case P.EVENT_MESSAGE_THREADINFO_UPDATED:case P.EVENT_MESSAGE_REACTION_UPDATED:case P.EVENT_MESSAGE_FEEDBACK_ADDED:case P.EVENT_MESSAGE_FEEDBACK_UPDATED:case P.EVENT_MESSAGE_FEEDBACK_DELETED:case P.SYNC_MESSAGE_CHANGELOGS:h._updateMessagesToView(A,E);break;case P.EVENT_MESSAGE_SENT_PENDING:h._addMessagesToView(A,E);break;case P.EVENT_MESSAGE_RECEIVED:h.hasNext||h._addMessagesToView(A,E);break;case P.SYNC_MESSAGE_FILL:h._addMessagesToView(A,E)}D.length>0&&h._removeMessagesFromView(D,E)}h._postprocessMessageUpdateEvent(v,E)},onRemove:function(v,E){h._removeMessagesFromView(v,E),h._postprocessMessageRemoveEvent(v)},onRemoveUnsent:function(v,E){h._removeUnsentMessageFromView(v,E)},onPollChangeLogUpdate:function(v,E){h._updatePollsToView(v,E)},onPollUpdate:function(v,E){h._applyPollUpdateEventToView(v,E)},onPollVote:function(v,E){h._applyPollVoteEventToView(v,E)},onReactionUpdate:function(v,E){h._applyReactionEventToView(v,E)},onThreadInfoUpdate:function(v,E){h._applyThreadInfoEventToView(v,E)},onDeletedByRetentionPolicy:function(v,E,S){E===h.channel.url&&h._messageRetention(v,S)}});var m=I.of(this._iid),y=m.cacheContext,C=m.dispatcher,b=m.messageBackgroundSyncThrottleController;this._channel._updateMessageCollectionLastAccessedAt(),C.dispatch(new Se({channels:[this._channel],context:{source:P.CHANNEL_LASTACCESSEDAT_UPDATED}})),this._backgroundSync=G8.of(this._iid,this._channel),!d&&this._shouldStartBackgroundSync()&&this._backgroundSync.resume(this._startingPoint),this._changelogSync=V8.of(this._iid,this._channel,this.changelogIncludeParams),this._changelogSync.resume(),this._pollChangelogSync=j8.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new Ya(this._key,function(v){return g(h,void 0,void 0,function(){var E=this;return _(this,function(S){switch(S.label){case 0:return[4,b.run("message-fill-sync-".concat(l.url,"-prev"),function(){return g(E,void 0,void 0,function(){var w,A,D,O,M,F,U;return _(this,function($){switch($.label){case 0:return[4,this._getRemoteMessages(v,{prevLimit:this._prevResultLimit,source:P.SYNC_MESSAGE_FILL,checkingContinuousMessages:y.localCacheEnabled,sdkSource:ui.INTERNAL_FILL_GAP})];case 1:return w=$.sent(),A=w.messages,D=w.isContinuousMessages,A.length>0?(O=Math.min.apply(Math,ce([],ne(A.map(function(J){return J.createdAt})),!1)),this._syncRange.extends(O),D&&((M=this._backgroundSync)===null||M===void 0||M.range.extends(O)),[2,{hasNext:A.length>=this._prevResultLimit&&this.viewTop<O,nextToken:this._syncRange.top}]):(y.localCacheEnabled&&f.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(U=(F=y.localCacheConfig)===null||F===void 0?void 0:F.maxSize)!==null&&U!==void 0?U:0,use_local_cache:y.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,S.sent()]}})})}),this._nextFill=new Ya(this._key,function(v){return g(h,void 0,void 0,function(){var E=this;return _(this,function(S){switch(S.label){case 0:return[4,b.run("message-fill-sync-".concat(l.url,"-next"),function(){return g(E,void 0,void 0,function(){var w,A,D,O,M,F,U,$;return _(this,function(J){switch(J.label){case 0:return[4,this._getRemoteMessages(v,{nextLimit:this._nextResultLimit,source:P.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:y.localCacheEnabled,sdkSource:ui.INTERNAL_FILL_GAP})];case 1:return w=J.sent(),A=w.messages,D=w.isContinuousMessages,O=w.hasNext,A.length>0?(M=Math.max.apply(Math,ce([],ne(A.map(function(ee){return ee.createdAt})),!1)),this._syncRange.extends(M),D&&((F=this._backgroundSync)===null||F===void 0||F.range.extends(M)),[2,{hasNext:O,nextToken:this._syncRange.bottom}]):(y.localCacheEnabled&&f.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:($=(U=y.localCacheConfig)===null||U===void 0?void 0:U.maxSize)!==null&&$!==void 0?$:0,use_local_cache:y.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,S.sent()]}})})}),this._connectionEventContext=C.on(function(v){if(v instanceof Zr)switch(v.stateType){case He.CONNECTED:Ct(function(){return g(h,void 0,void 0,function(){return _(this,function(E){return this._activate(),[2]})})});break;case He.LOGOUT:h.dispose();break;default:h._clearCheckMyMutedTimer(),h._prevFill.stop(),h._nextFill.stop()}})}return e.prototype.keyOf=function(n){return 0},Object.defineProperty(e.prototype,"changelogIncludeParams",{get:function(){return{includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0}},enumerable:!1,configurable:!0}),e.prototype._postprocessChannelUpdateEvent=function(n,t){},e.prototype._postprocessChannelRemoveEvent=function(n){},e.prototype._postprocessMessageUpdateEvent=function(n,t){},e.prototype._postprocessMessageRemoveEvent=function(n){},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return ce([],ne(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter(function(n){return n.sendingStatus===rt.FAILED})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter(function(n){return n.sendingStatus===rt.PENDING})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,ce(ce([],ne(this._messages.map(function(n){return n.createdAt})),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,ce(ce([],ne(this._messages.map(function(n){return n.createdAt})),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype._activate=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return I.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(P.SYNC_CHANNEL_CHANGELOGS)];case 1:return n.sent(),[2]}})})},e.prototype._replaceChannelOfCollection=function(n){this._channel.isGroupChannel()?this._channel=n:this._channel.isFeedChannel()&&(this._channel._groupChannel=n._groupChannel)},e.prototype._shouldStartBackgroundSync=function(){var n=I.of(this._iid).cacheContext;return this.channel.isGroupChannel()?n.localCacheEnabled&&!this.channel.isSuper:n.localCacheEnabled},e.prototype._setBaseMessageCollectionHandler=function(n){this._handler=n},e.prototype._filterUnderOffsetMessage=function(n){return n},e.prototype._updateChildMessagesInView=function(n){var t=[];return this._messages.forEach(function(r){r instanceof Vn&&r.parentMessageId===n.messageId&&r.applyParentMessage(n)&&t.push(r)}),t},e.prototype._updatePollsToView=function(n,t){var r,i,a=this,s=[];try{for(var o=K(n),l=o.next();!l.done;l=o.next()){var u=l.value,c=Ec(this._messages,u.messageId);if(c>=0){var d=this._messages[c];d.isUserMessage()&&d.applyPoll(u),s.push(d)}}}catch(h){r={error:h}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s.length>0&&Na(t)&&he(function(){return g(a,void 0,void 0,function(){var h,f,m;return _(this,function(y){return h={source:t},s.length>0&&((m=(f=this._handler).onMessagesUpdated)===null||m===void 0||m.call(f,h,this.channel,s)),[2]})})}),s},e.prototype._applyPollUpdateEventToView=function(n,t){var r=this,i=Ec(this._messages,n.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollUpdateEvent(n)&&Na(t)&&he(function(){return g(r,void 0,void 0,function(){var s,o,l;return _(this,function(u){return s={source:t},(l=(o=this._handler)===null||o===void 0?void 0:o.onMessagesUpdated)===null||l===void 0||l.call(o,s,this.channel,[a]),[2]})})})}},e.prototype._applyPollVoteEventToView=function(n,t){var r=this,i=Ec(this._messages,n.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollVoteEvent(n)&&Na(t)&&he(function(){return g(r,void 0,void 0,function(){var s,o,l;return _(this,function(u){return s={source:t},(l=(o=this._handler)===null||o===void 0?void 0:o.onMessagesUpdated)===null||l===void 0||l.call(o,s,this.channel,[a]),[2]})})})}},e.prototype._applyReactionEventToView=function(n,t){var r=this,i=Ec(this._messages,n.messageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&Na(t)&&(a.applyReactionEvent(n),he(function(){return g(r,void 0,void 0,function(){var s,o,l;return _(this,function(u){return s={source:t},(l=(o=this._handler)===null||o===void 0?void 0:o.onMessagesUpdated)===null||l===void 0||l.call(o,s,this.channel,[a]),[2]})})}))}},e.prototype._applyThreadInfoEventToView=function(n,t){var r=this,i=Ec(this._messages,n.targetMessageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&Na(t)&&(a.applyThreadInfoUpdateEvent(n),he(function(){return g(r,void 0,void 0,function(){var s,o,l;return _(this,function(u){return s={source:t},(l=(o=this._handler)===null||o===void 0?void 0:o.onMessagesUpdated)===null||l===void 0||l.call(o,s,this.channel,[a]),[2]})})}))}},e.prototype._removeMessagesFromView=function(n,t){var r,i,a=this,s=[],o=[],l=function(h){var f=u._messages.findIndex(function(y){return a.keyOf(y)===h});if(f>=0){var m=u._messages[f];s.push(u.keyOf(m)),o.push(m),u._messages.splice(f,1)}},u=this;try{for(var c=K(n),d=c.next();!d.done;d=c.next())l(d.value)}catch(h){r={error:h}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return Na(t)&&o.length>0&&he(function(){return g(a,void 0,void 0,function(){var h,f,m;return _(this,function(y){return h={source:t},(m=(f=this._handler)===null||f===void 0?void 0:f.onMessagesDeleted)===null||m===void 0||m.call(f,h,this.channel,s,o),[2]})})}),s},e.prototype._messageRetention=function(n,t){var r,i,a=[];try{for(var s=K(this._messages),o=s.next();!o.done;o=s.next()){var l=o.value;l.createdAt<=n&&a.push(this.keyOf(l))}}catch(u){r={error:u}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}a.length>0&&this._removeMessagesFromView(a,t)},e.prototype._removeUnsentMessageFromView=function(n,t){var r=this._unsentMessages.findIndex(function(i){return i.reqId===n});r>=0&&this._unsentMessages.splice(r,1)},e.prototype._getLocalMessages=function(n,t){var r=t.prevLimit,i=r===void 0?0:r,a=t.nextLimit,s=a===void 0?0:a,o=t.inclusive,l=o===void 0||o;return g(this,void 0,void 0,function(){var u,c,d,h,f;return _(this,function(m){switch(m.label){case 0:return u=[],l?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,n,this.filter)]:[3,2];case 1:u=m.sent(),m.label=2;case 2:return i>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,n,"prev",this.filter,i,!1)]:[3,4];case 3:return d=m.sent(),[3,5];case 4:d=[],m.label=5;case 5:return c=d,s>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,n,"next",this.filter,s,!1)]:[3,7];case 6:return f=m.sent(),[3,8];case 7:f=[],m.label=8;case 8:return h=f,[2,{messages:ce(ce(ce([],ne(u),!1),ne(c),!1),ne(h),!1).sort(function(y,C){return C.createdAt-y.createdAt}),prevMessagesCount:c.length,nextMessagesCount:h.length}]}})})},e.prototype._getRemoteMessages=function(n,t){var r=t.prevLimit,i=r===void 0?0:r,a=t.nextLimit,s=a===void 0?0:a,o=t.source,l=o===void 0?P.REQUEST_MESSAGE:o,u=t.reverse,c=u!==void 0&&u,d=t.checkingHasNext,h=d!==void 0&&d,f=t.checkingContinuousMessages,m=f!==void 0&&f,y=t.sdkSource;return g(this,void 0,void 0,function(){var C,b;return _(this,function(v){switch(v.label){case 0:return C=un.of(this._iid),i>0||s>0?[4,C._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,n,ae(N(N(N({},this.filter),aS),{isInclusive:!0,reverse:c,prevResultSize:i,nextResultSize:s})),l,h,m,y)]:[3,2];case 1:return b=v.sent(),[3,3];case 2:b={messages:[],isContinuousMessages:!1},v.label=3;case 3:return[2,b]}})})},e.prototype._checkHugeGap=function(){var n,t,r,i,a;return g(this,void 0,void 0,function(){var s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M,F,U,$,J,ee,ve=this;return _(this,function(Q){switch(Q.label){case 0:return s=I.of(this._iid),o=s.dispatcher,l=s.requestQueue,u=s.cacheContext,c=s.statManager,d=s.logger,this._messages.length>0?(h=this._syncRange.top,f=this.viewTop,m=this._syncRange.bottom,y=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,f,h)]):[3,8];case 1:return C=Q.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,m,y)];case 2:b=Q.sent(),Q.label=3;case 3:return Q.trys.push([3,5,6,7]),[4,Nm(function(){return g(ve,void 0,void 0,function(){var Z,X,se,Ce,Me,Ue,Le,ot,pe,lt,an,oe,le,me,ke,fe,de,ue=this;return _(this,function($e){switch($e.label){case 0:return Z=new Q8(N(N({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:f,prevEnd:h,prevCount:C,nextStart:m,nextEnd:y,nextCount:b,checkingContinuousMessages:u.localCacheEnabled},this.filter),aS)),[4,l.send(Z)];case 1:return X=$e.sent(),se=X.as(K8),Ce=se.isHugeGap,Me=se.prevMessages,Ue=Me===void 0?[]:Me,Le=se.prevHasMore,ot=se.isContinuousPrevMessages,pe=se.nextMessages,lt=pe===void 0?[]:pe,an=se.nextHasmore,oe=se.isContinuousNextMessages,Ce?he(function(){return g(ue,void 0,void 0,function(){var Yt;return _(this,function(Qe){return!((Yt=this._handler)===null||Yt===void 0)&&Yt.onHugeGapDetected&&this._handler.onHugeGapDetected(),[2]})})}):(le=this.viewTop,me=this.viewBottom,ke=Math.min.apply(Math,ce([Number.MAX_SAFE_INTEGER,le],ne(Ue.map(function(Yt){return Yt.createdAt})),!1)),fe=Math.max.apply(Math,ce([0,me],ne(lt.map(function(Yt){return Yt.createdAt})),!1)),o.dispatch(new _t({messages:Ue,source:P.SYNC_MESSAGE_FILL})),o.dispatch(new _t({messages:lt,source:P.SYNC_MESSAGE_FILL})),this._syncRange.extends(ke,fe),(ot||oe)&&((de=this._backgroundSync)===null||de===void 0||de.range.extends(ke,fe)),Le&&this._prevFill.start(ke),an&&this._nextFill.start(fe)),[2]}})})},1)];case 4:return Q.sent(),[3,7];case 5:return v=Q.sent(),d.debug("Failed HugeGap Check ",v),[3,7];case 6:return u.localCacheEnabled&&c.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(t=(n=u.localCacheConfig)===null||n===void 0?void 0:n.maxSize)!==null&&t!==void 0?t:0,use_local_cache:u.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:E=Date.now(),Q.label=9;case 9:return Q.trys.push([9,11,12,13]),[4,this._getRemoteMessages(E,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,source:P.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:u.localCacheEnabled,sdkSource:ui.INTERNAL_FILL_GAP})];case 10:if(S=Q.sent(),w=S.messages,A=S.isContinuousMessages,D=S.hasNext,w.length>0){for(O=w.map(function(Z){return Z.createdAt}),M=0,F=0,U=0;U<O.length;U++)($=O[U])<=E?M++:$>=E&&F++;this._hasPrevious=M>=this._prevResultLimit,this._hasNext=D??F>=this._nextResultLimit,(ee=this._syncRange).extends.apply(ee,ce([],ne(O),!1)),A&&((r=this._backgroundSync)===null||r===void 0||r.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(w,P.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return(J=Q.sent())instanceof k&&J.code===re.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return u.localCacheEnabled&&c.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(a=(i=u.localCacheConfig)===null||i===void 0?void 0:i.maxSize)!==null&&a!==void 0?a:0,use_local_cache:u.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}})})},e.prototype._loadUnsentMessages=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return n=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return n._unsentMessages=t.sent(),[2]}})})},e.prototype._hasPollMessage=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+6e5,this.filter,1)];case 1:return n.sent().length>0?[2,!0]:[2,!1]}})})},e.prototype._refreshChannel=function(n,t){return t===void 0&&(t=!1),g(this,void 0,void 0,function(){var r,i,a=this;return _(this,function(s){switch(s.label){case 0:r=I.of(this._iid).logger,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._channelManager.refreshChannel(this.channel.url,!0,n,t)];case 2:return s.sent(),this.channel._runIfHandleableWithGroupChannel(function(o){o.myMutedState===Fi.MUTED&&Ct(function(){return g(a,void 0,void 0,function(){var l;return _(this,function(u){switch(u.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(l=u.sent()).isMuted&&l.remainingDuration!==-1&&this._startCheckMyMutedTimer(l.remainingDuration),[2]}})})})}),[3,4];case 3:return i=s.sent(),r.warn("Failed to refresh channel",i),[3,4];case 4:return[2]}})})},e.prototype._startCheckMyMutedTimer=function(n){var t=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout(function(){return g(t,void 0,void 0,function(){var r,i,a,s=this;return _(this,function(o){switch(o.label){case 0:this._checkMyMutedStateTimer=void 0,r=!0,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return i=o.sent(),r=!i.isMuted,[3,5];case 3:return o.sent(),r=!0,[3,5];case 4:return r&&(a=I.of(this._iid).sessionManager,this.channel._runIfHandleableWithGroupChannel(function(l){var u,c;l.myMutedState=Fi.UNMUTED;var d={source:P.EVENT_CHANNEL_UNMUTED,user:a.currentUser};(c=(u=s._handler)===null||u===void 0?void 0:u.onChannelUpdated)===null||c===void 0||c.call(u,d,s.channel)})),[7];case 5:return[2]}})})},n+1e3)},e.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},e.prototype._setHasNextAndHasPrevious=function(n,t){for(var r=n.map(function(l){return l.createdAt}),i=0,a=0,s=0;s<r.length;s++){var o=r[s];o<this._startingPoint?i++:o>this._startingPoint&&a++}this._hasPrevious=i>=this._prevResultLimit,this._hasNext=t??a>=this._nextResultLimit},e.prototype.initialize=function(n){var t=this,r=new W8;this._messages=[],this._unsentMessages=[],this._syncRange=new na({}),this._hasNext=!0,this._hasPrevious=!0;var i=[],a={messages:[],prevMessagesCount:0,nextMessagesCount:0};return he(function(){return g(t,void 0,void 0,function(){var s,o,l,u,c,d=this;return _(this,function(h){switch(h.label){case 0:return[4,(c=this._backgroundSync)===null||c===void 0?void 0:c.loadMetadata()];case 1:return s=h.sent(),o=I.of(this._iid),l=o.cacheContext,u=o.statManager,n===nm.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit}).then(function(f){return g(d,void 0,void 0,function(){return _(this,function(m){switch(m.label){case 0:return a=f,i=this._filterUnderOffsetMessage(a.messages),this._addMessagesToView(i,P.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return m.sent(),r._invokeResponse("local",null,i),[2]}})})}).catch(function(f){if(fr(f))throw f;r._invokeResponse("local",f,null)}).finally(function(){return g(d,void 0,void 0,function(){var f,m,y,C,b,v,E,S=this;return _(this,function(w){switch(w.label){case 0:return f=I.of(this._iid).cacheContext,m=!0,y=!0,C=!1,f.localCacheEnabled&&i.length>0&&(b=s.range).includes.apply(b,ce([],ne(i.map(function(A){return A.createdAt})),!1))&&(!s.previousComplete&&a.prevMessagesCount<this._prevResultLimit?y=!0:this._startingPoint>s.range.bottom||a.nextMessagesCount<this._nextResultLimit?C=!0:y=!1),[4,this._refreshChannel(P.REFRESH_CHANNEL,C)];case 1:return w.sent(),C&&this._channel._runIfHandleableWithGroupChannel(function(A){var D=Math.max.apply(Math,ce([],ne(i.map(function(O){return O.createdAt})),!1));A._latestMessageInfo&&D>=A._latestMessageInfo.createdAt&&(y=!1)}),y?(m=!1,this._getRemoteMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:f.localCacheEnabled,sdkSource:ui.EXTERNAL_COLLECTION}).then(function(A){var D,O,M,F=A.messages,U=A.isContinuousMessages,$=A.hasNext,J=S._filterUnderOffsetMessage(F);S._messages=[],J.length>0?(S._setHasNextAndHasPrevious(J,$),(D=S._syncRange).extends.apply(D,ce([],ne(J.map(function(ee){return ee.createdAt})),!1)),U&&(!((O=S._backgroundSync)===null||O===void 0)&&O.range.overlap(S._syncRange))&&((M=S._backgroundSync)===null||M===void 0||M.range.extends(S._syncRange.top,S._syncRange.bottom)),S._addMessagesToView(J,P.REQUEST_MESSAGE)):(S._hasPrevious=!1,S._hasNext=!1),r._invokeResponse("remote",null,J)}).catch(function(A){if(fr(A))throw A;r._invokeResponse("remote",A,null)})):(this._setHasNextAndHasPrevious(i),r._invokeResponse("remote",null,i)),f.localCacheEnabled&&u.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"initial_load",event:m?"cache_hit":"cache_miss",max_db_size:(E=(v=f.localCacheConfig)===null||v===void 0?void 0:v.maxSize)!==null&&E!==void 0?E:0,message_init_policy:n,use_local_cache:f.localCacheEnabled,collection_id:this._key}})),[2]}})})}),u.put(new Bd({type:Ze.FEATURE_LOCALCACHE,data:{use_local_cache:l.localCacheEnabled,collection_interface:{message_init_policy:n,message:!0}}})),[2]}})})}),r},e.prototype.loadPrevious=function(){var n,t,r;return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:if(this._isDisposed)throw new k({code:re.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=I.of(this._iid),a=i.cacheContext,s=i.statManager,o=i.logger,this._hasPrevious?this._isLoadingPrevious?(o.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,l=this.viewTop,u=[],[4,Ct(function(){return g(h,void 0,void 0,function(){var m;return _(this,function(y){switch(y.label){case 0:return[4,this._getLocalMessages(l,{prevLimit:this._prevResultLimit,inclusive:!1})];case 1:return m=y.sent(),u=this._filterUnderOffsetMessage(m.messages),[2]}})})})]):[2,[]];case 1:return f.sent(),c=u.length>=this._prevResultLimit,a.localCacheEnabled&&s.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:c?"cache_hit":"cache_miss",max_db_size:(t=(n=a.localCacheConfig)===null||n===void 0?void 0:n.maxSize)!==null&&t!==void 0?t:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),c&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(u))?[3,3]:(d=!1,[4,Ct(function(){return g(h,void 0,void 0,function(){var m,y,C,b,v,E,S,w=this;return _(this,function(A){switch(A.label){case 0:return m=I.of(this._iid).cacheContext,[4,this._getRemoteMessages(l,{prevLimit:this._prevResultLimit,reverse:!0,checkingContinuousMessages:m.localCacheEnabled,sdkSource:ui.EXTERNAL_COLLECTION})];case 1:return y=A.sent(),(u=this._filterUnderOffsetMessage(y.messages)).length>0&&((C=this._syncRange).extends.apply(C,ce([],ne(u.map(function(D){return D.createdAt})),!1)),!((b=this._backgroundSync)===null||b===void 0)&&b.range.overlap(this._syncRange)&&y.isContinuousMessages&&(d=!0,(v=this._backgroundSync)===null||v===void 0||v.range.extends(this._syncRange.top))),u=u.filter(function(D){return Or(w._messages,D)<0}),this._hasPrevious=u.length>=this._prevResultLimit,d&&s.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:(S=(E=m.localCacheConfig)===null||E===void 0?void 0:E.maxSize)!==null&&S!==void 0?S:0,use_local_cache:m.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return f.sent(),this._addMessagesToView(u,P.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=u.length>=this._prevResultLimit,u.length>0&&this._addMessagesToView(u,P.REQUEST_MESSAGE),f.label=4;case 4:return this._isLoadingPrevious=!1,[2,u]}})})},e.prototype.loadNext=function(){var n,t,r;return g(this,void 0,void 0,function(){var i,a,s,o,l,u,c,d,h=this;return _(this,function(f){switch(f.label){case 0:if(this._isDisposed)throw new k({code:re.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=I.of(this._iid),a=i.cacheContext,s=i.statManager,o=i.logger,this._hasNext?this._isLoadingNext?(o.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,l=this.viewBottom,u=[],[4,Ct(function(){return g(h,void 0,void 0,function(){var m;return _(this,function(y){switch(y.label){case 0:return[4,this._getLocalMessages(l,{nextLimit:this._nextResultLimit,inclusive:!1})];case 1:return m=y.sent(),u=this._filterUnderOffsetMessage(m.messages),[2]}})})})]):[2,[]];case 1:return f.sent(),c=u.length>=this._nextResultLimit,a.localCacheEnabled&&s.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:c?"cache_hit":"cache_miss",max_db_size:(t=(n=a.localCacheConfig)===null||n===void 0?void 0:n.maxSize)!==null&&t!==void 0?t:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),c&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(u))?[3,3]:(d=!1,[4,Ct(function(){return g(h,void 0,void 0,function(){var m,y,C,b,v,E,S,w,A=this;return _(this,function(D){switch(D.label){case 0:return m=I.of(this._iid).cacheContext,[4,this._getRemoteMessages(l,{nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:m.localCacheEnabled,sdkSource:ui.EXTERNAL_COLLECTION})];case 1:return y=D.sent(),(u=this._filterUnderOffsetMessage(y.messages)).length>0&&((C=this._syncRange).extends.apply(C,ce([],ne(u.map(function(O){return O.createdAt})),!1)),!((b=this._backgroundSync)===null||b===void 0)&&b.range.overlap(this._syncRange)&&y.isContinuousMessages&&(d=!0,(v=this._backgroundSync)===null||v===void 0||v.range.extends(this._syncRange.bottom))),u=u.filter(function(O){return Or(A._messages,O)<0}),this._hasNext=(E=y.hasNext)!==null&&E!==void 0?E:u.length>=this._nextResultLimit,d&&s.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:(w=(S=m.localCacheConfig)===null||S===void 0?void 0:S.maxSize)!==null&&w!==void 0?w:0,use_local_cache:m.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return f.sent(),this._addMessagesToView(u,P.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=u.length>=this._nextResultLimit,u.length>0&&this._addMessagesToView(u,P.REQUEST_MESSAGE),f.label=4;case 4:return this._isLoadingNext=!1,[2,u]}})})},e.prototype.removeFailedMessage=function(n){return g(this,void 0,void 0,function(){var t;return _(this,function(r){switch(r.label){case 0:if(this._isDisposed)throw new k({code:re.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(n)];case 1:return r.sent(),(t=this._unsentMessages.findIndex(function(i){return i.reqId===n}))>-1&&this._unsentMessages.splice(t,1),[2]}})})},e.prototype.dispose=function(){var n,t,r,i=this;if(!this._isDisposed){this._isDisposed=!0;var a=I.of(this._iid),s=a.cacheContext,o=a.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel(function(l){l.myMemberState!==Mt.NONE&&(i._channel._updateMessageCollectionLastAccessedAt(),o.dispatch(new Se({channels:[i._channel],context:{source:P.CHANNEL_LASTACCESSEDAT_UPDATED}})))}),s.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),(n=this._backgroundSync)===null||n===void 0||n.close(),(t=this._changelogSync)===null||t===void 0||t.close(),(r=this._pollChangelogSync)===null||r===void 0||r.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},e}(),Z8=function(e){function n(t,r){return e.call(this,t,N(N({},r),{channelManager:en.of(t)}))||this}return T(n,e),n.prototype.keyOf=function(t){return t.messageId},n.prototype.initialize=function(t){return e.prototype.initialize.call(this,t)},n.prototype.setMessageCollectionHandler=function(t){this._setBaseMessageCollectionHandler(t)},n.prototype._addMessagesToView=function(t,r){var i,a,s=this,o=this._filterUnderOffsetMessage(t),l=[],u=[];try{for(var c=K(o),d=c.next();!d.done;d=c.next()){var h=d.value;if(r===P.SYNC_MESSAGE_FILL)if(h.messageId>0){if((C=Or(this._messages,h))<0){Or(this._unsentMessages,h)<0&&l.push(h);var f=Dg(this._messages,h);this._messages.splice(f,0,h)}}else h instanceof xt&&(C=Or(this._unsentMessages,h))<0&&Or(this._messages,h)<0&&(this._unsentMessages.push(h),l.push(h));else if(h.messageId>0){if((C=Or(this._messages,h))<0){var m=Or(this._unsentMessages,h);m<0?l.push(h):(this._unsentMessages.splice(m,1),u.push(h)),f=Dg(this._messages,h),this._messages.splice(f,0,h)}else u.push(h),this._messages[C]=h;if(h.updatedAt>0){var y=this._updateChildMessagesInView(h);u.push.apply(u,ce([],ne(y),!1))}}else if(h instanceof xt){var C;(C=Or(this._unsentMessages,h))<0?Or(this._messages,h)<0&&(this._unsentMessages.push(h),l.push(h)):(u.push(h),this._unsentMessages[C]=h)}}}catch(b){i={error:b}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}Na(r)&&he(function(){return g(s,void 0,void 0,function(){var b,v,E,S,w;return _(this,function(A){return b={source:r},l.length>0&&((E=(v=this._handler)===null||v===void 0?void 0:v.onMessagesAdded)===null||E===void 0||E.call(v,b,this.channel,l)),u.length>0&&((w=(S=this._handler)===null||S===void 0?void 0:S.onMessagesUpdated)===null||w===void 0||w.call(S,b,this.channel,u)),[2]})})})},n.prototype._updateMessagesToView=function(t,r){var i,a,s=this,o=[],l=[],u=[];try{for(var c=K(t),d=c.next();!d.done;d=c.next()){var h,f=d.value;if(f.messageId>0)if((h=Or(this._messages,f))>=0)l.push(f),this._messages[h]=f;else{var m=Or(this._unsentMessages,f);if(m>=0){var y=ne(this._unsentMessages.splice(m,1),1)[0];if(this.hasNext&&y)u.push(y);else{l.push(f);var C=Dg(this._messages,f);this._messages.splice(C,0,f)}}else{var b=this._messages.map(function(v){return v.createdAt});(f.createdAt<Math.min.apply(Math,ce([],ne(b),!1))&&!this._hasPrevious||f.createdAt>Math.max.apply(Math,ce([],ne(b),!1))&&!this._hasNext)&&o.push(f)}}else f instanceof xt&&(h=Or(this._unsentMessages,f))>=0&&(l.push(f),this._unsentMessages[h]=f)}}catch(v){i={error:v}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}return Na(r)&&he(function(){return g(s,void 0,void 0,function(){var v,E,S,w,A;return _(this,function(D){return v={source:r},l.length>0?(S=(E=this._handler)===null||E===void 0?void 0:E.onMessagesUpdated)===null||S===void 0||S.call(E,v,this.channel,l):u.length>0?(A=(w=this._handler)===null||w===void 0?void 0:w.onMessagesDeleted)===null||A===void 0||A.call(w,v,this.channel,[],u):o.length>0&&this._addMessagesToView(o,r),[2]})})}),l},n}(Y8),X8={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},J8=function(e){function n(t){var r=this,i=t.channelUrl,a=t.token,s=t.limit,o=t.order,l=t.mutedMemberFilter,u=t.memberStateFilter,c=t.nicknameStartsWithFilter,d=t.operatorFilter;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/members"),r.params={token:a,limit:s,order:o,muted_member_filter:l,member_state_filter:u,nickname_startswith:c,operator_filter:d,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},r}return T(n,e),n}(H),eF=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.members=[];var a=r.next,s=r.members;return i.token=a,s&&s.length>0&&(i.members=s.map(function(o){return new Hr(t,o)})),i}return T(n,e),n}(j);(function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted"})(bd||(bd={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(Ed||(Ed={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Cd||(Cd={}));var tF=function(e){function n(t,r,i){var a,s,o,l,u=this;return(u=e.call(this,t,r,Pe.GROUP,i)||this).mutedMemberFilter=bd.ALL,u.memberStateFilter=Cd.ALL,u.nicknameStartsWithFilter=null,u.operatorFilter=em.ALL,u.order=Ed.MEMBER_NICKNAME_ALPHABETICAL,u.mutedMemberFilter=(a=i.mutedMemberFilter)!==null&&a!==void 0?a:bd.ALL,u.memberStateFilter=(s=i.memberStateFilter)!==null&&s!==void 0?s:Cd.ALL,u.nicknameStartsWithFilter=(o=i.nicknameStartsWithFilter)!==null&&o!==void 0?o:null,u.order=(l=i.order)!==null&&l!==void 0?l:Ed.MEMBER_NICKNAME_ALPHABETICAL,u}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&be(bd,this.mutedMemberFilter)&&be(Cd,this.memberStateFilter)&&(x("string",this.nicknameStartsWithFilter)||this.nicknameStartsWithFilter===null)&&be(em,this.operatorFilter)&&be(Ed,this.order)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new J8(ae(N(N({},this),{token:this._token}))),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(eF),s=a.members,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Ja),nF=function(e){function n(t){var r=this,i=t.channelUrl,a=t.userId,s=t.accessCode;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/accept"),r.params={user_id:a,access_code:s},r}return T(n,e),n}(H),rF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i.channel.myMemberState=Mt.JOINED,i}return T(n,e),n}(j),iF=function(e){function n(t){var r=this,i=t.channelUrl,a=t.isDistinct,s=t.isPublic,o=t.isDiscoverable,l=t.coverUrl,u=t.coverImage,c=t.accessCode,d=t.name,h=t.data,f=t.customType,m=t.operatorUserIds,y=t.messageSurvivalSeconds;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i)),r.params=W({is_distinct:a,is_public:s,is_discoverable:o,name:d,data:h,custom_type:f,cover_url:l,cover_file:u,access_code:c,operator_ids:m,message_survival_seconds:y}),r}return T(n,e),n}(H),aF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.channel=new Yr(t,r),i}return T(n,e),n}(j),sF=function(e){function n(t){var r=this,i=t.channelUrl;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Jn,"/").concat(encodeURIComponent(i)),r}return T(n,e),n}(H);(function(e){function n(t,r){return e.call(this,t,r)||this}T(n,e)})(j);var oF=function(e){function n(t){var r=this,i=t.channelUrl;return(r=e.call(this)||this).method=z.DELETE,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/hide"),r}return T(n,e),n}(H);(function(e){function n(){return e!==null&&e.apply(this,arguments)||this}T(n,e)})(j);var lF=function(e){function n(t){var r=t.userId,i=t.channelUrl,a=t.countPreference,s=e.call(this)||this;return s.method=z.PUT,s.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/count_preference/").concat(encodeURIComponent(i)),s.params={count_preference:a},s}return T(n,e),n}(H),uF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.countPreference=r.count_preference,i}return T(n,e),n}(j),cF=function(e){function n(t){var r=this,i=t.channelUrl,a=t.locale;return(r=e.call(this)||this).method=z.PUT,r.path="".concat(Jn,"/").concat(encodeURIComponent(i),"/reset_user_history"),r.params=W({locale:a}),r}return T(n,e),n}(H),dF=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return T(n,e),n}(j),hF=N(N({},Ry),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),fF=N(N({},iN),{scheduledAt:void 0}),pF=function(e){function n(t){var r,i,a=this;a=e.call(this)||this;var s=[];t.mentionType===$n.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map(function(c){return c.userId})));var o=t.channelType,l=t.channelUrl,u=t.scheduledMessageId;return a.method=z.PUT,a.path="".concat(Re(o),"/").concat(encodeURIComponent(l),"/scheduled_messages/").concat(encodeURIComponent(u)),a.params=W(ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Nu.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:(r=t._thumbnails)===null||r===void 0?void 0:r.map(function(c){return es.payloadify(c)}),custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=t.metaArrays)===null||i===void 0?void 0:i.map(function(c){return nr.payloadify(c)}),apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption})),a}return T(n,e),n}(H),mF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=new qt(t,r),i}return T(n,e),n}(j),_F=function(e){function n(t){var r,i=this;i=e.call(this)||this;var a=[];t.mentionType===$n.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map(function(u){return u.userId})));var s=t.channelType,o=t.channelUrl,l=t.scheduledMessageId;return i.method=z.PUT,i.path="".concat(Re(s),"/").concat(encodeURIComponent(o),"/scheduled_messages/").concat(encodeURIComponent(l)),i.params=W(ae({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:Nu.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=t.metaArrays)===null||r===void 0?void 0:r.map(function(u){return nr.payloadify(u)}),apple_critical_alert_options:t.appleCriticalAlertOptions?Ei.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),i}return T(n,e),n}(H);(function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.message=new kn(t,r),i}T(n,e)})(j);var Lr,Pr,gF=function(e){function n(t){var r=e.call(this)||this,i=t.channelType,a=t.channelUrl,s=t.scheduledMessageId;return r.method=z.DELETE,r.path="".concat(Re(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s)),r}return T(n,e),n}(H),vF=function(e){function n(t){var r=e.call(this)||this,i=t.channelType,a=t.channelUrl,s=t.scheduledMessageId;return r.method=z.POST,r.path="".concat(Re(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s),"/send_now"),r}return T(n,e),n}(H),yF=function(e){function n(t){var r=t.userId,i=t.channelUrl,a=t.pushTriggerOption,s=e.call(this)||this;return s.method=z.PUT,s.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),s.params={push_trigger_option:a},s}return T(n,e),n}(H),bF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return T(n,e),n}(j),EF=function(e){function n(t){var r=t.userId,i=t.channelUrl,a=e.call(this)||this;return a.method=z.GET,a.path="".concat(Fe,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),a}return T(n,e),n}(H),CF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return T(n,e),n}(j),SF=function(e){function n(t){var r=this,i=t.channelUrl,a=t.channelType;return(r=e.call(this)||this).method=z.GET,r.path="".concat(Re(a),"/").concat(encodeURIComponent(i),"/message_purge_offset"),r}return T(n,e),n}(H),TF=function(e){function n(t,r){var i=e.call(this,t,r)||this,a=r.message_purge_offset;return i.messageDeletionTimestamp=a,i}return T(n,e),n}(j),wF=function(e){function n(t){var r=this,i=t.channelUrl;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Ey,"/").concat(encodeURIComponent(i),"/submit_csat"),r.params=W({csat:t.csat,csat_reason:t.csatReason,csat_type:t.csatType,is_resolved:t.isResolved}),r}return T(n,e),n}(H),AF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.conversation=new $u(r.conversation),i}return T(n,e),n}(j),NF=function(e){function n(t){var r=this,i=t.channelUrl;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Ey,"/").concat(encodeURIComponent(i),"/handoff"),r.params={},r}return T(n,e),n}(H),IF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.conversation=new $u(r.conversation),i}return T(n,e),n}(j),MF=function(e){function n(t){var r=this,i=t.channelUrl;return(r=e.call(this)||this).method=z.POST,r.path="".concat(Ey,"/").concat(encodeURIComponent(i),"/close_conversation"),r.params={},r}return T(n,e),n}(H),xF=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.conversation=new $u(r.conversation),i}return T(n,e),n}(j);(function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off"})(Lr||(Lr={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Pr||(Pr={}));var Yr=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w,A,D,O,M=this;return(M=e.call(this,t,r)||this)._unreadMemberStateMap=new Map,M._undeliveredMemberStateMap=new Map,M._typingStatus=new Map,M._lastMemberCountUpdated=0,M._typingStarted=0,M._typingEnded=0,M._hasBotInfo={general:!1,ai:!1},M.isDistinct=!1,M.isSuper=!1,M.isBroadcast=!1,M.isExclusive=!1,M.isPublic=!1,M.isDiscoverable=!0,M.isChatNotification=!1,M.isAccessCodeRequired=!1,M.isPushEnabled=!1,M.unreadMessageCount=0,M.unreadMentionCount=0,M.totalUnreadReplyCount=0,M.members=[],M.memberCount=0,M.joinedMemberCount=0,M.hiddenState=Pr.UNHIDDEN,M.lastMessage=null,M.messageOffsetTimestamp=0,M.messageSurvivalSeconds=-1,M.myMemberState=Mt.NONE,M.myRole=gi.NONE,M.myMutedState=Fi.UNMUTED,M.myLastRead=0,M.myCountPreference=Lr.ALL,M.myPushTriggerOption=Ro.DEFAULT,M.inviter=null,M.invitedAt=0,M.joinedAt=0,M.lastPinnedMessage=null,M.conversation=null,M._latestMessageInfo=null,M._pinnedMessagesUpdatedAt=0,M._myMutedRemainingTime=-1,M._messageDeletionTimestamp=0,M.channelType=Pe.GROUP,M.isDistinct=(a=r.is_distinct)!==null&&a!==void 0&&a,M.isSuper=(s=r.is_super)!==null&&s!==void 0&&s,M.isBroadcast=(o=r.is_broadcast)!==null&&o!==void 0&&o,M.isExclusive=(l=r.is_exclusive)!==null&&l!==void 0&&l,M.isPublic=(u=r.is_public)!==null&&u!==void 0&&u,M.isDiscoverable=(c=r.is_discoverable)!==null&&c!==void 0?c:M.isPublic,M.isChatNotification=(d=r.is_chat_notification)!==null&&d!==void 0&&d,M.isAccessCodeRequired=(h=r.is_access_code_required)!==null&&h!==void 0&&h,M.isPushEnabled=(f=r.is_push_enabled)!==null&&f!==void 0&&f,Array.isArray(r.members)&&(i=M.members).push.apply(i,ce([],ne(r.members.map(function(F){return new Hr(M._iid,F)})),!1)),M.memberCount=(m=r.member_count)!==null&&m!==void 0?m:0,M.joinedMemberCount=(y=r.joined_member_count)!==null&&y!==void 0?y:0,M.hiddenState=be(Pr,r.hidden_state)?r.hidden_state:Pr.UNHIDDEN,M.messageOffsetTimestamp=(C=r.ts_message_offset)!==null&&C!==void 0?C:0,M.messageSurvivalSeconds=(b=r.message_survival_seconds)!==null&&b!==void 0?b:-1,M.lastMessage=r.last_message?Zn(M._iid,N({channel_type:M.channelType},r.last_message)):null,r.read_receipt&&Object.keys(r.read_receipt).forEach(function(F){x("number",r.read_receipt[F])&&M._updateUnreadMemberState(F,r.read_receipt[F])}),r.delivery_receipt&&Object.keys(r.delivery_receipt).forEach(function(F){x("number",r.delivery_receipt[F])&&M._updateUndeliveredMemberState(F,r.delivery_receipt[F])}),M.myMemberState=be(Mt,r.member_state)?r.member_state:Mt.NONE,M.myRole=be(gi,r.my_role)?r.my_role:gi.NONE,be(Fi,r.is_muted)?M.myMutedState=r.is_muted:x("boolean",r.is_muted)?M.myMutedState=r.is_muted?Fi.MUTED:Fi.UNMUTED:M.myMutedState=Fi.UNMUTED,M.myCountPreference=be(Lr,r.count_preference)?r.count_preference:Lr.ALL,M.myPushTriggerOption=be(Ro,r.push_trigger_option)?r.push_trigger_option:Ro.ALL,M.myLastRead=(v=r.user_last_read)!==null&&v!==void 0?v:0,M.inviter=r.inviter?new xe(M._iid,r.inviter):null,M.invitedAt=(E=r.invited_at)!==null&&E!==void 0?E:0,M.joinedAt=(S=r.joined_ts)!==null&&S!==void 0?S:0,M._updateUnreadCount((w=r.unread_message_count)!==null&&w!==void 0?w:0,(A=r.unread_mention_count)!==null&&A!==void 0?A:0),M.totalUnreadReplyCount=(D=r.total_unread_thread_message_count)!==null&&D!==void 0?D:0,M.lastPinnedMessage=r.latest_pinned_message?Zn(M._iid,N({channel_type:M.channelType},r.latest_pinned_message)):null,M.conversation=r.conversation?new $u(r.conversation):null,r.latest_message&&(M._latestMessageInfo={messageId:r.latest_message.message_id,createdAt:r.latest_message.created_at}),M._hasBotInfo={general:!!r.has_bot,ai:!!r.has_ai_bot},M._messageDeletionTimestamp=(O=r.message_purge_offset)!==null&&O!==void 0?O:0,M}return T(n,e),Object.defineProperty(n.prototype,"isHidden",{get:function(){return this.hiddenState!==Pr.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedUnreadMemberState",{get:function(){var t,r,i={};try{for(var a=K(this._unreadMemberStateMap),s=a.next();!s.done;s=a.next()){var o=ne(s.value,2),l=o[0],u=o[1];i[l]=u}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedUndeliveredMemberState",{get:function(){var t,r,i={};try{for(var a=K(this._undeliveredMemberStateMap),s=a.next();!s.done;s=a.next()){var o=ne(s.value,2),l=o[0],u=o[1];i[l]=u}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasBot",{get:function(){return this._hasBotInfo.general},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasAiBot",{get:function(){return this._hasBotInfo.ai},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"messageDeletionTimestamp",{get:function(){return this._messageDeletionTimestamp},enumerable:!1,configurable:!0}),n.payloadify=function(t,r){r===void 0&&(r=!1);var i=N(N({},e.payloadify.call(this,t,r)),{is_access_code_required:t.isAccessCodeRequired,is_distinct:t.isDistinct,is_super:t.isSuper,is_broadcast:t.isBroadcast,is_exclusive:t.isExclusive,is_public:t.isPublic,is_discoverable:t.isDiscoverable,is_muted:t.myMutedState,is_push_enabled:t.isPushEnabled,unread_message_count:t.unreadMessageCount,unread_mention_count:t.unreadMentionCount,total_unread_thread_message_count:t.totalUnreadReplyCount,push_trigger_option:t.myPushTriggerOption,count_preference:t.myCountPreference,hidden_state:t.hiddenState,member_count:t.memberCount,joined_member_count:t.joinedMemberCount,member_state:t.myMemberState,my_role:t.myRole,user_last_read:t.myLastRead,ts_message_offset:t.messageOffsetTimestamp,message_survival_seconds:t.messageSurvivalSeconds,read_receipt:t.cachedUnreadMemberState,delivery_receipt:t.cachedUndeliveredMemberState,members:t.members.map(function(a){return Hr.payloadify(a)}),last_message:t.lastMessage?F1(t.lastMessage):null,inviter:t.inviter?xe.payloadify(t.inviter):null,invited_at:t.invitedAt,joined_ts:t.joinedAt,latest_pinned_message:t.lastPinnedMessage?F1(t.lastPinnedMessage):null,latest_message:t._latestMessageInfo?{message_id:t._latestMessageInfo.messageId,created_at:t._latestMessageInfo.createdAt}:null,has_bot:t.hasBot,has_ai_bot:t.hasAiBot,message_purge_offset:t.messageDeletionTimestamp,conversation:t.conversation?$u.payloadify(t.conversation):null});return r?i:W(ae(i))},n.prototype._shouldUpdateLastMessageWith=function(t){if(t.silent)return!1;var r=I.of(this._iid).appInfo;switch(r?.lastMessageThreadingPolicy){case Fo.NONE:case Fo.INCLUDE_REPLY:break;case Fo.EXCLUDE_REPLY:if(t.parentMessageId>0)return!1;break;case Fo.INCLUDE_REPLY_TO_CHANNEL:if(t instanceof xt&&t.parentMessageId>0&&!t.replyToChannel)return!1}return!this.lastMessage||this.lastMessage.createdAt<t.createdAt||this.lastMessage.createdAt===t.createdAt&&this.lastMessage.messageId===t.messageId&&this.lastMessage.updatedAt<t.updatedAt},n.prototype._tryUpdateLastMessageAndCallEvents=function(t,r){var i=I.of(this._iid).dispatcher,a=en.of(this._iid);this._updateLastMessage(r),a.handlers.map(function(s){s.onChannelChanged&&s.onChannelChanged(t)}),i.dispatch(new Se({channels:[t],context:{source:P.EVENT_MESSAGE_SENT}}))},n.prototype._shouldUpdateUnreadCountWith=function(t){var r=I.of(this._iid).appInfo;switch(r?.unreadCountThreadingPolicy){case Po.NONE:case Po.INCLUDE_REPLY:break;case Po.EXCLUDE_REPLY:if(t.parentMessageId>0)return!1;break;case Po.INCLUDE_REPLY_TO_CHANNEL:if(t instanceof xt&&t.parentMessageId>0&&!t.replyToChannel)return!1}return!0},n.prototype._updateLastMessage=function(t){return!!this._shouldUpdateLastMessageWith(t)&&(this.lastMessage=t,!0)},n.prototype._updateUnreadCount=function(t,r){if(typeof t=="number"&&t>=0)if(this.myCountPreference===Lr.ALL||this.myCountPreference===Lr.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var i=I.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=i&&t>=i?i:t}else this.unreadMessageCount=t;else this.unreadMessageCount=0;else this.unreadMessageCount=0;typeof r=="number"&&r>=0&&(this.myCountPreference===Lr.ALL||this.myCountPreference===Lr.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=r:this.unreadMentionCount=0},n.prototype._updateUnreadMemberState=function(t,r,i){i===void 0&&(i=!1);var a=this._unreadMemberStateMap.get(t);return!!(!a||i||!i&&a<r)&&(this._unreadMemberStateMap.set(t,r),I.of(this._iid).sdkState.userId===t&&(this.myLastRead=r),!0)},n.prototype._updateUndeliveredMemberState=function(t,r){var i=this._undeliveredMemberStateMap.get(t);return(!i||i<r)&&(this._undeliveredMemberStateMap.set(t,r),!0)},n.prototype._updateTypingStatus=function(t,r){r===void 0&&(r=new Date().getTime()),r>0?this._typingStatus.set(t.userId,{user:t,ts:r}):this._typingStatus.delete(t.userId)},n.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},n.prototype._setLatestMemberCount=function(t,r,i){var a=!1;return i>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=i,a=t!==this.memberCount||r!==this.joinedMemberCount,this.memberCount=t,this.joinedMemberCount=r),a},n.prototype.isReadMessage=function(t){var r=I.of(this._iid).sdkState,i=this._unreadMemberStateMap.get(r.userId);return!!i&&i>=t.createdAt},n.prototype.serialize=function(){var t=this;return Wu(this,function(r){r.cachedUnreadMemberState=t.cachedUnreadMemberState,r.cachedUndeliveredMemberState=t.cachedUndeliveredMemberState,Object.assign(r,t._serializeCachedMetaData())})},n.prototype.createMessageCollection=function(t){return t===void 0&&(t={}),new Z8(this._iid,N(N({},t),{channel:this}))},n.prototype.createMemberListQuery=function(t){return t===void 0&&(t={}),new tF(this._iid,this.url,t)},n.prototype.createThreadedParentMessageListQuery=function(t){return t===void 0&&(t={}),new v4(this._iid,this.url,this.channelType,t)},n.prototype.addMember=function(t,r){if(r===void 0&&(r=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var i=this.members.findIndex(function(s){return s.userId===t.userId});if(i>-1){var a=this.members[i];a.state===Mt.JOINED&&(t.state=a.state),this.members.splice(i,1),this.memberCount--}this.members.push(t),this.memberCount++,this._updateUnreadMemberState(t.userId,r),this._updateUndeliveredMemberState(t.userId,r)}},n.prototype.removeMember=function(t){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=t instanceof Hr?t.userId:t,i=this.members.findIndex(function(a){return a.userId===r});if(i>-1)return this.members.splice(i,1),this.memberCount--,!0}return!1},n.prototype.getUnreadMemberCount=function(t){var r,i;if(t instanceof xt&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=I.of(this._iid).sdkState,s=t.createdAt,o=0;try{for(var l=K(this.members),u=l.next();!u.done;u=l.next()){var c=u.value;a.userId!==c.userId&&c.state===Mt.JOINED&&t.sender.userId!==c.userId&&(this.cachedUnreadMemberState[c.userId]||0)<s&&o++}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return o}return 0},n.prototype.getUndeliveredMemberCount=function(t){var r,i;if(t instanceof xt&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=I.of(this._iid).sdkState,s=t.createdAt,o=0;try{for(var l=K(this.members),u=l.next();!u.done;u=l.next()){var c=u.value;a.userId!==c.userId&&c.state===Mt.JOINED&&t.sender.userId!==c.userId&&(this.cachedUndeliveredMemberState[c.userId]||0)<s&&o++}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return o}return 0},n.prototype.getReadMembers=function(t,r){var i=this;r===void 0&&(r=!1);var a=I.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=t instanceof xt?t.sender:null,o=[];return this.members.forEach(function(l){if(r||l.userId!==a.userId&&l.userId!==s?.userId){var u=i._unreadMemberStateMap.get(l.userId);u&&u>=t.createdAt&&o.push(l)}}),o},n.prototype.getUnreadMembers=function(t,r){var i=this;r===void 0&&(r=!1);var a=I.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=t instanceof xt?t.sender:null,o=[];return this.members.forEach(function(l){if(r||l.userId!==a.userId&&l.userId!==s?.userId){var u=i._unreadMemberStateMap.get(l.userId);u&&u<t.createdAt&&o.push(l)}}),o},n.prototype.getReadStatus=function(t){var r=this;t===void 0&&(t=!1);var i=I.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(t||s.userId!==i.userId){var o=r._unreadMemberStateMap.get(s.userId);a[s.userId]=new WA(r._iid,{channel_url:r.url,channel_type:r.channelType,user:Hr.payloadify(s),ts:o??0})}}),a},n.prototype.getDeliveryStatus=function(t){var r=this;t===void 0&&(t=!0);var i=I.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(t||s.userId!==i.userId){var o=r._undeliveredMemberStateMap.get(s.userId);a[s.userId]=new JP(r._iid,{channel_url:r.url,channel_type:r.channelType,user:Hr.payloadify(s),ts:o??0})}}),a},n.prototype.getTypingUsers=function(){var t=[];return this._typingStatus.forEach(function(r){var i=r.user;t.push(i)}),t},n.prototype.invalidateTypingStatus=function(){var t=this,r=I.of(this._iid).typingIndicatorInvalidateTime,i=Date.now(),a=!1;return this._typingStatus.forEach(function(s,o){var l=s.ts;i-l>=r&&(t._typingStatus.delete(o),a=!0)}),a},n.prototype.refresh=function(){return g(this,void 0,void 0,function(){return _(this,function(t){return[2,this._refresh()]})})},n.prototype._refresh=function(t){return t===void 0&&(t=!1),g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return r=I.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new _0({channelUrl:this.url}),[4,i.send(s)];case 1:return o=u.sent(),l=o.as(g0).channel,this._update(l),t||a.dispatch(new Se({channels:[l],context:{source:P.REFRESH_CHANNEL}})),[2,this]}})})},n.prototype.freeze=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,e.prototype.freeze.call(this)];case 1:return t.sent(),I.of(this._iid).dispatcher.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_FROZEN},isWebSocketEventComing:!0})),[2]}})})},n.prototype.unfreeze=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,e.prototype.unfreeze.call(this)];case 1:return t.sent(),I.of(this._iid).dispatcher.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_UNFROZEN},isWebSocketEventComing:!0})),[2]}})})},n.prototype.updateChannel=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return r=N(N({},X8),t),B(function(d){return x("string",d.coverUrl,!0)&&(Kn(d.coverImage)||x("string",d.coverImage,!0))&&x("boolean",d.isDistinct,!0)&&x("boolean",d.isPublic,!0)&&x("boolean",d.isDiscoverable,!0)&&x("string",d.accessCode,!0)&&x("string",d.name,!0)&&x("string",d.data,!0)&&x("string",d.customType,!0)&&Te("string",d.operatorUserIds,!0)&&x("number",d.messageSurvivalSeconds,!0)}(r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=new iF(N({channelUrl:this.url},r)),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(aF).channel,this._update(u),a.dispatch(new Se({channels:[u],context:{source:P.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.invite=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(t.every(function(i){return i instanceof xe})).throw(k.invalidParameters),[2,this.inviteWithUserIds(t.map(function(i){return i.userId}))]})})},n.prototype.inviteWithUserIds=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(Te("string",t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.dispatcher,a=r.requestQueue,s=r.sessionManager,o=new M8({channelUrl:this.url,userIds:t}),[4,a.send(o)];case 1:return l=c.sent(),u=l.as(x8).channel,this._update(u),i.dispatch(new Se({channels:[u],context:{source:P.EVENT_CHANNEL_INVITED,inviter:s.currentUser,invitees:[]},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.join=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(x("string",t,!0)).throw(k.invalidParameters),r=I.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,o=new T8({channelUrl:this.url,userId:a.userId,accessCode:t}),[4,s.send(o)];case 1:return l=c.sent(),(u=l.as(w8).channel).myMemberState=this.myMemberState=Mt.JOINED,this._update(u),i.dispatch(new Se({channels:[u],context:{source:P.EVENT_CHANNEL_JOINED,users:[]},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.leave=function(t){return t===void 0&&(t=!1),g(this,void 0,void 0,function(){var r,i,a,s;return _(this,function(o){switch(o.label){case 0:return r=I.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new N8({channelUrl:this.url,userId:i.userId,shouldRemoveOperatorStatus:t}),[4,a.send(s)];case 1:return o.sent(),this.myMemberState=Mt.NONE,[2]}})})},n.prototype.acceptInvitation=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(x("string",t,!0)).throw(k.invalidParameters),r=I.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,o=new nF({channelUrl:this.url,userId:a.userId,accessCode:t}),[4,s.send(o)];case 1:return l=c.sent(),(u=l.as(rF).channel).myMemberState=this.myMemberState=Mt.JOINED,this._update(u),i.dispatch(new Se({channels:[u],context:{source:P.EVENT_CHANNEL_ACCEPTED_INVITE},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.declineInvitation=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new D8({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.myMemberState=Mt.NONE,[2,this]}})})},n.prototype.sendUserMessage=function(t){var r=this,i=new Sr,a=I.of(this._iid).dispatcher,s=Fc.of(this._iid);return e.prototype.sendUserMessage.call(this,t).onPending(function(o){s.completeCurrentAndProcessNextAutoResend(o),i._trigger(o)}).onFailed(function(o,l){l&&s.completeCurrentAndProcessNextAutoResend(l),i._triggerFailed(o,l)}).onSucceeded(function(o){s.completeCurrentAndProcessNextAutoResend(o),r._updateLastMessage(o),en.of(r._iid).handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(r)}),a.dispatch(new Se({channels:[r],context:{source:P.EVENT_MESSAGE_SENT}})),i._trigger(o)}),i},n.prototype.updateUserMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:return i=I.of(this._iid).dispatcher,[4,e.prototype.updateUserMessage.call(this,t,r)];case 1:return a=u.sent(),s=this._updateLastMessage(a),o=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,o=!0),s&&(en.of(this._iid).handlers.map(function(c){c.onChannelChanged&&c.onChannelChanged(l)}),i.dispatch(new Se({channels:[this],context:{source:o?P.EVENT_PINNED_MESSAGE_UPDATED:P.EVENT_MESSAGE_UPDATED}}))),o&&en.of(this._iid).handlers.map(function(c){c.onPinnedMessageUpdated&&c.onPinnedMessageUpdated(l)}),i.dispatch(new _t({messages:[a],source:P.EVENT_MESSAGE_UPDATED})),[2,a]}})})},n.prototype._autoResendUserMessage=function(t){var r=this,i=new Sr,a=I.of(this._iid).dispatcher,s=Fc.of(this._iid);return e.prototype._autoResendUserMessage.call(this,t).onPending(function(o){s.completeCurrentAndProcessNextAutoResend(o),i._trigger(o)}).onFailed(function(o,l){s.completeCurrentAndProcessNextAutoResend(l),i._triggerFailed(o,l)}).onSucceeded(function(o){var l=en.of(r._iid);s.completeCurrentAndProcessNextAutoResend(o),r._updateLastMessage(o),l.handlers.map(function(u){u.onChannelChanged&&u.onChannelChanged(r)}),a.dispatch(new Se({channels:[r],context:{source:P.EVENT_MESSAGE_SENT}})),i._trigger(o)}),i},n.prototype.sendFileMessage=function(t){var r=this,i=new Sr,a=I.of(this._iid).dispatcher,s=Fc.of(this._iid);return e.prototype.sendFileMessage.call(this,t).onPending(function(o){s.completeCurrentAndProcessNextAutoResend(o),i._trigger(o)}).onFailed(function(o,l){l&&s.completeCurrentAndProcessNextAutoResend(l),i._triggerFailed(o,l)}).onSucceeded(function(o){var l=en.of(r._iid);s.completeCurrentAndProcessNextAutoResend(o),r._updateLastMessage(o),l.handlers.map(function(u){u.onChannelChanged&&u.onChannelChanged(r)}),a.dispatch(new Se({channels:[r],context:{source:P.EVENT_MESSAGE_SENT}})),i._trigger(o)}),i},n.prototype.sendMultipleFilesMessage=function(t){var r=this,i=new Ff,a=I.of(this._iid).dispatcher;return e.prototype.sendMultipleFilesMessage.call(this,t).onPending(function(s){i._trigger(s)}).onFailed(function(s,o){i._triggerFailed(s,o)}).onSucceeded(function(s){var o=en.of(r._iid);r._updateLastMessage(s),o.handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(r)}),a.dispatch(new Se({channels:[r],context:{source:P.EVENT_MESSAGE_SENT}})),i._trigger(s)}).onFileUploaded(function(s,o,l,u){i._triggerOnFileUploaded(s,o,l,u)}),i},n.prototype.updateFileMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o,l=this;return _(this,function(u){switch(u.label){case 0:return i=I.of(this._iid).dispatcher,[4,e.prototype.updateFileMessage.call(this,t,r)];case 1:return a=u.sent(),s=this._updateLastMessage(a),o=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,o=!0),s&&(en.of(this._iid).handlers.map(function(c){c.onChannelChanged&&c.onChannelChanged(l)}),i.dispatch(new Se({channels:[this],context:{source:o?P.EVENT_PINNED_MESSAGE_UPDATED:P.EVENT_MESSAGE_UPDATED}}))),o&&en.of(this._iid).handlers.map(function(c){c.onPinnedMessageUpdated&&c.onPinnedMessageUpdated(l)}),i.dispatch(new _t({messages:[a],source:P.EVENT_MESSAGE_UPDATED})),[2,a]}})})},n.prototype._autoResendFileMessage=function(t){var r=this,i=new Sr,a=I.of(this._iid).dispatcher,s=Fc.of(this._iid);return e.prototype._autoResendFileMessage.call(this,t).onPending(function(o){s.completeCurrentAndProcessNextAutoResend(o),i._trigger(o)}).onFailed(function(o,l){s.completeCurrentAndProcessNextAutoResend(l),i._triggerFailed(o,l)}).onSucceeded(function(o){var l=en.of(r._iid);s.completeCurrentAndProcessNextAutoResend(o),r._updateLastMessage(o),l.handlers.map(function(u){u.onChannelChanged&&u.onChannelChanged(r)}),a.dispatch(new Se({channels:[r],context:{source:P.EVENT_MESSAGE_SENT}})),i._trigger(o)}),i},n.prototype.deleteMessage=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,e.prototype.deleteMessage.call(this,t)];case 1:return r.sent(),t.messageId===0&&t instanceof xt&&I.of(this._iid).dispatcher.dispatch(new FA({reqId:t.reqId,source:P.EVENT_MESSAGE_DELETED})),[2]}})})},n.prototype.hide=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c;return _(this,function(d){switch(d.label){case 0:return r=N(N({},v0),t),B(function(h){return x("boolean",h.hidePreviousMessages,!0)&&x("boolean",h.allowAutoUnhide,!0)}(r)).throw(k.invalidParameters),i=I.of(this._iid),a=i.dispatcher,s=i.sdkState,o=i.requestQueue,l=new R8(N({channelUrl:this.url,userId:s.userId},r)),[4,o.send(l)];case 1:return u=d.sent(),c=u.as(U8).messageOffsetTimestamp,this.hiddenState=r.allowAutoUnhide?Pr.HIDDEN_ALLOW_AUTO_UNHIDE:Pr.HIDDEN_PREVENT_AUTO_UNHIDE,r.hidePreviousMessages&&this._updateUnreadCount(0,0),c&&(this.messageOffsetTimestamp=c),a.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_HIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.unhide=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid),r=t.dispatcher,i=t.requestQueue,a=new oF({channelUrl:this.url}),[4,i.send(a)];case 1:return s.sent(),this.hiddenState=Pr.UNHIDDEN,r.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_UNHIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype.delete=function(){return g(this,void 0,void 0,function(){var t,r;return _(this,function(i){switch(i.label){case 0:return t=I.of(this._iid).requestQueue,r=new sF({channelUrl:this.url}),[4,t.send(r)];case 1:return i.sent(),[2]}})})},n.prototype.markAsRead=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u=this;return _(this,function(c){switch(c.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.dispatcher,a=t.requestQueue,s=new Hk({channelUrl:this.url}),[4,a.send(s)];case 1:return o=c.sent(),l=o.as(YA).readStatus,this._updateUnreadMemberState(r.userId,l.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),en.of(this._iid).handlers.map(function(d){d.onChannelChanged&&d.onChannelChanged(u)})),i.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_READ}})),[2]}})})},n.prototype.markAsUnread=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h,f,m,y=this;return _(this,function(C){switch(C.label){case 0:return r=I.of(this._iid),i=r.sdkState,a=r.dispatcher,s=r.requestQueue,o=new qk({channelUrl:this.url,channelType:this.channelType,messageId:t.messageId,userId:i.userId,isExcluded:!0,uniqueId:"read-".concat(Wr())}),[4,s.send(o)];case 1:return l=C.sent(),u=l.as(Bk),c=u.readAt,d=u.unreadMessageCount,h=u.userId,f=u.isExcluded,m=u.totalUnreadCount,this._updateUnreadMemberState(h,c,f),this._updateUnreadCount(d,this.unreadMentionCount),a.dispatch(new Ny(m)),en.of(this._iid).handlers.map(function(b){b.onChannelChanged&&b.onChannelChanged(y)}),a.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_READ}})),[2]}})})},n.prototype.markAsDelivered=function(){return g(this,void 0,void 0,function(){var t,r,i,a;return _(this,function(s){switch(s.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new q8({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.startTyping=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid),r=t.requestQueue,i=t.typingIndicatorThrottle,(a=new Date().getTime())-this._typingStarted>=i?(this._typingStarted=a,this._typingEnded=0,s=new P8({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},n.prototype.endTyping=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s;return _(this,function(o){switch(o.label){case 0:return t=I.of(this._iid),r=t.requestQueue,i=t.typingIndicatorThrottle,(a=new Date().getTime())-this._typingEnded>=i?(this._typingStarted=0,this._typingEnded=a,s=new $8({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},n.prototype.createScheduledUserMessage=function(t){t=N(N({},n4),t),B(r4(t)).throw(k.invalidParameters);var r=new Sr;return this._createScheduledUserMessage(t,r),r},n.prototype.updateScheduledUserMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s,o;return _(this,function(l){switch(l.label){case 0:return i=N(N({},fF),r),B(function(u){return aN(u)&&x("number",u.scheduledAt,!0)}(i)).throw(k.invalidParameters),a=I.of(this._iid).requestQueue,s=new _F(N({reqId:this._generateRequestId(),scheduledMessageId:t,channelType:this.channelType,channelUrl:this.url},i)),[4,a.send(s)];case 1:return o=l.sent(),[2,o.as(oN).message]}})})},n.prototype.createScheduledFileMessage=function(t){var r=this;t=N(N({},i4),t),B(a4(t)).throw(k.invalidParameters);var i=Date.now(),a=this._generateRequestId(),s=new Sr;return tr(kU).then(function(){var o=r._createPendingScheduledFileMessage(t,a,i);he(function(){return g(r,void 0,void 0,function(){return _(this,function(l){return[2,s._trigger(o)]})})})}),Kn(t.file)?this._uploadFileAndUpdateParams(t).then(function(){return r._createScheduledFileMessage(t,s,a,i)}):this._createScheduledFileMessage(t,s,a,i),s},n.prototype.updateScheduledFileMessage=function(t,r){return g(this,void 0,void 0,function(){var i,a,s;return _(this,function(o){switch(o.label){case 0:return i=N(N({},hF),r),B(function(l){return Uy(l)&&x("number",l.scheduledAt,!0)&&(Kn(l.file)||x("string",l.fileUrl))&&x("string",l.fileName,!0)&&x("string",l.mimeType,!0)&&x("number",l.fileSize,!0)&&(l.thumbnailSizes===null||l.thumbnailSizes===void 0||l.thumbnailSizes.every(function(u){return x("object",u)&&u.maxWidth>0&&u.maxHeight>0}))}(i)).throw(k.invalidParameters),Kn(i.file)?[4,this._uploadFileAndUpdateParams(i)]:[3,2];case 1:o.sent(),o.label=2;case 2:return a=new pF(N({reqId:this._generateRequestId(),scheduledMessageId:t,channelType:this.channelType,channelUrl:this.url},i)),[4,I.of(this._iid).requestQueue.send(a)];case 3:return s=o.sent(),[2,s.as(mF).message]}})})},n.prototype.cancelScheduledMessage=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=new gF({scheduledMessageId:t,channelType:this.channelType,channelUrl:this.url}),[4,I.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},n.prototype.sendScheduledMessageNow=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){switch(i.label){case 0:return r=new vF({scheduledMessageId:t,channelType:this.channelType,channelUrl:this.url}),[4,I.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},n.prototype.getMyPushTriggerOption=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid),r=t.sdkState,i=t.requestQueue,a=new EF({userId:r.userId,channelUrl:this.url}),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(CF).pushTriggerOption,this.myPushTriggerOption=o,[2,o]}})})},n.prototype.setMyPushTriggerOption=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(be(Ro,t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,o=new yF({userId:a.userId,channelUrl:this.url,pushTriggerOption:t}),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(bF).pushTriggerOption,this.myPushTriggerOption=u,i.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,u]}})})},n.prototype.setMyCountPreference=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u;return _(this,function(c){switch(c.label){case 0:return B(be(Lr,t)).throw(k.invalidParameters),r=I.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,o=new lF({channelUrl:this.url,userId:a.userId,countPreference:t}),[4,s.send(o)];case 1:return l=c.sent(),u=l.as(uF).countPreference,this.myCountPreference=u,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),i.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,u]}})})},n.prototype.resetMyHistory=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid),r=t.dispatcher,i=t.requestQueue,a=new cF({channelUrl:this.url}),[4,i.send(a)];case 1:return s=l.sent(),o=s.as(dF).messageOffsetTimestamp,this.messageOffsetTimestamp=o,this.lastMessage&&this.lastMessage.createdAt<o&&(this.lastMessage=null),this._updateUnreadCount(0,0),this.totalUnreadReplyCount=0,r.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_RESET_HISTORY},isWebSocketEventComing:!0})),[2,this]}})})},n.prototype._uploadFileAndUpdateParams=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,d,h;return _(this,function(f){switch(f.label){case 0:return Kn(t.file)?(r=I.of(this._iid).requestQueue,i=new Fp({file:t.file,channelUrl:this.url,thumbnailSizes:t.thumbnailSizes,requestId:this._generateRequestId()}),[4,r.send(i)]):[3,2];case 1:a=f.sent(),s=a.as($p),o=s.url,l=s.fileSize,u=l===void 0?t.fileSize:l,c=s.thumbnails,d=s.requireAuth,h=d!==void 0&&d,t.fileUrl=o,t.fileSize=u,t.requireAuth=h,t._thumbnails=c,f.label=2;case 2:return[2]}})})},n.prototype.resendMessage=function(t,r){var i,a=this;if(B(t instanceof xt&&!t.scheduledInfo&&t.isResendable).throw(k.invalidParameters),t.isUserMessage()){var s=(i=t.messageParams)!==null&&i!==void 0?i:Zv(t),o=new Sr;return this._sendUserMessage(s,In.RESEND,t.reqId).onPending(function(d){o._trigger(d)}).onFailed(function(d,h){o._triggerFailed(d,h)}).onSucceeded(function(d){a._tryUpdateLastMessageAndCallEvents(a,d),o._trigger(d)}),o}if(t.isFileMessage()){var l=this._validateFailedFileMessageHasFile(t,r);B(l).throw(k.invalidParameters),s=Xv(t,r);var u=new Sr;return this._sendFileMessage(s,In.RESEND,t.reqId).onPending(function(d){u._trigger(d)}).onFailed(function(d,h){u._triggerFailed(d,h)}).onSucceeded(function(d){a._tryUpdateLastMessageAndCallEvents(a,d),u._trigger(d)}),u}if(t.isMultipleFilesMessage()){s=t.messageParams;var c=new Ff;return this._sendMultipleFilesMessage(s,In.RESEND,t.reqId).onPending(function(d){c._trigger(d)}).onFailed(function(d,h){c._triggerFailed(d,h)}).onSucceeded(function(d){a._tryUpdateLastMessageAndCallEvents(a,d),c._trigger(d)}).onFileUploaded(function(d,h,f,m){c._triggerOnFileUploaded(d,h,f,m)}),c}},n.prototype.copyMessage=function(t,r){var i=this;if(B(t instanceof eC&&r instanceof xt&&r.sendingStatus===rt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(k.invalidParameters),r.isUserMessage()){B(!r.poll).throw(k.notSupportedError);var a=tN(r),s=new Sr;return t._sendUserMessage(a).onPending(function(u){s._trigger(u)}).onFailed(function(u,c){s._triggerFailed(u,c)}).onSucceeded(function(u){t.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(t,u),s._trigger(u)}),s}if(r.isFileMessage()){a=rN(r);var o=new Sr;return t._sendFileMessage(a).onPending(function(u){o._trigger(u)}).onFailed(function(u,c){o._triggerFailed(u,c)}).onSucceeded(function(u){t.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(t,u),o._trigger(u)}),o}if(r.isMultipleFilesMessage()){if(t.isGroupChannel()){a=TU(r);var l=new Ff;return t._sendMultipleFilesMessage(a,In.COPY).onPending(function(u){l._trigger(u)}).onFailed(function(u,c){l._triggerFailed(u,c)}).onSucceeded(function(u){i._tryUpdateLastMessageAndCallEvents(t,u),l._trigger(u)}).onFileUploaded(function(u,c,d,h){l._triggerOnFileUploaded(u,c,d,h)}),l}throw k.channelTypeNotSupportedError}},n.prototype.getMessageDeletionTimestamp=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid),r=t.requestQueue,i=t.dispatcher,a=new SF({channelUrl:this.url,channelType:this.channelType}),[4,r.send(a)];case 1:return s=l.sent(),o=s.as(TF).messageDeletionTimestamp,this._messageDeletionTimestamp=o,i.dispatch(new a8({channel:this})),[2,o]}})})},n.prototype.submitCSAT=function(t){return g(this,void 0,void 0,function(){var r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return B(x("number",t.csat)&&x("string",t.csatType)&&x("string",t.csatReason,!0)&&x("boolean",t.isResolved,!0)).throw(k.invalidParameters),r=I.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new wF(N({channelUrl:this.url},t)),[4,i.send(s)];case 1:return o=u.sent(),l=o.as(AF).conversation,this.conversation=l,a.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_CSAT_SUBMITTED}})),[2,l]}})})},n.prototype.markConversationAsHandoff=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid),r=t.requestQueue,i=t.dispatcher,a=new NF({channelUrl:this.url}),[4,r.send(a)];case 1:return s=l.sent(),o=s.as(IF).conversation,this.conversation=o,i.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_CONVERSATION_HANDEDOFF}})),[2,o]}})})},n.prototype.closeConversation=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return t=I.of(this._iid),r=t.requestQueue,i=t.dispatcher,a=new MF({channelUrl:this.url}),[4,r.send(a)];case 1:return s=l.sent(),o=s.as(xF).conversation,this.conversation=o,i.dispatch(new Se({channels:[this],context:{source:P.EVENT_CHANNEL_UPDATED}})),[2,o]}})})},n}(eC),OF=function(){this.onUserMuted=Ne,this.onUserUnmuted=Ne,this.onUserBanned=Ne,this.onUserUnbanned=Ne,this.onChannelChanged=Ne,this.onChannelDeleted=Ne,this.onChannelFrozen=Ne,this.onChannelUnfrozen=Ne,this.onOperatorUpdated=Ne,this.onChannelMemberCountChanged=Ne,this.onMetaDataCreated=Ne,this.onMetaDataUpdated=Ne,this.onMetaDataDeleted=Ne,this.onMetaCounterCreated=Ne,this.onMetaCounterUpdated=Ne,this.onMetaCounterDeleted=Ne,this.onMessageReceived=Ne,this.onMessageUpdated=Ne,this.onMessageDeleted=Ne,this.onMentionReceived=Ne,this.onReactionUpdated=Ne,this.onThreadInfoUpdated=Ne},Sd,fs={},DF=function(){function e(n){var t=n._iid,r=n.limit,i=r===void 0?100:r,a=this;this.ref=0,this._iid=t,this._limit=i;var s,o=I.of(this._iid),l=o.sdkState,u=o.dispatcher,c=o.logger,d=o.cacheContext,h=o.statManager;this._metadataKey=(s=l.userId,"sendbird:".concat(s,"@groupchannel/sync.meta"));var f=function(m){return"sendbird:".concat(m,"@groupchannel/sync")}(l.userId);this._sync=new Ya(f,function(){return g(a,void 0,void 0,function(){var m,y,C,b,v,E,S,w,A,D,O,M,F,U,$,J;return _(this,function(ee){switch(ee.label){case 0:return m={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(ee.sent(),c.debug("channel background sync from",(A=this._metadata)===null||A===void 0?void 0:A.token),(D=this._metadata)===null||D===void 0?void 0:D.completed)return[3,14];y={includeEmpty:!0,includeMetaData:!0,hiddenChannelFilter:fi.ALL,order:Dt.CHRONOLOGICAL},ee.label=2;case 2:if(ee.trys.push([2,9,12,13]),y.order!==Dt.LATEST_LAST_MESSAGE)return[3,6];ee.label=3;case 3:return ee.trys.push([3,5,,6]),[4,d.preference.get(Iy(l.appId))];case 4:return C=ee.sent(),y.includeChatNotification=!!C,[3,6];case 5:return ee.sent(),y.includeChatNotification=!1,[3,6];case 6:return[4,en.of(this._iid).getMyGroupChannels((M=(O=this._metadata)===null||O===void 0?void 0:O.token)!==null&&M!==void 0?M:"",y,this._limit,P.SYNC_CHANNEL_BACKGROUND)];case 7:return b=ee.sent(),v=b.channels,E=b.token,m.hasNext=v.length>=this._limit&&!!E,m.nextToken=E,this._metadata&&(this._metadata.token=E,(w=this._metadata.range).extends.apply(w,ce([],ne(v.map(function(ve){return ve.createdAt})),!1)),this._metadata.completed=!m.hasNext),c.debug("channel background sync progress",m),[4,this.saveMetadata()];case 8:return ee.sent(),[3,13];case 9:return S=ee.sent(),c.debug("channel background sync error",S),S instanceof k&&S.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:ee.sent(),ee.label=11;case 11:throw S;case 12:return h.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_back_sync",event:"cache_fetch",max_db_size:(U=(F=d.localCacheConfig)===null||F===void 0?void 0:F.maxSize)!==null&&U!==void 0?U:0,use_local_cache:d.localCacheEnabled,starting_point:0,message_init_policy:(J=($=y.order)===null||$===void 0?void 0:$.toString())!==null&&J!==void 0?J:"",collection_id:l.userId}})),[7];case 13:return[3,15];case 14:m.hasNext=!1,m.nextToken="",ee.label=15;case 15:return[2,m]}})})}),this._connectionEventContext=u.on(function(m){m instanceof Zr&&(m.stateType===He.CONNECTED?a.resume():a.pause())})}return e.of=function(n){return fs[n]||(fs[n]=new e({_iid:n})),fs[n].ref++,fs[n]},e.clear=function(n){fs[n]&&(fs[n].close(),delete fs[n])},Object.defineProperty(e.prototype,"range",{get:function(){var n,t;return(t=(n=this._metadata)===null||n===void 0?void 0:n.range)!==null&&t!==void 0?t:new na({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var n;return!!(!((n=this._metadata)===null||n===void 0)&&n.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,I.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:n=t.sent(),this._metadata={token:n?n.token:"",range:new na(n?n.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!n&&n.completed},t.label=2;case 2:return[2,this._metadata]}})})},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this._metadata?[4,I.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}})})},e.prototype.clearMetaData=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return n.sent(),this._metadata=void 0,[2]}})})},e.prototype.resume=function(){var n,t,r=I.of(this._iid),i=r.logger;r.sessionManager.session.hasSession&&(i.debug("channel background sync resume()"),this._sync.start((t=(n=this._metadata)===null||n===void 0?void 0:n.token)!==null&&t!==void 0?t:""))},e.prototype.pause=function(){I.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete fs[this._iid])},e}(),ps={},kF=function(){function e(n){var t=n._iid,r=this;this.ref=0,this._iid=t;var i,a=I.of(this._iid),s=a.logger,o=a.sdkState,l=a.dispatcher,u=a.cacheContext,c=a.statManager;this._metadataKey=(i=o.userId,"sendbird:".concat(i,"@groupchannel/changelogs.meta")),this._subscribers=new Sl;var d=function(h){return"sendbird:".concat(h,"@groupchannel/changelogs")}(o.userId);this._sync=new Ya(d,function(){return g(r,void 0,void 0,function(){var h,f,m,y,C,b,v,E,S,w,A,D;return _(this,function(O){switch(O.label){case 0:return h={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:O.sent(),s.debug("channel changelog sync from",(w=this._metadata)===null||w===void 0?void 0:w.token),O.label=2;case 2:O.trys.push([2,9,,12]),f={includeEmpty:!0,includeMetaData:!0},O.label=3;case 3:return O.trys.push([3,5,,6]),[4,u.preference.get(Iy(o.appId))];case 4:return m=O.sent(),f.includeChatNotification=!!m,[3,6];case 5:return O.sent(),f.includeChatNotification=!1,[3,6];case 6:return[4,en.of(this._iid).getMyGroupChannelChangeLogs((D=(A=this._metadata)===null||A===void 0?void 0:A.token)!==null&&D!==void 0?D:"",f,P.SYNC_CHANNEL_CHANGELOGS)];case 7:return y=O.sent(),C=y.updatedChannels,b=y.deletedChannelUrls,v=y.hasMore,E=y.token,this._subscribers.dispatch("progress",{updatedChannels:C,deletedChannelUrls:b,hasMore:v,token:E}),h.hasNext=v,h.nextToken=E,this._metadata&&(this._metadata.token=E),s.debug("channel changelog sync progress",h),[4,this.saveMetadata()];case 8:return O.sent(),u.localCacheEnabled&&c.put(new ut({type:Ze.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_change_log_sync",event:C.length>0||b.length>0?"cache_miss":"cache_hit",max_db_size:C.length,use_local_cache:u.localCacheEnabled,starting_point:0,message_init_policy:b.length.toString(),collection_id:o.userId}})),[3,12];case 9:return S=O.sent(),s.debug("channel changelog sync error",S),S instanceof k&&S.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:O.sent(),O.label=11;case 11:throw S;case 12:return[2,h]}})})}),this._sync.on("stop",function(){r._subscribers.dispatch("pause")}),this._connectionEventContext=l.on(function(h){h instanceof Zr&&(h.stateType===He.CONNECTED?r.resume():r.pause())})}return e.of=function(n){return ps[n]||(ps[n]=new e({_iid:n})),ps[n].ref++,ps[n]},e.clear=function(n){ps[n]&&(ps[n].close(),delete ps[n])},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._sync.isRunning},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return g(this,void 0,void 0,function(){var n,t,r,i;return _(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(n=I.of(this._iid),t=n.cacheContext,r=n.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this._metadata?[4,I.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}})})},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,I.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return n.sent(),this._metadata=void 0,[2]}})})},e.prototype.on=function(n,t){return this._subscribers.on(n,t)},e.prototype.resume=function(){I.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},e.prototype.pause=function(){this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete ps[this._iid])},e}(),Kf=function(e,n){return e.findIndex(function(t){return t.isIdentical(n)})},sS=function(e,n,t){if(e.length>0){for(var r=Kf(e,n),i=0,a=e.length-1,s=Math.floor((i+a)/2);i<a;){var o=oS(e[s],n,t);if(o>0)a=s,s=Math.floor((i+a)/2);else{if(!(o<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+a)/2)}}return{place:oS(e[s],n,t)>=0?s:s+1,oldPosition:r}}return{place:e.length,oldPosition:-1}},oS=function(e,n,t){switch(t){case Dt.LATEST_LAST_MESSAGE:return e.lastMessage&&n.lastMessage?(r=n.lastMessage.createdAt-e.lastMessage.createdAt)===0?n.createdAt-e.createdAt:r:e.lastMessage?-1:n.lastMessage?1:n.createdAt-e.createdAt;case Dt.CHRONOLOGICAL:return n.createdAt-e.createdAt;case Dt.CHANNEL_NAME_ALPHABETICAL:var r;return(r=e.name.localeCompare(n.name))===0?e.createdAt-n.createdAt:r;default:return 0}},RF=function(){function e(n,t){var r=t.filter,i=r===void 0?new vI:r,a=t.order,s=a===void 0?Dt.LATEST_LAST_MESSAGE:a,o=t.limit,l=o===void 0?uN:o,u=t.includeChangesOnInitialLoad,c=u!==void 0&&u,d=this;this.channels=[],this._isInitialized=!1,this._iid=n,this._key="gcc-".concat(Wr()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this._includeChangesOnInitialLoad=c,this.filter=i,this.order=s,this._hasMore=!0,this._token="",this._limit=l;var h=I.of(this._iid),f=h.sdkState,m=h.cacheContext,y=h.dispatcher;m.localCacheEnabled&&(this._backgroundSync=DF.of(n),this._backgroundSync.resume()),this._changelogSync=kF.of(n),this._changelogSync.resume(),en.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(C,b){var v=b.source;if(Qf(v)){var E=C.filter(function(w){return d.filter.match(w,f.userId)}),S=C.filter(function(w){return!d.filter.match(w,f.userId)}).map(function(w){return w.url});E.length>0&&d._addChannelsToView(E,b),S.length>0&&d._removeChannelsFromView(S,b)}},onRemove:function(C,b){d._removeChannelsFromView(C,b)}}),y.on(function(C){C instanceof Zr&&(C.stateType===He.CONNECTED?d._isGetRemoteChannelsSucceeded||g(d,void 0,void 0,function(){return _(this,function(b){switch(b.label){case 0:return[4,this._revokeLoadMore()];case 1:return b.sent(),[2]}})}):C.stateType===He.LOGOUT&&d.dispose())})}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(n){this._handler=n},e.prototype._addChannelsToView=function(n,t,r){var i,a,s,o,l=this;r===void 0&&(r=!1);var u=[],c=[],d=[];try{for(var h=K(n),f=h.next();!f.done;f=h.next()){var m=f.value,y=Kf(this.channels,m);y>=0&&this.channels.splice(y,1);var C=sS(this.channels,m,this.order).place;if(y<0)C===this.channels.length?!r&&this._hasMore||(u.push(m),this.channels.push(m)):(u.push(m),this.channels.splice(C,0,m));else switch(t.source){case P.EVENT_CHANNEL_UPDATED:case P.EVENT_MESSAGE_RECEIVED:case P.SYNC_CHANNEL_CHANGELOGS:case P.EVENT_MESSAGE_SENT:this.order===Dt.CHANNEL_NAME_ALPHABETICAL&&this._hasMore&&C===this.channels.length?d.push(m):(this.channels.splice(C,0,m),c.push(m));break;default:this.channels.splice(C,0,m),c.push(m)}}}catch(S){i={error:S}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}if(d.length>0)try{for(var b=K(d),v=b.next();!v.done;v=b.next()){m=v.value;var E=Kf(this.channels,m);E!==-1&&this.channels.splice(E,1)}}catch(S){s={error:S}}finally{try{v&&!v.done&&(o=b.return)&&o.call(b)}finally{if(s)throw s.error}}Qf(t.source)&&he(function(){return g(l,void 0,void 0,function(){var S,w,A;return _(this,function(D){return u.length>0&&(!((S=this._handler)===null||S===void 0)&&S.onChannelsAdded)&&this._handler.onChannelsAdded(t,u),c.length>0&&(!((w=this._handler)===null||w===void 0)&&w.onChannelsUpdated)&&this._handler.onChannelsUpdated(t,c),d.length>0&&(!((A=this._handler)===null||A===void 0)&&A.onChannelsDeleted)&&this._handler.onChannelsDeleted(t,d.map(function(O){return O.url})),[2]})})})},e.prototype._removeChannelsFromView=function(n,t){var r,i,a=this,s=[],o=function(d){var h=l.channels.findIndex(function(f){return f.url===d});h>=0&&(s.push(l.channels[h].url),l.channels.splice(h,1))},l=this;try{for(var u=K(n),c=u.next();!c.done;c=u.next())o(c.value)}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return Qf(t.source)&&s.length>0&&he(function(){return g(a,void 0,void 0,function(){var d;return _(this,function(h){return!((d=this._handler)===null||d===void 0)&&d.onChannelsDeleted&&this._handler.onChannelsDeleted(t,s),[2]})})}),s},e.prototype._getLocalChannels=function(){return g(this,void 0,void 0,function(){var n,t;return _(this,function(r){switch(r.label){case 0:return n=en.of(this._iid),t=this.channels.length>0?function(i,a){var s,o,l,u;switch(a){case Dt.LATEST_LAST_MESSAGE:return(o=(s=i.lastMessage)===null||s===void 0?void 0:s.createdAt)!==null&&o!==void 0?o:i.createdAt;case Dt.CHRONOLOGICAL:return i.createdAt;case Dt.CHANNEL_NAME_ALPHABETICAL:return i.name;default:return(u=(l=i.lastMessage)===null||l===void 0?void 0:l.createdAt)!==null&&u!==void 0?u:i.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,n.getChannelsFromCache(t,this.filter,this.order,this._limit,t?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,r.sent()]}})})},e.prototype._getRemoteChannels=function(){return g(this,void 0,void 0,function(){var n,t,r;return _(this,function(i){switch(i.label){case 0:return[4,en.of(this._iid).getMyGroupChannels(this._token,ae(N(N({},this.filter),{userIdsFilter:this.filter.userIdsFilter,searchFilter:this.filter.searchFilter,order:this.order})),this._limit)];case 1:return n=i.sent(),t=n.channels,r=n.token,this._token=r,this._hasMore=!!r,[2,t]}})})},e.prototype._revokeLoadMore=function(){return g(this,void 0,void 0,function(){var n;return _(this,function(t){switch(t.label){case 0:if(this._isDisposed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return n=t.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(n,{source:P.REQUEST_CHANNEL},!0),[3,4];case 3:return t.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}})})},e.prototype.loadMore=function(){var n;return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l,u,c,d,h,f,m,y,C,b,v,E,S,w=this;return _(this,function(A){switch(A.label){case 0:if(this._isDisposed)throw new k({code:re.COLLECTION_DISPOSED,message:"Collection has been disposed."});return t=null,this._includeChangesOnInitialLoad&&this.channels.length===0&&this._changelogSync.isRunning?[4,new Promise(function(D){w._changelogSyncSubscriberContext=w._changelogSync.on("progress",function(O){return D(O)}).on("pause",function(){return D(null)})})]:[3,2];case 1:t=A.sent(),(n=this._changelogSyncSubscriberContext)===null||n===void 0||n.close(),A.label=2;case 2:return r=I.of(this._iid),i=r.cacheContext,a=r.connectionManager,s=r.statManager,this._isInitialized?[3,5]:(this._isInitialized=!0,i.localCacheEnabled?[4,this._backgroundSync.loadMetadata()]:[3,4]);case 3:A.sent(),A.label=4;case 4:s.put(new Bd({type:Ze.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{group_channel:!0}}})),A.label=5;case 5:return o=[],this._hasMore?!i.localCacheEnabled||a.isConnected&&!this._backgroundSync.completed?[3,7]:[4,Ct(function(){return g(w,void 0,void 0,function(){return _(this,function(D){switch(D.label){case 0:return[4,this._getLocalChannels()];case 1:return o=D.sent(),[2]}})})})]:[3,11];case 6:return A.sent(),this._hasMore=o.length>=this._limit,[3,10];case 7:return A.trys.push([7,9,,10]),[4,this._getRemoteChannels()];case 8:return o=A.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,10];case 9:return A.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,10];case 10:this._addChannelsToView(o,{source:P.REQUEST_CHANNEL},!0),A.label=11;case 11:if(t){try{for(l=K(t.updatedChannels),u=l.next();!u.done;u=l.next())c=u.value,(C=Kf(o,c))>=0?o[C]=c:(d=sS(o,c,this.order).place,o.splice(d,0,c))}catch(D){b={error:D}}finally{try{u&&!u.done&&(v=l.return)&&v.call(l)}finally{if(b)throw b.error}}h=o.map(function(D){return D.url});try{for(f=K(t.deletedChannelUrls),m=f.next();!m.done;m=f.next())y=m.value,(C=h.indexOf(y))>=0&&(o.splice(C,1),h.splice(C,1))}catch(D){E={error:D}}finally{try{m&&!m.done&&(S=f.return)&&S.call(f)}finally{if(E)throw E.error}}}return[2,o]}})})},e.prototype.dispose=function(){var n,t,r;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),(n=this._backgroundSync)===null||n===void 0||n.close(),(t=this._changelogSync)===null||t===void 0||t.close(),(r=this._changelogSyncSubscriberContext)===null||r===void 0||r.close(),en.of(this._iid).unsubscribeChannelEvent(this._key))},e}(),UF=function(e){function n(t){var r=this,i=t.token,a=t.limit,s=t.order,o=t.includeEmpty,l=t.membershipFilter,u=t.channelNameContainsFilter,c=t.channelUrlsFilter,d=t.customTypesFilter,h=t.customTypeStartsWithFilter,f=t.superChannelFilter,m=t.metadataOrderKeyFilter,y=t.metadataKey,C=t.metadataValues,b=t.metadataValueStartsWith,v=t.includeFrozen,E=t.includeMetaData;return(r=e.call(this)||this).method=z.GET,r.path=Jn,r.params=W(ae({token:i,limit:a,order:s,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:o,public_mode:la.PUBLIC,public_membership_mode:l,name_contains:u,channel_urls:c,custom_types:d,custom_type_startswith:h,super_mode:f,metadata_order_key:m,metadata_key:y,metadata_values:C,metadata_value_startswith:b,show_frozen:v,show_metadata:E})),r}return T(n,e),n}(H),LF=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.channels=[];var a=r.next,s=r.channels,o=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(l){return l.ts=o,new Yr(t,l)})),i.ts=typeof o=="number"?o:0,i}return T(n,e),n}(j);(function(e){e.ALL="all",e.JOINED="joined"})(Sd||(Sd={}));var PF=function(e){function n(t,r){var i,a,s,o,l,u,c,d,h,f,m,y,C,b,v=this;return(v=e.call(this,t,r)||this).includeEmpty=!1,v.includeFrozen=!0,v.includeMetaData=!0,v.channelUrlsFilter=null,v.customTypesFilter=null,v.customTypeStartsWithFilter=null,v.channelNameContainsFilter=null,v.membershipFilter=Sd.ALL,v.superChannelFilter=gr.ALL,v.metadataKey=null,v.metadataValues=null,v.metadataOrderKeyFilter=null,v.metadataValueStartsWith=null,v.order=vd.CHRONOLOGICAL,v.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,v.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,v.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,v.channelUrlsFilter=(o=r.channelUrlsFilter)!==null&&o!==void 0?o:null,v.customTypesFilter=(l=r.customTypesFilter)!==null&&l!==void 0?l:null,v.customTypeStartsWithFilter=(u=r.customTypeStartsWithFilter)!==null&&u!==void 0?u:null,v.channelNameContainsFilter=(c=r.channelNameContainsFilter)!==null&&c!==void 0?c:null,v.membershipFilter=(d=r.membershipFilter)!==null&&d!==void 0?d:Sd.ALL,v.superChannelFilter=(h=r.superChannelFilter)!==null&&h!==void 0?h:gr.ALL,v.metadataKey=(f=r.metadataKey)!==null&&f!==void 0?f:null,v.metadataValues=(m=r.metadataValues)!==null&&m!==void 0?m:null,v.metadataOrderKeyFilter=(y=r.metadataOrderKeyFilter)!==null&&y!==void 0?y:null,v.metadataValueStartsWith=(C=r.metadataValueStartsWith)!==null&&C!==void 0?C:null,v.order=(b=r.order)!==null&&b!==void 0?b:vd.CHRONOLOGICAL,v}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("boolean",this.includeEmpty)&&x("boolean",this.includeFrozen)&&x("boolean",this.includeMetaData)&&x("string",this.channelNameContainsFilter,!0)&&Te("string",this.channelUrlsFilter,!0)&&Te("string",this.customTypesFilter,!0)&&x("string",this.customTypeStartsWithFilter,!0)&&be(Sd,this.membershipFilter)&&be(gr,this.superChannelFilter)&&be(vd,this.order)&&x("string",this.metadataOrderKeyFilter,!0)&&x("string",this.metadataKey,!0)&&Te("string",this.metadataValues,!0)&&x("string",this.metadataValueStartsWith,!0)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o,l;return _(this,function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:(t=[],this._hasNext?(this._isLoading=!0,r=I.of(this._iid).requestQueue,i=new UF(ae(N(N({},this),{token:this._token}))),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=u.sent(),s=a.as(LF),o=s.channels,l=s.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,o];case 2:return[2,t];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),CI=function(e){function n(t){t===void 0&&(t={});var r=e.call(this)||this;return Object.keys(t).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=t[i])}),r}return T(n,e),n}(function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.onUserJoined=Ne,t.onUserLeft=Ne,t.onUserReceivedInvitation=Ne,t.onUserDeclinedInvitation=Ne,t.onChannelHidden=Ne,t.onUnreadMemberStatusUpdated=Ne,t.onUndeliveredMemberStatusUpdated=Ne,t.onTypingStatusUpdated=Ne,t.onPollUpdated=Ne,t.onPollVoted=Ne,t.onPollDeleted=Ne,t.onPinnedMessageUpdated=Ne,t}return T(n,e),n}(OF)),FF=function(e){function n(t){var r=this,i=t.token,a=t.limit,s=t.order,o=t.reverse,l=t.channelUrl,u=t.messageTypeFilter,c=t.scheduledStatus;return(r=e.call(this)||this).method=z.GET,r.path="".concat(X2),r.params=W(ae({token:i,limit:a,reverse:o,channel_url:l,order:s,message_type:u,status:c})),r}return T(n,e),n}(H),$F=function(e){function n(t,r){var i=e.call(this,t,r)||this;i.scheduledMessages=[];var a=r.next,s=r.scheduled_messages;return i.token=a,i.scheduledMessages=s.map(function(o){return Zn(t,o)}),i}return T(n,e),n}(j),zF=function(e){function n(t,r){var i,a,s,o,l,u=this;return(u=e.call(this,t,r)||this).channelUrl=null,u.order=null,u.reverse=!1,u.scheduledStatus=null,u.messageTypeFilter=Un.ALL,u.channelUrl=(i=r.channelUrl)!==null&&i!==void 0?i:null,u.order=(a=r.order)!==null&&a!==void 0?a:null,u.reverse=(s=r.reverse)!==null&&s!==void 0&&s,u.scheduledStatus=(o=r.scheduledStatus)!==null&&o!==void 0?o:null,u.messageTypeFilter=(l=r.messageTypeFilter)!==null&&l!==void 0?l:Un.ALL,u}return T(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&x("string",this.channelUrl,!0)&&(be(a0,this.order)||this.order===null)&&x("boolean",this.reverse)&&(Te(xs,this.scheduledStatus)||this.scheduledStatus===null)&&be(Un,this.messageTypeFilter)},n.prototype.next=function(){return g(this,void 0,void 0,function(){var t,r,i,a,s,o;return _(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=I.of(this._iid).requestQueue,r=new FF(ae(N(N({},this),{token:this._token}))),[4,t.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as($F),s=a.scheduledMessages,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw k.queryInProgress;case 4:return[3,6];case 5:throw k.invalidParameters;case 6:return[2]}})})},n}(Xa),HF=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.name="groupChannel",t}return T(n,e),n.prototype.init=function(t,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,o=r.requestQueue,l=r.logger,u=r.onlineDetector,c=r.cacheContext;e.prototype.init.call(this,t,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:o,logger:l,onlineDetector:u,cacheContext:c}),this._manager=new en(t,{sdkState:i,cacheContext:c,dispatcher:a,sessionManager:s,requestQueue:o,logger:l})},n.prototype.createGroupChannelCollection=function(t){return t===void 0&&(t={}),new RF(this._iid,t)},n.prototype.createMyGroupChannelListQuery=function(t){return t===void 0&&(t={}),new EI(this._iid,t)},n.prototype.createPublicGroupChannelListQuery=function(t){return t===void 0&&(t={}),new PF(this._iid,t)},n.prototype.createScheduledMessageListQuery=function(t){return t===void 0&&(t={}),new zF(this._iid,t)},n.prototype.addGroupChannelHandler=function(t,r){B(x("string",t)&&r instanceof CI).throw(k.invalidParameters),this._manager.addHandler(t,r)},n.prototype.removeGroupChannelHandler=function(t){B(x("string",t)).throw(k.invalidParameters),this._manager.removeHandler(t)},n.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},n.prototype.buildGroupChannelFromSerializedData=function(t){return this._manager.buildGroupChannelFromSerializedData(t)},n.prototype.buildGroupChannelListQueryFromSerializedData=function(t){return this._manager.buildGroupChannelListQueryFromSerializedData(t)},n.prototype.buildMemberFromSerializedData=function(t){return this._manager.buildMemberFromSerializedData(t)},n.prototype.getChannel=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(x("string",t)).throw(k.invalidParameters),[2,this._manager.getChannel(t)]})})},n.prototype.getChannelWithoutCache=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(x("string",t)).throw(k.invalidParameters),[2,this._manager.getChannelWithoutCache(t)]})})},n.prototype.getMyGroupChannelChangeLogsByToken=function(t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},tm),r),B(x("string",t)&&m0(i)).throw(k.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(t,i)];case 1:return[2,a.sent()]}})})},n.prototype.getMyGroupChannelChangeLogsByTimestamp=function(t,r){return r===void 0&&(r={}),g(this,void 0,void 0,function(){var i;return _(this,function(a){switch(a.label){case 0:return i=N(N({},tm),r),B(x("number",t)&&m0(i)).throw(k.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(t,i)];case 1:return[2,a.sent()]}})})},n.prototype.getGroupChannelCount=function(t){return g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},yI),t),B(bI(r)).throw(k.invalidParameters),[2,this._manager.getGroupChannelCount(r)]})})},n.prototype.getUnreadItemCount=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._manager.getUnreadItemCount(t)];case 1:return[2,r.sent()]}})})},n.prototype.getTotalUnreadChannelCount=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,t.sent()]}})})},n.prototype.getTotalUnreadMessageCount=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(t)];case 1:return[2,r.sent()]}})})},n.prototype.getTotalScheduledMessageCount=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(t)];case 1:return[2,r.sent()]}})})},n.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},n.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},n.prototype.getSubscribedCustomTypeUnreadMessageCount=function(t){return this._manager.getSubscribedCustomTypeUnreadMessageCount(t)},n.prototype.createChannel=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},jf),t),B(p0(r)).throw(k.invalidParameters),[2,this._manager.createChannel(r)]})})},n.prototype.createDistinctChannelIfNotExist=function(t){return t===void 0&&(t={}),g(this,void 0,void 0,function(){var r;return _(this,function(i){return r=N(N({},jf),t),B(p0(r)).throw(k.invalidParameters),r&&(r.isDistinct=!0),[2,this.createChannel(r)]})})},n.prototype.createChannelWithUserIds=function(t,r,i,a,s,o){return r===void 0&&(r=!1),s===void 0&&(s=""),o===void 0&&(o=""),g(this,void 0,void 0,function(){var l;return _(this,function(u){return l=N(N({},jf),{invitedUserIds:t,isDistinct:r,name:i,data:s,customType:o}),typeof a=="string"?l.coverUrl=a:l.coverImage=a,[2,this.createChannel(l)]})})},n.prototype.markAsReadAll=function(){return g(this,void 0,void 0,function(){return _(this,function(t){return this._manager.markAsReadAll(),[2]})})},n.prototype.markAsReadWithChannelUrls=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){return B(Te("string",t)).throw(k.invalidParameters),this._manager.markAsReadWithChannelUrls(t),[2]})})},n.prototype.markAsDelivered=function(t){return g(this,void 0,void 0,function(){return _(this,function(r){switch(r.label){case 0:return B(x("string",t)).throw(k.invalidParameters),[4,this.getChannel(t)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},n}(xm);const rm={collection:{groupChannel:{defaultOrder:Dt.LATEST_LAST_MESSAGE},message:{defaultLimit:{next:25,prev:25},searchLimit:{next:10,prev:10}}}};let qF=0;function BF(){return p.useState(()=>`${qF++}`)[0]}const Yy=(e,n,t)=>{const r=p.useRef(n),a=BF();r.current=n,p.useEffect(()=>{var s;const o=l=>(Object.keys(l).forEach(c=>{l[c]=(...d)=>{var h,f;return(f=(h=r.current)===null||h===void 0?void 0:h[c])===null||f===void 0?void 0:f.call(h,...d)}}),l);return(s=e?.groupChannel)===null||s===void 0||s.addGroupChannelHandler(a,o(new CI)),()=>{var l;(l=e?.groupChannel)===null||l===void 0||l.removeGroupChannelHandler(a)}},[e?.groupChannel,a])};function Nn(e){const n=p.useRef(e);return n.current=e,p.useCallback((...t)=>n.current(...t),[n])}function GF(e,n){return!e||!n?!0:e.url!==n.url}function pi(e){return e!=null&&"sendingStatus"in e}function SI(e,n="##__USER_ID_IS_NOT_PROVIDED__##"){var t;return pi(e)?((t=e.sender)===null||t===void 0?void 0:t.userId)===n:!1}function VF(e,n){return SI(e,n)||e.isAdminMessage()?!1:e.updatedAt===0}function lS(e){return"sendingStatus"in e?e.sendingStatus==="succeeded"?String(e.messageId):e.reqId:String(e.messageId)}function uS(e){return!e||!Array.isArray(e)?!1:e.length!==0}const TI=()=>{const[,e]=p.useState(0);return p.useCallback(()=>e(n=>n+1),[])};function cS(e,n){return e.reduce((t,r)=>{const i=n(r);return t[i]=r,t},{})}var jF=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t};const QF=(e,n)=>{var t=jF(e,[]);switch(n.type){case"update_initialized":return t.initialized=n.value.status,t;case"update_refreshing":return t.refreshing=n.value.status,t;case"update_loading":return t.loading=n.value.status,t;case"update_messages":{if(n.value.clearBeforeAction)t.messageMap=KF(n.value.messages);else{const r=Object.assign({},t.messageMap),i=[],a=[];n.value.messages.forEach(s=>{const o=pi(s)?s.reqId:void 0,l=s.messageId||void 0;[o,l].forEach(u=>{if(!u)return;const c=r[u];WF(c,s)&&(c&&i.push(c),a.push(s))})}),i.forEach(s=>{pi(s)&&delete r[s.reqId],delete r[s.messageId]}),a.forEach(s=>{pi(s)&&(r[s.reqId]=s),r[s.messageId]=s}),t.messageMap=r}return t}case"update_new_messages":{const r=n.value.currentUserId,i=n.value.messages.filter(a=>VF(a,r));return n.value.clearBeforeAction?t.newMessageMap=cS(i,lS):(i.map(s=>s.messageId).forEach(s=>delete t.newMessageMap[s]),t.newMessageMap=Object.assign(Object.assign({},t.newMessageMap),cS(i,lS))),t}case"delete_messages":case"delete_new_messages":{const r=n.type==="delete_messages"?"messageMap":"newMessageMap";return t[r]=Object.assign({},t[r]),n.value.messageIds.forEach(i=>{const a=t[r][i];a&&(pi(a)&&delete t[r][a.reqId],delete t[r][a.messageId])}),n.value.reqIds.forEach(i=>{const a=t[r][i];a&&(pi(a)&&delete t[r][a.reqId],delete t[r][a.messageId])}),t}}},KF=e=>e.reduce((n,t)=>(pi(t)?(n[t.reqId]=t,t.sendingStatus===rt.SUCCEEDED&&(n[t.messageId]=t)):n[t.messageId]=t,n),{}),WF=(e,n)=>!pi(e)||!pi(n)?!0:e.sendingStatus===rt.SUCCEEDED?n.sendingStatus===rt.SUCCEEDED:e.sendingStatus!==n.sendingStatus,YF=(e=ZF)=>{const[{initialized:n,loading:t,refreshing:r,messageMap:i,newMessageMap:a},s]=p.useReducer(QF,{initialized:!1,loading:!0,refreshing:!1,messageMap:{},newMessageMap:{}}),o=(C,b,v)=>{s({type:"update_messages",value:{messages:C,clearBeforeAction:b,currentUserId:v}})},l=(C,b)=>{s({type:"delete_messages",value:{messageIds:C,reqIds:b}})},u=(C,b,v)=>{s({type:"update_new_messages",value:{messages:C,clearBeforeAction:b,currentUserId:v}})},c=(C,b)=>{s({type:"delete_new_messages",value:{messageIds:C,reqIds:b}})},d=C=>{s({type:"update_initialized",value:{status:C}})},h=C=>{s({type:"update_loading",value:{status:C}})},f=C=>{s({type:"update_refreshing",value:{status:C}})},m=Object.values(a),y=p.useMemo(()=>Array.from(new Set(Object.values(i))).sort(e),[i]);return{updateInitialized:d,updateLoading:h,updateRefreshing:f,updateMessages:o,deleteMessages:l,initialized:n,loading:t,refreshing:r,messages:y,newMessages:m,updateNewMessages:u,deleteNewMessages:c}},dS=Math.floor(Number.MAX_SAFE_INTEGER/10);function ZF(e,n){let t=0,r=0;return pi(e)&&e.sendingStatus!=="succeeded"&&(t=dS),pi(n)&&n.sendingStatus!=="succeeded"&&(r=dS),e.createdAt+t-(n.createdAt+r)}var Di=function(e,n,t,r){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{u(r.next(c))}catch(d){s(d)}}function l(c){try{u(r.throw(c))}catch(d){s(d)}}function u(c){c.done?a(c.value):i(c.value).then(o,l)}u((r=r.apply(e,n||[])).next())})};const XF=(e,n,t)=>{var r;const i={prevResultLimit:n.prev,nextResultLimit:n.next,startingPoint:t?.startingPoint,replyType:t?.replyType},a=(r=t?.collectionCreator)===null||r===void 0?void 0:r.call(t,i);return a||e.createMessageCollection(Object.assign(Object.assign({},i),{filter:new Wa(i)}))};function hS(e){return e<Date.now()?rm.collection.message.searchLimit:rm.collection.message.defaultLimit}const JF=(e,n,t={})=>{var r,i,a;const s=p.useRef(t);s.current=t;const o=p.useRef(n);o.current=n;const l=s.current.logger,u=(r=s.current.startingPoint)!==null&&r!==void 0?r:Number.MAX_SAFE_INTEGER,c=hS(u),d=p.useRef({prev:!1,next:!1}),h=TI(),f=p.useRef({initialized:!1,apiInitialized:!1,instance:null}),{initialized:m,loading:y,refreshing:C,messages:b,newMessages:v,updateMessages:E,updateNewMessages:S,deleteNewMessages:w,deleteMessages:A,updateInitialized:D,updateLoading:O,updateRefreshing:M}=YF(t?.sortComparator),F=Nn(oe=>{var le,me,ke,fe;if(!o.current||!o.current.url)return(le=l?.error)===null||le===void 0?void 0:le.call(l,"[useGroupChannelMessages] channel is required");try{switch(oe){case P.EVENT_MESSAGE_RECEIVED:case P.EVENT_MESSAGE_SENT_SUCCESS:case P.SYNC_MESSAGE_FILL:case void 0:(ke=(me=s.current).markAsRead)===null||ke===void 0||ke.call(me,[o.current]);break}}catch(de){(fe=l?.warn)===null||fe===void 0||fe.call(l,"[useGroupChannelMessages/markAsReadBySource]",de)}}),U=Nn((oe,le)=>{var me,ke,fe,de,ue;const $e=le.filter(Yt=>{var Qe;return!SI(Yt,(Qe=e.currentUser)===null||Qe===void 0?void 0:Qe.userId)});if($e.length>0)switch(oe){case P.EVENT_MESSAGE_RECEIVED:case P.SYNC_MESSAGE_FILL:{!((ke=(me=s.current).shouldCountNewMessages)===null||ke===void 0)&&ke.call(me)&&S($e,!1,(fe=e.currentUser)===null||fe===void 0?void 0:fe.userId),(ue=(de=s.current).onMessagesReceived)===null||ue===void 0||ue.call(de,$e);break}}}),$=Nn((oe,le,me)=>Di(void 0,void 0,void 0,function*(){return new Promise((ke,fe)=>{var de;f.current.instance&&f.current.instance.dispose(),F(),S([],!0,(de=e.currentUser)===null||de===void 0?void 0:de.userId);const ue=()=>{var Qe,Tt,et;const{pendingMessages:Ye,failedMessages:kt}=(Qe=f.current.instance)!==null&&Qe!==void 0?Qe:{};uS(Ye)&&E(Ye,!1,(Tt=e.currentUser)===null||Tt===void 0?void 0:Tt.userId),uS(kt)&&E(kt,!1,(et=e.currentUser)===null||et===void 0?void 0:et.userId)},$e=XF(oe,me,Object.assign(Object.assign({},s.current),{startingPoint:le}));f.current={apiInitialized:!1,initialized:!1,instance:$e},$e.setMessageCollectionHandler({onMessagesAdded:(Qe,Tt,et)=>{var Ye;F(Qe.source),U(Qe.source,et),E(et,!1,(Ye=e.currentUser)===null||Ye===void 0?void 0:Ye.userId)},onMessagesUpdated:(Qe,Tt,et)=>{var Ye,kt,zn;F(Qe.source),U(Qe.source,et),E(et,!1,(Ye=e.currentUser)===null||Ye===void 0?void 0:Ye.userId),Qe.source===P.EVENT_MESSAGE_UPDATED&&((zn=(kt=s.current).onMessagesUpdated)===null||zn===void 0||zn.call(kt,et))},onMessagesDeleted:(Qe,Tt,et,Ye)=>{const kt=Ye.map(Cr=>Cr.messageId),zn=Ye.filter(pi).map(Cr=>Cr.reqId);A(kt,zn),w(kt,zn)},onChannelDeleted:(Qe,Tt)=>{var et,Ye;(Ye=(et=s.current).onChannelDeleted)===null||Ye===void 0||Ye.call(et,Tt)},onChannelUpdated:(Qe,Tt)=>{var et,Ye;h(),(Ye=(et=s.current).onChannelUpdated)===null||Ye===void 0||Ye.call(et,Tt)},onHugeGapDetected:()=>{$(oe,Number.MAX_SAFE_INTEGER,rm.collection.message.defaultLimit)}});let Yt=!1;$e.initialize(nm.CACHE_AND_REPLACE_BY_API).onCacheResult((Qe,Tt)=>{var et,Ye,kt;Qe?(e.isCacheEnabled&&((et=l?.error)===null||et===void 0||et.call(l,"[useGroupChannelMessages/onCacheResult]",Qe)),Yt=!0):Tt&&((Ye=l?.debug)===null||Ye===void 0||Ye.call(l,"[useGroupChannelMessages/onCacheResult]","message length:",Tt.length),E(Tt,!0,(kt=e.currentUser)===null||kt===void 0?void 0:kt.userId),ue(),Tt.length>0&&(f.current.initialized=!0,ke()))}).onApiResult((Qe,Tt)=>{var et,Ye,kt,zn,Cr;f.current.initialized=!0,f.current.apiInitialized=!0,Qe?((et=l?.warn)===null||et===void 0||et.call(l,"[useGroupChannelMessages/onApiResult]",Qe),Yt?fe(Qe):ke()):Tt&&((Ye=l?.debug)===null||Ye===void 0||Ye.call(l,"[useGroupChannelMessages/onApiResult]","message length:",Tt.length),E(Tt,!0,(kt=e.currentUser)===null||kt===void 0?void 0:kt.userId),s.current.startingPoint||(Cr=(zn=s.current).onMessagesReceived)===null||Cr===void 0||Cr.call(zn,Tt),e.isCacheEnabled&&ue(),ke())})})}));Yy(e,{onUserBanned(oe,le){var me,ke,fe;oe.isGroupChannel()&&!GF(oe,o.current)&&(le.userId===((me=e.currentUser)===null||me===void 0?void 0:me.userId)?(fe=(ke=s.current).onCurrentUserBanned)===null||fe===void 0||fe.call(ke):h())}}),p.useLayoutEffect(()=>{const oe=setTimeout(()=>Di(void 0,void 0,void 0,function*(){e.currentUser&&o.current&&(D(!1),O(!0),yield $(o.current,u,c),O(!1),D(!0))}));return()=>clearTimeout(oe)},[e,(i=e.currentUser)===null||i===void 0?void 0:i.userId,(a=o.current)===null||a===void 0?void 0:a.url,s.current.replyType]),p.useEffect(()=>()=>{f.current.instance&&f.current.instance.dispose()},[]);const J=Nn(()=>Di(void 0,void 0,void 0,function*(){e.currentUser&&o.current&&(M(!0),yield $(o.current,Number.MAX_SAFE_INTEGER,rm.collection.message.defaultLimit),M(!1))})),ee=Nn(()=>Di(void 0,void 0,void 0,function*(){var oe;const le=f.current.instance;if(le?.hasPrevious&&!d.current.prev)try{d.current.prev=!0;const me=yield le.loadPrevious();E(me,!1,(oe=e.currentUser)===null||oe===void 0?void 0:oe.userId)}catch{}finally{d.current.prev=!1}})),ve=Nn(()=>{const{initialized:oe,instance:le}=f.current;return oe&&le?le.hasPrevious:!1}),Q=Nn(()=>Di(void 0,void 0,void 0,function*(){var oe;const le=f.current.instance;if(le?.hasNext&&!d.current.next)try{d.current.next=!0;const me=yield le.loadNext();E(me,!1,(oe=e.currentUser)===null||oe===void 0?void 0:oe.userId)}catch{}finally{d.current.next=!1}})),Z=Nn(()=>{const{initialized:oe,apiInitialized:le,instance:me}=f.current;return le&&oe&&me?me.hasNext:!1}),X=Nn((oe,le)=>{var me;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((ke,fe)=>{o.current.sendUserMessage(oe).onPending(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),le?.(de)}).onSucceeded(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),ke(de)}).onFailed((de,ue)=>{var $e;ue&&ue.channelUrl===o.current.url&&E([ue],!1,($e=e.currentUser)===null||$e===void 0?void 0:$e.userId),fe(de)})})}),se=Nn((oe,le)=>{var me;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((ke,fe)=>{o.current.sendFileMessage(oe).onPending(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),le?.(de)}).onSucceeded(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),ke(de)}).onFailed((de,ue)=>{var $e;ue&&ue.channelUrl===o.current.url&&E([ue],!1,($e=e.currentUser)===null||$e===void 0?void 0:$e.userId),fe(de)})})}),Ce=Nn((oe,le)=>Di(void 0,void 0,void 0,function*(){var me;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise(ke=>{const fe=[];o.current.sendFileMessages(oe).onPending(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),le?.(de)}).onSucceeded(de=>{var ue;de.isFileMessage()&&de.channelUrl===o.current.url&&(E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),fe.push(de)),fe.length===oe.length&&ke(fe)}).onFailed((de,ue)=>{var $e;ue&&ue.channelUrl===o.current.url?(E([ue],!1,($e=e.currentUser)===null||$e===void 0?void 0:$e.userId),fe.push(ue)):fe.push(null),fe.length===oe.length&&ke(fe)})})})),Me=Nn((oe,le)=>{var me;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((ke,fe)=>{o.current.sendMultipleFilesMessage(oe).onPending(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),le?.(de)}).onFileUploaded(()=>{h()}).onSucceeded(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),ke(de)}).onFailed((de,ue)=>{var $e;ue&&ue.channelUrl===o.current.url&&E([ue],!1,($e=e.currentUser)===null||$e===void 0?void 0:$e.userId),fe(de)})})}),Ue=Nn((oe,le)=>Di(void 0,void 0,void 0,function*(){var me,ke;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");const fe=yield o.current.updateUserMessage(oe,le);return fe.channelUrl===o.current.url&&E([fe],!1,(ke=e.currentUser)===null||ke===void 0?void 0:ke.userId),fe})),Le=Nn((oe,le)=>Di(void 0,void 0,void 0,function*(){var me,ke;if(!o.current||!o.current.url)throw(me=l?.error)===null||me===void 0||me.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");const fe=yield o.current.updateFileMessage(oe,le);return fe.channelUrl===o.current.url&&E([fe],!1,(ke=e.currentUser)===null||ke===void 0?void 0:ke.userId),fe})),ot=Nn(oe=>Di(void 0,void 0,void 0,function*(){var le;if(!o.current||!o.current.url)throw(le=l?.error)===null||le===void 0||le.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");return new Promise((me,ke)=>{let fe;oe.isUserMessage()&&(fe=o.current.resendMessage(oe)),oe.isFileMessage()&&(fe=o.current.resendMessage(oe)),oe.isMultipleFilesMessage()&&(fe=o.current.resendMessage(oe)),fe&&("onPending"in fe&&fe.onPending(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId)}),"onFileUploaded"in fe&&fe.onFileUploaded(()=>{h()}),"onSucceeded"in fe&&fe.onSucceeded(de=>{var ue;de.channelUrl===o.current.url&&E([de],!1,(ue=e.currentUser)===null||ue===void 0?void 0:ue.userId),me(de)}),"onFailed"in fe&&fe.onFailed((de,ue)=>{var $e;ue&&ue.channelUrl===o.current.url&&E([ue],!1,($e=e.currentUser)===null||$e===void 0?void 0:$e.userId),ke(de)}))})})),pe=Nn(oe=>Di(void 0,void 0,void 0,function*(){var le,me;if(!o.current||!o.current.url)throw(le=l?.error)===null||le===void 0||le.call(l,"[useGroupChannelMessages] channel is required"),new Error("Channel is required");if(oe.sendingStatus==="succeeded")oe.isUserMessage()&&(yield o.current.deleteMessage(oe)),oe.isFileMessage()&&(yield o.current.deleteMessage(oe)),oe.isMultipleFilesMessage()&&(yield o.current.deleteMessage(oe));else try{yield(me=f.current.instance)===null||me===void 0?void 0:me.removeFailedMessage(oe.reqId)}finally{A([oe.messageId],[oe.reqId])}})),lt=Nn(()=>{var oe;S([],!0,(oe=e.currentUser)===null||oe===void 0?void 0:oe.userId)}),an=Nn(oe=>Di(void 0,void 0,void 0,function*(){var le;if(e.currentUser&&o.current){const me=hS(oe);O(!0),E([],!0,(le=e.currentUser)===null||le===void 0?void 0:le.userId),yield $(o.current,oe,me),O(!1)}}));return{initialized:m,loading:y,refreshing:C,messages:b,newMessages:v,resetNewMessages:lt,refresh:J,loadPrevious:ee,hasPrevious:ve,loadNext:Q,hasNext:Z,sendUserMessage:X,sendFileMessage:se,sendFileMessages:Ce,sendMultipleFilesMessage:Me,updateUserMessage:Ue,updateFileMessage:Le,resendMessage:ot,deleteMessage:pe,resetWithStartingPoint:an,_dangerous_reducer_updateMessages:E,_dangerous_reducer_deleteMessages:A}},wI=()=>({common:{enableUsingDefaultUserProfile:!1},groupChannel:{channel:{enableMention:!1,enableOgtag:!0,enableReactions:!0,enableReactionsSupergroup:!1,enableTypingIndicator:!0,enableVoiceMessage:!1,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}},replyType:"quote_reply",threadReplySelectType:"thread",typingIndicatorTypes:new Set(["text"]),enableFeedback:!1,enableSuggestedReplies:!1,showSuggestedRepliesFor:"last_message_only",suggestedRepliesDirection:"vertical",enableMarkdownForUserMessage:!1,enableFormTypeMessage:!1},channelList:{enableMessageReceiptStatus:!1,enableTypingIndicator:!1},setting:{enableMessageSearch:!1}},openChannel:{channel:{enableOgtag:!0,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}}}}});function e7(e){return delete e.groupChannel.channel.typingIndicatorTypes,delete e.groupChannel.channel.enableFeedback,delete e.groupChannel.channel.enableSuggestedReplies,delete e.groupChannel.channel.showSuggestedRepliesFor,delete e.groupChannel.channel.suggestedRepliesDirection,delete e.groupChannel.channel.enableMarkdownForUserMessage,delete e.groupChannel.channel.enableFormTypeMessage,e}const t7=()=>{const e=wI();return e7(e)},fS=wI();t7();p.createContext({initDashboardConfigs:()=>Promise.resolve(),configs:fS,configsWithAppAttr:()=>fS});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:AI,setPrototypeOf:pS,isFrozen:n7,getPrototypeOf:r7,getOwnPropertyDescriptor:i7}=Object;let{freeze:vr,seal:Si,create:NI}=Object,{apply:y0,construct:b0}=typeof Reflect<"u"&&Reflect;vr||(vr=function(n){return n});Si||(Si=function(n){return n});y0||(y0=function(n,t,r){return n.apply(t,r)});b0||(b0=function(n,t){return new n(...t)});const ff=yr(Array.prototype.forEach),a7=yr(Array.prototype.lastIndexOf),mS=yr(Array.prototype.pop),Cc=yr(Array.prototype.push),s7=yr(Array.prototype.splice),Wf=yr(String.prototype.toLowerCase),kg=yr(String.prototype.toString),_S=yr(String.prototype.match),Sc=yr(String.prototype.replace),o7=yr(String.prototype.indexOf),l7=yr(String.prototype.trim),Ri=yr(Object.prototype.hasOwnProperty),ur=yr(RegExp.prototype.test),Tc=u7(TypeError);function yr(e){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return y0(e,n,r)}}function u7(e){return function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return b0(e,t)}}function Xe(e,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wf;pS&&pS(e,null);let r=n.length;for(;r--;){let i=n[r];if(typeof i=="string"){const a=t(i);a!==i&&(n7(n)||(n[r]=a),i=a)}e[i]=!0}return e}function c7(e){for(let n=0;n<e.length;n++)Ri(e,n)||(e[n]=null);return e}function wa(e){const n=NI(null);for(const[t,r]of AI(e))Ri(e,t)&&(Array.isArray(r)?n[t]=c7(r):r&&typeof r=="object"&&r.constructor===Object?n[t]=wa(r):n[t]=r);return n}function wc(e,n){for(;e!==null;){const r=i7(e,n);if(r){if(r.get)return yr(r.get);if(typeof r.value=="function")return yr(r.value)}e=r7(e)}function t(){return null}return t}const gS=vr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Rg=vr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ug=vr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),d7=vr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Lg=vr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),h7=vr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vS=vr(["#text"]),yS=vr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Pg=vr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),bS=vr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),pf=vr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),f7=Si(/\{\{[\w\W]*|[\w\W]*\}\}/gm),p7=Si(/<%[\w\W]*|[\w\W]*%>/gm),m7=Si(/\$\{[\w\W]*/gm),_7=Si(/^data-[\-\w.\u00B7-\uFFFF]+$/),g7=Si(/^aria-[\-\w]+$/),II=Si(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),v7=Si(/^(?:\w+script|data):/i),y7=Si(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),MI=Si(/^html$/i),b7=Si(/^[a-z][.\w]*(-[.\w]+)+$/i);var ES=Object.freeze({__proto__:null,ARIA_ATTR:g7,ATTR_WHITESPACE:y7,CUSTOM_ELEMENT:b7,DATA_ATTR:_7,DOCTYPE_NAME:MI,ERB_EXPR:p7,IS_ALLOWED_URI:II,IS_SCRIPT_OR_DATA:v7,MUSTACHE_EXPR:f7,TMPLIT_EXPR:m7});const Ac={element:1,text:3,progressingInstruction:7,comment:8,document:9},E7=function(){return typeof window>"u"?null:window},C7=function(n,t){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const a="dompurify"+(r?"#"+r:"");try{return n.createPolicy(a,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},CS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function xI(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E7();const n=Ee=>xI(Ee);if(n.version="3.2.6",n.removed=[],!e||!e.document||e.document.nodeType!==Ac.document||!e.Element)return n.isSupported=!1,n;let{document:t}=e;const r=t,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:s,Node:o,Element:l,NodeFilter:u,NamedNodeMap:c=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:f}=e,m=l.prototype,y=wc(m,"cloneNode"),C=wc(m,"remove"),b=wc(m,"nextSibling"),v=wc(m,"childNodes"),E=wc(m,"parentNode");if(typeof s=="function"){const Ee=t.createElement("template");Ee.content&&Ee.content.ownerDocument&&(t=Ee.content.ownerDocument)}let S,w="";const{implementation:A,createNodeIterator:D,createDocumentFragment:O,getElementsByTagName:M}=t,{importNode:F}=r;let U=CS();n.isSupported=typeof AI=="function"&&typeof E=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:$,ERB_EXPR:J,TMPLIT_EXPR:ee,DATA_ATTR:ve,ARIA_ATTR:Q,IS_SCRIPT_OR_DATA:Z,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:se}=ES;let{IS_ALLOWED_URI:Ce}=ES,Me=null;const Ue=Xe({},[...gS,...Rg,...Ug,...Lg,...vS]);let Le=null;const ot=Xe({},[...yS,...Pg,...bS,...pf]);let pe=Object.seal(NI(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),lt=null,an=null,oe=!0,le=!0,me=!1,ke=!0,fe=!1,de=!0,ue=!1,$e=!1,Yt=!1,Qe=!1,Tt=!1,et=!1,Ye=!0,kt=!1;const zn="user-content-";let Cr=!0,fa=!1,pa={},Xr=null;const so=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Xu=null;const Nl=Xe({},["audio","video","img","source","image","track"]);let ns=null;const Il=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),cn="http://www.w3.org/1998/Math/MathML",Mr="http://www.w3.org/2000/svg",Jr="http://www.w3.org/1999/xhtml";let De=Jr,Tn=!1,rs=null;const gh=Xe({},[cn,Mr,Jr],kg);let oo=Xe({},["mi","mo","mn","ms","mtext"]),ji=Xe({},["annotation-xml"]);const Ml=Xe({},["title","style","font","a","script"]);let wi=null;const is=["application/xhtml+xml","text/html"],Lt="text/html";let Zt=null,Ai=null;const Ni=t.createElement("form"),xl=function(R){return R instanceof RegExp||R instanceof Function},lo=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ai&&Ai===R)){if((!R||typeof R!="object")&&(R={}),R=wa(R),wi=is.indexOf(R.PARSER_MEDIA_TYPE)===-1?Lt:R.PARSER_MEDIA_TYPE,Zt=wi==="application/xhtml+xml"?kg:Wf,Me=Ri(R,"ALLOWED_TAGS")?Xe({},R.ALLOWED_TAGS,Zt):Ue,Le=Ri(R,"ALLOWED_ATTR")?Xe({},R.ALLOWED_ATTR,Zt):ot,rs=Ri(R,"ALLOWED_NAMESPACES")?Xe({},R.ALLOWED_NAMESPACES,kg):gh,ns=Ri(R,"ADD_URI_SAFE_ATTR")?Xe(wa(Il),R.ADD_URI_SAFE_ATTR,Zt):Il,Xu=Ri(R,"ADD_DATA_URI_TAGS")?Xe(wa(Nl),R.ADD_DATA_URI_TAGS,Zt):Nl,Xr=Ri(R,"FORBID_CONTENTS")?Xe({},R.FORBID_CONTENTS,Zt):so,lt=Ri(R,"FORBID_TAGS")?Xe({},R.FORBID_TAGS,Zt):wa({}),an=Ri(R,"FORBID_ATTR")?Xe({},R.FORBID_ATTR,Zt):wa({}),pa=Ri(R,"USE_PROFILES")?R.USE_PROFILES:!1,oe=R.ALLOW_ARIA_ATTR!==!1,le=R.ALLOW_DATA_ATTR!==!1,me=R.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=R.ALLOW_SELF_CLOSE_IN_ATTR!==!1,fe=R.SAFE_FOR_TEMPLATES||!1,de=R.SAFE_FOR_XML!==!1,ue=R.WHOLE_DOCUMENT||!1,Qe=R.RETURN_DOM||!1,Tt=R.RETURN_DOM_FRAGMENT||!1,et=R.RETURN_TRUSTED_TYPE||!1,Yt=R.FORCE_BODY||!1,Ye=R.SANITIZE_DOM!==!1,kt=R.SANITIZE_NAMED_PROPS||!1,Cr=R.KEEP_CONTENT!==!1,fa=R.IN_PLACE||!1,Ce=R.ALLOWED_URI_REGEXP||II,De=R.NAMESPACE||Jr,oo=R.MATHML_TEXT_INTEGRATION_POINTS||oo,ji=R.HTML_INTEGRATION_POINTS||ji,pe=R.CUSTOM_ELEMENT_HANDLING||{},R.CUSTOM_ELEMENT_HANDLING&&xl(R.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(pe.tagNameCheck=R.CUSTOM_ELEMENT_HANDLING.tagNameCheck),R.CUSTOM_ELEMENT_HANDLING&&xl(R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(pe.attributeNameCheck=R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),R.CUSTOM_ELEMENT_HANDLING&&typeof R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(pe.allowCustomizedBuiltInElements=R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),fe&&(le=!1),Tt&&(Qe=!0),pa&&(Me=Xe({},vS),Le=[],pa.html===!0&&(Xe(Me,gS),Xe(Le,yS)),pa.svg===!0&&(Xe(Me,Rg),Xe(Le,Pg),Xe(Le,pf)),pa.svgFilters===!0&&(Xe(Me,Ug),Xe(Le,Pg),Xe(Le,pf)),pa.mathMl===!0&&(Xe(Me,Lg),Xe(Le,bS),Xe(Le,pf))),R.ADD_TAGS&&(Me===Ue&&(Me=wa(Me)),Xe(Me,R.ADD_TAGS,Zt)),R.ADD_ATTR&&(Le===ot&&(Le=wa(Le)),Xe(Le,R.ADD_ATTR,Zt)),R.ADD_URI_SAFE_ATTR&&Xe(ns,R.ADD_URI_SAFE_ATTR,Zt),R.FORBID_CONTENTS&&(Xr===so&&(Xr=wa(Xr)),Xe(Xr,R.FORBID_CONTENTS,Zt)),Cr&&(Me["#text"]=!0),ue&&Xe(Me,["html","head","body"]),Me.table&&(Xe(Me,["tbody"]),delete lt.tbody),R.TRUSTED_TYPES_POLICY){if(typeof R.TRUSTED_TYPES_POLICY.createHTML!="function")throw Tc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof R.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Tc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=R.TRUSTED_TYPES_POLICY,w=S.createHTML("")}else S===void 0&&(S=C7(f,i)),S!==null&&typeof w=="string"&&(w=S.createHTML(""));vr&&vr(R),Ai=R}},Ol=Xe({},[...Rg,...Ug,...d7]),Ju=Xe({},[...Lg,...h7]),as=function(R){let te=E(R);(!te||!te.tagName)&&(te={namespaceURI:De,tagName:"template"});const _e=Wf(R.tagName),dt=Wf(te.tagName);return rs[R.namespaceURI]?R.namespaceURI===Mr?te.namespaceURI===Jr?_e==="svg":te.namespaceURI===cn?_e==="svg"&&(dt==="annotation-xml"||oo[dt]):!!Ol[_e]:R.namespaceURI===cn?te.namespaceURI===Jr?_e==="math":te.namespaceURI===Mr?_e==="math"&&ji[dt]:!!Ju[_e]:R.namespaceURI===Jr?te.namespaceURI===Mr&&!ji[dt]||te.namespaceURI===cn&&!oo[dt]?!1:!Ju[_e]&&(Ml[_e]||!Ol[_e]):!!(wi==="application/xhtml+xml"&&rs[R.namespaceURI]):!1},or=function(R){Cc(n.removed,{element:R});try{E(R).removeChild(R)}catch{C(R)}},Qi=function(R,te){try{Cc(n.removed,{attribute:te.getAttributeNode(R),from:te})}catch{Cc(n.removed,{attribute:null,from:te})}if(te.removeAttribute(R),R==="is")if(Qe||Tt)try{or(te)}catch{}else try{te.setAttribute(R,"")}catch{}},ss=function(R){let te=null,_e=null;if(Yt)R="<remove></remove>"+R;else{const Vt=_S(R,/^[\r\n\t ]+/);_e=Vt&&Vt[0]}wi==="application/xhtml+xml"&&De===Jr&&(R='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+R+"</body></html>");const dt=S?S.createHTML(R):R;if(De===Jr)try{te=new h().parseFromString(dt,wi)}catch{}if(!te||!te.documentElement){te=A.createDocument(De,"template",null);try{te.documentElement.innerHTML=Tn?w:dt}catch{}}const Xt=te.body||te.documentElement;return R&&_e&&Xt.insertBefore(t.createTextNode(_e),Xt.childNodes[0]||null),De===Jr?M.call(te,ue?"html":"body")[0]:ue?te.documentElement:Xt},ma=function(R){return D.call(R.ownerDocument||R,R,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},wn=function(R){return R instanceof d&&(typeof R.nodeName!="string"||typeof R.textContent!="string"||typeof R.removeChild!="function"||!(R.attributes instanceof c)||typeof R.removeAttribute!="function"||typeof R.setAttribute!="function"||typeof R.namespaceURI!="string"||typeof R.insertBefore!="function"||typeof R.hasChildNodes!="function")},os=function(R){return typeof o=="function"&&R instanceof o};function xr(Ee,R,te){ff(Ee,_e=>{_e.call(n,R,te,Ai)})}const uo=function(R){let te=null;if(xr(U.beforeSanitizeElements,R,null),wn(R))return or(R),!0;const _e=Zt(R.nodeName);if(xr(U.uponSanitizeElement,R,{tagName:_e,allowedTags:Me}),de&&R.hasChildNodes()&&!os(R.firstElementChild)&&ur(/<[/\w!]/g,R.innerHTML)&&ur(/<[/\w!]/g,R.textContent)||R.nodeType===Ac.progressingInstruction||de&&R.nodeType===Ac.comment&&ur(/<[/\w]/g,R.data))return or(R),!0;if(!Me[_e]||lt[_e]){if(!lt[_e]&&_a(_e)&&(pe.tagNameCheck instanceof RegExp&&ur(pe.tagNameCheck,_e)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(_e)))return!1;if(Cr&&!Xr[_e]){const dt=E(R)||R.parentNode,Xt=v(R)||R.childNodes;if(Xt&&dt){const Vt=Xt.length;for(let mn=Vt-1;mn>=0;--mn){const _n=y(Xt[mn],!0);_n.__removalCount=(R.__removalCount||0)+1,dt.insertBefore(_n,b(R))}}}return or(R),!0}return R instanceof l&&!as(R)||(_e==="noscript"||_e==="noembed"||_e==="noframes")&&ur(/<\/no(script|embed|frames)/i,R.innerHTML)?(or(R),!0):(fe&&R.nodeType===Ac.text&&(te=R.textContent,ff([$,J,ee],dt=>{te=Sc(te,dt," ")}),R.textContent!==te&&(Cc(n.removed,{element:R.cloneNode()}),R.textContent=te)),xr(U.afterSanitizeElements,R,null),!1)},ls=function(R,te,_e){if(Ye&&(te==="id"||te==="name")&&(_e in t||_e in Ni))return!1;if(!(le&&!an[te]&&ur(ve,te))){if(!(oe&&ur(Q,te))){if(!Le[te]||an[te]){if(!(_a(R)&&(pe.tagNameCheck instanceof RegExp&&ur(pe.tagNameCheck,R)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(R))&&(pe.attributeNameCheck instanceof RegExp&&ur(pe.attributeNameCheck,te)||pe.attributeNameCheck instanceof Function&&pe.attributeNameCheck(te))||te==="is"&&pe.allowCustomizedBuiltInElements&&(pe.tagNameCheck instanceof RegExp&&ur(pe.tagNameCheck,_e)||pe.tagNameCheck instanceof Function&&pe.tagNameCheck(_e))))return!1}else if(!ns[te]){if(!ur(Ce,Sc(_e,X,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&R!=="script"&&o7(_e,"data:")===0&&Xu[R])){if(!(me&&!ur(Z,Sc(_e,X,"")))){if(_e)return!1}}}}}}return!0},_a=function(R){return R!=="annotation-xml"&&_S(R,se)},co=function(R){xr(U.beforeSanitizeAttributes,R,null);const{attributes:te}=R;if(!te||wn(R))return;const _e={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Le,forceKeepAttr:void 0};let dt=te.length;for(;dt--;){const Xt=te[dt],{name:Vt,namespaceURI:mn,value:_n}=Xt,ei=Zt(Vt),Ii=_n;let Jt=Vt==="value"?Ii:l7(Ii);if(_e.attrName=ei,_e.attrValue=Jt,_e.keepAttr=!0,_e.forceKeepAttr=void 0,xr(U.uponSanitizeAttribute,R,_e),Jt=_e.attrValue,kt&&(ei==="id"||ei==="name")&&(Qi(Vt,R),Jt=zn+Jt),de&&ur(/((--!?|])>)|<\/(style|title)/i,Jt)){Qi(Vt,R);continue}if(_e.forceKeepAttr)continue;if(!_e.keepAttr){Qi(Vt,R);continue}if(!ke&&ur(/\/>/i,Jt)){Qi(Vt,R);continue}fe&&ff([$,J,ee],gn=>{Jt=Sc(Jt,gn," ")});const ga=Zt(R.nodeName);if(!ls(ga,ei,Jt)){Qi(Vt,R);continue}if(S&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!mn)switch(f.getAttributeType(ga,ei)){case"TrustedHTML":{Jt=S.createHTML(Jt);break}case"TrustedScriptURL":{Jt=S.createScriptURL(Jt);break}}if(Jt!==Ii)try{mn?R.setAttributeNS(mn,Vt,Jt):R.setAttribute(Vt,Jt),wn(R)?or(R):mS(n.removed)}catch{Qi(Vt,R)}}xr(U.afterSanitizeAttributes,R,null)},Hn=function Ee(R){let te=null;const _e=ma(R);for(xr(U.beforeSanitizeShadowDOM,R,null);te=_e.nextNode();)xr(U.uponSanitizeShadowNode,te,null),uo(te),co(te),te.content instanceof a&&Ee(te.content);xr(U.afterSanitizeShadowDOM,R,null)};return n.sanitize=function(Ee){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te=null,_e=null,dt=null,Xt=null;if(Tn=!Ee,Tn&&(Ee="<!-->"),typeof Ee!="string"&&!os(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw Tc("dirty is not a string, aborting")}else throw Tc("toString is not a function");if(!n.isSupported)return Ee;if($e||lo(R),n.removed=[],typeof Ee=="string"&&(fa=!1),fa){if(Ee.nodeName){const _n=Zt(Ee.nodeName);if(!Me[_n]||lt[_n])throw Tc("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof o)te=ss("<!---->"),_e=te.ownerDocument.importNode(Ee,!0),_e.nodeType===Ac.element&&_e.nodeName==="BODY"||_e.nodeName==="HTML"?te=_e:te.appendChild(_e);else{if(!Qe&&!fe&&!ue&&Ee.indexOf("<")===-1)return S&&et?S.createHTML(Ee):Ee;if(te=ss(Ee),!te)return Qe?null:et?w:""}te&&Yt&&or(te.firstChild);const Vt=ma(fa?Ee:te);for(;dt=Vt.nextNode();)uo(dt),co(dt),dt.content instanceof a&&Hn(dt.content);if(fa)return Ee;if(Qe){if(Tt)for(Xt=O.call(te.ownerDocument);te.firstChild;)Xt.appendChild(te.firstChild);else Xt=te;return(Le.shadowroot||Le.shadowrootmode)&&(Xt=F.call(r,Xt,!0)),Xt}let mn=ue?te.outerHTML:te.innerHTML;return ue&&Me["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&ur(MI,te.ownerDocument.doctype.name)&&(mn="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+mn),fe&&ff([$,J,ee],_n=>{mn=Sc(mn,_n," ")}),S&&et?S.createHTML(mn):mn},n.setConfig=function(){let Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lo(Ee),$e=!0},n.clearConfig=function(){Ai=null,$e=!1},n.isValidAttribute=function(Ee,R,te){Ai||lo({});const _e=Zt(Ee),dt=Zt(R);return ls(_e,dt,te)},n.addHook=function(Ee,R){typeof R=="function"&&Cc(U[Ee],R)},n.removeHook=function(Ee,R){if(R!==void 0){const te=a7(U[Ee],R);return te===-1?void 0:s7(U[Ee],te,1)[0]}return mS(U[Ee])},n.removeHooks=function(Ee){U[Ee]=[]},n.removeAllHooks=function(){U=CS()},n}var OI=xI();function S7(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var T7=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,w7=S7(function(e){return T7.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91});const ts=(e,n)=>{const t=p.createContext(null),r=()=>{const i=p.useContext(t);if(!i)throw new Error(`use${e}Context must be used within a ${e}Provider`);return i};return t.displayName=`${e}Context`,r.displayName=`use${e}Context`,[t,r]};function Zy(e){const n=p.createContext({Template:e.template,updateTemplate:()=>{},components:e.components,updateComponent:()=>{}});function t({children:a}){const[s,o]=p.useState(()=>e.template),[l,u]=p.useState(e.components),c={Template:s,updateTemplate:d=>o(()=>d),components:l,updateComponent:(d,h)=>u(f=>({...f,[d]:h}))};return p.createElement(n.Provider,{value:c},a)}function r({template:a,children:s}){const{updateTemplate:o}=p.useContext(n);return p.useEffect(()=>{a&&o(a)},[a]),p.createElement(p.Fragment,null,s)}function i({children:a}){return p.createElement(t,null,a)}return i.defaults=e,i.useContext=()=>p.useContext(n),i.Context=n,i.Template=r,Object.keys(e.components).forEach(a=>{i[a]=function({component:s}){const{updateComponent:o}=p.useContext(n);return p.useEffect(()=>{s&&o(a,s)},[s]),null}}),i}function A7(...e){return function({children:n}){return e.reduce((t,r)=>p.createElement(r,null,t),n)}}function SS(){}function N7(){const e=/iPad|iPhone|iPod/.test(navigator.userAgent),n=/Android/.test(navigator.userAgent);return e||n}function I7(e){return JSON.parse(e)}class M7{constructor(n){this.logger=n,this.subscribers={}}async send(n){const t=x7(),r=this.subscribers[n.type];if(r){this.logger.debug(`messenger.dispatcher: dispatching command: ${n.type}`,n.payload);const i=r.map(a=>a(n.payload));await Promise.all(i).catch(a=>{this.logger.error(`messenger.dispatcher: error in callback for command: ${n.type}`,a)})}return t.resolve(),t.promise}subscribe(n,t){this.subscribers[n]||(this.subscribers[n]=[]),this.subscribers[n].push(t)}unsubscribe(n,t){this.subscribers[n]&&(this.subscribers[n]=this.subscribers[n].filter(r=>r!==t))}}const x7=()=>{let e=SS,n=SS;return{promise:new Promise((t,r)=>{e=t,n=r}),resolve:e,reject:n}},O7="1.0.0",Nc="sb-agent",D7=O7;var DI=(e=>(e[e.VERBOSE=0]="VERBOSE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.NONE=5]="NONE",e))(DI||{});class kI{constructor(n){this.level=n}verbose(...n){this.level<=0&&console.log(`[${Nc}/verbose]`,...n)}debug(...n){this.level<=1&&console.log(`[${Nc}/debug]`,...n)}info(...n){this.level<=2&&console.log(`[${Nc}/info]`,...n)}warn(...n){this.level<=3&&console.warn(`[${Nc}/warn]`,...n)}error(...n){this.level<=4&&console.error(`[${Nc}/error]`,...n)}}function TS(e,n,t){const r=OL.init({appId:e,modules:[new HF,new W6],localCacheEnabled:!0,...t});return r.addSendbirdExtensions([{version:D7,product:zv.AI_AGENT,platform:n.platform}],{platform:n.deviceOSPlatform,version:n.deviceOSVersion},n.customData)||console.warn("Invalid Sendbird Extensions",n),r}const[k7,R7]=ts("AIAgent");function U7({appId:e,aiAgentId:n,language:t,countryCode:r,context:i,chatSDK:a,chatParams:s,dispatcher:o,logger:l,children:u,extensions:c={platform:$d.JS,deviceOSPlatform:N7()?Ms.MOBILE_WEB:Ms.WEB}}){const[d,h]=p.useState(()=>{const f=l??new kI(DI.WARN),m=o??new M7(f);return{appId:e,aiAgentId:n,language:t,countryCode:r,context:i,chatSDK:a??TS(e,c,s),logger:f,dispatcher:m}});return(t!==d.language||r!==d.countryCode)&&h(f=>({...f,language:t,countryCode:r,context:i})),a&&a!==d.chatSDK?h(f=>({...f,aiAgentId:n,chatSDK:a})):!a&&d.chatSDK.appId!==e&&h(f=>({...f,aiAgentId:n,chatSDK:TS(e,c,{newInstance:!0,...s})})),p.useEffect(()=>()=>{d.chatSDK.disconnectWebSocket()},[d.chatSDK]),p.createElement(k7.Provider,{value:d},typeof u=="function"?u(d):u)}const L7=e=>({setTemplate:(n,t)=>e.onSetTemplate(n,t),getTemplate:n=>e.onGetTemplate(n),setCachedToken:n=>e.onSetCachedToken(n),getCachedToken:()=>e.onGetCachedToken(),clear:()=>e.onClear()}),[P7,RI]=ts("MessageCacheTemplate");function F7({logger:e,storage:n,children:t}){const r=p.useCallback(s=>{var o,l;const u=(l=(o=s.appInfo)==null?void 0:o.aiAgentInfo)==null?void 0:l.templateListToken;if(!u)return!1;const c=n.getCachedToken();return c?u!==c:!0},[n]),i=p.useCallback(async s=>{try{const{templates:o,token:l}=await s.aiAgent.getMessageTemplates({limit:20});for(const{template:u}of o){const{key:c}=I7(u);n.setTemplate(c,u)}n.setCachedToken(l)}catch(o){e?.error("messageTemplateContext.syncCachedTemplates: error:",o)}},[n,e]),a=p.useCallback(()=>{n.clear()},[n]);return p.createElement(P7.Provider,{value:{shouldSyncCachedTemplate:r,syncCachedTemplates:i,clearCachedTemplates:a,storage:n}},t)}const $7=(e,n,t)=>JF(e,n,t),z7=(e,n)=>{const t=()=>{const f=e.aiAgent.createConversationListQuery(n);return f.next().then(m=>{d(m)}).catch(m=>{m instanceof k&&o(m)}).finally(()=>{a(!0)}),f},r=p.useRef(!1),[i,a]=p.useState(!1),[s,o]=p.useState(null),[l,u]=p.useState(()=>t()),[c,d]=p.useState([]),h=p.useCallback(()=>{l.next().then(f=>{d(m=>[...m,...f])}).catch(()=>{})},[l]);return p.useEffect(()=>{r.current?u(t()):r.current=!0},[e,n.status,n.aiAgentId,n.limit]),{initialized:i,error:s,conversations:c,loadMore:h}};var E0=(e=>(e.ConversationClose="conv.close",e))(E0||{});class H7{constructor(n={}){this.payload=n}toJSON(){return JSON.stringify({type:this.type,payload:this.payload})}}class q7 extends H7{constructor(){super(...arguments),this.type="conv.close"}}const B7={CloseConversation:()=>new q7},qa="sb-agent",eo={ENTRY:`${qa}-entry`,MODAL_ROOT:`${qa}-modal-root`,WINDOW:`${qa}-window`,LAUNCHER:`${qa}-launcher`},mf=2147483647,Al={MODAL:mf-1,TOOLTIP:mf-2,WINDOW:mf-3,LAUNCHER:mf-4},G7={SESSION:`@${qa}-session`},fl={DEFAULT_PRIMARY:"#742ddd",DEFAULT_BOT_MSG_BG:"#eeeeee",WHITE:"#ffffff",BLACK:"#000000"},UI=36,V7=100,j7=25*1024*1024,LI=["application/pdf","image/jpeg","image/jpg","image/png"],Xy="noopener noreferrer nofollow";function PI(e){return e.length===4?`#${[...e.slice(1)].map(n=>n+n).join("")}`:e}function Q7(e){const n=PI(e);return[parseInt(n.slice(1,3),16),parseInt(n.slice(3,5),16),parseInt(n.slice(5,7),16)]}function K7(e){return`#${e.map(n=>n.toString(16).padStart(2,"0")).join("")}`}function W7(e,n,t){e/=255,n/=255,t/=255;const r=Math.max(e,n,t),i=Math.min(e,n,t),a=r-i;let s=0,o=0;const l=(r+i)/2;return r!==i&&(o=l>.5?a/(2-r-i):a/(r+i)),r===e?s=(n-t)/a+(n<t?6:0):r===n?s=(t-e)/a+2:r===t&&(s=(e-n)/a+4),s/=6,[s,o,l]}function Y7(e,n,t){let r,i,a;if(n===0)r=i=a=t;else{const s=function(u,c,d){return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?u+(c-u)*6*d:d<.5?c:d<.6666666666666666?u+(c-u)*(.6666666666666666-d)*6:u},o=t<.5?t*(1+n):t+n-t*n,l=2*t-o;r=s(l,o,e+1/3),i=s(l,o,e),a=s(l,o,e-1/3)}return[Math.round(r*255),Math.round(i*255),Math.round(a*255)]}function _f(e,n,t){const[r,i,a]=Q7(e),[s,o,l]=W7(r,i,a),u=Math.max(0,Math.min(1,l*n)),c=Math.max(0,Math.min(1,o*t)),[d,h,f]=Y7(s,c,u);return K7([Math.round(d),Math.round(h),Math.round(f)])}function Z7(e,n="light"){return e===fl.DEFAULT_PRIMARY?{extraDark:"#491389",dark:"#6211c8",main:"#742ddd",light:"#c2a9fa",extraLight:"#dbd1ff"}:{extraDark:_f(e,.6,1.2),dark:_f(e,.85,1.1),main:e,light:_f(e,n==="dark"?1.1:1.5,n==="dark"?.95:.9),extraLight:_f(e,n==="dark"?1.2:1.75,n==="dark"?.9:.8)}}function im(e){const n=PI(e),t=149,r=+`0x${n[1]}${n[2]}`,i=+`0x${n[3]}${n[4]}`,a=+`0x${n[5]}${n[6]}`;return r*.299+i*.587+a*.114>t?fl.BLACK:fl.WHITE}const Yd="data-sb-agent-theme",wS=e=>(n,...t)=>{let r="";return n.forEach((i,a)=>{r+=i+(t[a]??"")}),`[${Yd}='${e}'] & { ${r} }`},br={light:wS("light"),dark:wS("dark")},X7=at`:root,:host{--sendbird-primary-extra-dark:${e=>e.theme.palette.primary.extraDark};--sendbird-primary-dark:${e=>e.theme.palette.primary.dark};--sendbird-primary-main:${e=>e.theme.palette.primary.main};--sendbird-primary-light:${e=>e.theme.palette.primary.light};--sendbird-primary-extra-light:${e=>e.theme.palette.primary.extraLight};--sendbird-secondary-extra-dark:#066858;--sendbird-secondary-dark:#027d69;--sendbird-secondary-main:#259c72;--sendbird-secondary-light:#69c085;--sendbird-secondary-extra-light:#a8e2ab;--sendbird-information-extra-dark:#241389;--sendbird-information-dark:#362ca9;--sendbird-information-main:#4a48cd;--sendbird-information-light:#a9bbfa;--sendbird-information-extra-light:#d1dbff;--sendbird-highlight-100:#fff2b6;--sendbird-error-extra-dark:#9d091e;--sendbird-error-dark:#bf0711;--sendbird-error-main:#de360b;--sendbird-error-light:#f66161;--sendbird-error-extra-light:#fdaaaa;--sendbird-background-700:#000000;--sendbird-background-600:#161616;--sendbird-background-500:#2c2c2c;--sendbird-background-400:#393939;--sendbird-background-300:#bdbdbd;--sendbird-background-200:#e0e0e0;--sendbird-background-100:#eeeeee;--sendbird-background-50:#ffffff;--sendbird-onlight-01:rgba(0,0,0,0.88);--sendbird-onlight-02:rgba(0,0,0,0.5);--sendbird-onlight-03:rgba(0,0,0,0.38);--sendbird-onlight-04:rgba(0,0,0,0.12);--sendbird-ondark-01:rgba(255,255,255,0.88);--sendbird-ondark-02:rgba(255,255,255,0.5);--sendbird-ondark-03:rgba(255,255,255,0.38);--sendbird-ondark-04:rgba(255,255,255,0.12);--sendbird-overlay-01:rgba(0,0,0,0.55);--sendbird-overlay-02:rgba(0,0,0,0.32);--sendbird-shadow-01:0 1px 5px 0 rgba(33,34,66,0.04),0 0 3px 0 rgba(0,0,0,0.08),0 2px 1px 0 rgba(0,0,0,0.12);--sendbird-shadow-02:0 3px 5px -3px rgba(33,34,66,0.04),0 3px 14px 2px rgba(0,0,0,0.08),0 8px 10px 1px rgba(0,0,0,0.12);--sendbird-shadow-03:0 6px 10px -5px rgba(0,0,0,0.04),0 6px 30px 5px rgba(0,0,0,0.08),0 16px 24px 2px rgba(0,0,0,0.12);--sendbird-shadow-04:0 9px 15px -7px rgba(0,0,0,0.04),0 9px 46px 8px rgba(0,0,0,0.08),0 24px 38px 3px rgba(0,0,0,0.12);--sendbird-shadow-05:0 2px 8px 0 rgba(0,0,0,0.08),0 4px 6px 0 rgba(0,0,0,0.12);--sendbird-shadow-message-input:0 1px 5px 0 rgba(33,34,66,0.12),0 0 1px 0 rgba(33,34,66,0.16),0 2px 1px 0 rgba(33,34,66,0.08),0 1px 5px 0 rgba(0,0,0,0.12);}`,J7=at`[${Yd}='light'] &{--sb-on-bg-1:var(--sendbird-onlight-01);--sb-on-bg-2:var(--sendbird-onlight-02);--sb-on-bg-3:var(--sendbird-onlight-03);--sb-on-bg-4:var(--sendbird-onlight-04);--sb-bg-1:var(--sendbird-background-50);--sb-bg-2:var(--sendbird-background-100);--sb-bg-3:var(--sendbird-background-200);--sb-on-content-1:var(--sendbird-ondark-01);--sb-on-content-2:var(--sendbird-ondark-02);--sb-on-content-inverse-1:var(--sendbird-onlight-01);--sb-on-content-inverse-2:var(--sendbird-onlight-02);--sb-primary:var(--sendbird-primary-main);--sb-secondary:var(--sendbird-secondary-main);--sb-error:var(--sendbird-error-main);--sb-information:var(--sendbird-information-light);}[${Yd}='dark'] &{--sb-on-bg-1:var(--sendbird-ondark-01);--sb-on-bg-2:var(--sendbird-ondark-02);--sb-on-bg-3:var(--sendbird-ondark-03);--sb-on-bg-4:var(--sendbird-ondark-04);--sb-bg-1:var(--sendbird-background-600);--sb-bg-2:var(--sendbird-background-500);--sb-bg-3:var(--sendbird-background-400);--sb-on-content-1:var(--sendbird-onlight-01);--sb-on-content-2:var(--sendbird-onlight-02);--sb-on-content-inverse-1:var(--sendbird-ondark-01);--sb-on-content-inverse-2:var(--sendbird-ondark-02);--sb-primary:var(--sendbird-primary-light);--sb-secondary:var(--sendbird-secondary-light);--sb-error:var(--sendbird-error-light);--sb-information:var(--sendbird-information-light);}`,V={color:{primary:{dark:"var(--sendbird-primary-dark)",main:"var(--sendbird-primary-main)"},error:{extraDark:"var(--sendbird-error-extra-dark)",dark:"var(--sendbird-error-dark)"},information:{main:"var(--sendbird-information-main)",light:"var(--sendbird-information-light)"},background700:"var(--sendbird-background-700)",background600:"var(--sendbird-background-600)",background500:"var(--sendbird-background-500)",background400:"var(--sendbird-background-400)",background200:"var(--sendbird-background-200)",background100:"var(--sendbird-background-100)",background50:"var(--sendbird-background-50)",onlight03:"var(--sendbird-onlight-03)",ondark01:"var(--sendbird-ondark-01)",ondark02:"var(--sendbird-ondark-02)",ondark03:"var(--sendbird-ondark-03)",ondark04:"var(--sendbird-ondark-04)",overlay01:"var(--sendbird-overlay-01)",shadow05:"var(--sendbird-shadow-05)"},themedColor:{onbackground1:"var(--sb-on-bg-1)",onbackground2:"var(--sb-on-bg-2)",onbackground3:"var(--sb-on-bg-3)",onbackground4:"var(--sb-on-bg-4)",textHighEmphasis:"var(--sb-on-bg-1)",textMidEmphasis:"var(--sb-on-bg-2)",textLowEmphasis:"var(--sb-on-bg-3)",textDisabled:"var(--sb-on-bg-4)",background1:"var(--sb-bg-1)",background2:"var(--sb-bg-2)",background3:"var(--sb-bg-3)",oncontent1:"var(--sb-on-content-1)",oncontent_inverse1:"var(--sb-on-content-inverse-1)",error:"var(--sb-error)"}};function AS(e="light",n){const t={primary:n?.primary||fl.DEFAULT_PRIMARY,botMessageBackground:n?.botMessageBackground||fl.DEFAULT_BOT_MSG_BG,primaryContrast:n?.primaryContrast,botMessageBackgroundContrast:n?.botMessageBackgroundContrast},{contrastColors:r,aiAgentColorVariables:i}=n$(t),a=(e==="light"?e$:t$)(t,r);return{selected:e,palette:{primary:Z7(t.primary)},colors:a,aiAgentColorVariables:i}}const e$=(e,n)=>({base:{primary:e.primary,primaryContrastContent:n.primary,background:V.color.background50,headerBackground:V.color.background50,modalContentBackground:V.color.background50},metadata:{errorContent:V.color.ondark01,placeholderText:V.color.onlight03},messageInput:{background:V.color.background100},messageIncoming:{text:n.botMessageBackground,background:e.botMessageBackground},messageOutgoing:{text:n.primary,background:e.primary},csat:{background:V.color.background100}}),t$=(e,n)=>({base:{primary:e.primary,primaryContrastContent:n.primary,background:V.color.background600,headerBackground:V.color.background500,modalContentBackground:V.color.background500},metadata:{errorContent:V.color.ondark01,placeholderText:V.color.ondark03},messageInput:{background:V.color.background400},messageIncoming:{text:n.botMessageBackground,background:e.botMessageBackground},messageOutgoing:{text:n.primary,background:e.primary},csat:{background:V.color.background400}});function n$(e){const n={primary:e.primaryContrast??im(e.primary),botMessageBackground:e.botMessageBackgroundContrast??im(e.botMessageBackground)};return{contrastColors:n,aiAgentColorVariables:{primary_color:e.primary,bot_message_bg_color:e.botMessageBackground,primary_contrast_color:n.primary,bot_message_bg_contrast_color:n.botMessageBackground}}}const[r$,Bm]=ts("AgentTheme");function i$({appearance:e,rootElement:n=document.body,logger:t,children:r}){const i=e?.theme,a=e?.primaryColor,s=e?.botMessageBackgroundColor,[o,l]=p.useState(()=>(n.setAttribute(Yd,i??"light"),AS(i,{primary:a,botMessageBackground:s}))),u=p.useCallback((c,d)=>{const h=d?.(i),f=i??c,m={primary:a??h?.primary,botMessageBackground:s??h?.botMessageBackground,primaryContrast:h?.primaryContrast,botMessageBackgroundContrast:h?.botMessageBackgroundContrast};a&&delete m.primaryContrast,s&&delete m.botMessageBackgroundContrast,n.setAttribute(Yd,f),l(AS(f,m)),t?.info("theme.update:",f,m)},[n,i,a,s]);return p.useEffect(()=>{(i||a||s)&&u(o.selected)},[i,a,s]),p.createElement(D5,{theme:o},p.createElement(r$.Provider,{value:{theme:o,updateTheme:u}},r))}const ph="en",a$=new Set([ph,"ko","es","pt","fr","hi","it","de","tr","ja"]),s$=(e,n,t)=>{const r=e[n];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+n+(n.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})},o$=nI,l$={CHANNEL_FROZEN:"Channel frozen",PLACE_HOLDER__WRONG:"Something went wrong",PLACE_HOLDER__NO_MESSAGES:"No messages",UNKNOWN__UNKNOWN_MESSAGE_TYPE:"(Unknown message type)",HEADER_BUTTON__AGENT_HANDOFF:"Connect with an agent",MESSAGE_INPUT__PLACE_HOLDER:"Ask a question",MESSAGE_INPUT__PLACE_HOLDER__WAIT_AI_AGENT_RESPONSE:"Waiting for the agents reply",MESSAGE_INPUT__PLACE_HOLDER__DISABLED:"Chat is unavailable in this channel",BUTTON__CANCEL:"Cancel",BUTTON__SAVE:"Save",BUTTON__OK:"OK",NO_NAME:"(No name)",RETRY:"Retry",DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR:"MMMM dd, yyyy",DATE_FORMAT__MESSAGE_TIMESTAMP:"p",FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT:"You can't upload more than one image",FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT:"The maximum size per file is %d MB.",FILE_VIEWER__UNSUPPORT:"Unsupported message",CSAT_TITLE_UNSUBMITTED:"Your feedback matters to us",CSAT_TITLE_SUBMITTED:"Successfully submitted!",CSAT_CRE_TITLE:"Was your issue resolved?",CSAT_CRE_SOLVED:"Yes, thank you! ",CSAT_CRE_NOT_SOLVED:"No, that didnt help.",CSAT_REASON_PLACEHOLDER:"Share your feedback",CSAT_RATING_TITLE:"How would you rate your experience?",CSAT5_RATING_SCORE_1:"Terrible",CSAT5_RATING_SCORE_2:"Bad",CSAT5_RATING_SCORE_3:"Okay",CSAT5_RATING_SCORE_4:"Good",CSAT5_RATING_SCORE_5:"Great",CSAT_SUBMIT_LABEL:"Submit",CSAT_SUBMISSION_EXPIRED:"Were sorry, the survey period has ended.",POWERED_BY:"Powered by",CONVERSATION_CLOSED_FOOTER_LABEL:"Your conversation has ended",START_NEW_CONVERSATION:" Start a new conversation",RETURN_TO_CONVERSATION:" Return to conversation",CONVERSATION_LIST__HEADER_TITLE:"Conversation history",CONVERSATION_LIST__TOPICS_FALLBACK:"No category",CONVERSATION_LIST__NO_CONVERSATIONS:"No conversations yet",DATE_FORMAT__CONVERSATION_LIST__LIST_ITEM_TITLE:"MM/dd/yyyy",DATE_FORMAT__CONVERSATION_LIST__LIST_ITEM_TITLE_CAPTION:"h:mma"},Jy={language:"en",dateLocale:o$,stringSet:l$},u$=Object.freeze(Object.defineProperty({__proto__:null,default:Jy},Symbol.toStringTag,{value:"Module"})),Yf=new Map([[ph,Jy]]);async function c$(e){if(Yf.has(e))return Yf.get(e);const n=a$.has(e)?e:ph;try{const{default:t}=await s$(Object.assign({"./languages/de.ts":()=>Ie(()=>import("./DvjrAXLD-B5dU6QX5.js"),[]),"./languages/en.ts":()=>Promise.resolve().then(()=>u$),"./languages/es.ts":()=>Ie(()=>import("./zI14HLvP-BkpVOREp.js"),[]),"./languages/fr.ts":()=>Ie(()=>import("./B9V0T5ZP-fEANaJ9d.js"),[]),"./languages/hi.ts":()=>Ie(()=>import("./YRQ0vk5Q-D9doFbXR.js"),[]),"./languages/it.ts":()=>Ie(()=>import("./BQWJPfGp-BN-uC8VF.js"),[]),"./languages/ja.ts":()=>Ie(()=>import("./sl-YrKkN-Dhv8ZbnA.js"),[]),"./languages/ko.ts":()=>Ie(()=>import("./B8c_rqvH-DXNG1zm2.js"),[]),"./languages/pt.ts":()=>Ie(()=>import("./BSz49qaD-BwXhM9p2.js"),[]),"./languages/tr.ts":()=>Ie(()=>import("./D_eZyIAR-D8Jo2mI1.js"),[])}),`./languages/${n}.ts`,3);return Yf.set(e,t),t}catch{return Jy}}const[d$,Gt]=ts("Localization");function h$(e){var n;return((n=e.split("-"))==null?void 0:n[0])??ph}function f$({language:e=navigator.language,logger:n,stringSet:t,children:r}){const[i,a]=p.useState(Yf.get(ph));return p.useEffect(()=>{const s=h$(e);i.language!==s&&(n?.debug("localization.useEffect: update language",`${i.language} -> ${s}`),c$(s).then(a))},[e]),p.createElement(d$.Provider,{value:{language:i.language,stringSet:{...i.stringSet,...t},dateLocale:i.dateLocale,format:(s,o,l)=>Xp(s,o,{locale:i.dateLocale,...l})}},r)}const p$='@import"https://fonts.googleapis.com/css?family=Roboto:400,500,600,700&display=swap";.sb-message-template__border{position:relative}.sb-message-template__border:after{content:"";position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;box-shadow:inset 0 0 0 var(--border-width) var(--border-color);border-radius:var(--border-radius);pointer-events:none}.sb-message-template__action{cursor:pointer}.sb-message-template__parent{font-family:Roboto,serif}.sb-message-template__text{font-family:inherit;font-size:14px;font-weight:400;font-stretch:normal;font-style:normal;letter-spacing:normal;text-align:left}.sb-message-template__text-button{font-family:inherit;background-color:#e0e0e0;text-align:center;padding:10px;border-radius:6px;font-size:14px;font-weight:600;font-stretch:normal;font-style:normal;letter-spacing:normal}.sendbird-theme--light .sb-message-template__text-button{color:#742ddd}.sendbird-theme--dark .sb-message-template__text-button{color:#c2a9fa}.sb-message-template__text-button:hover{opacity:1;box-shadow:#0000001a 0 1px 3px,#0000000f 0 1px 2px}.sb-message-template__text-button,.sb-message-template__image-button{cursor:pointer;border-style:none}.sb-message-template__parent{border-radius:unset;background-color:transparent;overflow:hidden}.sb-message-template__parent *{box-sizing:border-box;line-height:1.3}.sb-message-template__carousel{display:flex;width:100%;box-sizing:border-box;touch-action:pan-y}';function pl(e,n){const t=e.getRootNode({composed:n});return t instanceof ShadowRoot||t instanceof Document?t:document}const m$=(e,n)=>{p.useEffect(()=>{const t=pl(n)instanceof ShadowRoot,r=pl(n,!0);if(!(t?n:r).querySelector(`link[href*='${e}']`)){const i=r.createElement("link");i.rel="stylesheet",i.href=e,(t?n:r.head).appendChild(i)}},[e,n])},_$=(e,n=document.body)=>{p.useEffect(()=>{const t=pl(n),r=t instanceof ShadowRoot?n:t.head;if(!r)return;const i=`sba-${btoa(e).slice(0,10)}`;let a=r.querySelector(`style#${i}`);a?a.textContent!==e&&(a.textContent=e):(a=r.ownerDocument.createElement("style"),a.id=i,a.textContent=e,r.appendChild(a))},[e,n])},[g$,FI]=ts("MessageTemplateFetching");function v$({children:e,rootElement:n,internalVariables:t}){_$(p$,n);const r=p.useRef({}),i=p.useRef({}),[a,s]=p.useState({}),o=p.useCallback((u,c)=>{s(d=>({...d,[u]:{fetching:!1,error:!1,...d[u],...c}}))},[]),l=p.useCallback(async({onRequestTemplate:u,onGetCachedTemplate:c,templateKey:d,suspense:h=!1})=>{const f=c(d);if(f)return f;const m=i.current[d];if(m)return m;h||o(d,{fetching:!0});const y=u(d).catch(C=>{throw h||o(d,{error:!0}),C}).finally(()=>{h||o(d,{fetching:!1}),delete i.current[d]});return i.current[d]=y,y},[o]);return p.createElement(g$.Provider,{value:{internalVariables:t,fetchTemplate:l,suspend:(u,c)=>{if(r.current[u])return r.current[u];const d=y$(c());return r.current[u]=d,d},getIsFetching:u=>{var c;return((c=a[u])==null?void 0:c.fetching)??!1},getHasError:u=>{var c;return((c=a[u])==null?void 0:c.error)??!1}}},e)}function y$(e){let n="pending",t=e.then(r=>{n="resolved",t=r}).catch(r=>{n="rejected",t=r});return{get value(){if(n==="resolved")return t;throw t}}}const b$=at`#${eo.ENTRY}{*:not(code *){font-family:'Roboto',sans-serif;box-sizing:border-box;}}`,E$=[b$,X7,J7],C$=(e,...n)=>U5(e,...E$,...n),mh=244,$I=640,Zd=26,zI=4,ca=12,Gm=2,S$=16,ao=`${qa}-incoming-msg`,T$=`${qa}-marked-text`;function eb(e){switch(e){case"top":case"middle":return Gm;default:return S$}}function tb(e,n){if(n){const[,t]=n.split("/");if(t)return t.toUpperCase()}if(e&&!e.startsWith(".")){const t=e.split(".").pop();if(t&&t!==e)return t.toUpperCase()}return"FILE"}const ml=e=>{const n=e;return typeof n=="number"?`${n}px`:n},w$=new Set(["send","chat","message","chevron-right"]),A$={spinner:p.lazy(()=>Ie(()=>import("./BcUGcaq2-BwRLgYxP.js"),[])),chat:p.lazy(()=>Ie(()=>import("./DcFCGVBm-CN6vcxHE.js"),[])),message:p.lazy(()=>Ie(()=>import("./DsGXnanX-D6zq7I5C.js"),[])),error:p.lazy(()=>Ie(()=>import("./B6fvrWGq-B5iyn3bW.js"),[])),info:p.lazy(()=>Ie(()=>import("./CAIYsKDy-bjg6V70o.js"),[])),refresh:p.lazy(()=>Ie(()=>import("./B6xd54zt-Db-G4iOa.js"),[])),"chevron-down":p.lazy(()=>Ie(()=>import("./BsimU71m-CutTjs_j.js"),[])),"chevron-right":p.lazy(()=>Ie(()=>import("./NmJl7zv3-Botwvgz_.js"),[])),done:p.lazy(()=>Ie(()=>import("./D_q6g3Dd-CWJpwaON.js"),[])),user:p.lazy(()=>Ie(()=>import("./CvqfQEhO-Ka5pc3w2.js"),[])),"file-document":p.lazy(()=>Ie(()=>import("./BAr50pfO-PRpglX6l.js"),[])),download:p.lazy(()=>Ie(()=>import("./B2CtcWp3-MnknuUe-.js"),[])),attach:p.lazy(()=>Ie(()=>import("./DY2ULcTX-n1n1tQ5v.js"),[])),delete:p.lazy(()=>Ie(()=>import("./DMruRpOm-CU9j41B4.js"),[])),close:p.lazy(()=>Ie(()=>import("./CuaBI7kd-BEtcgOtv.js"),[])),"close-filled":p.lazy(()=>Ie(()=>import("./CxQFWLnW-2plkLLA8.js"),[])),send:p.lazy(()=>Ie(()=>import("./DZJyDpNp-CE5DhcGp.js"),[])),menu:p.lazy(()=>Ie(()=>import("./BUYabNz7--NyfVkWg.js"),[])),expand:p.lazy(()=>Ie(()=>import("./wBtIAuNm-DLTOTBbY.js"),[])),collapse:p.lazy(()=>Ie(()=>import("./C0RFfifL-3SC7Ax3s.js"),[])),agent:p.lazy(()=>Ie(()=>import("./Cc7XmLN1-CcPAg5tq.js"),[])),question:p.lazy(()=>Ie(()=>import("./dqwvRBog-BjH8cWNA.js"),[])),actionbook:p.lazy(()=>Ie(()=>import("./CrjNuryZ-BtWuPHK5.js"),[])),function:p.lazy(()=>Ie(()=>import("./CvdSjw1c-DtX4is54.js"),[])),"radio-on":p.lazy(()=>Ie(()=>import("./nmdo2Fbj-D586YWCM.js"),[])),"radio-off":p.lazy(()=>Ie(()=>import("./BnZcRFmS-GimzWHux.js"),[])),confluence:p.lazy(()=>Ie(()=>import("./BOnlh2zd-DWO8nuUM.js"),[])),zendesk:p.lazy(()=>Ie(()=>import("./BAJ6LEKc-Din04L0B.js"),[])),salesforce:p.lazy(()=>Ie(()=>import("./CT2kv4lr-eP2vcmi-.js"),[])),sprinklr:p.lazy(()=>Ie(()=>import("./m2INcyV2-CNrEP2Sy.js"),[])),website:p.lazy(()=>Ie(()=>import("./BgGVGNdg-Y42aLgl7.js"),[])),snippet:p.lazy(()=>Ie(()=>import("./BFcXPuf5-CHUl9pGw.js"),[])),template:p.lazy(()=>Ie(()=>import("./awO7aBCv-A-ibKpTm.js"),[]))},Nt=({type:e,size:n=24,className:t,color:r})=>{const i=A$[e];return p.createElement(I$,{className:t,$rtlFlip:w$.has(e),$size:n,$color:r??V.color.primary.main},p.createElement(p.Suspense,{fallback:null},p.createElement(i,null)))},N$=at`[dir='rtl'] &{transform:scaleX(-1);}`,I$=q.div`width:${({$size:e})=>ml(e)};height:${({$size:e})=>ml(e)};display:inline-block;&:focus{outline:none;}svg{display:block;}[class*='fill']{fill:${({$color:e})=>e};}[class*='stroke']{stroke:${({$color:e})=>e};stroke-width:2px;stroke-linejoin:round;}${({$rtlFlip:e})=>e&&N$};`,We=({as:e,variant:n,color:t,className:r,...i})=>p.createElement(x$,{as:e,$variant:n,className:r,$color:t,...i}),NS={h1:{fs:"18px",fw:700},h2:{fs:"16px",fw:700},subtitle1:{fs:"16px",fw:500},subtitle2:{fs:"16px",fw:400},body1:{fs:"16px",fw:400},body2:{fs:"14px",fw:500},body3:{fs:"14px",fw:400},button:{fs:"14px",fw:700},caption1:{fs:"12px",fw:700},caption2:{fs:"12px",fw:400},caption3:{fs:"11px",fw:700},caption4:{fs:"11px",fw:400}},Fg=new Map;function M$(e){if(!e||!NS[e])return"";if(Fg.has(e))return Fg.get(e);const{fs:n,fw:t}=NS[e],r=at`font-size:${n};font-weight:${t};`;return Fg.set(e,r),r}const x$=q.span`font-stretch:normal;font-style:normal;letter-spacing:normal;line-height:100%;${({$variant:e})=>M$(e)}color:${({$color:e})=>e};`;function nb({name:e,type:n="FILE",iconColor:t,iconBackgroundColor:r}){const{colors:i}=Wy();return p.createElement(O$,null,p.createElement(D$,{$bgColor:r??i.base.primary},p.createElement(Nt,{type:"file-document",size:24,color:t??i.base.primaryContrastContent})),p.createElement(k$,null,p.createElement(R$,{variant:"button",color:V.themedColor.onbackground1},e),p.createElement(We,{color:V.themedColor.onbackground2,variant:"caption3"},n)))}const O$=q.div`border-radius:12px;gap:8px;width:${mh}px;height:64px;display:flex;align-items:center;padding:12px;box-sizing:border-box;border:1px solid ${V.themedColor.onbackground4};background-color:${V.themedColor.background1};`,D$=q.div`border-radius:8px;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background-color:${({$bgColor:e})=>e};`,k$=q.div`display:flex;flex:1;flex-direction:column;gap:4px;min-width:0;`,R$=q(We)`text-overflow:ellipsis;white-space:nowrap;overflow:hidden;`;function U$({file:e}){return p.createElement(nb,{name:e.name,type:tb(e.name,e.type)})}function L$({file:e,onClickMedia:n}){const t=()=>e.type.startsWith("image")?p.createElement(F$,{src:e.url,alt:"image-message"}):e.type.startsWith("video")?p.createElement($$,{controls:!0},p.createElement("source",{src:e.url}),p.createElement("track",{kind:"captions"})):null;return t?p.createElement(P$,{id:`${ao}-media-body`,onClick:()=>n?.(e)},t()):null}const P$=q.div`width:${mh}px;height:160px;border-radius:12px;overflow:hidden;background-color:${({theme:e})=>e.colors.messageIncoming.background};cursor:pointer;`,F$=q.img`width:100%;height:100%;object-fit:cover;`,$$=q.video`width:100%;height:100%;object-fit:cover;`,z$="";function HI(e){const n=new RegExp(`${z$}+`,"g");return e.replace(n,t=>`<span id=${T$} aria-label="marked-text">${t}</span>`)}function H$(e){const n=/```(\w+)?\n([\s\S]*?)```/g,t=[];let r=0;return e.replace(n,(i,...a)=>{const[s,o,l]=a;return r<l&&t.push({type:"text",value:e.slice(r,l).trim()}),t.push({type:"code",value:o.trim(),language:s?s.trim():"plaintext"}),r=l+i.length,i}),r<e.length&&t.push({type:"text",value:e.slice(r).trim()}),t.map(i=>i.type!=="text"?i:{...i,value:HI(i.value)})}const q$=p.lazy(async()=>({default:(await Ie(async()=>{const{MarkdownText:e}=await import("./DiXu6nm5-DDy-zu28.js");return{MarkdownText:e}},[])).MarkdownText})),B$=p.lazy(async()=>({default:(await Ie(async()=>{const{CodeBlock:e}=await import("./DH2PekOm-ihhr9u7B.js");return{CodeBlock:e}},[])).CodeBlock}));function IS(e){const n=e.maxBodyWidth??mh,t=p.useMemo(()=>H$(e.message),[e.message]),r={id:`${ao}-text-body`,$maxWidth:n};return t.length===0?e.children?p.createElement(MS,{...r},e.children):null:p.createElement(MS,{...r},t.map((i,a)=>i.type==="text"?p.createElement(xS,{key:a,variant:"body3"},p.createElement(p.Suspense,{fallback:i.value},p.createElement(q$,null,i.value))):i.type==="code"?p.createElement(p.Suspense,{key:a,fallback:p.createElement(xS,{variant:"body3"},i.value)},p.createElement(B$,{code:i.value,language:i.language})):null),e.children)}const MS=q.div`display:flex;flex-direction:column;border-radius:12px;overflow:hidden;max-width:${({$maxWidth:e})=>e}px;${({theme:e})=>at`
    color: ${e.colors.messageIncoming.text};
    background-color: ${e.colors.messageIncoming.background};
  `}
  padding: 12px 0;
  transition: max-width 0.3s;
  overflow-wrap: break-word;
`,xS=q(We)`align-items:flex-start;line-height:18px;white-space:pre-wrap;padding:0 12px;`;function G$(e){const{stringSet:n}=Gt();if(e.messageType==="user")return p.createElement(IS,{...e});if(e.messageType==="file"){const t=e.file;return t.type.startsWith("image")||t.type.startsWith("video")?p.createElement(L$,{...e}):p.createElement(U$,{...e})}return p.createElement(IS,{...e,message:n.UNKNOWN__UNKNOWN_MESSAGE_TYPE})}const rb=e=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0008 0.973633C10.6172 0.973633 9.49558 2.09527 9.49558 3.47888C9.49558 4.50705 10.115 5.39055 11.0009 5.77664V7.47887H13.0009V5.77653C13.8868 5.3904 14.5061 4.50696 14.5061 3.47888C14.5061 2.09527 13.3844 0.973633 12.0008 0.973633ZM0.250977 16.5788L0.250977 10.5789H2.25098L2.25098 16.5788H0.250977ZM21.7511 10.5789V16.5788H23.7511V10.5789H21.7511ZM18.251 7.47888H3.25097V18.9789C3.25097 20.3596 4.37026 21.4789 5.75097 21.4789H18.251C19.6317 21.4789 20.751 20.3596 20.751 18.9789V9.97887C20.751 8.59816 19.6317 7.47888 18.251 7.47888ZM9.78434 11.9539V15.2038C9.78434 15.7561 9.33663 16.2038 8.78434 16.2038C8.23206 16.2038 7.78434 15.7561 7.78434 15.2038V11.9539C7.78434 11.4016 8.23206 10.9539 8.78434 10.9539C9.33663 10.9539 9.78434 11.4016 9.78434 11.9539ZM16.2677 11.9539V15.2038C16.2677 15.7561 15.82 16.2038 15.2677 16.2038C14.7154 16.2038 14.2677 15.7561 14.2677 15.2038V11.9539C14.2677 11.4016 14.7154 10.9539 15.2677 10.9539C15.82 10.9539 16.2677 11.4016 16.2677 11.9539Z",fill:"#0D0D0D"}));function ib({id:e,src:n,size:t=56,onClick:r,style:i}){return p.createElement(V$,{id:e,tabIndex:0,onClick:r,$size:ml(t),style:i},n?p.createElement(j$,{src:n}):p.createElement(Nt,{type:"user",size:t}))}const V$=q.div`border-radius:50%;display:inline-block;overflow:hidden;position:relative;flex-shrink:0;height:${e=>e.$size};width:${e=>e.$size};background-color:${V.themedColor.background2};&:focus{outline:none;}`,j$=q.img`object-fit:cover;width:100%;height:100%;position:absolute;`;function Q$({sender:e,isBotMessage:n}){const t=`${ao}-sender-avatar`;return!e.profileUrl&&n?p.createElement(K$,{id:t},p.createElement(rb,null)):p.createElement(ib,{id:t,size:Zd,src:e.profileUrl})}const K$=q.div`flex-shrink:0;width:${Zd}px;height:${Zd}px;box-sizing:border-box;padding:6px;border-radius:50%;display:flex;justify-content:center;align-items:center;background-color:${({theme:e})=>e.colors.base.primary};path{fill:${({theme:e})=>e.colors.base.primaryContrastContent};}}`;function W$({sender:e}){return p.createElement(Y$,{id:`${ao}-sender-name`,variant:"caption1",color:V.themedColor.textMidEmphasis},e.nickname)}const Y$=q(We)`text-align:start;width:100%;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-block:5px;padding-inline:0 7px;`;function Z$({createdAt:e}){const{stringSet:n,format:t}=Gt();return p.createElement(We,{id:`${ao}-sent-time`,variant:"caption4",color:V.themedColor.textLowEmphasis},t(e,n.DATE_FORMAT__MESSAGE_TIMESTAMP))}function am(){}async function X$(e){let n=e;n&&(!n.startsWith("http://")&&!n.startsWith("https://")&&(n="https://"+n),window.open(n,"_blank","noopener,noreferrer"))}function OS(e){try{return JSON.parse(e===""?"{}":e)}catch{return{}}}function qI(e){return!e||!e.conversation?!1:e.conversation.status===Ar.CLOSED}function ab(e){return!e||!e.conversation?!1:e.conversation.status===Ar.OPEN}function J$(e){var n;const t=(n=e?.conversation)==null?void 0:n.handoff,r=!!(t!=null&&t.timestamp);return ab(e)&&!r}function ez({extendedMessagePayload:e,onClickCTA:n=({url:t})=>X$(t)}){const t=e?.cta_button;return t?p.createElement(tz,{id:`${ao}-ext-cta-button`,role:"button",onClick:()=>n(t)},p.createElement(nz,{variant:"button"},t.label)):null}const tz=q.div`display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:6px;padding:8px;background-color:${V.color.primary.main};color:${({theme:e})=>e.colors.base.primaryContrastContent};&:hover{background-color:${V.color.primary.dark};}`,nz=q(We)`overflow:hidden;text-overflow:ellipsis;white-space:nowrap;`;function rz(e){return p.createElement(p.Fragment,null)}const BI=e=>{try{const n=JSON.parse(e);return typeof n=="string"?JSON.stringify(n).slice(1,-1):e.trim()}catch{return JSON.stringify(e).slice(1,-1)}},Vm=e=>JSON.parse(e),jm=e=>JSON.parse(e);function iz(e,n){const[t,r]=n.split(",").map(i=>i.trim());return e==="dark"&&r||t}function az(e){const n={};function t(r,i=""){for(const[a,s]of Object.entries(r)){const o=i?`${i}.${a}`:a;s&&typeof s=="object"&&!Array.isArray(s)?t(s,o):n[o]=s}}return t(e),n}function sb({template:e,variables:n,variableKeyPattern:t,variableValueTransformer:r}){return Object.entries(n).reduce((i,[a,s])=>{if(!r&&!["number","boolean","string"].includes(typeof s))throw new Error("If transformer is not provided, value must be a {string, number, or boolean}");const o=r?r(s):String(s),l=t(a);return i.replace(l,BI(o))},e)}async function sz({template:e,variables:n,variableKeyPattern:t,variableValueTransformer:r}){return(await Promise.all(Object.entries(n).map(async([i,a])=>{const s=await r(a);return{regex:t(i),transformedValue:s}}))).reduce((i,{regex:a,transformedValue:s})=>i.replace(a,BI(s)),e)}const Qm={VARIABLE:e=>new RegExp(`\\{${e}\\}`,"g"),VIEW_VARIABLE:e=>new RegExp(`"{@${e}}"`,"g")};function to({uiTemplateString:e,variables:n={}}){const t=az(n);return sb({template:e,variables:t,variableKeyPattern:r=>Qm.VARIABLE(r)})}function no({theme:e,uiTemplateString:n,colorVariables:t={}}){return sb({template:n,variables:t,variableKeyPattern:r=>Qm.VARIABLE(r),variableValueTransformer:r=>iz(e,r)})}function oz({theme:e,uiTemplateString:n,viewVariables:t={},aiAgentColorVariables:r,internalVariables:i,onRequestTemplate:a}){const s=Object.values(t).flat().map(o=>o.key);return[...new Set(s)].some(o=>!a(o))?null:sb({template:n,variables:t,variableKeyPattern:o=>Qm.VIEW_VARIABLE(o),variableValueTransformer:o=>{const l=o.map(({key:u,variables:c})=>{const d=a(u),{ui_template:h,color_variables:f}=Vm(d);let m=JSON.stringify(h);return m=to({uiTemplateString:m,variables:i}),m=no({theme:e,uiTemplateString:m,colorVariables:f}),m=no({theme:e,uiTemplateString:m,colorVariables:r}),m=to({uiTemplateString:m,variables:c}),jm(m)});return JSON.stringify(l)}})}async function lz({theme:e,uiTemplateString:n,viewVariables:t={},aiAgentColorVariables:r,internalVariables:i,onRequestTemplate:a}){return sz({template:n,variables:t,variableKeyPattern:s=>Qm.VIEW_VARIABLE(s),variableValueTransformer:async s=>{const o=s.map(async({key:u,variables:c})=>{const d=await a(u),{ui_template:h,color_variables:f}=Vm(d);let m=JSON.stringify(h);return m=to({uiTemplateString:m,variables:i}),m=no({theme:e,uiTemplateString:m,colorVariables:f}),m=no({theme:e,uiTemplateString:m,colorVariables:r}),m=to({uiTemplateString:m,variables:c}),jm(m)}),l=await Promise.all(o);return JSON.stringify(l)}})}const uz=({rawTemplate:e,aiAgentColorVariables:n,internalVariables:t,...r})=>{const{ui_template:i,color_variables:a}=Vm(e);let s=JSON.stringify(i);if(Object.keys(r.viewVariables??{}).length>0){const o=oz({...r,uiTemplateString:s,aiAgentColorVariables:n,internalVariables:t});if(o===null)return null;s=o}return s=to({...r,uiTemplateString:s,variables:t}),s=no({...r,uiTemplateString:s,colorVariables:a}),s=no({...r,uiTemplateString:s,colorVariables:n}),s=to({...r,uiTemplateString:s}),jm(s)},cz=async({rawTemplate:e,aiAgentColorVariables:n,internalVariables:t,...r})=>{const{ui_template:i,color_variables:a}=Vm(e);let s=JSON.stringify(i);return Object.keys(r.viewVariables??{}).length>0&&(s=await lz({...r,uiTemplateString:s,aiAgentColorVariables:n,internalVariables:t})),s=to({...r,uiTemplateString:s,variables:t}),s=no({...r,uiTemplateString:s,colorVariables:a}),s=no({...r,uiTemplateString:s,colorVariables:n}),s=to({...r,uiTemplateString:s}),jm(s)},dz=e=>{const{aiAgentColorVariables:n}=Bm().theme,{internalVariables:t}=FI();return p.useState(()=>{const r=e.onGetCachedTemplate(e.templateKey);return r?uz({...e,rawTemplate:r,aiAgentColorVariables:n,internalVariables:t,onRequestTemplate:e.onGetCachedTemplate}):null})},hz=e=>{const[n]=dz(e);if(n)return n;const{aiAgentColorVariables:t}=Bm().theme,{internalVariables:r,fetchTemplate:i,suspend:a}=FI();return a(e.templateKey,async()=>{const s=await i({...e,suspense:!0});return await cz({...e,rawTemplate:s,aiAgentColorVariables:t,internalVariables:r})}).value};class fz extends p.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?this.props.errorFallback:p.createElement(p.Suspense,{fallback:this.props.loadingFallback},this.props.children)}}const pz=new Set(["default"]),{MessageTemplate:mz}=hI({parser:fI,renderer:gI,Container:e=>p.createElement("div",{...e})});function _z(e){return p.createElement(fz,{errorFallback:e.messageTemplateErrorFallback,loadingFallback:e.messageTemplateLoadingFallback},p.createElement(gz,{...e}))}const gz=({extendedMessagePayload:e,onGetCachedMessageTemplate:n=()=>null,onRequestMessageTemplate:t})=>{const r=e?.message_template;if(!pz.has(r?.type??"default"))throw new Error("Unsupported template type");if(!t)throw new Error("onRequestMessageTemplate is required");const{theme:i}=Bm(),a=hz({onRequestTemplate:t,onGetCachedTemplate:n,theme:i.selected,templateKey:r?.key??"invalid",variables:r?.variables,viewVariables:r?.view_variables});return p.createElement(vz,{id:`${ao}-ext-message-template`},p.createElement(RP,{message:{}},p.createElement(mz,{templateItems:a.body.items,templateVersion:a.version})))},vz=q.div`box-sizing:border-box;overflow:hidden;width:100%;`;function yz({extendedMessagePayload:e,onClickSuggestedReply:n,suggestedRepliesDirection:t="vertical"}){const[r,i]=p.useState(!1),a=e?.suggested_replies??[];return a.length===0||r?null:p.createElement(bz,{id:`${ao}-ext-suggested-replies`,$type:t},a.map((s,o)=>p.createElement(Ez,{key:o,$type:t,variant:"body3",onClick:()=>{n&&(n?.({reply:s}),i(!0))}},s)))}const bz=q.div`margin:16px 0;padding:0 ${ca}px;position:relative;display:flex;gap:8px;${({$type:e})=>e==="vertical"?Cz:Sz};`,Ez=q(We)`box-sizing:border-box;padding:8px 12px;display:flex;align-items:center;border-radius:100px;cursor:pointer;word-break:break-word;color:${V.color.primary.main};border:1px solid ${V.color.primary.main};background-color:${V.themedColor.background1};&:hover{background-color:${V.themedColor.background2};}${({$type:e,theme:n})=>at`
    ${e==="vertical"?Tz:wz};
    &:active {
      background-color: ${n.colors.base.primary};
      color: ${n.colors.base.primaryContrastContent};
    }
  `}
`,Cz=at`flex-direction:column;align-items:flex-end;`,Sz=at`flex-direction:row;overflow-x:scroll;-ms-overflow-style:none;scrollbar-width:none;&::-webkit-scrollbar{display:none;}`,Tz=at`max-width:calc(100% - 70px);white-space:pre-wrap;`,wz=at`white-space:nowrap;`,GI=({className:e})=>p.createElement(Az,{className:e},[0,1,2].map(n=>p.createElement(Nz,{key:n}))),Az=q.div`align-items:center;border-radius:12px;display:flex;gap:6px;justify-content:center;padding:16px 12px;background-color:${({theme:e})=>e.colors.messageIncoming.background};`,Nz=q.span`animation:blink 1.4s infinite;animation-fill-mode:both;border-radius:50%;height:8px;width:8px;background:${({theme:e})=>e.colors.messageIncoming.text};@keyframes blink{0%{opacity:0.12;transform:scale(1);}21.43%{opacity:0.38;transform:scale(1.2);}42.86%{opacity:0.12;transform:scale(1);}100%{opacity:0.12;transform:scale(1);}}&:nth-child(1){animation-delay:0.4s;}&:nth-child(2){animation-delay:0.6s;}&:nth-child(3){animation-delay:0.8s;}`;function VI(e){return e()}const _l=Zy({template:Iz,components:{SenderName:W$,SenderAvatar:Q$,SentTime:Z$,MessageBody:G$,SuggestedReplies:yz,MessageTemplate:_z,CTAButton:ez,MessageLogs:rz}});function Iz(e){return p.createElement(jI,{...e,testerMode:!1})}function jI(e){var n,t,r,i;const{components:a}=_l.useContext(),s=e.testerMode,o=!!((n=e.extendedMessagePayload)!=null&&n.message_template),l=!!((t=e.extendedMessagePayload)!=null&&t.cta_button),u=VI(()=>e.messageType==="user"?e.message.length>0:!0),c=e.groupType==="top"||e.groupType==="single",d=e.groupType==="bottom"||e.groupType==="single",h=s?0:Zd;return p.createElement(Mz,{$marginBottom:eb(e.groupType)},c&&p.createElement(xz,null,!s&&p.createElement(a.SenderAvatar,{...e}),p.createElement(a.SenderName,{...e})),p.createElement(p.Fragment,null,p.createElement($g,{$extraStartPadding:h},p.createElement(a.MessageBody,{...e},l&&p.createElement("div",{style:{marginTop:12,marginInline:12}},p.createElement(a.CTAButton,{...e})))),o&&p.createElement(DS,{$startPadding:0,$endPadding:0,style:{marginTop:u?Gm:0}},p.createElement(a.MessageTemplate,{...e,messageTemplateErrorFallback:e.messageTemplateErrorFallback??p.createElement($g,{$extraStartPadding:h},p.createElement(a.MessageBody,{...e,messageType:"user",message:((i=(r=e.extendedMessagePayload)==null?void 0:r.message_template)==null?void 0:i.fallback_message)??"Cannot read this template."})),messageTemplateLoadingFallback:e.messageTemplateLoadingFallback??p.createElement($g,{$extraStartPadding:h},p.createElement(GI,null))}))),d&&p.createElement(Oz,{$extraStartPadding:h+8},p.createElement(a.SentTime,{...e})),p.createElement(p.Fragment,null,e.suggestedRepliesVisible&&p.createElement(DS,null,p.createElement(a.SuggestedReplies,{...e})),p.createElement(a.MessageLogs,{...e})))}const Mz=q.div`display:flex;flex-direction:column;align-items:flex-start;margin-bottom:${({$marginBottom:e})=>`${e}px`};
`,Km=q.div`display:flex;align-self:stretch;justify-content:flex-start;${({$startPadding:e=ca,$endPadding:n=ca,$extraStartPadding:t=0})=>`
    padding-inline: ${e+t}px ${n}px;
  `}
`,xz=q(Km)`display:flex;flex-direction:row;align-items:center;gap:8px;`,$g=q(Km)`display:flex;`,Oz=q(Km)`margin-top:${zI}px;display:flex;align-items:flex-start;justify-content:flex-start;`,DS=q(Km)`display:flex;flex-direction:column;${({$startPadding:e=ca,$endPadding:n=ca,$extraStartPadding:t=0})=>`
    padding-inline: ${e+t}px ${n}px;
  `}
`;function Dz({file:e,children:n}){return p.createElement(kz,null,p.createElement(nb,{name:e.name,type:tb(e.name,e.type)}),n)}const kz=q.div`display:flex;flex-direction:column;align-items:flex-end;gap:${Gm}px;`,QI=({className:e,children:n,size:t=26})=>p.createElement(Rz,{className:e,$size:t},n??p.createElement(Nt,{type:"spinner",size:t})),Rz=q.div`display:flex;align-items:center;justify-content:center;width:${({$size:e})=>ml(e)};height:${({$size:e})=>ml(e)};animation:1s infinite linear;animation-name:rotate;@keyframes rotate{from{transform:rotate(0);}to{transform:rotate(360deg);}}`;function Uz({file:e,metadata:n,onClickMedia:t,children:r}){const{aspectRatio:i,localFile:a}=n,[s]=p.useState(()=>a instanceof File?URL.createObjectURL(a):e.url),[o,l]=p.useState(!1);return p.createElement(Lz,null,p.createElement(Pz,{$ratio:i,onClick:()=>t?.(e)},!o&&p.createElement(QI,{size:26},p.createElement(Nt,{type:"spinner",color:"onbackground3",size:26})),p.createElement(Fz,{$loaded:o,src:s,alt:"image-message",onLoad:()=>l(!0)})),r)}const Lz=q.div`display:flex;flex-direction:column;align-items:flex-end;gap:${Gm}px;`,Pz=q.div`width:${mh}px;border-radius:12px;overflow:hidden;cursor:pointer;height:auto;aspect-ratio:${e=>e.$ratio};position:relative;display:flex;align-items:center;justify-content:center;${br.light`
    background-color: ${V.color.background100};
  `}
  ${br.dark`
    background-color: ${V.color.background400};
  `}
`,Fz=q.img`position:absolute;width:100%;height:100%;inset-block-start:0;inset-inline-start:0;object-fit:cover;opacity:${e=>e.$loaded?1:0};transition:opacity 0.5s ease;`;function kS(e){const n=p.useMemo(()=>OI.sanitize(HI(e.message)),[e.message]);return p.createElement($z,{$maxWidth:e.maxBodyWidth??mh},p.createElement(zz,{variant:"body3",dangerouslySetInnerHTML:{__html:n}}))}const $z=q.div`display:flex;flex-direction:column;border-radius:12px;overflow:hidden;max-width:${({$maxWidth:e})=>e}px;${({theme:e})=>at`
    color: ${e.colors.messageOutgoing.text};
    background-color: ${e.colors.messageOutgoing.background};
  `}
  padding: 12px 0;
  transition: max-width 0.3s;
  overflow-wrap: break-word;
`,zz=q(We)`align-items:flex-start;line-height:18px;white-space:pre-wrap;padding:0 12px;`;function Hz(e){const{stringSet:n}=Gt(),t=e.message.length>0?p.createElement(kS,{...e}):null;return e.messageType==="user"?t:e.messageType==="file"?e.file.type.startsWith("image")?p.createElement(Uz,{...e},t):p.createElement(Dz,{...e},t):p.createElement(kS,{...e,message:n.UNKNOWN__UNKNOWN_MESSAGE_TYPE})}function qz({sendingStatus:e}){const n=Wy();switch(e){case"pending":return p.createElement(Bz,{size:16},p.createElement(Nt,{type:"spinner",color:n.colors.messageOutgoing.background,size:16}));case"failed":return p.createElement("div",{style:{marginBottom:2}},p.createElement(Nt,{type:"error",color:V.themedColor.error,size:16}));case"scheduled":case"canceled":return null;default:return p.createElement("div",null,p.createElement(Nt,{type:"chevron-down"}))}}const Bz=q(QI)`margin-bottom:2px;width:16px;height:16px;`;function Gz({createdAt:e}){const{stringSet:n,format:t}=Gt();return p.createElement(We,{variant:"caption4",color:V.themedColor.textLowEmphasis},t(e,n.DATE_FORMAT__MESSAGE_TIMESTAMP))}const ob=Zy({template:Vz,components:{SendingStatus:qz,SentTime:Gz,MessageBody:Hz}});function Vz(e){const{components:n}=ob.useContext(),t=e.sendingStatus==="succeeded",r=e.groupType==="bottom"||e.groupType==="single";return p.createElement(jz,{$marginBottom:eb(e.groupType)},p.createElement(Qz,null,p.createElement(n.MessageBody,{...e})),r&&p.createElement(Kz,{$extraEndPadding:8},t?p.createElement(n.SentTime,{...e}):p.createElement(n.SendingStatus,{...e})))}const jz=q.div`display:flex;flex:1;flex-direction:column;align-items:flex-end;margin-bottom:${({$marginBottom:e})=>`${e}px`};
`,KI=q.div`display:flex;align-self:stretch;justify-content:flex-end;${({$startPadding:e=ca,$endPadding:n=ca,$extraEndPadding:t=0})=>`padding-inline: ${e}px ${n+t}px;`};
`,Qz=q(KI)``,Kz=q(KI)`margin-top:${zI}px;`;function Wz(e){return e.messageType!=="admin"?null:p.createElement(Yz,null,p.createElement(We,{variant:"caption2",color:V.themedColor.textMidEmphasis},Zz(OI.sanitize(e.message))))}const Yz=q.div`text-align:center;text-wrap:pretty;a{text-decoration:none;color:inherit;}`,Zz=e=>{const n=/\[([^\]]+)\]\((https?:\/\/[^\s]+)\)/g,t=[];let r=0;return e.replace(n,(i,a,s,o)=>(t.push(e.slice(r,o)),t.push(p.createElement("a",{key:s,href:s,target:"_blank",rel:Xy},a)),r=o+i.length,i)),t.push(e.slice(r)),t},Xz=({submitted:e,defaultValue:n,value:t,onChange:r})=>{const{stringSet:i}=Gt();return p.useEffect(()=>{typeof t>"u"&&typeof n=="boolean"&&r?.(n)},[t,n]),p.createElement(Jz,null,p.createElement(We,{variant:"caption2",color:V.themedColor.textMidEmphasis},i.CSAT_CRE_TITLE),p.createElement("div",null,p.createElement(RS,{checked:t===!0,label:i.CSAT_CRE_SOLVED,disabled:e,onClick:()=>r?.(!0)}),p.createElement(RS,{checked:t===!1,label:i.CSAT_CRE_NOT_SOLVED,disabled:e,onClick:()=>r?.(!1)})))},RS=({onClick:e,checked:n,label:t,disabled:r})=>{const i=n?V.color.primary.main:r?V.themedColor.textDisabled:V.themedColor.textLowEmphasis,a=n?V.themedColor.textHighEmphasis:r?V.themedColor.textLowEmphasis:V.themedColor.textHighEmphasis;return p.createElement(e9,{onClick:e,disabled:r},p.createElement(Nt,{size:24,type:n?"radio-on":"radio-off",color:i}),p.createElement(We,{variant:"caption2",color:a},t))},Jz=q.div`display:flex;flex-direction:column;gap:8px;`,e9=q.button`all:unset;display:flex;align-items:center;justify-content:flex-start;gap:2px;span{line-height:initial;}&:enabled{cursor:pointer;}`,t9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",id:"csat1",...e},p.createElement("path",{d:"M2.08301 20C2.08301 10.1049 10.1046 2.08334 19.9997 2.08334C29.8948 2.08334 37.9163 10.1049 37.9163 20C37.9163 29.8952 29.8948 37.9167 19.9997 37.9167C10.1046 37.9167 2.08301 29.8952 2.08301 20Z",fill:"#E0E0E0"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5824 29.3328C13.1344 29.7473 13.918 29.636 14.3326 29.084C15.6269 27.3607 17.6835 26.25 19.9997 26.25C22.316 26.25 24.3727 27.3607 25.6668 29.084C26.0815 29.636 26.865 29.7473 27.4172 29.3328C27.9692 28.9182 28.0805 28.1347 27.6658 27.5825C25.9198 25.2577 23.1357 23.75 19.9997 23.75C16.8638 23.75 14.0797 25.2577 12.3336 27.5825C11.919 28.1347 12.0304 28.9182 12.5824 29.3328Z",fill:"black",fillOpacity:.12}),p.createElement("path",{d:"M28.4449 13.7707C29.1324 13.8328 29.64 14.4406 29.578 15.1281C29.516 15.8153 28.909 16.3221 28.2219 16.2608C28.2219 16.2608 28.0282 16.2502 27.9267 16.2487C27.7224 16.2457 27.4382 16.2509 27.1224 16.2833C26.7864 16.3177 26.4644 16.3782 26.1799 16.4662L26.304 16.86C26.7792 18.3675 25.5094 19.5813 24.2057 19.5813C23.504 19.5813 22.8319 19.2617 22.4295 18.6857C22.0025 18.0745 21.9417 17.241 22.4075 16.5344C22.7505 16.0143 23.2444 15.3831 23.8959 14.8657C24.8355 14.1195 26.0435 13.8809 26.867 13.7963C27.3024 13.7517 28.0149 13.7319 28.4449 13.7707Z",fill:"black",fillOpacity:.12}),p.createElement("path",{d:"M11.5553 13.7707C10.8677 13.8328 10.3601 14.4406 10.4221 15.1281C10.4842 15.8153 11.0912 16.3221 11.7782 16.2608C11.7782 16.2608 11.972 16.2502 12.0734 16.2487C12.2778 16.2457 12.562 16.2509 12.8778 16.2833C13.2137 16.3177 13.5357 16.3782 13.8203 16.4662L13.6962 16.86C13.2209 18.3675 14.4907 19.5813 15.7944 19.5813C16.4962 19.5813 17.1683 19.2617 17.5707 18.6857C17.9975 18.0745 18.0585 17.241 17.5925 16.5344C17.2497 16.0143 16.7557 15.3831 16.1043 14.8657C15.1646 14.1195 13.9566 13.8809 13.1331 13.7963C12.6978 13.7517 11.9853 13.7319 11.5553 13.7707Z",fill:"black",fillOpacity:.12})),n9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{d:"M2.08337 19.9999C2.08337 10.1048 10.1049 2.08325 20 2.08325C29.8952 2.08325 37.9167 10.1048 37.9167 19.9999C37.9167 29.8951 29.8952 37.9166 20 37.9166C10.1049 37.9166 2.08337 29.8951 2.08337 19.9999Z",fill:"url(#paint0_linear_159_173206)"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5828 29.3328C13.1348 29.7473 13.9184 29.636 14.3329 29.084C15.6272 27.3607 17.6839 26.25 20 26.25C22.3164 26.25 24.373 27.3607 25.6672 29.084C26.0819 29.636 26.8654 29.7473 27.4175 29.3328C27.9695 28.9182 28.0809 28.1347 27.6662 27.5825C25.9202 25.2577 23.136 23.75 20 23.75C16.8642 23.75 14.0801 25.2577 12.334 27.5825C11.9194 28.1347 12.0308 28.9182 12.5828 29.3328Z",fill:"#141B34"}),p.createElement("path",{d:"M28.4454 13.7707C29.1329 13.8328 29.6405 14.4406 29.5785 15.1281C29.5165 15.8153 28.9095 16.3221 28.2224 16.2608C28.2224 16.2608 28.0287 16.2502 27.9272 16.2487C27.7229 16.2457 27.4387 16.2509 27.1229 16.2833C26.7869 16.3177 26.4649 16.3782 26.1804 16.4662L26.3045 16.86C26.7797 18.3675 25.5099 19.5813 24.2062 19.5813C23.5045 19.5813 22.8324 19.2617 22.43 18.6857C22.003 18.0745 21.9422 17.241 22.408 16.5344C22.751 16.0143 23.2449 15.3831 23.8964 14.8657C24.836 14.1195 26.044 13.8809 26.8675 13.7963C27.3029 13.7517 28.0154 13.7319 28.4454 13.7707Z",fill:"#141B34"}),p.createElement("path",{d:"M11.5549 13.7707C10.8674 13.8328 10.3597 14.4406 10.4218 15.1281C10.4838 15.8153 11.0908 16.3221 11.7779 16.2608C11.7779 16.2608 11.9716 16.2502 12.073 16.2487C12.2774 16.2457 12.5616 16.2509 12.8774 16.2833C13.2134 16.3177 13.5353 16.3782 13.8199 16.4662L13.6958 16.86C13.2205 18.3675 14.4904 19.5813 15.794 19.5813C16.4958 19.5813 17.168 19.2617 17.5703 18.6857C17.9971 18.0745 18.0581 17.241 17.5921 16.5344C17.2493 16.0143 16.7553 15.3831 16.1039 14.8657C15.1643 14.1195 13.9562 13.8809 13.1327 13.7963C12.6974 13.7517 11.9849 13.7319 11.5549 13.7707Z",fill:"#141B34"}),p.createElement("defs",null,p.createElement("linearGradient",{id:"paint0_linear_159_173206",x1:20,y1:2.08325,x2:20,y2:37.9166,gradientUnits:"userSpaceOnUse"},p.createElement("stop",{stopColor:"#FF2D1D"}),p.createElement("stop",{offset:1,stopColor:"#FFA540"})))),r9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{d:"M19.9997 36.6667C29.2044 36.6667 36.6663 29.2048 36.6663 20C36.6663 10.7953 29.2044 3.33334 19.9997 3.33334C10.7949 3.33334 3.33301 10.7953 3.33301 20C3.33301 29.2048 10.7949 36.6667 19.9997 36.6667Z",fill:"#E0E0E0"}),p.createElement("path",{d:"M15 28.333C16.3927 27.2867 18.124 26.6667 20 26.6667C21.876 26.6667 23.6073 27.2867 25 28.333",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{d:"M11.667 13.3511C11.667 13.3511 14.0161 13.139 15.3268 14.18M15.3268 14.18L14.8882 15.5711C14.7153 16.1199 15.1675 16.6667 15.7943 16.6667C16.4531 16.6667 16.8882 16.0723 16.549 15.5579C16.2483 15.102 15.8388 14.5866 15.3268 14.18ZM23.3337 13.3511C23.3337 13.3511 25.6827 13.139 26.9935 14.18M26.9935 14.18L26.555 15.5711C26.382 16.1199 26.8342 16.6667 27.461 16.6667C28.1198 16.6667 28.5548 16.0723 28.2157 15.5579C27.915 15.102 27.5055 14.5866 26.9935 14.18Z",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),i9=e=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:40,height:40,viewBox:"0 0 40 40",fill:"none",...e},p.createElement("path",{d:"M2.083 20C2.083 10.105 10.105 2.083 20 2.083c9.895 0 17.917 8.021 17.917 17.917 0 9.895-8.022 17.917-17.917 17.917C10.105 37.917 2.083 29.895 2.083 20Z",fill:"#FFD46E"}),p.createElement("path",{d:"M14.249 27.334C15.851 26.13 17.844 25.417 20 25.417c2.156 0 4.149.714 5.751 1.917.553.415.664 1.199.25 1.751-.415.552-1.199.664-1.751.25-1.183-.889-2.652-1.416-4.25-1.416s-3.067.527-4.25 1.416c-.553.414-1.336.302-1.751-.25-.415-.552-.303-1.336.249-1.751Z",fill:"#141B34"}),p.createElement("path",{d:"M23.445 14.596c-.687.062-1.294-.445-1.356-1.132-.062-.687.445-1.295 1.132-1.357.082-.005.342-.02.482-.022.277-.004.662.002 1.097.047.823.085 2.031.323 2.97 1.07.652.518 1.146 1.15 1.489 1.67.466.706.405 1.54-.022 2.15-.402.576-1.074.896-1.775.896-1.304 0-2.573-1.214-2.098-2.722l.125-.394c-.285-.088-.607-.148-.942-.182-.316-.033-.6-.038-.804-.035-.101.002-.242.01-.294.013Z",fill:"#141B34"}),p.createElement("path",{d:"M11.779 14.596c-.687.062-1.294-.445-1.356-1.132-.062-.687.445-1.295 1.132-1.357.082-.005.342-.02.482-.022.277-.004.662.002 1.097.047.823.085 2.031.323 2.97 1.07.652.518 1.146 1.15 1.489 1.67.466.706.405 1.54-.022 2.15-.402.576-1.074.896-1.775.896-1.304 0-2.573-1.214-2.098-2.722l.124-.394c-.284-.088-.606-.148-.941-.182-.316-.033-.6-.038-.804-.035-.101.002-.243.01-.294.013Z",fill:"#141B34"})),a9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{d:"M19.9997 36.6667C29.2044 36.6667 36.6663 29.2048 36.6663 20C36.6663 10.7953 29.2044 3.33334 19.9997 3.33334C10.7949 3.33334 3.33301 10.7953 3.33301 20C3.33301 29.2048 10.7949 36.6667 19.9997 36.6667Z",fill:"#E0E0E0"}),p.createElement("path",{d:"M13.348 15H13.333M26.6663 15H26.6513",stroke:"black",strokeOpacity:.12,strokeWidth:3.33333,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{d:"M15 26.6667H25",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),s9=e=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:40,height:40,viewBox:"0 0 40 40",fill:"none",...e},p.createElement("path",{d:"M2.083 20C2.083 10.105 10.105 2.083 20 2.083c9.895 0 17.917 8.021 17.917 17.917 0 9.895-8.022 17.917-17.917 17.917C10.105 37.917 2.083 29.895 2.083 20Z",fill:"#FFD46E"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 15c0-1.151.933-2.083 2.083-2.083h.015c1.151 0 2.084.933 2.084 2.083 0 1.151-.933 2.083-2.084 2.083h-.015c-1.15 0-2.083-.933-2.083-2.083ZM24.568 15c0-1.151.933-2.083 2.084-2.083h.015c1.151 0 2.083.933 2.083 2.083 0 1.151-.932 2.083-2.083 2.083h-.015c-1.151 0-2.084-.933-2.084-2.083Z",fill:"#141B34"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.75 26.667c0-.691.56-1.25 1.25-1.25h10c.69 0 1.25.559 1.25 1.25 0 .691-.56 1.25-1.25 1.25h-10c-.69 0-1.25-.559-1.25-1.25Z",fill:"#141B34"})),o9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{d:"M19.9997 36.6667C29.2044 36.6667 36.6663 29.2048 36.6663 20C36.6663 10.7953 29.2044 3.33334 19.9997 3.33334C10.7949 3.33334 3.33301 10.7953 3.33301 20C3.33301 29.2048 10.7949 36.6667 19.9997 36.6667Z",fill:"#E0E0E0"}),p.createElement("path",{d:"M13.333 25C14.8532 27.024 17.2735 28.3333 19.9997 28.3333C22.7258 28.3333 25.1462 27.024 26.6663 25",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{d:"M13.348 15H13.333M26.6663 15H26.6513",stroke:"black",strokeOpacity:.12,strokeWidth:3.33333,strokeLinecap:"round",strokeLinejoin:"round"})),l9=e=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:40,height:40,viewBox:"0 0 40 40",fill:"none",...e},p.createElement("path",{d:"M2.083 20C2.083 10.105 10.105 2.083 20 2.083c9.895 0 17.917 8.021 17.917 17.917 0 9.895-8.022 17.917-17.917 17.917C10.105 37.917 2.083 29.895 2.083 20Z",fill:"#FFD46E"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.583 24.001c.552-.414 1.335-.302 1.75.25 1.294 1.723 3.35 2.834 5.667 2.834s4.373-1.11 5.667-2.834c.415-.552 1.199-.664 1.751-.25.552.415.664 1.199.25 1.751C25.92 28.076 23.136 29.584 20 29.584s-5.92-1.508-7.666-3.832c-.415-.552-.303-1.336.249-1.751Z",fill:"#141B34"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 15c0-1.151.933-2.083 2.083-2.083h.015c1.151 0 2.084.933 2.084 2.083 0 1.151-.933 2.083-2.084 2.083h-.015c-1.15 0-2.083-.933-2.083-2.083ZM24.568 15c0-1.151.933-2.083 2.084-2.083h.015c1.151 0 2.083.933 2.083 2.083 0 1.151-.932 2.083-2.083 2.083h-.015c-1.151 0-2.084-.933-2.084-2.083Z",fill:"#141B34"})),u9=e=>p.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},p.createElement("path",{d:"M19.9997 36.6663C29.2044 36.6663 36.6663 29.2044 36.6663 19.9997C36.6663 10.7949 29.2044 3.33301 19.9997 3.33301C10.7949 3.33301 3.33301 10.7949 3.33301 19.9997C3.33301 29.2044 10.7949 36.6663 19.9997 36.6663Z",fill:"#E0E0E0"}),p.createElement("path",{d:"M19.9997 30C23.16 30 25.8145 27.867 26.56 24.9832C26.9068 23.6413 26.4033 23.3333 25.0765 23.3333H14.9228C13.5959 23.3333 13.0925 23.6413 13.4393 24.9832C14.1848 27.867 16.8393 30 19.9997 30Z",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{d:"M11.667 15.8333C11.667 14.4526 12.7863 13.3333 14.167 13.3333C15.5477 13.3333 16.667 14.4526 16.667 15.8333M23.3337 15.8333C23.3337 14.4526 24.453 13.3333 25.8337 13.3333C27.2143 13.3333 28.3337 14.4526 28.3337 15.8333",stroke:"black",strokeOpacity:.12,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),c9=e=>p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:40,height:40,viewBox:"0 0 40 40",fill:"none",...e},p.createElement("path",{d:"M2.083 20C2.083 10.105 10.105 2.083 20 2.083c9.895 0 17.917 8.021 17.917 17.917 0 9.895-8.022 17.917-17.917 17.917C10.105 37.917 2.083 29.895 2.083 20Z",fill:"#FFD46E"}),p.createElement("g",{clipPath:"url(#clip0_159_173224)"},p.createElement("g",{clipPath:"url(#clip1_159_173224)"},p.createElement("path",{d:"M20 30.624c3.752 0 6.904-2.532 7.789-5.956.412-1.593-.185-1.959-1.76-1.959H13.973c-1.575 0-2.173.366-1.761 1.959.885 3.424 4.037 5.956 7.788 5.956Z",fill:"#141B34"})),p.createElement("mask",{id:"mask0_159_173224",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:12,y:22,width:16,height:9},p.createElement("path",{d:"M20 30.624c3.752 0 6.904-2.532 7.789-5.956.412-1.593-.185-1.959-1.76-1.959H13.973c-1.575 0-2.173.366-1.761 1.959.885 3.424 4.037 5.956 7.788 5.956Z",fill:"#141B34"})),p.createElement("g",{mask:"url(#mask0_159_173224)"},p.createElement("path",{d:"M20 32.998c3.278 0 5.936-1.594 5.936-3.561 0-1.968-2.658-3.562-5.936-3.562-3.278 0-5.936 1.594-5.936 3.562 0 1.967 2.658 3.561 5.936 3.561Z",fill:"#FF493B"}))),p.createElement("path",{d:"M11.667 15.833c0-1.381 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5M23.333 15.833c0-1.381 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5",stroke:"#141B34",strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("defs",null,p.createElement("clipPath",{id:"clip0_159_173224"},p.createElement("rect",{width:15.83,height:7.915,fill:"white",transform:"translate(12.085 22.709)"})),p.createElement("clipPath",{id:"clip1_159_173224"},p.createElement("rect",{width:15.83,height:7.915,fill:"white",transform:"translate(12.085 22.709)"})))),d9=[{value:1,Icon:{Active:n9,Inactive:t9},isActive:e=>e<=1,getTooltip:e=>e.CSAT5_RATING_SCORE_1},{value:2,Icon:{Active:i9,Inactive:r9},isActive:e=>e===2,getTooltip:e=>e.CSAT5_RATING_SCORE_2},{value:3,Icon:{Active:s9,Inactive:a9},isActive:e=>e===3,getTooltip:e=>e.CSAT5_RATING_SCORE_3},{value:4,Icon:{Active:l9,Inactive:o9},isActive:e=>e===4,getTooltip:e=>e.CSAT5_RATING_SCORE_4},{value:5,Icon:{Active:c9,Inactive:u9},isActive:e=>5<=e,getTooltip:e=>e.CSAT5_RATING_SCORE_5}],h9=()=>d9,WI=({label:e,children:n,position:t="top",disabled:r})=>{const[i,a]=p.useState(!1);return r?n:p.createElement("div",{style:{position:"relative"},onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1)},n,p.createElement(m9,{$visible:i,$position:t},p.createElement(_9,{variant:"caption1"},e),p.createElement(f9,{$position:t})))},f9=({$position:e})=>p.createElement("svg",{style:{transform:e==="top"?"rotate(0)":"rotate(180deg)"},xmlns:"http://www.w3.org/2000/svg",width:"12",height:"6",viewBox:"0 0 12 6",fill:"none"},p.createElement("path",{d:"M6 6L0 0h12L6 6Z",fill:V.themedColor.oncontent_inverse1})),p9={top:at`flex-direction:column;top:0;transform:translate(-50%,-100%);`,bottom:at`flex-direction:column-reverse;bottom:0;transform:translate(-50%,100%);`},m9=q.div`display:${({$visible:e})=>e?"flex":"none"};align-items:center;position:absolute;left:50%;z-index:${Al.TOOLTIP};${({$position:e})=>p9[e]}`,_9=q(We)`padding:6px 8px;color:${V.themedColor.oncontent1};background:${V.themedColor.oncontent_inverse1};border-radius:4px;font-size:12px;white-space:nowrap;`,g9=({submitted:e,value:n,onChange:t})=>{const{stringSet:r}=Gt(),i=h9(),a=typeof n=="number";return p.createElement(v9,null,p.createElement(We,{variant:"caption2",color:V.themedColor.textMidEmphasis},r.CSAT_RATING_TITLE),p.createElement(y9,null,i.map(s=>p.createElement(WI,{disabled:e,key:s.value,label:s.getTooltip(r)},p.createElement(b9,{disabled:e,onClick:()=>t(s.value),$inactive:a&&!s.isActive(n)},a?s.isActive(n)?p.createElement(s.Icon.Active,null):p.createElement(s.Icon.Inactive,null):p.createElement(s.Icon.Active,null))))))},v9=q.div`display:flex;flex-direction:column;gap:8px;`,y9=q.div`display:flex;justify-content:space-between;width:100%;max-width:320px;`,b9=q.button`background-color:transparent;border:none;border-radius:4px;padding:0;display:flex;align-items:center;justify-content:center;box-sizing:border-box;&:enabled:hover{cursor:pointer;background-color:${V.color.background200};${br.dark`
      background-color: ${V.color.background500};
    `}
  }

  ${({$inactive:e,theme:n})=>e&&n.selected==="dark"&&E9};
`,E9=at`[fill]{fill:white;fill-opacity:0.12;}[stroke]{stroke:white;stroke-opacity:0.12;}`,C9=({submitted:e,value:n="",onChange:t})=>{const{stringSet:r}=Gt();return e&&!n?null:p.createElement(S9,{disabled:e,maxLength:255,value:n,onChange:i=>t(i.target.value),placeholder:r.CSAT_REASON_PLACEHOLDER})},S9=q.input`box-sizing:border-box;width:100%;border-radius:4px;padding:10px 16px;font-size:14px;font-weight:400;font-style:normal;border:unset;&:focus{outline:none;}color:${V.themedColor.textHighEmphasis};&::placeholder{color:${V.themedColor.onbackground3};}background-color:${V.color.background50};${br.dark`
    background-color: ${V.themedColor.textDisabled};
  `}

  &:disabled {
    cursor: not-allowed;
    color: ${V.themedColor.textLowEmphasis};
    background-color: ${V.color.background200};
    ${br.dark`
      color: ${V.color.ondark04};
      background-color: ${V.themedColor.textDisabled};
    `}
  }
`,T9=({submitted:e})=>{const{stringSet:n}=Gt();return e?p.createElement(We,{variant:"h2",color:V.themedColor.onbackground1},n.CSAT_TITLE_SUBMITTED):p.createElement(We,{variant:"h2",color:V.themedColor.onbackground1},n.CSAT_TITLE_UNSUBMITTED)};var Jo=(e=>(e.AI_AGENT_CSAT_5="AI_AGENT_CSAT_5",e.AI_AGENT_CSAT_5_WITH_CRE="AI_AGENT_CSAT_5_WITH_CRE",e))(Jo||{});const w9=e=>p.useReducer((n,t)=>({...n,...t}),e),A9=({type:e,renderSubmitButton:n,initialCsat:t,initialCsatReason:r,initialIsResolved:i})=>{const[a,s]=w9({csatType:e,csat:t,csatReason:r,isResolved:i}),o=typeof t=="number"?"submitted":e===Jo.AI_AGENT_CSAT_5&&typeof a.csat=="number"||e===Jo.AI_AGENT_CSAT_5_WITH_CRE&&typeof a.csat=="number"&&typeof a.isResolved=="boolean"?"submittable":"unsubmittable",l={state:o,submitted:o==="submitted"};return p.createElement(p.Fragment,null,p.createElement(N9,null,p.createElement(T9,{...l}),e===Jo.AI_AGENT_CSAT_5_WITH_CRE&&p.createElement(Xz,{...l,defaultValue:i,value:a.isResolved,onChange:u=>s({isResolved:u})}),p.createElement(g9,{...l,value:a.csat,onChange:u=>s({csat:u})}),a.csat&&p.createElement(C9,{...l,value:a.csatReason,onChange:u=>s({csatReason:u})})),o!=="submitted"&&n({state:o,params:a}))},N9=q.div`display:flex;flex-direction:column;gap:12px;`,I9=()=>{const{stringSet:e}=Gt();return p.createElement(We,{variant:"body2",color:V.themedColor.textMidEmphasis,style:{textAlign:"center"}},e.CSAT_SUBMISSION_EXPIRED)},M9=e=>{if(e.messageType!=="admin.csat")throw new Error("Invalid message type");const n=TI(),{stringSet:t}=Gt(),{extendedMessagePayload:r,csat:i,csatReason:a,csatExpireAt:s,isResolvedWhenDeterminedByUser:o,onSubmitCSAT:l}=e,{visibility:u,type:c}=r?.csat??{};if(!u||!c||!Jo[c])return null;const d=c===Jo.AI_AGENT_CSAT_5||c===Jo.AI_AGENT_CSAT_5_WITH_CRE?A9:()=>null,h=f=>{f.csat&&!US(s)?l({csatType:f.csatType,csat:f.csat,csatReason:f.csatReason,isResolved:f.isResolved}):n()};return p.createElement(x9,null,!i&&US(s)?p.createElement(I9,null):p.createElement(d,{type:c,initialCsat:i,initialCsatReason:a,initialIsResolved:o,renderSubmitButton:({state:f,params:m})=>p.createElement(O9,{disabled:f!=="submittable",onClick:()=>h(m)},p.createElement(We,{variant:"button"},t.CSAT_SUBMIT_LABEL))}))},x9=q.div`display:flex;flex-direction:column;background-color:${({theme:e})=>e.colors.csat.background};border-radius:16px;gap:16px;padding:24px;`,O9=q.button`all:unset;background-color:${({theme:e})=>e.colors.base.primary};color:${({theme:e})=>e.colors.base.primaryContrastContent};border-radius:6px;padding:10px 20px;display:flex;align-items:center;justify-content:center;cursor:pointer;&:hover{background-color:${V.color.primary.dark};}&:disabled{color:${V.color.ondark03};background-color:${V.themedColor.textDisabled};cursor:not-allowed;}`;function US(e){return!!e&&e<Date.now()}const lb=Zy({template:D9,components:{AdminMessage:Wz,CSATMessage:M9}});function D9(e){const{components:n}=lb.useContext(),t=VI(()=>e.messageType==="admin"?p.createElement(n.AdminMessage,{...e}):e.messageType==="admin.csat"?p.createElement(n.CSATMessage,{...e}):null);return p.createElement(k9,{$marginBottom:eb(e.groupType)},t)}const k9=q.div`padding-inline:${ca}px;margin-bottom:${({$marginBottom:e})=>e}px;`,R9=C$``,U9=A7(_l,ob,lb);function L9({appearance:e,rootElement:n,logger:t,language:r,stringSet:i,children:a,messageTemplate:s}){var o,l;const u=p.useMemo(()=>{const c={},{carousel_padding_left:d,carousel_padding_right:h}=s?.__internalVariables||{},f=d,m=h;return typeof f=="number"&&(c.carousel_padding_left=f),typeof m=="number"&&(c.carousel_padding_right=m),Object.keys(c).length>0?c:void 0},[(o=s?.__internalVariables)==null?void 0:o.carousel_padding_left,(l=s?.__internalVariables)==null?void 0:l.carousel_padding_right]);return p.createElement(I5,{target:n},p.createElement(i$,{rootElement:n,logger:t,appearance:e},p.createElement(v$,{rootElement:n,internalVariables:u},p.createElement(f$,{stringSet:i,logger:t,language:r},p.createElement(U9,null,a,p.createElement(R9,null))))))}const LS={key_payment_plan_container:{color_variables:{},created_at:1232,updated_at:4563,key:"key_payment_plan_container",ui_template:{body:{items:[{carouselStyle:{maxChildWidth:265,spacing:10},items:"{@templates}",type:"carouselView",viewStyle:{padding:{top:0,bottom:0,left:50,right:16}}}]},version:2}},key_payment_plan:{color_variables:{},created_at:123,updated_at:456,key:"key_payment_plan",ui_template:{version:1,body:{items:[{viewStyle:{radius:16,backgroundColor:"#FFFFFF",borderWidth:"1",borderColor:"#E0E0E0"},width:{type:"fixed",value:"264"},height:{type:"fixed",value:"275"},type:"box",layout:"column",items:[{viewStyle:{padding:{left:16,right:16,top:16,bottom:16},backgroundImageUrl:"https://storage-66w.pages.dev/carousel-bg.png"},action:{type:"web",data:"{action_url}"},type:"box",layout:"column",items:[{type:"text",text:"{header_plan}",textStyle:{size:14,weight:"bold",color:"#FFFFFF"}},{type:"text",text:"{header_desc}",textStyle:{size:12,color:"#FFFFFF"}}]},{viewStyle:{padding:{left:16,right:16,top:16,bottom:16}},action:{type:"web",data:"{action_url}"},type:"box",layout:"column",items:[{type:"text",text:"{price}",textStyle:{size:20,weight:"bold"}},{viewStyle:{padding:{left:0,right:0,top:16,bottom:16}},type:"box",layout:"column",items:[{viewStyle:{backgroundColor:"#E0E0E0"},width:{type:"flex",value:0},height:{type:"fixed",value:"1"},type:"box",layout:"column"}]},{viewStyle:{margin:{bottom:8,top:0,left:0,right:0}},type:"text",text:"{description}",textStyle:{size:14,weight:"normal",color:"#7F7F7F"}}]}]}]}}},key_content_preview:{color_variables:{},created_at:1232,updated_at:4563,key:"key_content_preview",ui_template:{version:1,body:{items:[{viewStyle:{radius:16,borderWidth:1,borderColor:"#1F000000",backgroundColor:"#FFFFFF"},width:{type:"fixed",value:264},action:{type:"web",data:"{action_url}"},type:"box",layout:"column",items:[{action:{type:"web",data:"{action_url}"},width:{type:"flex",value:0},height:{type:"fixed",value:200},type:"image",imageUrl:"{image}",imageStyle:{contentMode:"aspectFill"}},{action:{type:"web",data:"{action_url}"},viewStyle:{padding:{left:16,right:16,top:16,bottom:16}},type:"box",layout:"column",items:[{viewStyle:{margin:{bottom:4,top:0,left:0,right:0}},height:{type:"fixed",value:16},type:"text",text:"{title}",maxTextLines:1,textStyle:{size:14,weight:"bold",color:"#000000"}},{height:{type:"fixed",value:16},type:"text",text:"{release_date}",maxTextLines:1,textStyle:{size:14,weight:"normal",color:"#80000000"}}]}]}]}}}},[YI,Sn]=ts("Agent"),P9=({children:e})=>p.createElement(YI.Consumer,null,n=>n?e(n):null);function F9({children:e,state:n,enableCloseConversationButton:t=!1,enableExpandButton:r=!0,enableAutoDisconnectInLauncher:i=!0,...a}){const s=R7(),[o,l]=p.useState(!1),[u,c]=p.useState(!1),d={opened:n?.opened??o,setOpened:n?.setOpened??l,expanded:n?.expanded??u,setExpanded:n?.setExpanded??c};return p.createElement(YI.Provider,{value:{...a,...s,state:d,enableCloseConversationButton:t,enableExpandButton:r,enableAutoDisconnectInLauncher:i}},e)}const gf={},Oa={getItem:e=>{try{return localStorage.getItem(e)}catch{return gf[e]??null}},setItem:(e,n)=>{try{localStorage.setItem(e,n)}catch{gf[e]=n}},deleteItem:e=>{try{localStorage.removeItem(e)}catch{delete gf[e]}},getKeys:e=>{try{const n=[];for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);r&&r.startsWith(e)&&n.push(r)}return n}catch{return Object.keys(gf).filter(n=>n.startsWith(e))}}},ub=/iPad|iPhone|iPod/.test(navigator.userAgent),$9=/Android/.test(navigator.userAgent),Wm=e=>ub||$9,cb=(e,n)=>`${G7.SESSION}/${e}/${n}`,zg={get:z9,set:H9,clear:q9};function z9(e){const n=cb(e.appId,e.aiAgentId),t=Oa.getItem(n);try{return t?JSON.parse(t):null}catch{return null}}function H9(e){const n=cb(e.appId,e.aiAgentId),t=JSON.stringify(e.data);Oa.setItem(n,t)}function q9(e){const n=cb(e.appId,e.aiAgentId);Oa.deleteItem(n)}function B9(){const{chatSDK:e,logger:n}=Sn(),{shouldSyncCachedTemplate:t,syncCachedTemplates:r,clearCachedTemplates:i}=RI(),a=p.useCallback(async(o,l)=>{n.debug("authManager.authenticate: session:",o.userId),l&&e.setSessionHandler(new t0(l)),await e.connect(o.userId,o.authToken),n.debug("authManager.authenticate: user:",e.currentUser),t(e)&&await r(e)},[e,n,t,r]),s=p.useCallback(async()=>{n.debug("authManager.deauthenticate: disconnect"),await e.disconnect(),i()},[e,n,i]);return{authenticate:a,deauthenticate:s}}const G9=24*60*60*1e3,[V9,Xn]=ts("MessengerSession");function j9({userSessionInfo:e,children:n}){const{appId:t,aiAgentId:r,chatSDK:i,agentPreviewConfigs:a,state:s,logger:o,language:l,countryCode:u,context:c,handlers:d}=Sn(),{updateTheme:h}=Bm(),{authenticate:f,deauthenticate:m}=B9(),[y,C]=p.useState(void 0),[b,v]=p.useState(void 0),[E,S]=p.useState(null),[w,A]=p.useState(null),[D,O]=p.useState(null),M=a?.forceCreateChannel??!1;function F(){if(e){o.debug("messengerSession.initialize: manual session info detected");const J=["userId","authToken","sessionHandler"].filter(ee=>!(ee in e));return J.length>0&&o.error(`messengerSession.initialize: missing required keys in userSessionInfo: ${J.join(", ")}`),e}const $=zg.get({appId:t,aiAgentId:r});return $?$.expireAt-G9<=Date.now()?(o.debug("messengerSession.initialize: auto session expired, clear cache"),zg.clear({appId:t,aiAgentId:r}),null):(o.debug("messengerSession.initialize: auto session info detected"),$):null}const U=p.useCallback(async()=>{if(E){o.debug("messengerSession.refreshActiveChannel: try to refresh active channel"),C(void 0);const $=await i.aiAgent.requestMessengerSettings({aiAgentId:r,userId:E.userId,language:l,country:u,context:c,forceCreateChannel:M});return C({url:$.active_channel.channel_url,status:Ar.OPEN}),o.info("messengerSession.refreshActiveChannel: refreshed active channel",$.active_channel.channel_url),$.active_channel.channel_url}else throw o.error("messengerSession.refreshActiveChannel: userSession is not ready"),new Error("userSession is not ready")},[i,r,E?.userId,l,u,c,M]);return Yy(i,{onChannelChanged:$=>{var J;$.isGroupChannel()&&$.url===y?.url&&(o.info("messengerSession.channelChanged: channel.conversation",$.conversation),C({url:$.url,status:((J=$.conversation)==null?void 0:J.status)??Ar.OPEN}))},async onUserJoined($,J){var ee,ve;if($.conversation&&$.conversation.type===f0.PROACTIVE&&J.userId===((ee=i.currentUser)==null?void 0:ee.userId)){o.info("messengerSession.onUserJoined: proactive channel joined",$.url);const Q=((ve=$.conversation)==null?void 0:ve.status)??Ar.OPEN;C({url:$.url,status:Q}),s.setOpened(!0),Q9({sound:document.hidden||!s.opened})}}}),p.useEffect(()=>{async function $(){o.debug("messengerSession.initialize: start");const J=F(),ee=await i.aiAgent.requestMessengerSettings({aiAgentId:r,userId:J?.userId,language:l,country:u,context:c,forceCreateChannel:M});o.debug("messengerSession.initialize: messenger settings response",ee);let ve=null;if(ee.auto_created_user){const{user_id:X,session_token:se,expire_at:Ce}=ee.auto_created_user;zg.set({appId:t,aiAgentId:r,data:{userId:X,authToken:se,expireAt:Ce}}),ve={userId:X,authToken:se}}else ve={userId:J?.userId??"",authToken:J?.authToken??""};function Q(){const X=ee.appearance.selected_theme;h(X,se=>{const Ce=ee.appearance.themes[se??X];return{primary:Ce.primary_color,botMessageBackground:Ce.bot_message_bg_color,primaryContrast:Ce.primary_contrast_color,botMessageBackgroundContrast:Ce.bot_message_bg_contrast_color}}),v(void 0),S(ve),A({userId:ee.bot.bot_userid,profileUrl:ee.bot.bot_profile_url,nickname:ee.bot.bot_nickname,replyToFile:ee.bot.reply_to_file,specialNotice:ee.bot.special_notice,specialNoticeEnabled:ee.bot.is_special_notice_enabled,showHandoffButton:ee.bot.show_handoff_button??!0}),O({type:ee.launcher.image_type||"default_icon",imageUrl:ee.launcher.image_url}),ee.launcher.auto_open&&!Wm()&&setTimeout(()=>s.setOpened(!0),500)}function Z(){C({url:ee.active_channel.channel_url,status:Ar.OPEN})}try{Q(),await f(ve,e?.sessionHandler),Z()}catch(X){X instanceof Error&&(o.error("messengerSession.initialize: failed to connect",X),v(X))}}$().catch(J=>{o.error("messengerSession: failed to initialize",J)})},[i,r,e?.userId,e?.authToken]),p.useEffect(()=>{d!=null&&d.onRegisterDeauthenticateHandler&&(o.debug("messengerSession: registering deauthenticate handler"),d.onRegisterDeauthenticateHandler(m))},[d?.onRegisterDeauthenticateHandler,m]),!E||!w||!D?null:p.createElement(V9.Provider,{value:{userSession:E,activeChannel:y,refreshActiveChannel:U,connectionError:b,aiAgentInfo:{...w,...a?.bot},launcherInfo:{...D,...a?.launcher}}},n)}function Q9({sound:e}){const n="You have received a new message",t=document.title,r=setInterval(()=>{document.title=document.title===n?t:n},750);setTimeout(()=>clearInterval(r),5e3),e&&Ie(()=>import("./DP0MwObA-BpqlphCk.js"),[]).then(i=>{new Audio(i.default).play()})}const PS={file:"attach",snippet:"snippet",site:"website",sb_sprinklr:"sprinklr",sb_salesforce:"salesforce",sb_confluence:"confluence",sb_zendesk:"zendesk",sb_desk:"snippet"},K9=({actionbook:e,functionCalls:n,groundedness:t,agentMessageTemplates:r,onClickActionbook:i,onClickFunctionCall:a,onClickFunctionCallDetail:s,onClickGroundedness:o,onClickAgentMessageTemplate:l,bottomContent:u,renderCustomGroundednessIcon:c=h=>h.default,style:d={}})=>{const{iconColor:h="#000000",textColor:f="#000000",highlightColor:m=fl.DEFAULT_PRIMARY}=d;return p.createElement(FS,null,e&&p.createElement(FS,null,p.createElement(sm,null,p.createElement(yf,null,p.createElement(Nt,{size:16,type:"actionbook",color:h})),p.createElement(vf,{$clickable:!!i,$highlightColor:m,variant:"body2",color:f,onClick:()=>i?.(e)},e.name))),n?.map(y=>p.createElement(Hg,{key:y.key},p.createElement(yf,null,p.createElement(Nt,{size:16,type:"function",color:h})),p.createElement(sm,null,p.createElement(vf,{$clickable:!!i,$highlightColor:m,variant:"body2",color:f,onClick:()=>a?.(y)},y.name),p.createElement(Y9,{role:"button",onClick:()=>s?.(y)},p.createElement(We,{variant:"body2",color:m},"View details"),p.createElement(Nt,{type:"chevron-right",size:16,color:m}))))),t?.map(y=>p.createElement(Hg,{key:y.id},p.createElement(yf,null,c({default:p.createElement(Nt,{size:16,type:PS[y.source_type]??PS.snippet,color:h}),sourceType:y.source_type})),p.createElement(vf,{$clickable:!!o,$highlightColor:m,variant:"body2",color:f,onClick:()=>o?.(y)},y.preview_title))),r?.map(y=>p.createElement(Hg,{key:y.key},p.createElement(yf,null,p.createElement(Nt,{size:16,type:"template",color:h})),p.createElement(vf,{$clickable:!!l,$highlightColor:m,variant:"body2",color:f,onClick:()=>l?.(y)},y.name))),u)},W9=q(We)`font-weight:400;`,vf=q(W9)`${({$clickable:e,$highlightColor:n})=>e&&at`
      cursor: pointer;
      text-decoration: underline;
      &:hover {
        color: ${n};
      }
    `}
`,yf=q.div`display:flex;align-items:center;justify-content:center;flex-shrink:0;`,sm=q.div`display:flex;gap:8px;align-items:center;`,Y9=q(sm)`cursor:pointer;gap:4px;`,Hg=q(sm)`flex-direction:row;align-items:center;`,FS=q.div`display:flex;gap:4px;flex-direction:column;align-items:flex-start;`,ZI=p.createContext(null);function Z9({isDashboardActionbookTester:e=!1,children:n}){return p.createElement(ZI.Provider,{value:{isDashboardActionbookTester:e}},e&&p.createElement(X9,null),n)}const Ym=()=>{const e=p.useContext(ZI);if(!e)throw new Error("_UNSAFE_INTERNAL_DashboardActionbookTesterProvider not found");return e},X9=()=>p.createElement(_l.Template,{template:J9},p.createElement(_l.MessageLogs,{component:eH})),J9=e=>p.createElement(jI,{...e,testerMode:!0,maxBodyWidth:$I}),eH=({extendedMessagePayload:e={}})=>{const{handlers:n}=Sn(),{manual:t,groundedness:r,function_calls:i,agent_message_templates:a,is_thinking:s}=e;return s||!t&&!r&&!i&&!a?p.createElement(p.Fragment,null):p.createElement(tH,null,p.createElement(nH,{width:4}),p.createElement(K9,{actionbook:t,functionCalls:i,groundedness:r,agentMessageTemplates:a,onClickFunctionCallDetail:n?.onFunctionCallDetailClick,style:{iconColor:V.themedColor.textHighEmphasis,textColor:V.themedColor.textHighEmphasis,barColor:V.themedColor.textDisabled},bottomContent:p.createElement(rH,{variant:"caption2",color:V.themedColor.textLowEmphasis},"Only visible in the tester")}))},tH=q.div`display:flex;gap:16px;margin:16px ${ca}px 0;align-self:stretch;`,nH=q.div`width:${({width:e})=>e}px;background-color:${V.themedColor.textDisabled};border-radius:100px;flex-shrink:0;`,rH=q(We)`margin-top:5px;`;function iH({rootElement:e=document.body,logLevel:n=Pi.WARN,language:t=navigator.language,userSessionInfo:r,children:i,...a}){var s;return Ic.level!==n&&(Ic.level=n),m$("https://fonts.googleapis.com/css2?family=Roboto&display=swap",e),p.createElement("div",{id:eo.ENTRY,style:{width:"fit-content",height:"fit-content"}},p.createElement(F7,{logger:Ic,storage:aH},p.createElement(L9,{logger:Ic,rootElement:e,appearance:(s=a.agentPreviewConfigs)==null?void 0:s.appearance,stringSet:a.stringSet,language:t,messageTemplate:a.messageTemplate},p.createElement(U7,{appId:a.appId,aiAgentId:a.aiAgentId,language:t,countryCode:a.countryCode,context:a.context,logger:Ic,chatParams:{customApiHost:a.customApiHost,customWebSocketHost:a.customWebSocketHost}},p.createElement(F9,{rootElement:e,...a},p.createElement(j9,{userSessionInfo:r},p.createElement(Z9,{isDashboardActionbookTester:a._UNSAFE_INTERNAL_isActionbookTester},i,p.createElement("div",{id:eo.MODAL_ROOT}))))))))}const Ic=new kI(Pi.WARN),db="@sba/message-template",$S=e=>`${db}/templates/${e}`,zS=()=>`${db}/token`,aH=L7({onSetTemplate:(e,n)=>{LS[e]||Oa.setItem($S(e),n)},onGetTemplate:e=>{const n=LS[e];return n?JSON.stringify(n):Oa.getItem($S(e))},onSetCachedToken(e){Oa.setItem(zS(),e)},onGetCachedToken(){return Oa.getItem(zS())},onClear:()=>{Oa.getKeys(db).forEach(Oa.deleteItem)}}),sH=({children:e,isOpened:n})=>{const{dir:t,rootElement:r}=Sn(),i=pl(r,!0);return p.useEffect(()=>{const a="sb-agent-block-scroll";return n?i.body.classList.add(a):i.body.classList.remove(a),()=>{i.body.classList.remove(a)}},[i,n]),p.createElement(oH,{dir:t,$visible:n},e)},oH=q.div`width:100%;height:100%;position:fixed;top:0;left:0;z-index:${Al.WINDOW};visibility:${({$visible:e})=>e?"visible":"hidden"};`;function lH({className:e,isOpened:n,onClick:t,type:r,imageUrl:i,dir:a,animated:s=!0,backgroundColor:o}){const l=im(o);return p.createElement(dH,{dir:a,id:eo.LAUNCHER,className:e,"aria-label":"Sendbird AIAgent Launcher",onClick:t,$animated:s,$backgroundColor:o},p.createElement(hH,{$isOpened:n,$animated:s,$fillColor:l},p.createElement(HS.Open,{url:i,isDefaultIcon:r==="default_icon"})),p.createElement(fH,{$isOpened:n,$animated:s,$fillColor:l},p.createElement(HS.Close,null)))}const uH=at`&:hover{transition:transform 250ms cubic-bezier(0.33,0,0,1);transform:scale(1.1);}&:active{transform:scale(0.8);}`,cH=at`img{width:100%;height:100%;object-fit:cover;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-drag:none;&[data-default-icon='true']{width:32px;height:32px;filter:${({$fillColor:e})=>e===fl.WHITE?"grayscale(100%) brightness(2000%)":"grayscale(100%) invert(100%) saturate(0%) brightness(0%) contrast(1000%)"};}}`,XI=at`svg{width:32px;height:32px;${({$fillColor:e})=>at`
        path {
          fill: ${e};
        }
        [class*='fill'] {
          fill: ${e};
        }
      `}
  }
`,dH=q.button`position:relative;padding:0;width:48px;height:48px;background:${({$backgroundColor:e})=>e};border-radius:50%;transition:all 0.3s cubic-bezier(0.31,-0.105,0.43,1.4);border:none;display:flex;justify-content:center;align-items:center;box-shadow:0 16px 24px 2px rgba(33,33,33,0.12),0 6px 30px 5px rgba(33,33,33,0.08),0 6px 10px -5px rgba(33,33,33,0.04);${({$animated:e})=>e&&uH}`,JI=q.span`position:absolute;width:100%;height:100%;border-radius:50%;overflow:hidden;transition:transform 0.16s linear,opacity 0.08s linear,scale 0.16s linear;user-select:none;display:flex;justify-content:center;align-items:center;`,hH=q(JI)`opacity:${({$isOpened:e})=>e?0:1};transform:${({$animated:e,$isOpened:n})=>e&&(n?"rotate(-90deg) scale(0)":"rotate(0deg)")};${cH}${XI}`,fH=q(JI)`scale:${({$isOpened:e})=>e?1:0};transform:${({$animated:e,$isOpened:n})=>e&&(n?"rotate(0deg)":"rotate(-90deg)")};${XI}`,HS={Open:e=>e.url?p.createElement("img",{src:e.url,alt:"launcher-img","data-default-icon":e.isDefaultIcon}):p.createElement(rb,null),Close:()=>p.createElement(Nt,{size:32,type:"chevron-down"})};function pH({className:e}){const{colors:n}=Wy(),{dir:t,state:r}=Sn(),{launcherInfo:i}=Xn();return _H(),p.createElement(lH,{dir:t,className:e,isOpened:r.opened,onClick:()=>r.setOpened(!r.opened),type:i.type,imageUrl:i.imageUrl,backgroundColor:n.base.primary})}const mH=1e3*60;function _H(){const{chatSDK:e,state:n,logger:t,enableAutoDisconnectInLauncher:r}=Sn(),i=p.useRef(null);p.useEffect(()=>{if(!r)return;function a(){i.current&&(clearTimeout(i.current),i.current=null)}function s(){e.connectionState===li.CLOSED&&(e.reconnect(),t.debug("useSDKInactivityTimeout: reconnected")),a(),t.debug("useSDKInactivityTimeout: clear disconnect schedule")}function o(){a(),i.current=setTimeout(async()=>{await e.disconnectWebSocket(),t.debug("useSDKInactivityTimeout: disconnected")},mH)}n.opened?s():(o(),t.debug("useSDKInactivityTimeout: schedule disconnect"))},[r,e,n.opened])}const gH=({publishSynchronous:e=!1})=>{const n=new Set;return{publish:t=>{n.forEach(r=>{e?r(t):setTimeout(()=>r(t),0)})},subscribe:t=>(n.add(t),()=>n.delete(t))}};function vH(e,n=[]){const t=p.useRef(null),r=p.useRef(0),i=p.useRef(0),[a]=p.useState(()=>gH({publishSynchronous:!0})),[s,o]=p.useState(!0);return p.useLayoutEffect(()=>{r.current=0,i.current=0,o(!0),t.current&&(t.current.scrollTop=t.current.scrollHeight)},n),p.useLayoutEffect(()=>a.subscribe(({type:l,data:u})=>{const{resolve:c,animated:d}=u??{};if(!t.current)return c?.();if(l==="scrollToBottom"&&(t.current.scroll?t.current.scroll({top:t.current.scrollHeight,behavior:qS(e,d)}):t.current.scrollTop=t.current.scrollHeight,i.current=0,o(!0),c?.()),l==="scroll"){const h=u?.top,{scrollTop:f,scrollHeight:m,clientHeight:y}=t.current;t.current.scroll?t.current.scroll({top:h,behavior:qS(e,d)}):typeof h=="number"&&(t.current.scrollTop=h),i.current=Math.max(0,m-f-y),o(i.current===0),c?.()}}),[e]),{scrollRef:t,scrollPubSub:a,isScrollBottomReached:s,setIsScrollBottomReached:o,scrollDistanceFromBottomRef:i,scrollPositionRef:r}}function qS(e,n){return typeof n=="boolean"?n?"smooth":"auto":e}function yH(e){return new Promise(n=>{const t=new Image;t.onload=function(){const r=String(t.width),i=String(t.height);URL.revokeObjectURL(t.src),n({width:r,height:i})},t.src=URL.createObjectURL(e)})}async function bH(e){if("file"in e&&e.file instanceof File&&e.file.type.startsWith("image/")){const{width:n,height:t}=await yH(e.file);return new nr({key:eM,value:[n,t]})}}const eM="KEY_IMG_ASPECT_RATIO",EH=({onScroll:e})=>{const{agentPreviewConfigs:n,handlers:t}=Sn(),r=p.useRef(n?.agentAttributes);return r.current=n?.agentAttributes,{onBeforeSendMessage:async i=>{var a,s;const o=await bH(i),l={...i,metaArrays:o?[o]:void 0},u=((a=r.current)==null?void 0:a.ai)??{},c=((s=r.current)==null?void 0:s.safeguard)??{};return Object.keys(u).length>0||Object.keys(c).length>0?{...l,data:JSON.stringify({ai_attrs:u,safeguard_attrs:c})}:l},onAfterSendMessage:i=>{var a;e(),(a=t?.onMessageSend)==null||a.call(t,i.message)}}},[CH,Vi]=ts("Conversation");function SH({children:e,closedChannelUrl:n,onClearClosedChannelUrl:t,onNavigateToConversationList:r}){const{logger:i,chatSDK:a,dispatcher:s}=Sn(),{activeChannel:o,refreshActiveChannel:l}=Xn(),u=n||o?.url,c=async()=>{await l(),n&&t?.()},d=vH("smooth"),h=()=>{setTimeout(()=>d.scrollPubSub.publish({type:"scrollToBottom"}),25)},{onBeforeSendMessage:f,onAfterSendMessage:m}=EH({onScroll:h}),[y,C]=p.useState(),[b,v]=p.useState(),E=$7(a,y,{shouldCountNewMessages:()=>!1,onChannelDeleted:()=>c(),onMessagesReceived:h,onMessagesUpdated:h,logger:i});async function S(){if(i.debug("conversation.fetchChannel: start"),C(void 0),v(void 0),u)try{i.debug("conversation.fetchChannel: get channel",u);const w=await a.groupChannel.getChannel(u);C(w);const A=new $y({onReconnectSucceeded:()=>w.refresh()});a.addConnectionHandler("sba-refresh",A),i.debug("conversation.fetchChannel: fetched channel",w)}catch(w){w instanceof k&&v(w),i.error("conversation.fetchChannel: error",w)}}return p.useEffect(()=>{S()},[u]),p.useEffect(()=>{const w=async()=>{i.debug("conversation.dispatcher: try to close conversation",y),y!=null&&y.conversation&&ab(y)&&(await y.closeConversation(),await l())};return s.subscribe(E0.ConversationClose,w),()=>{s.unsubscribe(E0.ConversationClose,w)}},[s,y,l]),p.createElement(CH.Provider,{value:{channel:y,channelFetchError:b,fetchChannel:S,dataSource:E,scrollSource:d,goToActiveConversation:c,onBeforeSendMessage:f,onAfterSendMessage:m,onNavigateToConversationList:r}},e)}const hb=p.createContext({onDrop:am,subscribe:()=>am}),C0=({children:e})=>{const n=p.useRef(new Set);return p.createElement(hb.Provider,{value:{onDrop:t=>{var r;if(t.preventDefault(),(r=t.dataTransfer)!=null&&r.files){const i=Array.from(t.dataTransfer.files);i.length>0&&n.current.forEach(a=>a(i))}},subscribe:t=>(n.current.add(t),()=>n.current.delete(t))}},e)},TH=({onDropFiles:e})=>{const{subscribe:n}=p.useContext(hb);p.useEffect(()=>n(e),[e])};C0.Consumer=({children:e})=>{const{onDrop:n}=p.useContext(hb);return e({onDrop:n,onDragOver:t=>t.preventDefault()})};const eG=({iconSize:e=64,icon:n,className:t,label:r,children:i})=>p.createElement(AH,{className:t},p.createElement(Nt,{type:n,size:e,color:V.themedColor.onbackground3}),p.createElement(We,{variant:"body1",color:V.themedColor.onbackground2},r),i),wH=q.div`position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:100%;`,AH=q.div`display:flex;flex-direction:column;min-height:104px;align-items:center;gap:20px;text-align:center;`,NH={loading:p.lazy(()=>Ie(()=>import("./DnKaqbmp-BiEz77Qo.js"),[])),error:p.lazy(()=>Ie(()=>import("./DfJKEre2-tfRekxxH.js"),[])),noChannels:p.lazy(()=>Ie(()=>import("./BLrqIqwk-8tAiATdg.js"),[])),noMessages:p.lazy(()=>Ie(()=>import("./DAMSBm7t-DIlDfJow.js"),[]))},zu=({className:e,type:n="loading",...t})=>{const r=NH[n];return p.createElement(wH,{className:e},p.createElement(p.Suspense,{fallback:null},p.createElement(r,{...t})))},fb={isStreaming(e){const n=OS(e.data);return typeof n=="object"?!!n.stream:!1},isWelcomeMessage(e,n){var t;if(((t=e.extendedMessagePayload)==null?void 0:t.bot_message_type)==="welcome")return!0;if((e.isUserMessage()||e.isFileMessage())&&e.sender.userId===n){const r=OS(e.data);return!(r!=null&&r.respond_mesg_id)&&!(r!=null&&r.stream)}return!1}};function IH(e){return"sendingStatus"in e?e.sendingStatus==="succeeded"?String(e.messageId):e.reqId:String(e.messageId)}const MH=(e,n,t,r=!0)=>{if(!r||!e.isUserMessage()&&!e.isFileMessage())return"single";const i=()=>{if(!n||!n.isUserMessage()&&!n.isFileMessage())return!1;const l=n.sender.userId===e.sender.userId,u=FC(n.createdAt,e.createdAt);return l&&u},a=()=>{if(!t||!t.isUserMessage()&&!t.isFileMessage())return!1;const l=t.sender.userId===e.sender.userId,u=FC(t.createdAt,e.createdAt);return l&&u},s=i(),o=a();return s&&o?"middle":s?"bottom":o?"top":"single"};function xH(e,n){return e.filter(t=>fb.isWelcomeMessage(t,n))}function tM(e,n){return OH(e)===n}function OH(e){var n;if(e)return e.isUserMessage()||e.isFileMessage()||e.isMultipleFilesMessage()?e.sender.userId:((n=e?.sender)==null?void 0:n.userId)??void 0}function DH(e){return e.isAdminMessage()?e.message==="The channel's custom_type was updated.":!1}const BS=e=>!!e&&"sender"in e,nM=e=>e.startsWith("image/"),rM=e=>e.startsWith("video/"),GS=e=>nM(e)||rM(e),bf={isAdmin:e=>e.isAdminMessage(),isCSAT:e=>{var n;return e.isAdminMessage()&&!!((n=e.extendedMessagePayload)!=null&&n.csat)},isIncoming:(e,n)=>BS(e)&&e.sender.userId!==n,isOutgoing:(e,n)=>BS(e)&&(e.sender.userId===n||e.sendingStatus===rt.PENDING)},iM=({rootElementId:e,visible:n,onClose:t,children:r})=>{if(!n)return null;const{rootElement:i}=Sn(),a=pl(i),s=pl(i,!0);return fT.createPortal(p.createElement(kH,{onClick:t},p.createElement(RH,{onClick:o=>o.stopPropagation()},r)),a.getElementById(e)??a.getElementById(eo.MODAL_ROOT)??s.body)},kH=q.div`position:fixed;top:0;left:0;width:100%;height:100%;background:${V.color.overlay01};display:flex;justify-content:center;align-items:center;z-index:${Al.MODAL};`,RH=q.div`border-radius:4px;overflow:hidden;box-shadow:0 16px 24px 2px rgba(13,13,13,0.12),0 6px 30px 5px rgba(13,13,13,0.08),0 6px 10px -5px rgba(13,13,13,0.04);z-index:${Al.MODAL};`,UH=q.div`flex-shrink:0;width:${({$size:e})=>ml(e)};height:${({$size:e})=>ml(e)};background-color:${({theme:e})=>e.colors.base.primary};box-sizing:border-box;padding:6px;border-radius:50%;display:flex;justify-content:center;align-items:center;}`,LH=q(rb)`path{fill:${({theme:e})=>im(e.colors.base.primary)};}`;function aM({size:e}){const{aiAgentInfo:n}=Xn();return n.profileUrl?p.createElement(ib,{size:e,src:n.profileUrl}):p.createElement(UH,{$size:e},p.createElement(LH,null))}const PH=q.div`width:100%;height:100%;position:fixed;top:0;left:0;outline:none;`,FH=q.div`height:64px;min-height:64px;box-sizing:border-box;display:flex;justify-content:space-between;border-bottom:1px solid ${V.themedColor.onbackground4};background-color:${V.themedColor.background1};@media screen and (max-width:768px){position:relative;}`,$H=q.div`box-sizing:border-box;display:flex;flex-direction:row;align-items:center;height:64px;padding:16px 20px;width:calc(100% - 128px);`,zH=q.div`margin-inline-end:8px;`,HH=q.div`max-width:500px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;@media screen and (max-width:768px){position:absolute;inset-inline-start:64px;top:10px;display:block;max-width:calc(100vw - 240px);}`,qH=q.div`display:inline-block;margin-inline-start:8px;padding-top:5px;@media screen and (max-width:768px){position:absolute;inset-inline-start:56px;top:24px;}`,BH=q.div`display:flex;width:160px;justify-content:flex-end;`,GH=q.div`inset-inline-end:0;display:flex;flex-direction:row;`,S0=q.div`width:64px;padding:21px;box-sizing:border-box;cursor:${e=>e.disabled?"not-allowed":"pointer"};`,VH=q(S0)`border-inline-start:1px solid ${V.themedColor.onbackground4};`,jH=q.div`width:100%;height:100%;display:flex;align-items:center;justify-content:center;`,QH=q.video`max-width:100%;max-height:100%;user-select:none;-webkit-user-drag:none;`,KH=q.img`max-width:90%;max-height:90%;user-select:none;-webkit-user-drag:none;`,WH=q.div`max-width:100%;max-height:100%;display:flex;justify-content:center;align-items:center;`,YH=({message:e,onClose:n,onDownloadClick:t})=>{const{sender:r,type:i,url:a,name:s="",threadInfo:o}=e,{profileUrl:l,nickname:u,userId:c}=r,{userSession:d,aiAgentInfo:h}=Xn();return p.createElement(XH,{profileUrl:l,nickname:u,type:i,url:a,name:s,onClose:n,isBotMessage:c===h.userId,isByMe:d.userId===c,disableDelete:o!=null&&o.replyCount?o.replyCount>0:!1,onDownloadClick:t})},ZH=({profileUrl:e,isBotMessage:n})=>!e&&n?p.createElement(aM,{size:32}):p.createElement(ib,{size:32,src:e}),XH=({profileUrl:e,isBotMessage:n,nickname:t,name:r,type:i,url:a,isByMe:s,onClose:o,onDelete:l,disableDelete:u,onDownloadClick:c})=>{const{stringSet:d}=Gt();return p.createElement(iM,{onClose:o,visible:!0,rootElementId:eo.MODAL_ROOT},p.createElement(PH,null,p.createElement(FH,null,p.createElement($H,null,p.createElement(zH,null,p.createElement(ZH,{profileUrl:e,isBotMessage:n})),p.createElement(HH,null,p.createElement(We,{variant:"h2",color:V.themedColor.onbackground1},r)),p.createElement(qH,null,p.createElement(We,{variant:"body1",color:V.color.ondark02},t))),p.createElement(BH,null,GS(i)&&p.createElement(GH,null,p.createElement(S0,{as:"a",href:a,target:"_blank",rel:Xy,onClick:c},p.createElement(Nt,{type:"download",color:V.themedColor.onbackground1,size:24})),l&&s&&p.createElement(S0,{disabled:u,onClick:()=>{u||l()}},p.createElement(Nt,{type:"delete",color:u?"gray":V.themedColor.onbackground1,size:24}))),p.createElement(VH,{onClick:o},p.createElement(Nt,{type:"close",color:V.themedColor.onbackground1,size:24})))),p.createElement(jH,{onClick:h=>h.currentTarget===h.target&&o()},rM(i)&&p.createElement(QH,{controls:!0},p.createElement("source",{src:a,type:i})),nM(i)&&p.createElement(KH,{src:a,alt:r}),!GS(i)&&p.createElement(WH,null,p.createElement(We,{variant:"h1",color:V.themedColor.onbackground1},d.FILE_VIEWER__UNSUPPORT)))))},sM=({className:e,locale:n,date:t=Date.now(),formatString:r="MMMM dd, yyyy",style:i})=>p.createElement(JH,{style:i,className:e},p.createElement(We,{variant:"caption4",color:V.themedColor.textMidEmphasis},Xp(t,r,{locale:n}))),JH=q.div`display:flex;justify-content:center;align-items:center;`,eq=p.forwardRef(function(e,n){const{messages:t,renderMessage:r,messageTopArea:i,messageBottomArea:a,overlayArea:s,onLoadPrev:o,onLoadNext:l,loadThreshold:u=.05,onScrollPosition:c=am,depsForResetScrollPositionToBottom:d,scrollPositionRef:h,scrollDistanceFromBottomRef:f,stackDirection:m="top"}=e,y=n&&"current"in n?n:{current:null},C=p.useRef(!1),b=p.useRef(void 0),v=p.useRef(0),E=p.useRef(0),S=p.useRef(0),w=h??E,A=f??S;p.useLayoutEffect(()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)},d),p.useLayoutEffect(()=>{y.current&&(b.current==="top"&&(y.current.scrollTop=y.current.scrollHeight-w.current),b.current==="bottom"&&(y.current.scrollTop=v.current),b.current=void 0)},[y.current,t.length]);const D=async()=>{if(!y.current)return;const O=y.current;if(c(tq(O)),w.current=O.scrollHeight-O.scrollTop,A.current=w.current-O.clientHeight,v.current=O.scrollTop,C.current)return;const M=O.clientHeight*Math.min(Math.max(0,u),1);O.scrollTop<=M?(C.current=!0,b.current="top",await o(),C.current=!1):O.scrollHeight-O.scrollTop-O.clientHeight<=M?(C.current=!0,b.current="bottom",await l(),C.current=!1):b.current=void 0};return p.createElement(nq,{id:"infinite-list-container"},p.createElement(rq,{id:"infinite-list-inner",ref:y,onScroll:D},m==="bottom"&&p.createElement("div",{style:{flexGrow:1}}),i,t.map((O,M)=>r({message:O,index:M})),a),p.createElement(iq,{id:"infinite-list-overlay-container"},p.createElement(aq,{id:"infinite-list-overlay"},s)))});function tq(e){return e.scrollTop<=10?"top":e.scrollHeight-(e.scrollTop+e.clientHeight)<=10?"bottom":"middle"}const nq=q.div`display:flex;position:relative;flex:1;overflow:hidden;`,rq=q.div`display:flex;flex:1;flex-direction:column;overflow-y:auto;scrollbar-color:${V.themedColor.onbackground3}transparent;&::-webkit-scrollbar-thumb:hover{background-color:transparent;}`,iq=q.div`position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;`,aq=q.div`pointer-events:auto;`,sq=({className:e,onClick:n})=>p.createElement(oq,{className:e,onClick:n,tabIndex:0},p.createElement(Nt,{size:24,type:"chevron-down",color:V.color.primary.main})),oq=q.button`all:unset;cursor:pointer;display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:24px;box-shadow:${V.color.shadow05};${br.light`
    background-color: ${V.color.background50};
    &:hover {
      background-color: ${V.color.background100};
    }
    &:active {
      background-color: ${V.color.background200};
    }
  `}
  ${br.dark`
    background-color: ${V.color.background400};
    &:hover {
      background-color: ${V.color.background500};
    }
    &:active {
      background-color: ${V.color.background700};
    }
  `}

  &:focus {
    outline: none;
  }
`,lq=()=>{const{agentPreviewConfigs:e={},aiAgentId:n}=Sn(),{aiAgentInfo:t}=Xn(),{stringSet:r,dateLocale:i}=Gt(),{dataSource:a,onAfterSendMessage:s,onBeforeSendMessage:o}=Vi(),{Template:l}=_l.useContext(),u=e.welcomeMessages??[],{messages:c}=a,d=xH(c,n),h=c[d.length+1],f=d[0]??h;return{filteredMessages:c.filter(m=>DH(m)?!1:u.length>0?!fb.isWelcomeMessage(m,n):!0),shouldShowOriginalDate:m=>m>0||u.length===0?!0:h&&!tI(h.createdAt,f?.createdAt??0),renderAgentPreviewWelcomeMessages:()=>u.length===0?null:p.createElement(p.Fragment,null,p.createElement(sM,{style:{margin:"16px 0"},date:f?.createdAt,locale:i,formatString:r.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR}),u.map((m,y)=>{const C=y===u.length-1,b=d.length!==c.length,v=u.length===1?"single":y===0?"top":C||b?"bottom":"middle";return p.createElement(l,{messageType:"user",message:m.message,sender:t,groupType:v,createdAt:f?.createdAt??Date.now(),extendedMessagePayload:{suggested_replies:m.suggestedReplies},suggestedRepliesDirection:e.suggestedRepliesDirection,suggestedRepliesVisible:C&&!b,isBotMessage:!0,onClickSuggestedReply:async({reply:E})=>{const S=await o({message:E});a.sendUserMessage(S,s).then(s)}})}))}},oM=()=>{const{chatSDK:e}=Sn(),{channel:n}=Vi(),[t,r]=p.useState([]);return Yy(e,{onTypingStatusUpdated(i){if(i.url===n?.url){const a=i.getTypingUsers();r(a)}}}),t};function uq(){const{isDashboardActionbookTester:e}=Ym(),{aiAgentInfo:n}=Xn(),{scrollSource:t}=Vi(),r=oM(),{components:i}=_l.useContext(),[a]=r,s=!!a,o=e?0:Zd,l=a?.userId===n.userId;return p.useEffect(()=>{s&&setTimeout(()=>t.scrollPubSub.publish({type:"scrollToBottom",data:{animated:!0}}),25)},[s]),s?p.createElement(cq,null,p.createElement(dq,null,!e&&p.createElement(i.SenderAvatar,{isBotMessage:l,sender:l?n:a}),p.createElement(i.SenderName,{sender:a})),p.createElement(hq,{$startPadding:o},p.createElement(GI,null))):null}const cq=q.div`display:flex;flex-direction:column;padding:0 ${ca}px;`,dq=q.div`display:flex;align-items:center;gap:8px;`,hq=q.div`display:flex;padding-inline-start:${({$startPadding:e})=>`${e}px`};
`,fq=e=>q(e).withConfig({shouldForwardProp:w7});function pq(e){var n;const t="remove_powered_by",r=(n=e?.appInfo)==null?void 0:n.applicationAttributes;return Array.isArray(r)&&r.includes(t)}const mq=({style:e})=>{const{stringSet:n}=Gt(),{chatSDK:t}=Sn(),{isDashboardActionbookTester:r}=Ym();return pq(t)||r?null:p.createElement(_q,{variant:"caption2",style:e},n.POWERED_BY+" ",p.createElement(gq,{variant:"caption2",as:"a",href:"https://sendbird.com?utm_medium=product&utm_source=aiagent&utm_campaign=fy26-glbl-ai-agent-poweredby","aria-label":"Learn more about Sendbird",rel:Xy,target:"_blank"},"Sendbird"))},_q=q(We)`color:${V.themedColor.onbackground3};text-align:center;`,gq=fq(We)`
  color: ${V.themedColor.onbackground3};
  cursor: pointer;
  text-decoration: none;
`,vq=()=>{const{stringSet:e}=Gt(),{activeChannel:n}=Xn(),{channel:t,goToActiveConversation:r,scrollSource:i}=Vi(),a=qI(t),s=n&&t?.url===n?.url&&a;return p.useLayoutEffect(()=>{s&&i.scrollPubSub.publish({type:"scrollToBottom",data:{animated:!0}})},[s]),s?p.createElement(yq,null,p.createElement(bq,{variant:"button",role:"button",color:V.themedColor.textHighEmphasis,onClick:()=>r()},e.START_NEW_CONVERSATION)):null},yq=q.div`display:flex;justify-content:center;margin:16px 0;`,bq=q(We)`border-radius:6px;box-sizing:border-box;padding:10px 20px;border:1px solid ${V.themedColor.onbackground4};cursor:pointer;user-select:none;`,Eq=!0,Cq=()=>{const[e,n]=p.useState(null),{userSession:t,aiAgentInfo:r}=Xn(),{agentPreviewConfigs:i,chatSDK:a,state:s}=Sn(),{stringSet:o,dateLocale:l}=Gt(),{channel:u,dataSource:c,scrollSource:d,onAfterSendMessage:h,onBeforeSendMessage:f}=Vi(),{isDashboardActionbookTester:m}=Ym(),{filteredMessages:y,shouldShowOriginalDate:C,renderAgentPreviewWelcomeMessages:b}=lq(),{storage:v}=RI(),{Template:E}=ob.useContext(),{Template:S}=_l.useContext(),{Template:w}=lb.useContext(),A=(O,M=!1)=>M?r:u?.members.find(F=>F.userId===O.sender.userId)??O.sender,D=()=>{if(!c.initialized)return p.createElement(zu,{type:"loading"});if(c.messages.length===0){const O=b();return O?p.createElement("div",{style:{width:"100%"}},O):p.createElement(zu,{type:"noMessages",label:o.PLACE_HOLDER__NO_MESSAGES})}return p.createElement(eq,{ref:d.scrollRef,scrollPositionRef:d.scrollPositionRef,scrollDistanceFromBottomRef:d.scrollDistanceFromBottomRef,onScrollPosition:O=>d.setIsScrollBottomReached(O==="bottom"),stackDirection:i?.messageStackDirection,messages:y,onLoadPrev:c.loadPrevious,onLoadNext:c.loadNext,depsForResetScrollPositionToBottom:[c.initialized,c.messages.length!==0],messageTopArea:p.createElement(p.Fragment,null,p.createElement(mq,{style:{marginTop:16}}),b()),messageBottomArea:p.createElement(p.Fragment,null,p.createElement(uq,null),p.createElement(vq,null)),overlayArea:p.createElement(p.Fragment,null,!d.isScrollBottomReached&&p.createElement(Tq,{onClick:()=>d.scrollPubSub.publish({type:"scrollToBottom"})})),renderMessage:({message:O,index:M})=>{const F=IH(O),U=y[M-1],$=y[M+1],J=y[y.length-1],ee=O===J,ve=MH(O,U,$,Eq),Q=!tI(U?.createdAt??0,O.createdAt)&&C(M)&&!m,Z=()=>{O.isFileMessage()&&n(O)},X=Q?p.createElement(sM,{style:{margin:"16px 0"},date:O.createdAt,locale:l,formatString:o.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR}):null,se={maxBodyWidth:s.expanded?$I:void 0,extendedMessagePayload:O.extendedMessagePayload,createdAt:O.createdAt,groupType:ve,onClickMedia:Z},Ce=(()=>{var Me,Ue;if(bf.isAdmin(O))return bf.isCSAT(O)?u!=null&&u.conversation?p.createElement(w,{...se,...u.conversation,isResolvedWhenDeterminedByUser:wq(u.conversation),messageType:"admin.csat",onSubmitCSAT:({csat:Le,csatType:ot,csatReason:pe,isResolved:lt})=>{Le&&u.submitCSAT({csat:Le,csatType:ot,csatReason:pe,isResolved:lt})}}):null:p.createElement(w,{...se,messageType:"admin",message:O.message});if(bf.isOutgoing(O,t.userId)){const Le={...se,message:O.message,sender:A(O),sendingStatus:O.sendingStatus};if(O.isUserMessage())return p.createElement(E,{messageType:"user",...Le});if(O.isFileMessage()){const[ot,pe]=((Me=O.metaArrays.find(lt=>lt.key===eM))==null?void 0:Me.value)??[];return p.createElement(E,{messageType:"file",file:O,metadata:{aspectRatio:ot&&pe?`${ot}/${pe}`:"1/1",localFile:(Ue=O.messageParams)==null?void 0:Ue.file},...Le})}}if(bf.isIncoming(O,t.userId)){const Le=O.sender.userId===r.userId,ot={...se,sender:A(O,Le),message:O.message,suggestedRepliesVisible:ee,suggestedRepliesDirection:i?.suggestedRepliesDirection,isBotMessage:Le,onClickSuggestedReply:async({reply:pe})=>{const lt=await f({message:pe});c.sendUserMessage(lt,h).then(h)},onRequestMessageTemplate:async pe=>{const{template:lt}=await a.aiAgent.getMessageTemplate(pe);return v.setTemplate(pe,lt),lt},onGetCachedMessageTemplate:pe=>v.getTemplate(pe)};if(O.isUserMessage())return p.createElement(S,{messageType:"user",...ot});if(O.isFileMessage())return p.createElement(S,{messageType:"file",file:O,...ot})}})();return p.createElement("div",{key:F,id:`${qa}-message-item`},X,Ce)}})};return p.createElement(Sq,{id:`${qa}-message-list`},D(),e&&p.createElement(YH,{onClose:()=>n(null),message:e}))},Sq=q.div`overflow-y:hidden;display:flex;flex:1;position:relative;`,Tq=q(sq)`position:absolute;bottom:20px;inset-inline-end:20px;`;function wq(e){var n;if(((n=e?.resolution)==null?void 0:n.determinedBy)==="user")return e.resolution.isResolved}const Aq=()=>{const{stringSet:e}=Gt(),{connectionError:n}=Xn(),{channel:t,channelFetchError:r,fetchChannel:i}=Vi(),a=n||r;if(a){const s=n?void 0:{label:e.RETRY,onClick:()=>i()};return p.createElement(zu,{type:"error",label:a.message,action:s})}return t?p.createElement(Cq,null):p.createElement(zu,{type:"loading"})},lM=()=>{const{stringSet:e}=Gt(),{activeChannel:n}=Xn(),[t]=p.useState(()=>n?.status===Ar.OPEN);return t?e.RETURN_TO_CONVERSATION:e.START_NEW_CONVERSATION},Nq=()=>{const{stringSet:e}=Gt(),{goToActiveConversation:n}=Vi(),t=lM();return p.createElement(Iq,null,p.createElement(We,{variant:"body1",color:V.themedColor.textMidEmphasis},e.CONVERSATION_CLOSED_FOOTER_LABEL),p.createElement(Mq,{onClick:n},p.createElement(We,{variant:"button",color:V.themedColor.textHighEmphasis},t)))},Iq=q.div`display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 0;gap:14px;${br.light`
    background-color: ${V.color.background100};
  `}
  ${br.dark`
    background-color: ${V.color.background500};
  `}
`,Mq=q.button`all:unset;padding:10px 20px;border-radius:6px;border:1px solid ${V.themedColor.textDisabled};cursor:pointer;${br.light`
    background-color: ${V.color.background50};
  `}
  ${br.dark`
    background-color: ${V.color.background700};
  `}
`,uM=p.createContext(void 0),xq=({children:e})=>{const{stringSet:n}=Gt(),{aiAgentInfo:t}=Xn(),[r,i]=p.useState([]),[a,s]=p.useState({visible:!1,title:"",buttonText:n.BUTTON__OK}),o=t?.replyToFile,l=d=>{if(!o)return;const h=d.filter(f=>LI.includes(f.type));if(h.length!==0){if(h.some(f=>f.size>j7)){s(f=>({...f,visible:!0,title:n.FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT.replace("%d","25")}));return}if(h.length>1||h.length>0&&r.length>0){s(f=>({...f,visible:!0,title:n.FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT}));return}i(f=>[...f,...h.map(m=>({file:m,preview:{url:URL.createObjectURL(m),type:m.type,name:m.name}}))])}},u=d=>{i(h=>{var f;const m=(f=h[d])==null?void 0:f.preview;return m&&URL.revokeObjectURL(m.url),h.filter((y,C)=>C!==d)})},c=()=>{i(d=>(d.forEach(h=>URL.revokeObjectURL(h.preview.url)),[]))};return p.createElement(uM.Provider,{value:{files:r,addFiles:l,removeFile:u,clearFiles:c,isFileUploadEnabled:o}},e,p.createElement(Oq,{...a,onClose:()=>s(d=>({...d,visible:!1,title:""}))}))},pb=()=>{const e=p.useContext(uM);if(!e)throw new Error("useFileUpload must be used within FileUploadProvider");return e},Oq=({title:e,buttonText:n,visible:t,onClose:r})=>p.createElement(iM,{rootElementId:eo.WINDOW,visible:t,onClose:r},p.createElement(Dq,null,p.createElement(Rq,null,p.createElement(We,{variant:"h1",color:V.themedColor.onbackground1},e)),p.createElement(kq,null,p.createElement(Uq,{onClick:r},p.createElement(We,{variant:"button",color:V.themedColor.oncontent1},n))))),Dq=q.div`width:100%;height:auto;padding-block:18px 24px;padding-inline:24px;margin:0 auto;border-radius:4px;box-sizing:border-box;background-color:${({theme:e})=>e.colors.base.modalContentBackground};`,kq=q.div`display:flex;flex-direction:row;justify-content:flex-end;`,Rq=q.div`margin-bottom:16px;`,Uq=q.button`display:flex;justify-content:center;align-items:center;border-radius:4px;cursor:pointer;background-color:${V.themedColor.error};border:1px solid ${V.themedColor.error};padding:10px 16px;&:hover{background-color:${V.color.error.dark};border-color:${V.color.error.dark};}&:active{background-color:${V.color.error.extraDark};}`;function Lq({blurred:e,elementRef:n,document:t=window.document}){const r=p.useRef(!1);e&&n.current&&t.activeElement===n.current&&(r.current=!0),p.useLayoutEffect(()=>{var i;!e&&r.current&&((i=n.current)==null||i.focus(),r.current=!1)},[e])}const Pq=q.div`&::-webkit-scrollbar{display:none;}overflow-x:auto;display:flex;flex-direction:row;gap:10px;padding:8px 16px;background-color:transparent;`,Fq=q.div`display:flex;flex-shrink:0;position:relative;margin-block-start:8px;border-radius:12px;height:64px;img{border-radius:12px;object-fit:cover;width:64px;-webkit-user-drag:none;}`,$q=q.div`display:flex;align-items:center;justify-content:center;position:absolute;inset-inline-end:-8px;inset-block-start:-8px;cursor:pointer;border-radius:50%;${br.light`
    background-color: ${V.color.background50};
  `}
  ${br.dark`
    background-color: ${V.color.background500};
  `}
  path {
    fill: ${V.themedColor.onbackground2};
  }

  &:hover {
    path {
      fill: ${V.themedColor.onbackground1};
    }
  }

  circle {
    stroke: ${V.themedColor.background1};
  }
`,zq=()=>{const e=Wm(),[n,t]=p.useState(),{files:r,removeFile:i,isFileUploadEnabled:a}=pb();return!a||r.length===0?null:p.createElement(Pq,null,r.map(({preview:{type:s,name:o,url:l}},u)=>p.createElement(Fq,{key:l,onMouseOver:()=>t(u),onMouseLeave:()=>t(void 0)},(e||n===u)&&p.createElement($q,{title:"Remove file",onClick:()=>i(u)},p.createElement(Nt,{type:"close-filled",color:V.themedColor.onbackground2})),s.startsWith("image/")?p.createElement("img",{alt:"file-image",src:l}):p.createElement(nb,{name:o,type:tb(o,s)}))))},Hq=({channel:e,messages:n})=>{const{stringSet:t}=Gt(),{aiAgentInfo:r}=Xn(),i=qq(),a=Bq({lastMessage:n[n.length-1],aiAgentUserId:r.userId});return!e||!i||qI(e)?[!0,t.MESSAGE_INPUT__PLACE_HOLDER__DISABLED]:a?[!0,t.MESSAGE_INPUT__PLACE_HOLDER__WAIT_AI_AGENT_RESPONSE]:[!1,t.MESSAGE_INPUT__PLACE_HOLDER]},qq=()=>{const e=p.useId(),{chatSDK:n}=Sn(),[t,r]=p.useState(!0);return p.useEffect(()=>{const i=new $y({onDisconnected:()=>r(!1),onConnected:()=>r(!0),onReconnectSucceeded:()=>r(!0)});return n.addConnectionHandler(e,i),()=>{n.removeConnectionHandler(e)}},[n]),t},Bq=({lastMessage:e,aiAgentUserId:n})=>{const[t,r]=p.useState(!1),i=oM();return p.useEffect(()=>{if(!e)return;const a=i.some(o=>o.userId===n),s=tM(e,n)&&fb.isStreaming(e);r(!!(s||a))},[i,e,n]),t},cM={textArea:at`min-height:40px;height:40px;font-size:16px;line-height:24px;`,attachIcon:at`margin-bottom:4px;`},dM=q.button`all:unset;cursor:pointer;display:flex;align-items:center;justify-content:center;width:32px;height:32px;`,Gq=q(dM)`flex-shrink:0;margin-inline-end:12px;margin-bottom:2px;&:disabled{cursor:not-allowed;}&:not(:disabled){&:hover{path{fill:${V.themedColor.onbackground1};}}&:active{border-radius:4px;background-color:${V.themedColor.background3};}}${ub&&cM.attachIcon};`,Vq=q.input`display:none;`,VS=q.div`width:100%;position:relative;background-color:${V.themedColor.background2};border-radius:20px;`,jS=q.div`display:flex;flex-direction:row;align-items:flex-end;position:relative;`,QS=q.textarea`all:unset;display:block;flex:1;min-width:0;padding-top:8px;padding-bottom:8px;padding-inline-start:16px;padding-inline-end:12px;box-sizing:border-box;font-size:14px;line-height:20px;color:${V.themedColor.onbackground1};resize:none;width:100%;height:${UI}px;overflow-wrap:break-word;white-space:pre-wrap;overflow-x:hidden;${ub&&cM.textArea};&::placeholder{color:${V.themedColor.onbackground3};}&:disabled{cursor:not-allowed;&::placeholder{color:${V.themedColor.onbackground4};}}`,KS=q.div`padding:12px 16px;position:relative;display:flex;align-items:center;`,WS=({disabled:e})=>{const n=p.useRef(null),{addFiles:t,clearFiles:r,files:i,isFileUploadEnabled:a}=pb();return!a||i.length>0?null:p.createElement(Gq,{disabled:e,onClick:()=>{var s;r(),(s=n.current)==null||s.click()}},p.createElement(Nt,{type:"attach",color:e?V.themedColor.onbackground4:V.themedColor.onbackground2,size:16}),p.createElement(Vq,{type:"file",ref:n,onChange:s=>{const o=s.currentTarget.files;o&&t(Array.from(o)),s.target.value=""},accept:LI.join(",")}))},jq=()=>{const e=p.useRef(null),[n,t]=p.useState(""),{rootElement:r}=Sn(),{channel:i,dataSource:a,onBeforeSendMessage:s,onAfterSendMessage:o}=Vi(),[l,u]=Hq({channel:i,messages:a.messages}),{files:c,addFiles:d,clearFiles:h}=pb();TH({onDropFiles:d}),Lq({blurred:l,elementRef:e,document:pl(r)});const f=n.trim().length>0,m=c.length>0,y=!l&&(f||m),C=()=>{e.current&&(e.current.value="",e.current.style.height=""),h(),t("")},b=async()=>{const w=n.trim(),A={message:w};if(!w&&!c.length)return;if(c.length>0){const O=c[0].file,M={...A,file:O},F=await s(M);a.sendFileMessage(F,o).then(o),C();return}const D=await s(A);a.sendUserMessage(D,o).then(o),C()},v=w=>{const A=Array.from(w.clipboardData.files);A.length>0&&(w.preventDefault(),d(A))},E=w=>{w.key!=="Enter"||w.nativeEvent.isComposing||w.shiftKey||(w.preventDefault(),b())},S=w=>{if(e.current){e.current.style.height="";const A=Math.min(V7,e.current.scrollHeight);UI<A&&(e.current.style.height=`${A}px`)}t(w.target.value)};return l?p.createElement(KS,null,p.createElement(VS,null,p.createElement(jS,null,p.createElement(QS,{disabled:!0,placeholder:u}),p.createElement(WS,{disabled:!0})))):p.createElement(KS,null,p.createElement(VS,null,p.createElement(zq,null),p.createElement(jS,null,p.createElement(QS,{ref:e,role:"textbox","aria-label":"Text Input",placeholder:u,maxLength:5e3,onKeyDown:E,onChange:S,onPaste:v}),p.createElement(WS,null))),y&&p.createElement(dM,{onClick:()=>b()},p.createElement(Nt,{type:"send",color:V.color.primary.main,size:20})))},Qq=q.div`padding:8px 16px;text-align:center;word-break:break-word;white-space:pre-wrap;line-height:1.43;letter-spacing:-0.2px;font-size:14px;font-weight:400;color:${V.themedColor.textLowEmphasis};&& a{font-weight:700;text-decoration:none;${br.light`
      color: ${V.color.information.light};
    `};
    ${br.dark`
      color: ${V.color.information.main};
    `};
  }
`,Kq=p.lazy(()=>Ie(()=>import("./DiXu6nm5-DDy-zu28.js"),[]).then(e=>({default:e.MarkdownText}))),Wq=()=>{const{aiAgentInfo:e}=Xn(),{dataSource:n}=Vi(),{userSession:t}=Xn();return!e.specialNoticeEnabled||!e.specialNotice||!(n.initialized&&!n.messages.some(r=>tM(r,t.userId)))?null:p.createElement(Qq,null,p.createElement(Kq,null,e.specialNotice))},Yq=()=>p.createElement(Zq,null,p.createElement(Wq,null),p.createElement(xq,null,p.createElement(jq,null))),Zq=q.div`z-index:0;border:none;width:100%;`,Xq=()=>{var e;const{activeChannel:n}=Xn(),{channel:t}=Vi(),r=((e=t?.conversation)==null?void 0:e.status)===Ar.CLOSED;return t?.url!==n?.url&&r?p.createElement(Nq,null):p.createElement(Yq,null)},Jq=()=>{var e;const{state:n,logger:t,enableCloseConversationButton:r,enableExpandButton:i,dispatcher:a}=Sn(),{stringSet:s}=Gt(),{aiAgentInfo:o,activeChannel:l}=Xn(),{channel:u,onNavigateToConversationList:c}=Vi(),d=Wm()?24:16,h=()=>{n.setOpened(!1)},f=async()=>{try{const b=await u?.markConversationAsHandoff();t.info("conversation.handleAgentHandoff: success",b)}catch(b){t.error("conversation.handleAgentHandoff: error",b)}},m=async()=>{u&&await a.send(B7.CloseConversation())},y=l&&u?.url===l.url,C=o.showHandoffButton&&!!((e=u?.conversation)!=null&&e.handoff)&&y;return p.createElement(iB,null,p.createElement(aB,null,c&&p.createElement(_h,{onClick:()=>c()},p.createElement(Nt,{type:"menu",size:24,color:V.themedColor.textHighEmphasis})),y&&p.createElement(aM,{size:34}),p.createElement(oB,{variant:"h2",color:V.themedColor.onbackground1},o.nickname||u?.name)),p.createElement(sB,null,C&&p.createElement(rB,{tooltipLabel:s.HEADER_BUTTON__AGENT_HANDOFF,disabled:!J$(u),size:d,onClick:f}),r&&p.createElement(nB,{disabled:!ab(u),size:d,onClick:m}),i&&p.createElement(eB,{size:d}),p.createElement(tB,{size:d,onClick:h})))},eB=({size:e,disabled:n})=>{const{state:t}=Sn();return p.createElement(_h,{"aria-label":"expand",onClick:()=>t.setExpanded(!t.expanded),disabled:n},p.createElement(Nt,{type:t.expanded?"collapse":"expand",size:e,color:V.themedColor.textHighEmphasis}))},tB=({size:e,disabled:n,onClick:t})=>p.createElement(_h,{"aria-label":"close messenger",onClick:t,disabled:n},p.createElement(Nt,{type:"close",size:e,color:V.themedColor.textHighEmphasis})),nB=({size:e,disabled:n,onClick:t})=>p.createElement(_h,{"aria-label":"close conversation",onClick:t,disabled:n},p.createElement(Nt,{type:"refresh",size:e,color:n?V.themedColor.textDisabled:V.themedColor.textHighEmphasis})),rB=({size:e,onClick:n,disabled:t,tooltipLabel:r})=>p.createElement(WI,{label:r,position:"bottom",disabled:t},p.createElement(_h,{"aria-label":"agent",onClick:n,disabled:t},p.createElement(Nt,{type:"agent",size:e,color:t?V.themedColor.textDisabled:V.themedColor.textHighEmphasis}))),iB=q.div`height:56px;box-sizing:border-box;display:flex;align-items:center;padding:11px 12px;border-bottom:1px solid ${V.themedColor.onbackground4};background-color:${({theme:e})=>e.colors.base.headerBackground};`,aB=q.div`display:flex;flex:1;flex-direction:row;align-items:center;gap:6px;overflow:hidden;`,sB=q.div`display:flex;gap:10px;align-items:center;justify-content:center;`,oB=q(We)`text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:2px 0;`,_h=q.button`all:unset;padding:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;&:disabled{cursor:not-allowed;}`,lB=()=>{const{isDashboardActionbookTester:e}=Ym();return e?null:p.createElement(Jq,null)},YS=({children:e,onNavigateToConversationList:n,closedChannelUrl:t,onClearClosedChannelUrl:r})=>p.createElement(SH,{onNavigateToConversationList:n,closedChannelUrl:t,onClearClosedChannelUrl:r},p.createElement(C0,null,p.createElement(C0.Consumer,null,i=>p.createElement(p.Fragment,null,p.createElement(uB,{...i},p.createElement(lB,null),p.createElement(Aq,null),p.createElement(Xq,null)),e)))),uB=q.div`height:100%;width:100%;display:flex;flex-direction:column;flex:1;background-color:${({theme:e})=>e.colors.base.background};`,[cB,hM]=ts("ConversationList");function dB({onOpenConversationView:e=am,children:n}){const{chatSDK:t,aiAgentId:r}=Sn(),i=z7(t,{aiAgentId:r,status:Ar.CLOSED,order:Kd.UPDATED_AT,reverse:!0});return p.createElement(cB.Provider,{value:{dataSource:i,onOpenConversationView:e}},n)}const hB=({onClick:e,conversation:n})=>{var t;const{stringSet:r,dateLocale:i}=Gt();return p.createElement(fB,{role:"button",onClick:()=>e?.()},p.createElement(mB,null,p.createElement(_B,null,p.createElement(We,{variant:"subtitle1",color:V.themedColor.textHighEmphasis},Xp(n.channelInfo.lastMessageTs,r.DATE_FORMAT__CONVERSATION_LIST__LIST_ITEM_TITLE,{locale:i})),p.createElement(We,{variant:"caption2",color:V.themedColor.textLowEmphasis},Xp(n.channelInfo.lastMessageTs,r.DATE_FORMAT__CONVERSATION_LIST__LIST_ITEM_TITLE_CAPTION,{locale:i}))),p.createElement(We,{variant:"body3",color:V.themedColor.textMidEmphasis},((t=n.topics)==null?void 0:t.join(", "))||r.CONVERSATION_LIST__TOPICS_FALLBACK)),p.createElement(Nt,{type:"chevron-right",size:16,color:V.themedColor.textHighEmphasis}),p.createElement(pB,null))},fB=q.div`display:flex;flex-direction:row;align-items:center;position:relative;width:100%;padding:14px 16px;box-sizing:border-box;gap:4px;cursor:pointer;`,pB=q.div`position:absolute;bottom:0;height:1px;width:calc(100% - 32px);background-color:${V.themedColor.onbackground4};`,mB=q.div`gap:4px;display:flex;flex-direction:column;flex:1;`,_B=q.div`display:flex;justify-content:flex-start;align-items:center;gap:6px;`,gB=({items:e,renderItem:n,onEndReached:t})=>{const r=i=>{const a=i.target;a.scrollHeight-a.scrollTop===a.clientHeight&&t?.()};return p.createElement(vB,{onScroll:i=>r(i)},e.map((i,a)=>n(i,a)))},vB=q.div`width:100%;height:100%;display:flex;flex-direction:column;flex:1;overflow:auto;`,yB=()=>{const{stringSet:e}=Gt(),{dataSource:n,onOpenConversationView:t}=hM();return n.initialized?n.conversations.length===0?p.createElement(zu,{type:"noChannels",label:e.CONVERSATION_LIST__NO_CONVERSATIONS}):p.createElement(gB,{items:n.conversations,renderItem:(r,i)=>p.createElement(hB,{key:i,conversation:r,onClick:()=>t(r.channelInfo.url,Ar.CLOSED)}),onEndReached:()=>{n.loadMore()}}):p.createElement(zu,{type:"loading"})},bB=()=>{const{refreshActiveChannel:e}=Xn(),{onOpenConversationView:n}=hM(),t=lM();return p.createElement(EB,{role:"button",onClick:async()=>{const r=await e();n(r,Ar.OPEN)}},p.createElement(CB,{variant:"h1"},t))},EB=q.div`background-color:${({theme:e})=>e.colors.base.primary};display:flex;align-items:center;justify-content:center;padding:16px;cursor:pointer;`,CB=q(We)`color:${({theme:e})=>e.colors.base.primaryContrastContent};overflow:hidden;text-overflow:ellipsis;white-space:nowrap;`,SB=()=>{const{stringSet:e}=Gt();return p.createElement(TB,null,p.createElement(wB,{variant:"h2",color:V.themedColor.textHighEmphasis},e.CONVERSATION_LIST__HEADER_TITLE),p.createElement(AB,null))},TB=q.div`display:flex;flex-direction:column;align-items:flex-start;justify-content:center;width:100%;flex-shrink:0;height:56px;position:relative;background-color:${({theme:e})=>e.colors.base.headerBackground};`,wB=q(We)`padding:0 12px;width:100%;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;`,AB=q.div`position:absolute;bottom:0;width:100%;height:1px;background-color:${V.themedColor.onbackground4};`,NB=({children:e,onOpenConversationView:n})=>p.createElement(dB,{onOpenConversationView:n},p.createElement(IB,null,p.createElement(SB,null),p.createElement(yB,null),p.createElement(bB,null)),e),IB=q.div`height:100%;width:100%;display:flex;flex-direction:column;flex:1;background-color:${({theme:e})=>e.colors.base.background};`,fM=p.createContext(null);function MB(){const e=p.useContext(fM);if(!e)throw new Error("useNavigator() must be used within <Navigator />");return e}function pM({children:e}){const n=MB();return typeof e=="function"?e(n):p.createElement(p.Fragment,null,e)}const xB=ZN`0%{transform:translateY(40px);opacity:0;}100%{transform:translateY(0px);opacity:1;}`,OB=ZN`0%{transform:translateY(0px);opacity:1;}100%{transform:translateY(40px);opacity:0;}`,DB=at`animation:${xB} 0.3s forwards;`,kB=at``,RB=at`animation:${OB} 0.3s forwards;`,UB=at`visibility:hidden;`,LB=q.div`position:absolute;top:0;left:0;width:100%;height:100%;${({$transitionState:e})=>{switch(e){case"entering":return DB;case"entered":return kB;case"exiting":return RB;case"exited":return UB;default:return""}}}${({$active:e})=>e?at`
          z-index: 999;
        `:at`z-index:1;pointer-events:none;`}
`;function zc({initialId:e,children:n}){const t=p.useCallback((C,b)=>{l(v=>[...v,C]),c(v=>({...v,[C]:!0})),b!=null&&b.reset&&m(v=>({...v,[C]:(v[C]||0)+1})),h(v=>({...v,[C]:"entering"})),setTimeout(()=>{h(v=>({...v,[C]:"entered"}))},300)},[]),r=p.useCallback(()=>{l(C=>{if(C.length<=1)return C;const b=C[C.length-1];return h(v=>({...v,[b]:"exiting"})),setTimeout(()=>{h(v=>({...v,[b]:"exited"})),l(v=>v.slice(0,-1))},300),C})},[]),i=p.useMemo(()=>({navigation:{navigate:t,pop:r}}),[t,r]),a=p.useMemo(()=>p.Children.toArray(n).filter(C=>C.type===pM),[n]),s=p.useMemo(()=>{const C={};return a.forEach(b=>{const{id:v,lazy:E,children:S}=b.props;C[v]={lazy:E,element:typeof S=="function"?S(i):S}}),C},[a]),[o,l]=p.useState([e]),[u,c]=p.useState(()=>{const C={};return Object.entries(s).forEach(([b,{lazy:v}])=>{v===!1&&(C[b]=!0)}),C[e]=!0,C}),[d,h]=p.useState(()=>{const C={};return Object.keys(s).forEach(b=>{b===e?C[b]="entered":C[b]="exited"}),C}),[f,m]=p.useState({}),y=o[o.length-1];return p.createElement(fM.Provider,{value:i},p.createElement(PB,null,Object.keys(s).map(C=>{var b;if(!u[C])return null;const v=d[C]||"exited",E=C===y,S=`${C}-${f[C]||0}`;return p.createElement(LB,{key:S,$transitionState:v,$active:E},(b=s[C])==null?void 0:b.element)})))}const PB=q.div`position:relative;width:100%;height:100%;`;zc.Screen=pM;const Eo={activeConv:"active-conv",closedConv:"closed-conv",convList:"conv-list"},FB=({setClosedChannelUrl:e,closedChannelUrl:n})=>p.createElement(zc,{initialId:Eo.activeConv},p.createElement(zc.Screen,{id:Eo.activeConv},({navigation:t})=>p.createElement(YS,{onNavigateToConversationList:()=>t.navigate(Eo.convList,{reset:!0})})),p.createElement(zc.Screen,{id:Eo.closedConv},({navigation:t})=>p.createElement(YS,{onNavigateToConversationList:()=>t.pop(),closedChannelUrl:n,onClearClosedChannelUrl:()=>e(void 0)})),p.createElement(zc.Screen,{id:Eo.convList,lazy:!0},({navigation:t})=>p.createElement(NB,{onOpenConversationView:(r,i)=>{i==="closed"?(e(r),t.navigate(Eo.closedConv,{reset:!0})):t.navigate(Eo.activeConv)}})));q.div`display:flex;flex-direction:column;gap:8px;align-items:flex-end;`;q.div`background:${({theme:e})=>e.colors.base.background};display:flex;overscroll-behavior:none;-webkit-overflow-scrolling:auto;height:640px;min-height:80px;width:400px;max-width:80vw;max-height:80vh;box-shadow:0px 16px 24px 2px rgba(33,33,33,0.12),0px 6px 30px 5px rgba(33,33,33,0.08),0px 6px 10px -5px rgba(33,33,33,0.04);border-radius:16px;overflow:hidden;transition:width 200ms ease 0s,height 200ms ease 0s,max-height 200ms ease 0s,transform 150ms cubic-bezier(0,1.2,1,1) 0s,opacity 83ms ease-out 0s;transform:scale(0.15);opacity:0;transform-origin:right bottom;[dir='rtl'] &:not([dir='ltr']),&[dir='rtl']{transform-origin:left bottom;}${({$isOpened:e})=>e&&zB};${({$isExpanded:e})=>e&&$B};`;const $B=at`width:743px;height:723px;`,zB=at`z-index:${Al.WINDOW};pointer-events:all;transform:scale(1);opacity:1;transition:width 200ms ease 0s,height 200ms ease 0s,max-height 200ms ease 0s,transform 300ms cubic-bezier(0,1.2,1,1) 0s,opacity 83ms ease-out 0s;`;function HB(e){return p.createElement(qB,{...e})}const qB=q(pH)`position:fixed;z-index:${Al.LAUNCHER};bottom:24px;inset-inline-end:24px;`;function BB({isExpanded:e,isOpened:n,children:t}){const{dir:r}=Sn();return p.createElement(GB,{dir:r,id:eo.WINDOW,$isExpanded:e,$isOpened:n},t)}const GB=q.div`background:${({theme:e})=>e.colors.base.background};display:flex;overscroll-behavior:none;-webkit-overflow-scrolling:auto;position:fixed;bottom:84px;inset-inline-end:20px;height:640px;min-height:80px;width:400px;max-width:80vw;max-height:80vh;box-shadow:0px 16px 24px 2px rgba(33,33,33,0.12),0px 6px 30px 5px rgba(33,33,33,0.08),0px 6px 10px -5px rgba(33,33,33,0.04);border-radius:16px;overflow:hidden;transition:width 200ms ease 0s,height 200ms ease 0s,max-height 200ms ease 0s,transform 150ms cubic-bezier(0,1.2,1,1) 0s,opacity 83ms ease-out 0s;transform:scale(0.15);opacity:0;transform-origin:right bottom;[dir='rtl'] &:not([dir='ltr']),&[dir='rtl']{transform-origin:left bottom;}${({$isOpened:e})=>e&&jB};${({$isExpanded:e})=>e&&VB};`,VB=at`width:743px;height:723px;`,jB=at`z-index:${Al.WINDOW};pointer-events:all;transform:scale(1);opacity:1;transition:width 200ms ease 0s,height 200ms ease 0s,max-height 200ms ease 0s,transform 300ms cubic-bezier(0,1.2,1,1) 0s,opacity 83ms ease-out 0s;`,QB=({children:e,...n})=>{const t=Wm(),[r,i]=p.useState(),a=t?sH:BB;return p.createElement(iH,{enableExpandButton:!t,...n},p.createElement(P9,null,({state:s})=>p.createElement(p.Fragment,null,p.createElement(a,{isExpanded:s.expanded,isOpened:s.opened},p.createElement(FB,{closedChannelUrl:r,setClosedChannelUrl:i})),p.createElement(HB,null),e)))},KB=()=>{const{appConfig:e,updateAppConfig:n,getStringSet:t}=fO(),r=mO(e,t);return $i.jsxs("div",{className:"none",children:[$i.jsx("div",{className:"none",children:$i.jsx("p",{className:"mb-6 mt-3 text-base text-gray-500"})}),$i.jsx(QB,{...r,state:{opened:e.opened,setOpened:i=>n({opened:i})}},`messenger-${e.messengerKey}`)]})},WB=()=>$i.jsx(pO,{children:$i.jsx(KB,{})}),Bl={react:{label:"React (npm)",path:"/react-example"},cdn:{label:"CDN",path:"/cdn-example"}},Ef="react";function YB(){const[e,n]=p.useState(Ef);return p.useEffect(()=>{const r=window.location.pathname,i=Object.keys(Bl).find(a=>Bl[a].path===r);i?n(i):(n(Ef),(r==="/"||r==="")&&window.history.replaceState(null,"",Bl[Ef].path))},[]),p.useEffect(()=>{const r=()=>{const i=window.location.pathname,a=Object.keys(Bl).find(s=>Bl[s].path===i);n(a||Ef)};return window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)},[]),{activeTab:e,handleTabChange:r=>{n(r),window.history.pushState(null,"",Bl[r].path)}}}function ZB(){const{activeTab:e}=YB();return $i.jsxs("div",{className:"min-h-full",children:[$i.jsx("img",{src:"/swiftpage.png",alt:"Replacement",style:{maxWidth:"100%",height:"auto"}}),e==="react"&&$i.jsx(WB,{},"react-tab")]})}cO.createRoot(document.getElementById("root")).render($i.jsx(ZB,{}));const XB=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Nt as A,Mu as B,ye as R,We as T,Sy as W,nA as X,V as a,q as b,Mp as c,eG as d,JB as e,I as f,xg as g,vc as h,yc as i,j,o6 as k,Xy as l,k as m,eI as n,ar as o,OI as p,ZS as q,p as r,Qd as s,QI as w};
